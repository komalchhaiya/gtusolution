var ng=a=>{throw TypeError(a)};var Mu=(a,e,t)=>e.has(a)||ng("Cannot "+t);var Ve=(a,e,t)=>(Mu(a,e,"read from private field"),t?t.call(a):e.get(a)),Rn=(a,e,t)=>e.has(a)?ng("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(a):e.set(a,t),Ot=(a,e,t,n)=>(Mu(a,e,"write to private field"),n?n.call(a,t):e.set(a,t),t),In=(a,e,t)=>(Mu(a,e,"access private method"),t);var ig=(a,e,t,n)=>({set _(s){Ot(a,e,s,t)},get _(){return Ve(a,e,n)}});(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const l of o.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&n(l)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();function Lm(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var Nu={exports:{}},Qr={},Ou={exports:{}},xe={};var sg;function L0(){if(sg)return xe;sg=1;var a=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.iterator;function y(M){return M===null||typeof M!="object"?null:(M=g&&M[g]||M["@@iterator"],typeof M=="function"?M:null)}var w={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b=Object.assign,_={};function A(M,H,ne){this.props=M,this.context=H,this.refs=_,this.updater=ne||w}A.prototype.isReactComponent={},A.prototype.setState=function(M,H){if(typeof M!="object"&&typeof M!="function"&&M!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,M,H,"setState")},A.prototype.forceUpdate=function(M){this.updater.enqueueForceUpdate(this,M,"forceUpdate")};function E(){}E.prototype=A.prototype;function C(M,H,ne){this.props=M,this.context=H,this.refs=_,this.updater=ne||w}var T=C.prototype=new E;T.constructor=C,b(T,A.prototype),T.isPureReactComponent=!0;var R=Array.isArray,L=Object.prototype.hasOwnProperty,k={current:null},N={key:!0,ref:!0,__self:!0,__source:!0};function U(M,H,ne){var de,we={},ve=null,fe=null;if(H!=null)for(de in H.ref!==void 0&&(fe=H.ref),H.key!==void 0&&(ve=""+H.key),H)L.call(H,de)&&!N.hasOwnProperty(de)&&(we[de]=H[de]);var Ce=arguments.length-2;if(Ce===1)we.children=ne;else if(1<Ce){for(var Te=Array(Ce),ke=0;ke<Ce;ke++)Te[ke]=arguments[ke+2];we.children=Te}if(M&&M.defaultProps)for(de in Ce=M.defaultProps,Ce)we[de]===void 0&&(we[de]=Ce[de]);return{$$typeof:a,type:M,key:ve,ref:fe,props:we,_owner:k.current}}function z(M,H){return{$$typeof:a,type:M.type,key:H,ref:M.ref,props:M.props,_owner:M._owner}}function V(M){return typeof M=="object"&&M!==null&&M.$$typeof===a}function q(M){var H={"=":"=0",":":"=2"};return"$"+M.replace(/[=:]/g,function(ne){return H[ne]})}var ue=/\/+/g;function Q(M,H){return typeof M=="object"&&M!==null&&M.key!=null?q(""+M.key):H.toString(36)}function le(M,H,ne,de,we){var ve=typeof M;(ve==="undefined"||ve==="boolean")&&(M=null);var fe=!1;if(M===null)fe=!0;else switch(ve){case"string":case"number":fe=!0;break;case"object":switch(M.$$typeof){case a:case e:fe=!0}}if(fe)return fe=M,we=we(fe),M=de===""?"."+Q(fe,0):de,R(we)?(ne="",M!=null&&(ne=M.replace(ue,"$&/")+"/"),le(we,H,ne,"",function(ke){return ke})):we!=null&&(V(we)&&(we=z(we,ne+(!we.key||fe&&fe.key===we.key?"":(""+we.key).replace(ue,"$&/")+"/")+M)),H.push(we)),1;if(fe=0,de=de===""?".":de+":",R(M))for(var Ce=0;Ce<M.length;Ce++){ve=M[Ce];var Te=de+Q(ve,Ce);fe+=le(ve,H,ne,Te,we)}else if(Te=y(M),typeof Te=="function")for(M=Te.call(M),Ce=0;!(ve=M.next()).done;)ve=ve.value,Te=de+Q(ve,Ce++),fe+=le(ve,H,ne,Te,we);else if(ve==="object")throw H=String(M),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(M).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.");return fe}function ye(M,H,ne){if(M==null)return M;var de=[],we=0;return le(M,de,"","",function(ve){return H.call(ne,ve,we++)}),de}function J(M){if(M._status===-1){var H=M._result;H=H(),H.then(function(ne){(M._status===0||M._status===-1)&&(M._status=1,M._result=ne)},function(ne){(M._status===0||M._status===-1)&&(M._status=2,M._result=ne)}),M._status===-1&&(M._status=0,M._result=H)}if(M._status===1)return M._result.default;throw M._result}var K={current:null},$={transition:null},ee={ReactCurrentDispatcher:K,ReactCurrentBatchConfig:$,ReactCurrentOwner:k};function Z(){throw Error("act(...) is not supported in production builds of React.")}return xe.Children={map:ye,forEach:function(M,H,ne){ye(M,function(){H.apply(this,arguments)},ne)},count:function(M){var H=0;return ye(M,function(){H++}),H},toArray:function(M){return ye(M,function(H){return H})||[]},only:function(M){if(!V(M))throw Error("React.Children.only expected to receive a single React element child.");return M}},xe.Component=A,xe.Fragment=t,xe.Profiler=s,xe.PureComponent=C,xe.StrictMode=n,xe.Suspense=h,xe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ee,xe.act=Z,xe.cloneElement=function(M,H,ne){if(M==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+M+".");var de=b({},M.props),we=M.key,ve=M.ref,fe=M._owner;if(H!=null){if(H.ref!==void 0&&(ve=H.ref,fe=k.current),H.key!==void 0&&(we=""+H.key),M.type&&M.type.defaultProps)var Ce=M.type.defaultProps;for(Te in H)L.call(H,Te)&&!N.hasOwnProperty(Te)&&(de[Te]=H[Te]===void 0&&Ce!==void 0?Ce[Te]:H[Te])}var Te=arguments.length-2;if(Te===1)de.children=ne;else if(1<Te){Ce=Array(Te);for(var ke=0;ke<Te;ke++)Ce[ke]=arguments[ke+2];de.children=Ce}return{$$typeof:a,type:M.type,key:we,ref:ve,props:de,_owner:fe}},xe.createContext=function(M){return M={$$typeof:l,_currentValue:M,_currentValue2:M,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},M.Provider={$$typeof:o,_context:M},M.Consumer=M},xe.createElement=U,xe.createFactory=function(M){var H=U.bind(null,M);return H.type=M,H},xe.createRef=function(){return{current:null}},xe.forwardRef=function(M){return{$$typeof:c,render:M}},xe.isValidElement=V,xe.lazy=function(M){return{$$typeof:p,_payload:{_status:-1,_result:M},_init:J}},xe.memo=function(M,H){return{$$typeof:f,type:M,compare:H===void 0?null:H}},xe.startTransition=function(M){var H=$.transition;$.transition={};try{M()}finally{$.transition=H}},xe.unstable_act=Z,xe.useCallback=function(M,H){return K.current.useCallback(M,H)},xe.useContext=function(M){return K.current.useContext(M)},xe.useDebugValue=function(){},xe.useDeferredValue=function(M){return K.current.useDeferredValue(M)},xe.useEffect=function(M,H){return K.current.useEffect(M,H)},xe.useId=function(){return K.current.useId()},xe.useImperativeHandle=function(M,H,ne){return K.current.useImperativeHandle(M,H,ne)},xe.useInsertionEffect=function(M,H){return K.current.useInsertionEffect(M,H)},xe.useLayoutEffect=function(M,H){return K.current.useLayoutEffect(M,H)},xe.useMemo=function(M,H){return K.current.useMemo(M,H)},xe.useReducer=function(M,H,ne){return K.current.useReducer(M,H,ne)},xe.useRef=function(M){return K.current.useRef(M)},xe.useState=function(M){return K.current.useState(M)},xe.useSyncExternalStore=function(M,H,ne){return K.current.useSyncExternalStore(M,H,ne)},xe.useTransition=function(){return K.current.useTransition()},xe.version="18.3.1",xe}var rg;function xh(){return rg||(rg=1,Ou.exports=L0()),Ou.exports}var og;function D0(){if(og)return Qr;og=1;var a=xh(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,s=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function l(c,h,f){var p,g={},y=null,w=null;f!==void 0&&(y=""+f),h.key!==void 0&&(y=""+h.key),h.ref!==void 0&&(w=h.ref);for(p in h)n.call(h,p)&&!o.hasOwnProperty(p)&&(g[p]=h[p]);if(c&&c.defaultProps)for(p in h=c.defaultProps,h)g[p]===void 0&&(g[p]=h[p]);return{$$typeof:e,type:c,key:y,ref:w,props:g,_owner:s.current}}return Qr.Fragment=t,Qr.jsx=l,Qr.jsxs=l,Qr}var ag;function M0(){return ag||(ag=1,Nu.exports=D0()),Nu.exports}var j=M0(),I=xh(),Ka={},Fu={exports:{}},Ft={},Bu={exports:{}},Uu={};var lg;function N0(){return lg||(lg=1,(function(a){function e($,ee){var Z=$.length;$.push(ee);e:for(;0<Z;){var M=Z-1>>>1,H=$[M];if(0<s(H,ee))$[M]=ee,$[Z]=H,Z=M;else break e}}function t($){return $.length===0?null:$[0]}function n($){if($.length===0)return null;var ee=$[0],Z=$.pop();if(Z!==ee){$[0]=Z;e:for(var M=0,H=$.length,ne=H>>>1;M<ne;){var de=2*(M+1)-1,we=$[de],ve=de+1,fe=$[ve];if(0>s(we,Z))ve<H&&0>s(fe,we)?($[M]=fe,$[ve]=Z,M=ve):($[M]=we,$[de]=Z,M=de);else if(ve<H&&0>s(fe,Z))$[M]=fe,$[ve]=Z,M=ve;else break e}}return ee}function s($,ee){var Z=$.sortIndex-ee.sortIndex;return Z!==0?Z:$.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;a.unstable_now=function(){return o.now()}}else{var l=Date,c=l.now();a.unstable_now=function(){return l.now()-c}}var h=[],f=[],p=1,g=null,y=3,w=!1,b=!1,_=!1,A=typeof setTimeout=="function"?setTimeout:null,E=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T($){for(var ee=t(f);ee!==null;){if(ee.callback===null)n(f);else if(ee.startTime<=$)n(f),ee.sortIndex=ee.expirationTime,e(h,ee);else break;ee=t(f)}}function R($){if(_=!1,T($),!b)if(t(h)!==null)b=!0,J(L);else{var ee=t(f);ee!==null&&K(R,ee.startTime-$)}}function L($,ee){b=!1,_&&(_=!1,E(U),U=-1),w=!0;var Z=y;try{for(T(ee),g=t(h);g!==null&&(!(g.expirationTime>ee)||$&&!q());){var M=g.callback;if(typeof M=="function"){g.callback=null,y=g.priorityLevel;var H=M(g.expirationTime<=ee);ee=a.unstable_now(),typeof H=="function"?g.callback=H:g===t(h)&&n(h),T(ee)}else n(h);g=t(h)}if(g!==null)var ne=!0;else{var de=t(f);de!==null&&K(R,de.startTime-ee),ne=!1}return ne}finally{g=null,y=Z,w=!1}}var k=!1,N=null,U=-1,z=5,V=-1;function q(){return!(a.unstable_now()-V<z)}function ue(){if(N!==null){var $=a.unstable_now();V=$;var ee=!0;try{ee=N(!0,$)}finally{ee?Q():(k=!1,N=null)}}else k=!1}var Q;if(typeof C=="function")Q=function(){C(ue)};else if(typeof MessageChannel<"u"){var le=new MessageChannel,ye=le.port2;le.port1.onmessage=ue,Q=function(){ye.postMessage(null)}}else Q=function(){A(ue,0)};function J($){N=$,k||(k=!0,Q())}function K($,ee){U=A(function(){$(a.unstable_now())},ee)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function($){$.callback=null},a.unstable_continueExecution=function(){b||w||(b=!0,J(L))},a.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):z=0<$?Math.floor(1e3/$):5},a.unstable_getCurrentPriorityLevel=function(){return y},a.unstable_getFirstCallbackNode=function(){return t(h)},a.unstable_next=function($){switch(y){case 1:case 2:case 3:var ee=3;break;default:ee=y}var Z=y;y=ee;try{return $()}finally{y=Z}},a.unstable_pauseExecution=function(){},a.unstable_requestPaint=function(){},a.unstable_runWithPriority=function($,ee){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var Z=y;y=$;try{return ee()}finally{y=Z}},a.unstable_scheduleCallback=function($,ee,Z){var M=a.unstable_now();switch(typeof Z=="object"&&Z!==null?(Z=Z.delay,Z=typeof Z=="number"&&0<Z?M+Z:M):Z=M,$){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=Z+H,$={id:p++,callback:ee,priorityLevel:$,startTime:Z,expirationTime:H,sortIndex:-1},Z>M?($.sortIndex=Z,e(f,$),t(h)===null&&$===t(f)&&(_?(E(U),U=-1):_=!0,K(R,Z-M))):($.sortIndex=H,e(h,$),b||w||(b=!0,J(L))),$},a.unstable_shouldYield=q,a.unstable_wrapCallback=function($){var ee=y;return function(){var Z=y;y=ee;try{return $.apply(this,arguments)}finally{y=Z}}}})(Uu)),Uu}var cg;function O0(){return cg||(cg=1,Bu.exports=N0()),Bu.exports}var ug;function F0(){if(ug)return Ft;ug=1;var a=xh(),e=O0();function t(i){for(var r="https://reactjs.org/docs/error-decoder.html?invariant="+i,u=1;u<arguments.length;u++)r+="&args[]="+encodeURIComponent(arguments[u]);return"Minified React error #"+i+"; visit "+r+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,s={};function o(i,r){l(i,r),l(i+"Capture",r)}function l(i,r){for(s[i]=r,i=0;i<r.length;i++)n.add(r[i])}var c=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),h=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,p={},g={};function y(i){return h.call(g,i)?!0:h.call(p,i)?!1:f.test(i)?g[i]=!0:(p[i]=!0,!1)}function w(i,r,u,d){if(u!==null&&u.type===0)return!1;switch(typeof r){case"function":case"symbol":return!0;case"boolean":return d?!1:u!==null?!u.acceptsBooleans:(i=i.toLowerCase().slice(0,5),i!=="data-"&&i!=="aria-");default:return!1}}function b(i,r,u,d){if(r===null||typeof r>"u"||w(i,r,u,d))return!0;if(d)return!1;if(u!==null)switch(u.type){case 3:return!r;case 4:return r===!1;case 5:return isNaN(r);case 6:return isNaN(r)||1>r}return!1}function _(i,r,u,d,m,v,S){this.acceptsBooleans=r===2||r===3||r===4,this.attributeName=d,this.attributeNamespace=m,this.mustUseProperty=u,this.propertyName=i,this.type=r,this.sanitizeURL=v,this.removeEmptyString=S}var A={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(i){A[i]=new _(i,0,!1,i,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(i){var r=i[0];A[r]=new _(r,1,!1,i[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(i){A[i]=new _(i,2,!1,i.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(i){A[i]=new _(i,2,!1,i,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(i){A[i]=new _(i,3,!1,i.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(i){A[i]=new _(i,3,!0,i,null,!1,!1)}),["capture","download"].forEach(function(i){A[i]=new _(i,4,!1,i,null,!1,!1)}),["cols","rows","size","span"].forEach(function(i){A[i]=new _(i,6,!1,i,null,!1,!1)}),["rowSpan","start"].forEach(function(i){A[i]=new _(i,5,!1,i.toLowerCase(),null,!1,!1)});var E=/[\-:]([a-z])/g;function C(i){return i[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(i){var r=i.replace(E,C);A[r]=new _(r,1,!1,i,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(i){var r=i.replace(E,C);A[r]=new _(r,1,!1,i,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(i){var r=i.replace(E,C);A[r]=new _(r,1,!1,i,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(i){A[i]=new _(i,1,!1,i.toLowerCase(),null,!1,!1)}),A.xlinkHref=new _("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(i){A[i]=new _(i,1,!1,i.toLowerCase(),null,!0,!0)});function T(i,r,u,d){var m=A.hasOwnProperty(r)?A[r]:null;(m!==null?m.type!==0:d||!(2<r.length)||r[0]!=="o"&&r[0]!=="O"||r[1]!=="n"&&r[1]!=="N")&&(b(r,u,m,d)&&(u=null),d||m===null?y(r)&&(u===null?i.removeAttribute(r):i.setAttribute(r,""+u)):m.mustUseProperty?i[m.propertyName]=u===null?m.type===3?!1:"":u:(r=m.attributeName,d=m.attributeNamespace,u===null?i.removeAttribute(r):(m=m.type,u=m===3||m===4&&u===!0?"":""+u,d?i.setAttributeNS(d,r,u):i.setAttribute(r,u))))}var R=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,L=Symbol.for("react.element"),k=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),U=Symbol.for("react.strict_mode"),z=Symbol.for("react.profiler"),V=Symbol.for("react.provider"),q=Symbol.for("react.context"),ue=Symbol.for("react.forward_ref"),Q=Symbol.for("react.suspense"),le=Symbol.for("react.suspense_list"),ye=Symbol.for("react.memo"),J=Symbol.for("react.lazy"),K=Symbol.for("react.offscreen"),$=Symbol.iterator;function ee(i){return i===null||typeof i!="object"?null:(i=$&&i[$]||i["@@iterator"],typeof i=="function"?i:null)}var Z=Object.assign,M;function H(i){if(M===void 0)try{throw Error()}catch(u){var r=u.stack.trim().match(/\n( *(at )?)/);M=r&&r[1]||""}return`
`+M+i}var ne=!1;function de(i,r){if(!i||ne)return"";ne=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(r)if(r=function(){throw Error()},Object.defineProperty(r.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(r,[])}catch(B){var d=B}Reflect.construct(i,[],r)}else{try{r.call()}catch(B){d=B}i.call(r.prototype)}else{try{throw Error()}catch(B){d=B}i()}}catch(B){if(B&&d&&typeof B.stack=="string"){for(var m=B.stack.split(`
`),v=d.stack.split(`
`),S=m.length-1,x=v.length-1;1<=S&&0<=x&&m[S]!==v[x];)x--;for(;1<=S&&0<=x;S--,x--)if(m[S]!==v[x]){if(S!==1||x!==1)do if(S--,x--,0>x||m[S]!==v[x]){var P=`
`+m[S].replace(" at new "," at ");return i.displayName&&P.includes("<anonymous>")&&(P=P.replace("<anonymous>",i.displayName)),P}while(1<=S&&0<=x);break}}}finally{ne=!1,Error.prepareStackTrace=u}return(i=i?i.displayName||i.name:"")?H(i):""}function we(i){switch(i.tag){case 5:return H(i.type);case 16:return H("Lazy");case 13:return H("Suspense");case 19:return H("SuspenseList");case 0:case 2:case 15:return i=de(i.type,!1),i;case 11:return i=de(i.type.render,!1),i;case 1:return i=de(i.type,!0),i;default:return""}}function ve(i){if(i==null)return null;if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case N:return"Fragment";case k:return"Portal";case z:return"Profiler";case U:return"StrictMode";case Q:return"Suspense";case le:return"SuspenseList"}if(typeof i=="object")switch(i.$$typeof){case q:return(i.displayName||"Context")+".Consumer";case V:return(i._context.displayName||"Context")+".Provider";case ue:var r=i.render;return i=i.displayName,i||(i=r.displayName||r.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case ye:return r=i.displayName||null,r!==null?r:ve(i.type)||"Memo";case J:r=i._payload,i=i._init;try{return ve(i(r))}catch{}}return null}function fe(i){var r=i.type;switch(i.tag){case 24:return"Cache";case 9:return(r.displayName||"Context")+".Consumer";case 10:return(r._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return i=r.render,i=i.displayName||i.name||"",r.displayName||(i!==""?"ForwardRef("+i+")":"ForwardRef");case 7:return"Fragment";case 5:return r;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return ve(r);case 8:return r===U?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof r=="function")return r.displayName||r.name||null;if(typeof r=="string")return r}return null}function Ce(i){switch(typeof i){case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function Te(i){var r=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(r==="checkbox"||r==="radio")}function ke(i){var r=Te(i)?"checked":"value",u=Object.getOwnPropertyDescriptor(i.constructor.prototype,r),d=""+i[r];if(!i.hasOwnProperty(r)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var m=u.get,v=u.set;return Object.defineProperty(i,r,{configurable:!0,get:function(){return m.call(this)},set:function(S){d=""+S,v.call(this,S)}}),Object.defineProperty(i,r,{enumerable:u.enumerable}),{getValue:function(){return d},setValue:function(S){d=""+S},stopTracking:function(){i._valueTracker=null,delete i[r]}}}}function Rt(i){i._valueTracker||(i._valueTracker=ke(i))}function Xt(i){if(!i)return!1;var r=i._valueTracker;if(!r)return!0;var u=r.getValue(),d="";return i&&(d=Te(i)?i.checked?"true":"false":i.value),i=d,i!==u?(r.setValue(i),!0):!1}function Pe(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}function Ne(i,r){var u=r.checked;return Z({},r,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:u??i._wrapperState.initialChecked})}function Je(i,r){var u=r.defaultValue==null?"":r.defaultValue,d=r.checked!=null?r.checked:r.defaultChecked;u=Ce(r.value!=null?r.value:u),i._wrapperState={initialChecked:d,initialValue:u,controlled:r.type==="checkbox"||r.type==="radio"?r.checked!=null:r.value!=null}}function et(i,r){r=r.checked,r!=null&&T(i,"checked",r,!1)}function En(i,r){et(i,r);var u=Ce(r.value),d=r.type;if(u!=null)d==="number"?(u===0&&i.value===""||i.value!=u)&&(i.value=""+u):i.value!==""+u&&(i.value=""+u);else if(d==="submit"||d==="reset"){i.removeAttribute("value");return}r.hasOwnProperty("value")?Ui(i,r.type,u):r.hasOwnProperty("defaultValue")&&Ui(i,r.type,Ce(r.defaultValue)),r.checked==null&&r.defaultChecked!=null&&(i.defaultChecked=!!r.defaultChecked)}function li(i,r,u){if(r.hasOwnProperty("value")||r.hasOwnProperty("defaultValue")){var d=r.type;if(!(d!=="submit"&&d!=="reset"||r.value!==void 0&&r.value!==null))return;r=""+i._wrapperState.initialValue,u||r===i.value||(i.value=r),i.defaultValue=r}u=i.name,u!==""&&(i.name=""),i.defaultChecked=!!i._wrapperState.initialChecked,u!==""&&(i.name=u)}function Ui(i,r,u){(r!=="number"||Pe(i.ownerDocument)!==i)&&(u==null?i.defaultValue=""+i._wrapperState.initialValue:i.defaultValue!==""+u&&(i.defaultValue=""+u))}var ji=Array.isArray;function cn(i,r,u,d){if(i=i.options,r){r={};for(var m=0;m<u.length;m++)r["$"+u[m]]=!0;for(u=0;u<i.length;u++)m=r.hasOwnProperty("$"+i[u].value),i[u].selected!==m&&(i[u].selected=m),m&&d&&(i[u].defaultSelected=!0)}else{for(u=""+Ce(u),r=null,m=0;m<i.length;m++){if(i[m].value===u){i[m].selected=!0,d&&(i[m].defaultSelected=!0);return}r!==null||i[m].disabled||(r=i[m])}r!==null&&(r.selected=!0)}}function fr(i,r){if(r.dangerouslySetInnerHTML!=null)throw Error(t(91));return Z({},r,{value:void 0,defaultValue:void 0,children:""+i._wrapperState.initialValue})}function Bo(i,r){var u=r.value;if(u==null){if(u=r.children,r=r.defaultValue,u!=null){if(r!=null)throw Error(t(92));if(ji(u)){if(1<u.length)throw Error(t(93));u=u[0]}r=u}r==null&&(r=""),u=r}i._wrapperState={initialValue:Ce(u)}}function Uo(i,r){var u=Ce(r.value),d=Ce(r.defaultValue);u!=null&&(u=""+u,u!==i.value&&(i.value=u),r.defaultValue==null&&i.defaultValue!==u&&(i.defaultValue=u)),d!=null&&(i.defaultValue=""+d)}function jo(i){var r=i.textContent;r===i._wrapperState.initialValue&&r!==""&&r!==null&&(i.value=r)}function Ho(i){switch(i){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Kt(i,r){return i==null||i==="http://www.w3.org/1999/xhtml"?Ho(r):i==="http://www.w3.org/2000/svg"&&r==="foreignObject"?"http://www.w3.org/1999/xhtml":i}var un,hn=(function(i){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(r,u,d,m){MSApp.execUnsafeLocalFunction(function(){return i(r,u,d,m)})}:i})(function(i,r){if(i.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in i)i.innerHTML=r;else{for(un=un||document.createElement("div"),un.innerHTML="<svg>"+r.valueOf().toString()+"</svg>",r=un.firstChild;i.firstChild;)i.removeChild(i.firstChild);for(;r.firstChild;)i.appendChild(r.firstChild)}});function zn(i,r){if(r){var u=i.firstChild;if(u&&u===i.lastChild&&u.nodeType===3){u.nodeValue=r;return}}i.textContent=r}var pr={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Ov=["Webkit","ms","Moz","O"];Object.keys(pr).forEach(function(i){Ov.forEach(function(r){r=r+i.charAt(0).toUpperCase()+i.substring(1),pr[r]=pr[i]})});function md(i,r,u){return r==null||typeof r=="boolean"||r===""?"":u||typeof r!="number"||r===0||pr.hasOwnProperty(i)&&pr[i]?(""+r).trim():r+"px"}function yd(i,r){i=i.style;for(var u in r)if(r.hasOwnProperty(u)){var d=u.indexOf("--")===0,m=md(u,r[u],d);u==="float"&&(u="cssFloat"),d?i.setProperty(u,m):i[u]=m}}var Fv=Z({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gl(i,r){if(r){if(Fv[i]&&(r.children!=null||r.dangerouslySetInnerHTML!=null))throw Error(t(137,i));if(r.dangerouslySetInnerHTML!=null){if(r.children!=null)throw Error(t(60));if(typeof r.dangerouslySetInnerHTML!="object"||!("__html"in r.dangerouslySetInnerHTML))throw Error(t(61))}if(r.style!=null&&typeof r.style!="object")throw Error(t(62))}}function ql(i,r){if(i.indexOf("-")===-1)return typeof r.is=="string";switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xl=null;function Kl(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var Yl=null,gs=null,ms=null;function vd(i){if(i=Or(i)){if(typeof Yl!="function")throw Error(t(280));var r=i.stateNode;r&&(r=ua(r),Yl(i.stateNode,i.type,r))}}function wd(i){gs?ms?ms.push(i):ms=[i]:gs=i}function _d(){if(gs){var i=gs,r=ms;if(ms=gs=null,vd(i),r)for(i=0;i<r.length;i++)vd(r[i])}}function bd(i,r){return i(r)}function Sd(){}var Ql=!1;function Ad(i,r,u){if(Ql)return i(r,u);Ql=!0;try{return bd(i,r,u)}finally{Ql=!1,(gs!==null||ms!==null)&&(Sd(),_d())}}function gr(i,r){var u=i.stateNode;if(u===null)return null;var d=ua(u);if(d===null)return null;u=d[r];e:switch(r){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(d=!d.disabled)||(i=i.type,d=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!d;break e;default:i=!1}if(i)return null;if(u&&typeof u!="function")throw Error(t(231,r,typeof u));return u}var Jl=!1;if(c)try{var mr={};Object.defineProperty(mr,"passive",{get:function(){Jl=!0}}),window.addEventListener("test",mr,mr),window.removeEventListener("test",mr,mr)}catch{Jl=!1}function Bv(i,r,u,d,m,v,S,x,P){var B=Array.prototype.slice.call(arguments,3);try{r.apply(u,B)}catch(G){this.onError(G)}}var yr=!1,zo=null,$o=!1,Zl=null,Uv={onError:function(i){yr=!0,zo=i}};function jv(i,r,u,d,m,v,S,x,P){yr=!1,zo=null,Bv.apply(Uv,arguments)}function Hv(i,r,u,d,m,v,S,x,P){if(jv.apply(this,arguments),yr){if(yr){var B=zo;yr=!1,zo=null}else throw Error(t(198));$o||($o=!0,Zl=B)}}function Hi(i){var r=i,u=i;if(i.alternate)for(;r.return;)r=r.return;else{i=r;do r=i,(r.flags&4098)!==0&&(u=r.return),i=r.return;while(i)}return r.tag===3?u:null}function Ed(i){if(i.tag===13){var r=i.memoizedState;if(r===null&&(i=i.alternate,i!==null&&(r=i.memoizedState)),r!==null)return r.dehydrated}return null}function Cd(i){if(Hi(i)!==i)throw Error(t(188))}function zv(i){var r=i.alternate;if(!r){if(r=Hi(i),r===null)throw Error(t(188));return r!==i?null:i}for(var u=i,d=r;;){var m=u.return;if(m===null)break;var v=m.alternate;if(v===null){if(d=m.return,d!==null){u=d;continue}break}if(m.child===v.child){for(v=m.child;v;){if(v===u)return Cd(m),i;if(v===d)return Cd(m),r;v=v.sibling}throw Error(t(188))}if(u.return!==d.return)u=m,d=v;else{for(var S=!1,x=m.child;x;){if(x===u){S=!0,u=m,d=v;break}if(x===d){S=!0,d=m,u=v;break}x=x.sibling}if(!S){for(x=v.child;x;){if(x===u){S=!0,u=v,d=m;break}if(x===d){S=!0,d=v,u=m;break}x=x.sibling}if(!S)throw Error(t(189))}}if(u.alternate!==d)throw Error(t(190))}if(u.tag!==3)throw Error(t(188));return u.stateNode.current===u?i:r}function Td(i){return i=zv(i),i!==null?xd(i):null}function xd(i){if(i.tag===5||i.tag===6)return i;for(i=i.child;i!==null;){var r=xd(i);if(r!==null)return r;i=i.sibling}return null}var kd=e.unstable_scheduleCallback,Pd=e.unstable_cancelCallback,$v=e.unstable_shouldYield,Vv=e.unstable_requestPaint,tt=e.unstable_now,Wv=e.unstable_getCurrentPriorityLevel,ec=e.unstable_ImmediatePriority,Rd=e.unstable_UserBlockingPriority,Vo=e.unstable_NormalPriority,Gv=e.unstable_LowPriority,Id=e.unstable_IdlePriority,Wo=null,Cn=null;function qv(i){if(Cn&&typeof Cn.onCommitFiberRoot=="function")try{Cn.onCommitFiberRoot(Wo,i,void 0,(i.current.flags&128)===128)}catch{}}var dn=Math.clz32?Math.clz32:Yv,Xv=Math.log,Kv=Math.LN2;function Yv(i){return i>>>=0,i===0?32:31-(Xv(i)/Kv|0)|0}var Go=64,qo=4194304;function vr(i){switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return i&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return i}}function Xo(i,r){var u=i.pendingLanes;if(u===0)return 0;var d=0,m=i.suspendedLanes,v=i.pingedLanes,S=u&268435455;if(S!==0){var x=S&~m;x!==0?d=vr(x):(v&=S,v!==0&&(d=vr(v)))}else S=u&~m,S!==0?d=vr(S):v!==0&&(d=vr(v));if(d===0)return 0;if(r!==0&&r!==d&&(r&m)===0&&(m=d&-d,v=r&-r,m>=v||m===16&&(v&4194240)!==0))return r;if((d&4)!==0&&(d|=u&16),r=i.entangledLanes,r!==0)for(i=i.entanglements,r&=d;0<r;)u=31-dn(r),m=1<<u,d|=i[u],r&=~m;return d}function Qv(i,r){switch(i){case 1:case 2:case 4:return r+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jv(i,r){for(var u=i.suspendedLanes,d=i.pingedLanes,m=i.expirationTimes,v=i.pendingLanes;0<v;){var S=31-dn(v),x=1<<S,P=m[S];P===-1?((x&u)===0||(x&d)!==0)&&(m[S]=Qv(x,r)):P<=r&&(i.expiredLanes|=x),v&=~x}}function tc(i){return i=i.pendingLanes&-1073741825,i!==0?i:i&1073741824?1073741824:0}function Ld(){var i=Go;return Go<<=1,(Go&4194240)===0&&(Go=64),i}function nc(i){for(var r=[],u=0;31>u;u++)r.push(i);return r}function wr(i,r,u){i.pendingLanes|=r,r!==536870912&&(i.suspendedLanes=0,i.pingedLanes=0),i=i.eventTimes,r=31-dn(r),i[r]=u}function Zv(i,r){var u=i.pendingLanes&~r;i.pendingLanes=r,i.suspendedLanes=0,i.pingedLanes=0,i.expiredLanes&=r,i.mutableReadLanes&=r,i.entangledLanes&=r,r=i.entanglements;var d=i.eventTimes;for(i=i.expirationTimes;0<u;){var m=31-dn(u),v=1<<m;r[m]=0,d[m]=-1,i[m]=-1,u&=~v}}function ic(i,r){var u=i.entangledLanes|=r;for(i=i.entanglements;u;){var d=31-dn(u),m=1<<d;m&r|i[d]&r&&(i[d]|=r),u&=~m}}var Me=0;function Dd(i){return i&=-i,1<i?4<i?(i&268435455)!==0?16:536870912:4:1}var Md,sc,Nd,Od,Fd,rc=!1,Ko=[],ci=null,ui=null,hi=null,_r=new Map,br=new Map,di=[],ew="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Bd(i,r){switch(i){case"focusin":case"focusout":ci=null;break;case"dragenter":case"dragleave":ui=null;break;case"mouseover":case"mouseout":hi=null;break;case"pointerover":case"pointerout":_r.delete(r.pointerId);break;case"gotpointercapture":case"lostpointercapture":br.delete(r.pointerId)}}function Sr(i,r,u,d,m,v){return i===null||i.nativeEvent!==v?(i={blockedOn:r,domEventName:u,eventSystemFlags:d,nativeEvent:v,targetContainers:[m]},r!==null&&(r=Or(r),r!==null&&sc(r)),i):(i.eventSystemFlags|=d,r=i.targetContainers,m!==null&&r.indexOf(m)===-1&&r.push(m),i)}function tw(i,r,u,d,m){switch(r){case"focusin":return ci=Sr(ci,i,r,u,d,m),!0;case"dragenter":return ui=Sr(ui,i,r,u,d,m),!0;case"mouseover":return hi=Sr(hi,i,r,u,d,m),!0;case"pointerover":var v=m.pointerId;return _r.set(v,Sr(_r.get(v)||null,i,r,u,d,m)),!0;case"gotpointercapture":return v=m.pointerId,br.set(v,Sr(br.get(v)||null,i,r,u,d,m)),!0}return!1}function Ud(i){var r=zi(i.target);if(r!==null){var u=Hi(r);if(u!==null){if(r=u.tag,r===13){if(r=Ed(u),r!==null){i.blockedOn=r,Fd(i.priority,function(){Nd(u)});return}}else if(r===3&&u.stateNode.current.memoizedState.isDehydrated){i.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}i.blockedOn=null}function Yo(i){if(i.blockedOn!==null)return!1;for(var r=i.targetContainers;0<r.length;){var u=ac(i.domEventName,i.eventSystemFlags,r[0],i.nativeEvent);if(u===null){u=i.nativeEvent;var d=new u.constructor(u.type,u);Xl=d,u.target.dispatchEvent(d),Xl=null}else return r=Or(u),r!==null&&sc(r),i.blockedOn=u,!1;r.shift()}return!0}function jd(i,r,u){Yo(i)&&u.delete(r)}function nw(){rc=!1,ci!==null&&Yo(ci)&&(ci=null),ui!==null&&Yo(ui)&&(ui=null),hi!==null&&Yo(hi)&&(hi=null),_r.forEach(jd),br.forEach(jd)}function Ar(i,r){i.blockedOn===r&&(i.blockedOn=null,rc||(rc=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,nw)))}function Er(i){function r(m){return Ar(m,i)}if(0<Ko.length){Ar(Ko[0],i);for(var u=1;u<Ko.length;u++){var d=Ko[u];d.blockedOn===i&&(d.blockedOn=null)}}for(ci!==null&&Ar(ci,i),ui!==null&&Ar(ui,i),hi!==null&&Ar(hi,i),_r.forEach(r),br.forEach(r),u=0;u<di.length;u++)d=di[u],d.blockedOn===i&&(d.blockedOn=null);for(;0<di.length&&(u=di[0],u.blockedOn===null);)Ud(u),u.blockedOn===null&&di.shift()}var ys=R.ReactCurrentBatchConfig,Qo=!0;function iw(i,r,u,d){var m=Me,v=ys.transition;ys.transition=null;try{Me=1,oc(i,r,u,d)}finally{Me=m,ys.transition=v}}function sw(i,r,u,d){var m=Me,v=ys.transition;ys.transition=null;try{Me=4,oc(i,r,u,d)}finally{Me=m,ys.transition=v}}function oc(i,r,u,d){if(Qo){var m=ac(i,r,u,d);if(m===null)Ec(i,r,d,Jo,u),Bd(i,d);else if(tw(m,i,r,u,d))d.stopPropagation();else if(Bd(i,d),r&4&&-1<ew.indexOf(i)){for(;m!==null;){var v=Or(m);if(v!==null&&Md(v),v=ac(i,r,u,d),v===null&&Ec(i,r,d,Jo,u),v===m)break;m=v}m!==null&&d.stopPropagation()}else Ec(i,r,d,null,u)}}var Jo=null;function ac(i,r,u,d){if(Jo=null,i=Kl(d),i=zi(i),i!==null)if(r=Hi(i),r===null)i=null;else if(u=r.tag,u===13){if(i=Ed(r),i!==null)return i;i=null}else if(u===3){if(r.stateNode.current.memoizedState.isDehydrated)return r.tag===3?r.stateNode.containerInfo:null;i=null}else r!==i&&(i=null);return Jo=i,null}function Hd(i){switch(i){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Wv()){case ec:return 1;case Rd:return 4;case Vo:case Gv:return 16;case Id:return 536870912;default:return 16}default:return 16}}var fi=null,lc=null,Zo=null;function zd(){if(Zo)return Zo;var i,r=lc,u=r.length,d,m="value"in fi?fi.value:fi.textContent,v=m.length;for(i=0;i<u&&r[i]===m[i];i++);var S=u-i;for(d=1;d<=S&&r[u-d]===m[v-d];d++);return Zo=m.slice(i,1<d?1-d:void 0)}function ea(i){var r=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&r===13&&(i=13)):i=r,i===10&&(i=13),32<=i||i===13?i:0}function ta(){return!0}function $d(){return!1}function jt(i){function r(u,d,m,v,S){this._reactName=u,this._targetInst=m,this.type=d,this.nativeEvent=v,this.target=S,this.currentTarget=null;for(var x in i)i.hasOwnProperty(x)&&(u=i[x],this[x]=u?u(v):v[x]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?ta:$d,this.isPropagationStopped=$d,this}return Z(r.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=ta)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=ta)},persist:function(){},isPersistent:ta}),r}var vs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cc=jt(vs),Cr=Z({},vs,{view:0,detail:0}),rw=jt(Cr),uc,hc,Tr,na=Z({},Cr,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:fc,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Tr&&(Tr&&i.type==="mousemove"?(uc=i.screenX-Tr.screenX,hc=i.screenY-Tr.screenY):hc=uc=0,Tr=i),uc)},movementY:function(i){return"movementY"in i?i.movementY:hc}}),Vd=jt(na),ow=Z({},na,{dataTransfer:0}),aw=jt(ow),lw=Z({},Cr,{relatedTarget:0}),dc=jt(lw),cw=Z({},vs,{animationName:0,elapsedTime:0,pseudoElement:0}),uw=jt(cw),hw=Z({},vs,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),dw=jt(hw),fw=Z({},vs,{data:0}),Wd=jt(fw),pw={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},gw={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},mw={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function yw(i){var r=this.nativeEvent;return r.getModifierState?r.getModifierState(i):(i=mw[i])?!!r[i]:!1}function fc(){return yw}var vw=Z({},Cr,{key:function(i){if(i.key){var r=pw[i.key]||i.key;if(r!=="Unidentified")return r}return i.type==="keypress"?(i=ea(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?gw[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:fc,charCode:function(i){return i.type==="keypress"?ea(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?ea(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),ww=jt(vw),_w=Z({},na,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gd=jt(_w),bw=Z({},Cr,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:fc}),Sw=jt(bw),Aw=Z({},vs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ew=jt(Aw),Cw=Z({},na,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Tw=jt(Cw),xw=[9,13,27,32],pc=c&&"CompositionEvent"in window,xr=null;c&&"documentMode"in document&&(xr=document.documentMode);var kw=c&&"TextEvent"in window&&!xr,qd=c&&(!pc||xr&&8<xr&&11>=xr),Xd=" ",Kd=!1;function Yd(i,r){switch(i){case"keyup":return xw.indexOf(r.keyCode)!==-1;case"keydown":return r.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qd(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var ws=!1;function Pw(i,r){switch(i){case"compositionend":return Qd(r);case"keypress":return r.which!==32?null:(Kd=!0,Xd);case"textInput":return i=r.data,i===Xd&&Kd?null:i;default:return null}}function Rw(i,r){if(ws)return i==="compositionend"||!pc&&Yd(i,r)?(i=zd(),Zo=lc=fi=null,ws=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(r.ctrlKey||r.altKey||r.metaKey)||r.ctrlKey&&r.altKey){if(r.char&&1<r.char.length)return r.char;if(r.which)return String.fromCharCode(r.which)}return null;case"compositionend":return qd&&r.locale!=="ko"?null:r.data;default:return null}}var Iw={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jd(i){var r=i&&i.nodeName&&i.nodeName.toLowerCase();return r==="input"?!!Iw[i.type]:r==="textarea"}function Zd(i,r,u,d){wd(d),r=aa(r,"onChange"),0<r.length&&(u=new cc("onChange","change",null,u,d),i.push({event:u,listeners:r}))}var kr=null,Pr=null;function Lw(i){vf(i,0)}function ia(i){var r=Es(i);if(Xt(r))return i}function Dw(i,r){if(i==="change")return r}var ef=!1;if(c){var gc;if(c){var mc="oninput"in document;if(!mc){var tf=document.createElement("div");tf.setAttribute("oninput","return;"),mc=typeof tf.oninput=="function"}gc=mc}else gc=!1;ef=gc&&(!document.documentMode||9<document.documentMode)}function nf(){kr&&(kr.detachEvent("onpropertychange",sf),Pr=kr=null)}function sf(i){if(i.propertyName==="value"&&ia(Pr)){var r=[];Zd(r,Pr,i,Kl(i)),Ad(Lw,r)}}function Mw(i,r,u){i==="focusin"?(nf(),kr=r,Pr=u,kr.attachEvent("onpropertychange",sf)):i==="focusout"&&nf()}function Nw(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return ia(Pr)}function Ow(i,r){if(i==="click")return ia(r)}function Fw(i,r){if(i==="input"||i==="change")return ia(r)}function Bw(i,r){return i===r&&(i!==0||1/i===1/r)||i!==i&&r!==r}var fn=typeof Object.is=="function"?Object.is:Bw;function Rr(i,r){if(fn(i,r))return!0;if(typeof i!="object"||i===null||typeof r!="object"||r===null)return!1;var u=Object.keys(i),d=Object.keys(r);if(u.length!==d.length)return!1;for(d=0;d<u.length;d++){var m=u[d];if(!h.call(r,m)||!fn(i[m],r[m]))return!1}return!0}function rf(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function of(i,r){var u=rf(i);i=0;for(var d;u;){if(u.nodeType===3){if(d=i+u.textContent.length,i<=r&&d>=r)return{node:u,offset:r-i};i=d}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=rf(u)}}function af(i,r){return i&&r?i===r?!0:i&&i.nodeType===3?!1:r&&r.nodeType===3?af(i,r.parentNode):"contains"in i?i.contains(r):i.compareDocumentPosition?!!(i.compareDocumentPosition(r)&16):!1:!1}function lf(){for(var i=window,r=Pe();r instanceof i.HTMLIFrameElement;){try{var u=typeof r.contentWindow.location.href=="string"}catch{u=!1}if(u)i=r.contentWindow;else break;r=Pe(i.document)}return r}function yc(i){var r=i&&i.nodeName&&i.nodeName.toLowerCase();return r&&(r==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||r==="textarea"||i.contentEditable==="true")}function Uw(i){var r=lf(),u=i.focusedElem,d=i.selectionRange;if(r!==u&&u&&u.ownerDocument&&af(u.ownerDocument.documentElement,u)){if(d!==null&&yc(u)){if(r=d.start,i=d.end,i===void 0&&(i=r),"selectionStart"in u)u.selectionStart=r,u.selectionEnd=Math.min(i,u.value.length);else if(i=(r=u.ownerDocument||document)&&r.defaultView||window,i.getSelection){i=i.getSelection();var m=u.textContent.length,v=Math.min(d.start,m);d=d.end===void 0?v:Math.min(d.end,m),!i.extend&&v>d&&(m=d,d=v,v=m),m=of(u,v);var S=of(u,d);m&&S&&(i.rangeCount!==1||i.anchorNode!==m.node||i.anchorOffset!==m.offset||i.focusNode!==S.node||i.focusOffset!==S.offset)&&(r=r.createRange(),r.setStart(m.node,m.offset),i.removeAllRanges(),v>d?(i.addRange(r),i.extend(S.node,S.offset)):(r.setEnd(S.node,S.offset),i.addRange(r)))}}for(r=[],i=u;i=i.parentNode;)i.nodeType===1&&r.push({element:i,left:i.scrollLeft,top:i.scrollTop});for(typeof u.focus=="function"&&u.focus(),u=0;u<r.length;u++)i=r[u],i.element.scrollLeft=i.left,i.element.scrollTop=i.top}}var jw=c&&"documentMode"in document&&11>=document.documentMode,_s=null,vc=null,Ir=null,wc=!1;function cf(i,r,u){var d=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;wc||_s==null||_s!==Pe(d)||(d=_s,"selectionStart"in d&&yc(d)?d={start:d.selectionStart,end:d.selectionEnd}:(d=(d.ownerDocument&&d.ownerDocument.defaultView||window).getSelection(),d={anchorNode:d.anchorNode,anchorOffset:d.anchorOffset,focusNode:d.focusNode,focusOffset:d.focusOffset}),Ir&&Rr(Ir,d)||(Ir=d,d=aa(vc,"onSelect"),0<d.length&&(r=new cc("onSelect","select",null,r,u),i.push({event:r,listeners:d}),r.target=_s)))}function sa(i,r){var u={};return u[i.toLowerCase()]=r.toLowerCase(),u["Webkit"+i]="webkit"+r,u["Moz"+i]="moz"+r,u}var bs={animationend:sa("Animation","AnimationEnd"),animationiteration:sa("Animation","AnimationIteration"),animationstart:sa("Animation","AnimationStart"),transitionend:sa("Transition","TransitionEnd")},_c={},uf={};c&&(uf=document.createElement("div").style,"AnimationEvent"in window||(delete bs.animationend.animation,delete bs.animationiteration.animation,delete bs.animationstart.animation),"TransitionEvent"in window||delete bs.transitionend.transition);function ra(i){if(_c[i])return _c[i];if(!bs[i])return i;var r=bs[i],u;for(u in r)if(r.hasOwnProperty(u)&&u in uf)return _c[i]=r[u];return i}var hf=ra("animationend"),df=ra("animationiteration"),ff=ra("animationstart"),pf=ra("transitionend"),gf=new Map,mf="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function pi(i,r){gf.set(i,r),o(r,[i])}for(var bc=0;bc<mf.length;bc++){var Sc=mf[bc],Hw=Sc.toLowerCase(),zw=Sc[0].toUpperCase()+Sc.slice(1);pi(Hw,"on"+zw)}pi(hf,"onAnimationEnd"),pi(df,"onAnimationIteration"),pi(ff,"onAnimationStart"),pi("dblclick","onDoubleClick"),pi("focusin","onFocus"),pi("focusout","onBlur"),pi(pf,"onTransitionEnd"),l("onMouseEnter",["mouseout","mouseover"]),l("onMouseLeave",["mouseout","mouseover"]),l("onPointerEnter",["pointerout","pointerover"]),l("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Lr="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),$w=new Set("cancel close invalid load scroll toggle".split(" ").concat(Lr));function yf(i,r,u){var d=i.type||"unknown-event";i.currentTarget=u,Hv(d,r,void 0,i),i.currentTarget=null}function vf(i,r){r=(r&4)!==0;for(var u=0;u<i.length;u++){var d=i[u],m=d.event;d=d.listeners;e:{var v=void 0;if(r)for(var S=d.length-1;0<=S;S--){var x=d[S],P=x.instance,B=x.currentTarget;if(x=x.listener,P!==v&&m.isPropagationStopped())break e;yf(m,x,B),v=P}else for(S=0;S<d.length;S++){if(x=d[S],P=x.instance,B=x.currentTarget,x=x.listener,P!==v&&m.isPropagationStopped())break e;yf(m,x,B),v=P}}}if($o)throw i=Zl,$o=!1,Zl=null,i}function He(i,r){var u=r[Rc];u===void 0&&(u=r[Rc]=new Set);var d=i+"__bubble";u.has(d)||(wf(r,i,2,!1),u.add(d))}function Ac(i,r,u){var d=0;r&&(d|=4),wf(u,i,d,r)}var oa="_reactListening"+Math.random().toString(36).slice(2);function Dr(i){if(!i[oa]){i[oa]=!0,n.forEach(function(u){u!=="selectionchange"&&($w.has(u)||Ac(u,!1,i),Ac(u,!0,i))});var r=i.nodeType===9?i:i.ownerDocument;r===null||r[oa]||(r[oa]=!0,Ac("selectionchange",!1,r))}}function wf(i,r,u,d){switch(Hd(r)){case 1:var m=iw;break;case 4:m=sw;break;default:m=oc}u=m.bind(null,r,u,i),m=void 0,!Jl||r!=="touchstart"&&r!=="touchmove"&&r!=="wheel"||(m=!0),d?m!==void 0?i.addEventListener(r,u,{capture:!0,passive:m}):i.addEventListener(r,u,!0):m!==void 0?i.addEventListener(r,u,{passive:m}):i.addEventListener(r,u,!1)}function Ec(i,r,u,d,m){var v=d;if((r&1)===0&&(r&2)===0&&d!==null)e:for(;;){if(d===null)return;var S=d.tag;if(S===3||S===4){var x=d.stateNode.containerInfo;if(x===m||x.nodeType===8&&x.parentNode===m)break;if(S===4)for(S=d.return;S!==null;){var P=S.tag;if((P===3||P===4)&&(P=S.stateNode.containerInfo,P===m||P.nodeType===8&&P.parentNode===m))return;S=S.return}for(;x!==null;){if(S=zi(x),S===null)return;if(P=S.tag,P===5||P===6){d=v=S;continue e}x=x.parentNode}}d=d.return}Ad(function(){var B=v,G=Kl(u),X=[];e:{var W=gf.get(i);if(W!==void 0){var te=cc,oe=i;switch(i){case"keypress":if(ea(u)===0)break e;case"keydown":case"keyup":te=ww;break;case"focusin":oe="focus",te=dc;break;case"focusout":oe="blur",te=dc;break;case"beforeblur":case"afterblur":te=dc;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":te=Vd;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":te=aw;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":te=Sw;break;case hf:case df:case ff:te=uw;break;case pf:te=Ew;break;case"scroll":te=rw;break;case"wheel":te=Tw;break;case"copy":case"cut":case"paste":te=dw;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":te=Gd}var ae=(r&4)!==0,nt=!ae&&i==="scroll",O=ae?W!==null?W+"Capture":null:W;ae=[];for(var D=B,F;D!==null;){F=D;var Y=F.stateNode;if(F.tag===5&&Y!==null&&(F=Y,O!==null&&(Y=gr(D,O),Y!=null&&ae.push(Mr(D,Y,F)))),nt)break;D=D.return}0<ae.length&&(W=new te(W,oe,null,u,G),X.push({event:W,listeners:ae}))}}if((r&7)===0){e:{if(W=i==="mouseover"||i==="pointerover",te=i==="mouseout"||i==="pointerout",W&&u!==Xl&&(oe=u.relatedTarget||u.fromElement)&&(zi(oe)||oe[$n]))break e;if((te||W)&&(W=G.window===G?G:(W=G.ownerDocument)?W.defaultView||W.parentWindow:window,te?(oe=u.relatedTarget||u.toElement,te=B,oe=oe?zi(oe):null,oe!==null&&(nt=Hi(oe),oe!==nt||oe.tag!==5&&oe.tag!==6)&&(oe=null)):(te=null,oe=B),te!==oe)){if(ae=Vd,Y="onMouseLeave",O="onMouseEnter",D="mouse",(i==="pointerout"||i==="pointerover")&&(ae=Gd,Y="onPointerLeave",O="onPointerEnter",D="pointer"),nt=te==null?W:Es(te),F=oe==null?W:Es(oe),W=new ae(Y,D+"leave",te,u,G),W.target=nt,W.relatedTarget=F,Y=null,zi(G)===B&&(ae=new ae(O,D+"enter",oe,u,G),ae.target=F,ae.relatedTarget=nt,Y=ae),nt=Y,te&&oe)t:{for(ae=te,O=oe,D=0,F=ae;F;F=Ss(F))D++;for(F=0,Y=O;Y;Y=Ss(Y))F++;for(;0<D-F;)ae=Ss(ae),D--;for(;0<F-D;)O=Ss(O),F--;for(;D--;){if(ae===O||O!==null&&ae===O.alternate)break t;ae=Ss(ae),O=Ss(O)}ae=null}else ae=null;te!==null&&_f(X,W,te,ae,!1),oe!==null&&nt!==null&&_f(X,nt,oe,ae,!0)}}e:{if(W=B?Es(B):window,te=W.nodeName&&W.nodeName.toLowerCase(),te==="select"||te==="input"&&W.type==="file")var ce=Dw;else if(Jd(W))if(ef)ce=Fw;else{ce=Nw;var pe=Mw}else(te=W.nodeName)&&te.toLowerCase()==="input"&&(W.type==="checkbox"||W.type==="radio")&&(ce=Ow);if(ce&&(ce=ce(i,B))){Zd(X,ce,u,G);break e}pe&&pe(i,W,B),i==="focusout"&&(pe=W._wrapperState)&&pe.controlled&&W.type==="number"&&Ui(W,"number",W.value)}switch(pe=B?Es(B):window,i){case"focusin":(Jd(pe)||pe.contentEditable==="true")&&(_s=pe,vc=B,Ir=null);break;case"focusout":Ir=vc=_s=null;break;case"mousedown":wc=!0;break;case"contextmenu":case"mouseup":case"dragend":wc=!1,cf(X,u,G);break;case"selectionchange":if(jw)break;case"keydown":case"keyup":cf(X,u,G)}var ge;if(pc)e:{switch(i){case"compositionstart":var _e="onCompositionStart";break e;case"compositionend":_e="onCompositionEnd";break e;case"compositionupdate":_e="onCompositionUpdate";break e}_e=void 0}else ws?Yd(i,u)&&(_e="onCompositionEnd"):i==="keydown"&&u.keyCode===229&&(_e="onCompositionStart");_e&&(qd&&u.locale!=="ko"&&(ws||_e!=="onCompositionStart"?_e==="onCompositionEnd"&&ws&&(ge=zd()):(fi=G,lc="value"in fi?fi.value:fi.textContent,ws=!0)),pe=aa(B,_e),0<pe.length&&(_e=new Wd(_e,i,null,u,G),X.push({event:_e,listeners:pe}),ge?_e.data=ge:(ge=Qd(u),ge!==null&&(_e.data=ge)))),(ge=kw?Pw(i,u):Rw(i,u))&&(B=aa(B,"onBeforeInput"),0<B.length&&(G=new Wd("onBeforeInput","beforeinput",null,u,G),X.push({event:G,listeners:B}),G.data=ge))}vf(X,r)})}function Mr(i,r,u){return{instance:i,listener:r,currentTarget:u}}function aa(i,r){for(var u=r+"Capture",d=[];i!==null;){var m=i,v=m.stateNode;m.tag===5&&v!==null&&(m=v,v=gr(i,u),v!=null&&d.unshift(Mr(i,v,m)),v=gr(i,r),v!=null&&d.push(Mr(i,v,m))),i=i.return}return d}function Ss(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5);return i||null}function _f(i,r,u,d,m){for(var v=r._reactName,S=[];u!==null&&u!==d;){var x=u,P=x.alternate,B=x.stateNode;if(P!==null&&P===d)break;x.tag===5&&B!==null&&(x=B,m?(P=gr(u,v),P!=null&&S.unshift(Mr(u,P,x))):m||(P=gr(u,v),P!=null&&S.push(Mr(u,P,x)))),u=u.return}S.length!==0&&i.push({event:r,listeners:S})}var Vw=/\r\n?/g,Ww=/\u0000|\uFFFD/g;function bf(i){return(typeof i=="string"?i:""+i).replace(Vw,`
`).replace(Ww,"")}function la(i,r,u){if(r=bf(r),bf(i)!==r&&u)throw Error(t(425))}function ca(){}var Cc=null,Tc=null;function xc(i,r){return i==="textarea"||i==="noscript"||typeof r.children=="string"||typeof r.children=="number"||typeof r.dangerouslySetInnerHTML=="object"&&r.dangerouslySetInnerHTML!==null&&r.dangerouslySetInnerHTML.__html!=null}var kc=typeof setTimeout=="function"?setTimeout:void 0,Gw=typeof clearTimeout=="function"?clearTimeout:void 0,Sf=typeof Promise=="function"?Promise:void 0,qw=typeof queueMicrotask=="function"?queueMicrotask:typeof Sf<"u"?function(i){return Sf.resolve(null).then(i).catch(Xw)}:kc;function Xw(i){setTimeout(function(){throw i})}function Pc(i,r){var u=r,d=0;do{var m=u.nextSibling;if(i.removeChild(u),m&&m.nodeType===8)if(u=m.data,u==="/$"){if(d===0){i.removeChild(m),Er(r);return}d--}else u!=="$"&&u!=="$?"&&u!=="$!"||d++;u=m}while(u);Er(r)}function gi(i){for(;i!=null;i=i.nextSibling){var r=i.nodeType;if(r===1||r===3)break;if(r===8){if(r=i.data,r==="$"||r==="$!"||r==="$?")break;if(r==="/$")return null}}return i}function Af(i){i=i.previousSibling;for(var r=0;i;){if(i.nodeType===8){var u=i.data;if(u==="$"||u==="$!"||u==="$?"){if(r===0)return i;r--}else u==="/$"&&r++}i=i.previousSibling}return null}var As=Math.random().toString(36).slice(2),Tn="__reactFiber$"+As,Nr="__reactProps$"+As,$n="__reactContainer$"+As,Rc="__reactEvents$"+As,Kw="__reactListeners$"+As,Yw="__reactHandles$"+As;function zi(i){var r=i[Tn];if(r)return r;for(var u=i.parentNode;u;){if(r=u[$n]||u[Tn]){if(u=r.alternate,r.child!==null||u!==null&&u.child!==null)for(i=Af(i);i!==null;){if(u=i[Tn])return u;i=Af(i)}return r}i=u,u=i.parentNode}return null}function Or(i){return i=i[Tn]||i[$n],!i||i.tag!==5&&i.tag!==6&&i.tag!==13&&i.tag!==3?null:i}function Es(i){if(i.tag===5||i.tag===6)return i.stateNode;throw Error(t(33))}function ua(i){return i[Nr]||null}var Ic=[],Cs=-1;function mi(i){return{current:i}}function ze(i){0>Cs||(i.current=Ic[Cs],Ic[Cs]=null,Cs--)}function je(i,r){Cs++,Ic[Cs]=i.current,i.current=r}var yi={},wt=mi(yi),It=mi(!1),$i=yi;function Ts(i,r){var u=i.type.contextTypes;if(!u)return yi;var d=i.stateNode;if(d&&d.__reactInternalMemoizedUnmaskedChildContext===r)return d.__reactInternalMemoizedMaskedChildContext;var m={},v;for(v in u)m[v]=r[v];return d&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=r,i.__reactInternalMemoizedMaskedChildContext=m),m}function Lt(i){return i=i.childContextTypes,i!=null}function ha(){ze(It),ze(wt)}function Ef(i,r,u){if(wt.current!==yi)throw Error(t(168));je(wt,r),je(It,u)}function Cf(i,r,u){var d=i.stateNode;if(r=r.childContextTypes,typeof d.getChildContext!="function")return u;d=d.getChildContext();for(var m in d)if(!(m in r))throw Error(t(108,fe(i)||"Unknown",m));return Z({},u,d)}function da(i){return i=(i=i.stateNode)&&i.__reactInternalMemoizedMergedChildContext||yi,$i=wt.current,je(wt,i),je(It,It.current),!0}function Tf(i,r,u){var d=i.stateNode;if(!d)throw Error(t(169));u?(i=Cf(i,r,$i),d.__reactInternalMemoizedMergedChildContext=i,ze(It),ze(wt),je(wt,i)):ze(It),je(It,u)}var Vn=null,fa=!1,Lc=!1;function xf(i){Vn===null?Vn=[i]:Vn.push(i)}function Qw(i){fa=!0,xf(i)}function vi(){if(!Lc&&Vn!==null){Lc=!0;var i=0,r=Me;try{var u=Vn;for(Me=1;i<u.length;i++){var d=u[i];do d=d(!0);while(d!==null)}Vn=null,fa=!1}catch(m){throw Vn!==null&&(Vn=Vn.slice(i+1)),kd(ec,vi),m}finally{Me=r,Lc=!1}}return null}var xs=[],ks=0,pa=null,ga=0,Yt=[],Qt=0,Vi=null,Wn=1,Gn="";function Wi(i,r){xs[ks++]=ga,xs[ks++]=pa,pa=i,ga=r}function kf(i,r,u){Yt[Qt++]=Wn,Yt[Qt++]=Gn,Yt[Qt++]=Vi,Vi=i;var d=Wn;i=Gn;var m=32-dn(d)-1;d&=~(1<<m),u+=1;var v=32-dn(r)+m;if(30<v){var S=m-m%5;v=(d&(1<<S)-1).toString(32),d>>=S,m-=S,Wn=1<<32-dn(r)+m|u<<m|d,Gn=v+i}else Wn=1<<v|u<<m|d,Gn=i}function Dc(i){i.return!==null&&(Wi(i,1),kf(i,1,0))}function Mc(i){for(;i===pa;)pa=xs[--ks],xs[ks]=null,ga=xs[--ks],xs[ks]=null;for(;i===Vi;)Vi=Yt[--Qt],Yt[Qt]=null,Gn=Yt[--Qt],Yt[Qt]=null,Wn=Yt[--Qt],Yt[Qt]=null}var Ht=null,zt=null,$e=!1,pn=null;function Pf(i,r){var u=tn(5,null,null,0);u.elementType="DELETED",u.stateNode=r,u.return=i,r=i.deletions,r===null?(i.deletions=[u],i.flags|=16):r.push(u)}function Rf(i,r){switch(i.tag){case 5:var u=i.type;return r=r.nodeType!==1||u.toLowerCase()!==r.nodeName.toLowerCase()?null:r,r!==null?(i.stateNode=r,Ht=i,zt=gi(r.firstChild),!0):!1;case 6:return r=i.pendingProps===""||r.nodeType!==3?null:r,r!==null?(i.stateNode=r,Ht=i,zt=null,!0):!1;case 13:return r=r.nodeType!==8?null:r,r!==null?(u=Vi!==null?{id:Wn,overflow:Gn}:null,i.memoizedState={dehydrated:r,treeContext:u,retryLane:1073741824},u=tn(18,null,null,0),u.stateNode=r,u.return=i,i.child=u,Ht=i,zt=null,!0):!1;default:return!1}}function Nc(i){return(i.mode&1)!==0&&(i.flags&128)===0}function Oc(i){if($e){var r=zt;if(r){var u=r;if(!Rf(i,r)){if(Nc(i))throw Error(t(418));r=gi(u.nextSibling);var d=Ht;r&&Rf(i,r)?Pf(d,u):(i.flags=i.flags&-4097|2,$e=!1,Ht=i)}}else{if(Nc(i))throw Error(t(418));i.flags=i.flags&-4097|2,$e=!1,Ht=i}}}function If(i){for(i=i.return;i!==null&&i.tag!==5&&i.tag!==3&&i.tag!==13;)i=i.return;Ht=i}function ma(i){if(i!==Ht)return!1;if(!$e)return If(i),$e=!0,!1;var r;if((r=i.tag!==3)&&!(r=i.tag!==5)&&(r=i.type,r=r!=="head"&&r!=="body"&&!xc(i.type,i.memoizedProps)),r&&(r=zt)){if(Nc(i))throw Lf(),Error(t(418));for(;r;)Pf(i,r),r=gi(r.nextSibling)}if(If(i),i.tag===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(t(317));e:{for(i=i.nextSibling,r=0;i;){if(i.nodeType===8){var u=i.data;if(u==="/$"){if(r===0){zt=gi(i.nextSibling);break e}r--}else u!=="$"&&u!=="$!"&&u!=="$?"||r++}i=i.nextSibling}zt=null}}else zt=Ht?gi(i.stateNode.nextSibling):null;return!0}function Lf(){for(var i=zt;i;)i=gi(i.nextSibling)}function Ps(){zt=Ht=null,$e=!1}function Fc(i){pn===null?pn=[i]:pn.push(i)}var Jw=R.ReactCurrentBatchConfig;function Fr(i,r,u){if(i=u.ref,i!==null&&typeof i!="function"&&typeof i!="object"){if(u._owner){if(u=u._owner,u){if(u.tag!==1)throw Error(t(309));var d=u.stateNode}if(!d)throw Error(t(147,i));var m=d,v=""+i;return r!==null&&r.ref!==null&&typeof r.ref=="function"&&r.ref._stringRef===v?r.ref:(r=function(S){var x=m.refs;S===null?delete x[v]:x[v]=S},r._stringRef=v,r)}if(typeof i!="string")throw Error(t(284));if(!u._owner)throw Error(t(290,i))}return i}function ya(i,r){throw i=Object.prototype.toString.call(r),Error(t(31,i==="[object Object]"?"object with keys {"+Object.keys(r).join(", ")+"}":i))}function Df(i){var r=i._init;return r(i._payload)}function Mf(i){function r(O,D){if(i){var F=O.deletions;F===null?(O.deletions=[D],O.flags|=16):F.push(D)}}function u(O,D){if(!i)return null;for(;D!==null;)r(O,D),D=D.sibling;return null}function d(O,D){for(O=new Map;D!==null;)D.key!==null?O.set(D.key,D):O.set(D.index,D),D=D.sibling;return O}function m(O,D){return O=Ti(O,D),O.index=0,O.sibling=null,O}function v(O,D,F){return O.index=F,i?(F=O.alternate,F!==null?(F=F.index,F<D?(O.flags|=2,D):F):(O.flags|=2,D)):(O.flags|=1048576,D)}function S(O){return i&&O.alternate===null&&(O.flags|=2),O}function x(O,D,F,Y){return D===null||D.tag!==6?(D=ku(F,O.mode,Y),D.return=O,D):(D=m(D,F),D.return=O,D)}function P(O,D,F,Y){var ce=F.type;return ce===N?G(O,D,F.props.children,Y,F.key):D!==null&&(D.elementType===ce||typeof ce=="object"&&ce!==null&&ce.$$typeof===J&&Df(ce)===D.type)?(Y=m(D,F.props),Y.ref=Fr(O,D,F),Y.return=O,Y):(Y=Ha(F.type,F.key,F.props,null,O.mode,Y),Y.ref=Fr(O,D,F),Y.return=O,Y)}function B(O,D,F,Y){return D===null||D.tag!==4||D.stateNode.containerInfo!==F.containerInfo||D.stateNode.implementation!==F.implementation?(D=Pu(F,O.mode,Y),D.return=O,D):(D=m(D,F.children||[]),D.return=O,D)}function G(O,D,F,Y,ce){return D===null||D.tag!==7?(D=Zi(F,O.mode,Y,ce),D.return=O,D):(D=m(D,F),D.return=O,D)}function X(O,D,F){if(typeof D=="string"&&D!==""||typeof D=="number")return D=ku(""+D,O.mode,F),D.return=O,D;if(typeof D=="object"&&D!==null){switch(D.$$typeof){case L:return F=Ha(D.type,D.key,D.props,null,O.mode,F),F.ref=Fr(O,null,D),F.return=O,F;case k:return D=Pu(D,O.mode,F),D.return=O,D;case J:var Y=D._init;return X(O,Y(D._payload),F)}if(ji(D)||ee(D))return D=Zi(D,O.mode,F,null),D.return=O,D;ya(O,D)}return null}function W(O,D,F,Y){var ce=D!==null?D.key:null;if(typeof F=="string"&&F!==""||typeof F=="number")return ce!==null?null:x(O,D,""+F,Y);if(typeof F=="object"&&F!==null){switch(F.$$typeof){case L:return F.key===ce?P(O,D,F,Y):null;case k:return F.key===ce?B(O,D,F,Y):null;case J:return ce=F._init,W(O,D,ce(F._payload),Y)}if(ji(F)||ee(F))return ce!==null?null:G(O,D,F,Y,null);ya(O,F)}return null}function te(O,D,F,Y,ce){if(typeof Y=="string"&&Y!==""||typeof Y=="number")return O=O.get(F)||null,x(D,O,""+Y,ce);if(typeof Y=="object"&&Y!==null){switch(Y.$$typeof){case L:return O=O.get(Y.key===null?F:Y.key)||null,P(D,O,Y,ce);case k:return O=O.get(Y.key===null?F:Y.key)||null,B(D,O,Y,ce);case J:var pe=Y._init;return te(O,D,F,pe(Y._payload),ce)}if(ji(Y)||ee(Y))return O=O.get(F)||null,G(D,O,Y,ce,null);ya(D,Y)}return null}function oe(O,D,F,Y){for(var ce=null,pe=null,ge=D,_e=D=0,ht=null;ge!==null&&_e<F.length;_e++){ge.index>_e?(ht=ge,ge=null):ht=ge.sibling;var De=W(O,ge,F[_e],Y);if(De===null){ge===null&&(ge=ht);break}i&&ge&&De.alternate===null&&r(O,ge),D=v(De,D,_e),pe===null?ce=De:pe.sibling=De,pe=De,ge=ht}if(_e===F.length)return u(O,ge),$e&&Wi(O,_e),ce;if(ge===null){for(;_e<F.length;_e++)ge=X(O,F[_e],Y),ge!==null&&(D=v(ge,D,_e),pe===null?ce=ge:pe.sibling=ge,pe=ge);return $e&&Wi(O,_e),ce}for(ge=d(O,ge);_e<F.length;_e++)ht=te(ge,O,_e,F[_e],Y),ht!==null&&(i&&ht.alternate!==null&&ge.delete(ht.key===null?_e:ht.key),D=v(ht,D,_e),pe===null?ce=ht:pe.sibling=ht,pe=ht);return i&&ge.forEach(function(xi){return r(O,xi)}),$e&&Wi(O,_e),ce}function ae(O,D,F,Y){var ce=ee(F);if(typeof ce!="function")throw Error(t(150));if(F=ce.call(F),F==null)throw Error(t(151));for(var pe=ce=null,ge=D,_e=D=0,ht=null,De=F.next();ge!==null&&!De.done;_e++,De=F.next()){ge.index>_e?(ht=ge,ge=null):ht=ge.sibling;var xi=W(O,ge,De.value,Y);if(xi===null){ge===null&&(ge=ht);break}i&&ge&&xi.alternate===null&&r(O,ge),D=v(xi,D,_e),pe===null?ce=xi:pe.sibling=xi,pe=xi,ge=ht}if(De.done)return u(O,ge),$e&&Wi(O,_e),ce;if(ge===null){for(;!De.done;_e++,De=F.next())De=X(O,De.value,Y),De!==null&&(D=v(De,D,_e),pe===null?ce=De:pe.sibling=De,pe=De);return $e&&Wi(O,_e),ce}for(ge=d(O,ge);!De.done;_e++,De=F.next())De=te(ge,O,_e,De.value,Y),De!==null&&(i&&De.alternate!==null&&ge.delete(De.key===null?_e:De.key),D=v(De,D,_e),pe===null?ce=De:pe.sibling=De,pe=De);return i&&ge.forEach(function(I0){return r(O,I0)}),$e&&Wi(O,_e),ce}function nt(O,D,F,Y){if(typeof F=="object"&&F!==null&&F.type===N&&F.key===null&&(F=F.props.children),typeof F=="object"&&F!==null){switch(F.$$typeof){case L:e:{for(var ce=F.key,pe=D;pe!==null;){if(pe.key===ce){if(ce=F.type,ce===N){if(pe.tag===7){u(O,pe.sibling),D=m(pe,F.props.children),D.return=O,O=D;break e}}else if(pe.elementType===ce||typeof ce=="object"&&ce!==null&&ce.$$typeof===J&&Df(ce)===pe.type){u(O,pe.sibling),D=m(pe,F.props),D.ref=Fr(O,pe,F),D.return=O,O=D;break e}u(O,pe);break}else r(O,pe);pe=pe.sibling}F.type===N?(D=Zi(F.props.children,O.mode,Y,F.key),D.return=O,O=D):(Y=Ha(F.type,F.key,F.props,null,O.mode,Y),Y.ref=Fr(O,D,F),Y.return=O,O=Y)}return S(O);case k:e:{for(pe=F.key;D!==null;){if(D.key===pe)if(D.tag===4&&D.stateNode.containerInfo===F.containerInfo&&D.stateNode.implementation===F.implementation){u(O,D.sibling),D=m(D,F.children||[]),D.return=O,O=D;break e}else{u(O,D);break}else r(O,D);D=D.sibling}D=Pu(F,O.mode,Y),D.return=O,O=D}return S(O);case J:return pe=F._init,nt(O,D,pe(F._payload),Y)}if(ji(F))return oe(O,D,F,Y);if(ee(F))return ae(O,D,F,Y);ya(O,F)}return typeof F=="string"&&F!==""||typeof F=="number"?(F=""+F,D!==null&&D.tag===6?(u(O,D.sibling),D=m(D,F),D.return=O,O=D):(u(O,D),D=ku(F,O.mode,Y),D.return=O,O=D),S(O)):u(O,D)}return nt}var Rs=Mf(!0),Nf=Mf(!1),va=mi(null),wa=null,Is=null,Bc=null;function Uc(){Bc=Is=wa=null}function jc(i){var r=va.current;ze(va),i._currentValue=r}function Hc(i,r,u){for(;i!==null;){var d=i.alternate;if((i.childLanes&r)!==r?(i.childLanes|=r,d!==null&&(d.childLanes|=r)):d!==null&&(d.childLanes&r)!==r&&(d.childLanes|=r),i===u)break;i=i.return}}function Ls(i,r){wa=i,Bc=Is=null,i=i.dependencies,i!==null&&i.firstContext!==null&&((i.lanes&r)!==0&&(Dt=!0),i.firstContext=null)}function Jt(i){var r=i._currentValue;if(Bc!==i)if(i={context:i,memoizedValue:r,next:null},Is===null){if(wa===null)throw Error(t(308));Is=i,wa.dependencies={lanes:0,firstContext:i}}else Is=Is.next=i;return r}var Gi=null;function zc(i){Gi===null?Gi=[i]:Gi.push(i)}function Of(i,r,u,d){var m=r.interleaved;return m===null?(u.next=u,zc(r)):(u.next=m.next,m.next=u),r.interleaved=u,qn(i,d)}function qn(i,r){i.lanes|=r;var u=i.alternate;for(u!==null&&(u.lanes|=r),u=i,i=i.return;i!==null;)i.childLanes|=r,u=i.alternate,u!==null&&(u.childLanes|=r),u=i,i=i.return;return u.tag===3?u.stateNode:null}var wi=!1;function $c(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ff(i,r){i=i.updateQueue,r.updateQueue===i&&(r.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,effects:i.effects})}function Xn(i,r){return{eventTime:i,lane:r,tag:0,payload:null,callback:null,next:null}}function _i(i,r,u){var d=i.updateQueue;if(d===null)return null;if(d=d.shared,(Le&2)!==0){var m=d.pending;return m===null?r.next=r:(r.next=m.next,m.next=r),d.pending=r,qn(i,u)}return m=d.interleaved,m===null?(r.next=r,zc(d)):(r.next=m.next,m.next=r),d.interleaved=r,qn(i,u)}function _a(i,r,u){if(r=r.updateQueue,r!==null&&(r=r.shared,(u&4194240)!==0)){var d=r.lanes;d&=i.pendingLanes,u|=d,r.lanes=u,ic(i,u)}}function Bf(i,r){var u=i.updateQueue,d=i.alternate;if(d!==null&&(d=d.updateQueue,u===d)){var m=null,v=null;if(u=u.firstBaseUpdate,u!==null){do{var S={eventTime:u.eventTime,lane:u.lane,tag:u.tag,payload:u.payload,callback:u.callback,next:null};v===null?m=v=S:v=v.next=S,u=u.next}while(u!==null);v===null?m=v=r:v=v.next=r}else m=v=r;u={baseState:d.baseState,firstBaseUpdate:m,lastBaseUpdate:v,shared:d.shared,effects:d.effects},i.updateQueue=u;return}i=u.lastBaseUpdate,i===null?u.firstBaseUpdate=r:i.next=r,u.lastBaseUpdate=r}function ba(i,r,u,d){var m=i.updateQueue;wi=!1;var v=m.firstBaseUpdate,S=m.lastBaseUpdate,x=m.shared.pending;if(x!==null){m.shared.pending=null;var P=x,B=P.next;P.next=null,S===null?v=B:S.next=B,S=P;var G=i.alternate;G!==null&&(G=G.updateQueue,x=G.lastBaseUpdate,x!==S&&(x===null?G.firstBaseUpdate=B:x.next=B,G.lastBaseUpdate=P))}if(v!==null){var X=m.baseState;S=0,G=B=P=null,x=v;do{var W=x.lane,te=x.eventTime;if((d&W)===W){G!==null&&(G=G.next={eventTime:te,lane:0,tag:x.tag,payload:x.payload,callback:x.callback,next:null});e:{var oe=i,ae=x;switch(W=r,te=u,ae.tag){case 1:if(oe=ae.payload,typeof oe=="function"){X=oe.call(te,X,W);break e}X=oe;break e;case 3:oe.flags=oe.flags&-65537|128;case 0:if(oe=ae.payload,W=typeof oe=="function"?oe.call(te,X,W):oe,W==null)break e;X=Z({},X,W);break e;case 2:wi=!0}}x.callback!==null&&x.lane!==0&&(i.flags|=64,W=m.effects,W===null?m.effects=[x]:W.push(x))}else te={eventTime:te,lane:W,tag:x.tag,payload:x.payload,callback:x.callback,next:null},G===null?(B=G=te,P=X):G=G.next=te,S|=W;if(x=x.next,x===null){if(x=m.shared.pending,x===null)break;W=x,x=W.next,W.next=null,m.lastBaseUpdate=W,m.shared.pending=null}}while(!0);if(G===null&&(P=X),m.baseState=P,m.firstBaseUpdate=B,m.lastBaseUpdate=G,r=m.shared.interleaved,r!==null){m=r;do S|=m.lane,m=m.next;while(m!==r)}else v===null&&(m.shared.lanes=0);Ki|=S,i.lanes=S,i.memoizedState=X}}function Uf(i,r,u){if(i=r.effects,r.effects=null,i!==null)for(r=0;r<i.length;r++){var d=i[r],m=d.callback;if(m!==null){if(d.callback=null,d=u,typeof m!="function")throw Error(t(191,m));m.call(d)}}}var Br={},xn=mi(Br),Ur=mi(Br),jr=mi(Br);function qi(i){if(i===Br)throw Error(t(174));return i}function Vc(i,r){switch(je(jr,r),je(Ur,i),je(xn,Br),i=r.nodeType,i){case 9:case 11:r=(r=r.documentElement)?r.namespaceURI:Kt(null,"");break;default:i=i===8?r.parentNode:r,r=i.namespaceURI||null,i=i.tagName,r=Kt(r,i)}ze(xn),je(xn,r)}function Ds(){ze(xn),ze(Ur),ze(jr)}function jf(i){qi(jr.current);var r=qi(xn.current),u=Kt(r,i.type);r!==u&&(je(Ur,i),je(xn,u))}function Wc(i){Ur.current===i&&(ze(xn),ze(Ur))}var qe=mi(0);function Sa(i){for(var r=i;r!==null;){if(r.tag===13){var u=r.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||u.data==="$!"))return r}else if(r.tag===19&&r.memoizedProps.revealOrder!==void 0){if((r.flags&128)!==0)return r}else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break;for(;r.sibling===null;){if(r.return===null||r.return===i)return null;r=r.return}r.sibling.return=r.return,r=r.sibling}return null}var Gc=[];function qc(){for(var i=0;i<Gc.length;i++)Gc[i]._workInProgressVersionPrimary=null;Gc.length=0}var Aa=R.ReactCurrentDispatcher,Xc=R.ReactCurrentBatchConfig,Xi=0,Xe=null,at=null,ct=null,Ea=!1,Hr=!1,zr=0,Zw=0;function _t(){throw Error(t(321))}function Kc(i,r){if(r===null)return!1;for(var u=0;u<r.length&&u<i.length;u++)if(!fn(i[u],r[u]))return!1;return!0}function Yc(i,r,u,d,m,v){if(Xi=v,Xe=r,r.memoizedState=null,r.updateQueue=null,r.lanes=0,Aa.current=i===null||i.memoizedState===null?i0:s0,i=u(d,m),Hr){v=0;do{if(Hr=!1,zr=0,25<=v)throw Error(t(301));v+=1,ct=at=null,r.updateQueue=null,Aa.current=r0,i=u(d,m)}while(Hr)}if(Aa.current=xa,r=at!==null&&at.next!==null,Xi=0,ct=at=Xe=null,Ea=!1,r)throw Error(t(300));return i}function Qc(){var i=zr!==0;return zr=0,i}function kn(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ct===null?Xe.memoizedState=ct=i:ct=ct.next=i,ct}function Zt(){if(at===null){var i=Xe.alternate;i=i!==null?i.memoizedState:null}else i=at.next;var r=ct===null?Xe.memoizedState:ct.next;if(r!==null)ct=r,at=i;else{if(i===null)throw Error(t(310));at=i,i={memoizedState:at.memoizedState,baseState:at.baseState,baseQueue:at.baseQueue,queue:at.queue,next:null},ct===null?Xe.memoizedState=ct=i:ct=ct.next=i}return ct}function $r(i,r){return typeof r=="function"?r(i):r}function Jc(i){var r=Zt(),u=r.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=i;var d=at,m=d.baseQueue,v=u.pending;if(v!==null){if(m!==null){var S=m.next;m.next=v.next,v.next=S}d.baseQueue=m=v,u.pending=null}if(m!==null){v=m.next,d=d.baseState;var x=S=null,P=null,B=v;do{var G=B.lane;if((Xi&G)===G)P!==null&&(P=P.next={lane:0,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null}),d=B.hasEagerState?B.eagerState:i(d,B.action);else{var X={lane:G,action:B.action,hasEagerState:B.hasEagerState,eagerState:B.eagerState,next:null};P===null?(x=P=X,S=d):P=P.next=X,Xe.lanes|=G,Ki|=G}B=B.next}while(B!==null&&B!==v);P===null?S=d:P.next=x,fn(d,r.memoizedState)||(Dt=!0),r.memoizedState=d,r.baseState=S,r.baseQueue=P,u.lastRenderedState=d}if(i=u.interleaved,i!==null){m=i;do v=m.lane,Xe.lanes|=v,Ki|=v,m=m.next;while(m!==i)}else m===null&&(u.lanes=0);return[r.memoizedState,u.dispatch]}function Zc(i){var r=Zt(),u=r.queue;if(u===null)throw Error(t(311));u.lastRenderedReducer=i;var d=u.dispatch,m=u.pending,v=r.memoizedState;if(m!==null){u.pending=null;var S=m=m.next;do v=i(v,S.action),S=S.next;while(S!==m);fn(v,r.memoizedState)||(Dt=!0),r.memoizedState=v,r.baseQueue===null&&(r.baseState=v),u.lastRenderedState=v}return[v,d]}function Hf(){}function zf(i,r){var u=Xe,d=Zt(),m=r(),v=!fn(d.memoizedState,m);if(v&&(d.memoizedState=m,Dt=!0),d=d.queue,eu(Wf.bind(null,u,d,i),[i]),d.getSnapshot!==r||v||ct!==null&&ct.memoizedState.tag&1){if(u.flags|=2048,Vr(9,Vf.bind(null,u,d,m,r),void 0,null),ut===null)throw Error(t(349));(Xi&30)!==0||$f(u,r,m)}return m}function $f(i,r,u){i.flags|=16384,i={getSnapshot:r,value:u},r=Xe.updateQueue,r===null?(r={lastEffect:null,stores:null},Xe.updateQueue=r,r.stores=[i]):(u=r.stores,u===null?r.stores=[i]:u.push(i))}function Vf(i,r,u,d){r.value=u,r.getSnapshot=d,Gf(r)&&qf(i)}function Wf(i,r,u){return u(function(){Gf(r)&&qf(i)})}function Gf(i){var r=i.getSnapshot;i=i.value;try{var u=r();return!fn(i,u)}catch{return!0}}function qf(i){var r=qn(i,1);r!==null&&vn(r,i,1,-1)}function Xf(i){var r=kn();return typeof i=="function"&&(i=i()),r.memoizedState=r.baseState=i,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$r,lastRenderedState:i},r.queue=i,i=i.dispatch=n0.bind(null,Xe,i),[r.memoizedState,i]}function Vr(i,r,u,d){return i={tag:i,create:r,destroy:u,deps:d,next:null},r=Xe.updateQueue,r===null?(r={lastEffect:null,stores:null},Xe.updateQueue=r,r.lastEffect=i.next=i):(u=r.lastEffect,u===null?r.lastEffect=i.next=i:(d=u.next,u.next=i,i.next=d,r.lastEffect=i)),i}function Kf(){return Zt().memoizedState}function Ca(i,r,u,d){var m=kn();Xe.flags|=i,m.memoizedState=Vr(1|r,u,void 0,d===void 0?null:d)}function Ta(i,r,u,d){var m=Zt();d=d===void 0?null:d;var v=void 0;if(at!==null){var S=at.memoizedState;if(v=S.destroy,d!==null&&Kc(d,S.deps)){m.memoizedState=Vr(r,u,v,d);return}}Xe.flags|=i,m.memoizedState=Vr(1|r,u,v,d)}function Yf(i,r){return Ca(8390656,8,i,r)}function eu(i,r){return Ta(2048,8,i,r)}function Qf(i,r){return Ta(4,2,i,r)}function Jf(i,r){return Ta(4,4,i,r)}function Zf(i,r){if(typeof r=="function")return i=i(),r(i),function(){r(null)};if(r!=null)return i=i(),r.current=i,function(){r.current=null}}function ep(i,r,u){return u=u!=null?u.concat([i]):null,Ta(4,4,Zf.bind(null,r,i),u)}function tu(){}function tp(i,r){var u=Zt();r=r===void 0?null:r;var d=u.memoizedState;return d!==null&&r!==null&&Kc(r,d[1])?d[0]:(u.memoizedState=[i,r],i)}function np(i,r){var u=Zt();r=r===void 0?null:r;var d=u.memoizedState;return d!==null&&r!==null&&Kc(r,d[1])?d[0]:(i=i(),u.memoizedState=[i,r],i)}function ip(i,r,u){return(Xi&21)===0?(i.baseState&&(i.baseState=!1,Dt=!0),i.memoizedState=u):(fn(u,r)||(u=Ld(),Xe.lanes|=u,Ki|=u,i.baseState=!0),r)}function e0(i,r){var u=Me;Me=u!==0&&4>u?u:4,i(!0);var d=Xc.transition;Xc.transition={};try{i(!1),r()}finally{Me=u,Xc.transition=d}}function sp(){return Zt().memoizedState}function t0(i,r,u){var d=Ei(i);if(u={lane:d,action:u,hasEagerState:!1,eagerState:null,next:null},rp(i))op(r,u);else if(u=Of(i,r,u,d),u!==null){var m=Tt();vn(u,i,d,m),ap(u,r,d)}}function n0(i,r,u){var d=Ei(i),m={lane:d,action:u,hasEagerState:!1,eagerState:null,next:null};if(rp(i))op(r,m);else{var v=i.alternate;if(i.lanes===0&&(v===null||v.lanes===0)&&(v=r.lastRenderedReducer,v!==null))try{var S=r.lastRenderedState,x=v(S,u);if(m.hasEagerState=!0,m.eagerState=x,fn(x,S)){var P=r.interleaved;P===null?(m.next=m,zc(r)):(m.next=P.next,P.next=m),r.interleaved=m;return}}catch{}finally{}u=Of(i,r,m,d),u!==null&&(m=Tt(),vn(u,i,d,m),ap(u,r,d))}}function rp(i){var r=i.alternate;return i===Xe||r!==null&&r===Xe}function op(i,r){Hr=Ea=!0;var u=i.pending;u===null?r.next=r:(r.next=u.next,u.next=r),i.pending=r}function ap(i,r,u){if((u&4194240)!==0){var d=r.lanes;d&=i.pendingLanes,u|=d,r.lanes=u,ic(i,u)}}var xa={readContext:Jt,useCallback:_t,useContext:_t,useEffect:_t,useImperativeHandle:_t,useInsertionEffect:_t,useLayoutEffect:_t,useMemo:_t,useReducer:_t,useRef:_t,useState:_t,useDebugValue:_t,useDeferredValue:_t,useTransition:_t,useMutableSource:_t,useSyncExternalStore:_t,useId:_t,unstable_isNewReconciler:!1},i0={readContext:Jt,useCallback:function(i,r){return kn().memoizedState=[i,r===void 0?null:r],i},useContext:Jt,useEffect:Yf,useImperativeHandle:function(i,r,u){return u=u!=null?u.concat([i]):null,Ca(4194308,4,Zf.bind(null,r,i),u)},useLayoutEffect:function(i,r){return Ca(4194308,4,i,r)},useInsertionEffect:function(i,r){return Ca(4,2,i,r)},useMemo:function(i,r){var u=kn();return r=r===void 0?null:r,i=i(),u.memoizedState=[i,r],i},useReducer:function(i,r,u){var d=kn();return r=u!==void 0?u(r):r,d.memoizedState=d.baseState=r,i={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:r},d.queue=i,i=i.dispatch=t0.bind(null,Xe,i),[d.memoizedState,i]},useRef:function(i){var r=kn();return i={current:i},r.memoizedState=i},useState:Xf,useDebugValue:tu,useDeferredValue:function(i){return kn().memoizedState=i},useTransition:function(){var i=Xf(!1),r=i[0];return i=e0.bind(null,i[1]),kn().memoizedState=i,[r,i]},useMutableSource:function(){},useSyncExternalStore:function(i,r,u){var d=Xe,m=kn();if($e){if(u===void 0)throw Error(t(407));u=u()}else{if(u=r(),ut===null)throw Error(t(349));(Xi&30)!==0||$f(d,r,u)}m.memoizedState=u;var v={value:u,getSnapshot:r};return m.queue=v,Yf(Wf.bind(null,d,v,i),[i]),d.flags|=2048,Vr(9,Vf.bind(null,d,v,u,r),void 0,null),u},useId:function(){var i=kn(),r=ut.identifierPrefix;if($e){var u=Gn,d=Wn;u=(d&~(1<<32-dn(d)-1)).toString(32)+u,r=":"+r+"R"+u,u=zr++,0<u&&(r+="H"+u.toString(32)),r+=":"}else u=Zw++,r=":"+r+"r"+u.toString(32)+":";return i.memoizedState=r},unstable_isNewReconciler:!1},s0={readContext:Jt,useCallback:tp,useContext:Jt,useEffect:eu,useImperativeHandle:ep,useInsertionEffect:Qf,useLayoutEffect:Jf,useMemo:np,useReducer:Jc,useRef:Kf,useState:function(){return Jc($r)},useDebugValue:tu,useDeferredValue:function(i){var r=Zt();return ip(r,at.memoizedState,i)},useTransition:function(){var i=Jc($r)[0],r=Zt().memoizedState;return[i,r]},useMutableSource:Hf,useSyncExternalStore:zf,useId:sp,unstable_isNewReconciler:!1},r0={readContext:Jt,useCallback:tp,useContext:Jt,useEffect:eu,useImperativeHandle:ep,useInsertionEffect:Qf,useLayoutEffect:Jf,useMemo:np,useReducer:Zc,useRef:Kf,useState:function(){return Zc($r)},useDebugValue:tu,useDeferredValue:function(i){var r=Zt();return at===null?r.memoizedState=i:ip(r,at.memoizedState,i)},useTransition:function(){var i=Zc($r)[0],r=Zt().memoizedState;return[i,r]},useMutableSource:Hf,useSyncExternalStore:zf,useId:sp,unstable_isNewReconciler:!1};function gn(i,r){if(i&&i.defaultProps){r=Z({},r),i=i.defaultProps;for(var u in i)r[u]===void 0&&(r[u]=i[u]);return r}return r}function nu(i,r,u,d){r=i.memoizedState,u=u(d,r),u=u==null?r:Z({},r,u),i.memoizedState=u,i.lanes===0&&(i.updateQueue.baseState=u)}var ka={isMounted:function(i){return(i=i._reactInternals)?Hi(i)===i:!1},enqueueSetState:function(i,r,u){i=i._reactInternals;var d=Tt(),m=Ei(i),v=Xn(d,m);v.payload=r,u!=null&&(v.callback=u),r=_i(i,v,m),r!==null&&(vn(r,i,m,d),_a(r,i,m))},enqueueReplaceState:function(i,r,u){i=i._reactInternals;var d=Tt(),m=Ei(i),v=Xn(d,m);v.tag=1,v.payload=r,u!=null&&(v.callback=u),r=_i(i,v,m),r!==null&&(vn(r,i,m,d),_a(r,i,m))},enqueueForceUpdate:function(i,r){i=i._reactInternals;var u=Tt(),d=Ei(i),m=Xn(u,d);m.tag=2,r!=null&&(m.callback=r),r=_i(i,m,d),r!==null&&(vn(r,i,d,u),_a(r,i,d))}};function lp(i,r,u,d,m,v,S){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(d,v,S):r.prototype&&r.prototype.isPureReactComponent?!Rr(u,d)||!Rr(m,v):!0}function cp(i,r,u){var d=!1,m=yi,v=r.contextType;return typeof v=="object"&&v!==null?v=Jt(v):(m=Lt(r)?$i:wt.current,d=r.contextTypes,v=(d=d!=null)?Ts(i,m):yi),r=new r(u,v),i.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,r.updater=ka,i.stateNode=r,r._reactInternals=i,d&&(i=i.stateNode,i.__reactInternalMemoizedUnmaskedChildContext=m,i.__reactInternalMemoizedMaskedChildContext=v),r}function up(i,r,u,d){i=r.state,typeof r.componentWillReceiveProps=="function"&&r.componentWillReceiveProps(u,d),typeof r.UNSAFE_componentWillReceiveProps=="function"&&r.UNSAFE_componentWillReceiveProps(u,d),r.state!==i&&ka.enqueueReplaceState(r,r.state,null)}function iu(i,r,u,d){var m=i.stateNode;m.props=u,m.state=i.memoizedState,m.refs={},$c(i);var v=r.contextType;typeof v=="object"&&v!==null?m.context=Jt(v):(v=Lt(r)?$i:wt.current,m.context=Ts(i,v)),m.state=i.memoizedState,v=r.getDerivedStateFromProps,typeof v=="function"&&(nu(i,r,v,u),m.state=i.memoizedState),typeof r.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(r=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),r!==m.state&&ka.enqueueReplaceState(m,m.state,null),ba(i,u,m,d),m.state=i.memoizedState),typeof m.componentDidMount=="function"&&(i.flags|=4194308)}function Ms(i,r){try{var u="",d=r;do u+=we(d),d=d.return;while(d);var m=u}catch(v){m=`
Error generating stack: `+v.message+`
`+v.stack}return{value:i,source:r,stack:m,digest:null}}function su(i,r,u){return{value:i,source:null,stack:u??null,digest:r??null}}function ru(i,r){try{console.error(r.value)}catch(u){setTimeout(function(){throw u})}}var o0=typeof WeakMap=="function"?WeakMap:Map;function hp(i,r,u){u=Xn(-1,u),u.tag=3,u.payload={element:null};var d=r.value;return u.callback=function(){Na||(Na=!0,_u=d),ru(i,r)},u}function dp(i,r,u){u=Xn(-1,u),u.tag=3;var d=i.type.getDerivedStateFromError;if(typeof d=="function"){var m=r.value;u.payload=function(){return d(m)},u.callback=function(){ru(i,r)}}var v=i.stateNode;return v!==null&&typeof v.componentDidCatch=="function"&&(u.callback=function(){ru(i,r),typeof d!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var S=r.stack;this.componentDidCatch(r.value,{componentStack:S!==null?S:""})}),u}function fp(i,r,u){var d=i.pingCache;if(d===null){d=i.pingCache=new o0;var m=new Set;d.set(r,m)}else m=d.get(r),m===void 0&&(m=new Set,d.set(r,m));m.has(u)||(m.add(u),i=_0.bind(null,i,r,u),r.then(i,i))}function pp(i){do{var r;if((r=i.tag===13)&&(r=i.memoizedState,r=r!==null?r.dehydrated!==null:!0),r)return i;i=i.return}while(i!==null);return null}function gp(i,r,u,d,m){return(i.mode&1)===0?(i===r?i.flags|=65536:(i.flags|=128,u.flags|=131072,u.flags&=-52805,u.tag===1&&(u.alternate===null?u.tag=17:(r=Xn(-1,1),r.tag=2,_i(u,r,1))),u.lanes|=1),i):(i.flags|=65536,i.lanes=m,i)}var a0=R.ReactCurrentOwner,Dt=!1;function Ct(i,r,u,d){r.child=i===null?Nf(r,null,u,d):Rs(r,i.child,u,d)}function mp(i,r,u,d,m){u=u.render;var v=r.ref;return Ls(r,m),d=Yc(i,r,u,d,v,m),u=Qc(),i!==null&&!Dt?(r.updateQueue=i.updateQueue,r.flags&=-2053,i.lanes&=~m,Kn(i,r,m)):($e&&u&&Dc(r),r.flags|=1,Ct(i,r,d,m),r.child)}function yp(i,r,u,d,m){if(i===null){var v=u.type;return typeof v=="function"&&!xu(v)&&v.defaultProps===void 0&&u.compare===null&&u.defaultProps===void 0?(r.tag=15,r.type=v,vp(i,r,v,d,m)):(i=Ha(u.type,null,d,r,r.mode,m),i.ref=r.ref,i.return=r,r.child=i)}if(v=i.child,(i.lanes&m)===0){var S=v.memoizedProps;if(u=u.compare,u=u!==null?u:Rr,u(S,d)&&i.ref===r.ref)return Kn(i,r,m)}return r.flags|=1,i=Ti(v,d),i.ref=r.ref,i.return=r,r.child=i}function vp(i,r,u,d,m){if(i!==null){var v=i.memoizedProps;if(Rr(v,d)&&i.ref===r.ref)if(Dt=!1,r.pendingProps=d=v,(i.lanes&m)!==0)(i.flags&131072)!==0&&(Dt=!0);else return r.lanes=i.lanes,Kn(i,r,m)}return ou(i,r,u,d,m)}function wp(i,r,u){var d=r.pendingProps,m=d.children,v=i!==null?i.memoizedState:null;if(d.mode==="hidden")if((r.mode&1)===0)r.memoizedState={baseLanes:0,cachePool:null,transitions:null},je(Os,$t),$t|=u;else{if((u&1073741824)===0)return i=v!==null?v.baseLanes|u:u,r.lanes=r.childLanes=1073741824,r.memoizedState={baseLanes:i,cachePool:null,transitions:null},r.updateQueue=null,je(Os,$t),$t|=i,null;r.memoizedState={baseLanes:0,cachePool:null,transitions:null},d=v!==null?v.baseLanes:u,je(Os,$t),$t|=d}else v!==null?(d=v.baseLanes|u,r.memoizedState=null):d=u,je(Os,$t),$t|=d;return Ct(i,r,m,u),r.child}function _p(i,r){var u=r.ref;(i===null&&u!==null||i!==null&&i.ref!==u)&&(r.flags|=512,r.flags|=2097152)}function ou(i,r,u,d,m){var v=Lt(u)?$i:wt.current;return v=Ts(r,v),Ls(r,m),u=Yc(i,r,u,d,v,m),d=Qc(),i!==null&&!Dt?(r.updateQueue=i.updateQueue,r.flags&=-2053,i.lanes&=~m,Kn(i,r,m)):($e&&d&&Dc(r),r.flags|=1,Ct(i,r,u,m),r.child)}function bp(i,r,u,d,m){if(Lt(u)){var v=!0;da(r)}else v=!1;if(Ls(r,m),r.stateNode===null)Ra(i,r),cp(r,u,d),iu(r,u,d,m),d=!0;else if(i===null){var S=r.stateNode,x=r.memoizedProps;S.props=x;var P=S.context,B=u.contextType;typeof B=="object"&&B!==null?B=Jt(B):(B=Lt(u)?$i:wt.current,B=Ts(r,B));var G=u.getDerivedStateFromProps,X=typeof G=="function"||typeof S.getSnapshotBeforeUpdate=="function";X||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(x!==d||P!==B)&&up(r,S,d,B),wi=!1;var W=r.memoizedState;S.state=W,ba(r,d,S,m),P=r.memoizedState,x!==d||W!==P||It.current||wi?(typeof G=="function"&&(nu(r,u,G,d),P=r.memoizedState),(x=wi||lp(r,u,x,d,W,P,B))?(X||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(r.flags|=4194308)):(typeof S.componentDidMount=="function"&&(r.flags|=4194308),r.memoizedProps=d,r.memoizedState=P),S.props=d,S.state=P,S.context=B,d=x):(typeof S.componentDidMount=="function"&&(r.flags|=4194308),d=!1)}else{S=r.stateNode,Ff(i,r),x=r.memoizedProps,B=r.type===r.elementType?x:gn(r.type,x),S.props=B,X=r.pendingProps,W=S.context,P=u.contextType,typeof P=="object"&&P!==null?P=Jt(P):(P=Lt(u)?$i:wt.current,P=Ts(r,P));var te=u.getDerivedStateFromProps;(G=typeof te=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(x!==X||W!==P)&&up(r,S,d,P),wi=!1,W=r.memoizedState,S.state=W,ba(r,d,S,m);var oe=r.memoizedState;x!==X||W!==oe||It.current||wi?(typeof te=="function"&&(nu(r,u,te,d),oe=r.memoizedState),(B=wi||lp(r,u,B,d,W,oe,P)||!1)?(G||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(d,oe,P),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(d,oe,P)),typeof S.componentDidUpdate=="function"&&(r.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(r.flags|=1024)):(typeof S.componentDidUpdate!="function"||x===i.memoizedProps&&W===i.memoizedState||(r.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||x===i.memoizedProps&&W===i.memoizedState||(r.flags|=1024),r.memoizedProps=d,r.memoizedState=oe),S.props=d,S.state=oe,S.context=P,d=B):(typeof S.componentDidUpdate!="function"||x===i.memoizedProps&&W===i.memoizedState||(r.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||x===i.memoizedProps&&W===i.memoizedState||(r.flags|=1024),d=!1)}return au(i,r,u,d,v,m)}function au(i,r,u,d,m,v){_p(i,r);var S=(r.flags&128)!==0;if(!d&&!S)return m&&Tf(r,u,!1),Kn(i,r,v);d=r.stateNode,a0.current=r;var x=S&&typeof u.getDerivedStateFromError!="function"?null:d.render();return r.flags|=1,i!==null&&S?(r.child=Rs(r,i.child,null,v),r.child=Rs(r,null,x,v)):Ct(i,r,x,v),r.memoizedState=d.state,m&&Tf(r,u,!0),r.child}function Sp(i){var r=i.stateNode;r.pendingContext?Ef(i,r.pendingContext,r.pendingContext!==r.context):r.context&&Ef(i,r.context,!1),Vc(i,r.containerInfo)}function Ap(i,r,u,d,m){return Ps(),Fc(m),r.flags|=256,Ct(i,r,u,d),r.child}var lu={dehydrated:null,treeContext:null,retryLane:0};function cu(i){return{baseLanes:i,cachePool:null,transitions:null}}function Ep(i,r,u){var d=r.pendingProps,m=qe.current,v=!1,S=(r.flags&128)!==0,x;if((x=S)||(x=i!==null&&i.memoizedState===null?!1:(m&2)!==0),x?(v=!0,r.flags&=-129):(i===null||i.memoizedState!==null)&&(m|=1),je(qe,m&1),i===null)return Oc(r),i=r.memoizedState,i!==null&&(i=i.dehydrated,i!==null)?((r.mode&1)===0?r.lanes=1:i.data==="$!"?r.lanes=8:r.lanes=1073741824,null):(S=d.children,i=d.fallback,v?(d=r.mode,v=r.child,S={mode:"hidden",children:S},(d&1)===0&&v!==null?(v.childLanes=0,v.pendingProps=S):v=za(S,d,0,null),i=Zi(i,d,u,null),v.return=r,i.return=r,v.sibling=i,r.child=v,r.child.memoizedState=cu(u),r.memoizedState=lu,i):uu(r,S));if(m=i.memoizedState,m!==null&&(x=m.dehydrated,x!==null))return l0(i,r,S,d,x,m,u);if(v){v=d.fallback,S=r.mode,m=i.child,x=m.sibling;var P={mode:"hidden",children:d.children};return(S&1)===0&&r.child!==m?(d=r.child,d.childLanes=0,d.pendingProps=P,r.deletions=null):(d=Ti(m,P),d.subtreeFlags=m.subtreeFlags&14680064),x!==null?v=Ti(x,v):(v=Zi(v,S,u,null),v.flags|=2),v.return=r,d.return=r,d.sibling=v,r.child=d,d=v,v=r.child,S=i.child.memoizedState,S=S===null?cu(u):{baseLanes:S.baseLanes|u,cachePool:null,transitions:S.transitions},v.memoizedState=S,v.childLanes=i.childLanes&~u,r.memoizedState=lu,d}return v=i.child,i=v.sibling,d=Ti(v,{mode:"visible",children:d.children}),(r.mode&1)===0&&(d.lanes=u),d.return=r,d.sibling=null,i!==null&&(u=r.deletions,u===null?(r.deletions=[i],r.flags|=16):u.push(i)),r.child=d,r.memoizedState=null,d}function uu(i,r){return r=za({mode:"visible",children:r},i.mode,0,null),r.return=i,i.child=r}function Pa(i,r,u,d){return d!==null&&Fc(d),Rs(r,i.child,null,u),i=uu(r,r.pendingProps.children),i.flags|=2,r.memoizedState=null,i}function l0(i,r,u,d,m,v,S){if(u)return r.flags&256?(r.flags&=-257,d=su(Error(t(422))),Pa(i,r,S,d)):r.memoizedState!==null?(r.child=i.child,r.flags|=128,null):(v=d.fallback,m=r.mode,d=za({mode:"visible",children:d.children},m,0,null),v=Zi(v,m,S,null),v.flags|=2,d.return=r,v.return=r,d.sibling=v,r.child=d,(r.mode&1)!==0&&Rs(r,i.child,null,S),r.child.memoizedState=cu(S),r.memoizedState=lu,v);if((r.mode&1)===0)return Pa(i,r,S,null);if(m.data==="$!"){if(d=m.nextSibling&&m.nextSibling.dataset,d)var x=d.dgst;return d=x,v=Error(t(419)),d=su(v,d,void 0),Pa(i,r,S,d)}if(x=(S&i.childLanes)!==0,Dt||x){if(d=ut,d!==null){switch(S&-S){case 4:m=2;break;case 16:m=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:m=32;break;case 536870912:m=268435456;break;default:m=0}m=(m&(d.suspendedLanes|S))!==0?0:m,m!==0&&m!==v.retryLane&&(v.retryLane=m,qn(i,m),vn(d,i,m,-1))}return Tu(),d=su(Error(t(421))),Pa(i,r,S,d)}return m.data==="$?"?(r.flags|=128,r.child=i.child,r=b0.bind(null,i),m._reactRetry=r,null):(i=v.treeContext,zt=gi(m.nextSibling),Ht=r,$e=!0,pn=null,i!==null&&(Yt[Qt++]=Wn,Yt[Qt++]=Gn,Yt[Qt++]=Vi,Wn=i.id,Gn=i.overflow,Vi=r),r=uu(r,d.children),r.flags|=4096,r)}function Cp(i,r,u){i.lanes|=r;var d=i.alternate;d!==null&&(d.lanes|=r),Hc(i.return,r,u)}function hu(i,r,u,d,m){var v=i.memoizedState;v===null?i.memoizedState={isBackwards:r,rendering:null,renderingStartTime:0,last:d,tail:u,tailMode:m}:(v.isBackwards=r,v.rendering=null,v.renderingStartTime=0,v.last=d,v.tail=u,v.tailMode=m)}function Tp(i,r,u){var d=r.pendingProps,m=d.revealOrder,v=d.tail;if(Ct(i,r,d.children,u),d=qe.current,(d&2)!==0)d=d&1|2,r.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=r.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&Cp(i,u,r);else if(i.tag===19)Cp(i,u,r);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break e;for(;i.sibling===null;){if(i.return===null||i.return===r)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}d&=1}if(je(qe,d),(r.mode&1)===0)r.memoizedState=null;else switch(m){case"forwards":for(u=r.child,m=null;u!==null;)i=u.alternate,i!==null&&Sa(i)===null&&(m=u),u=u.sibling;u=m,u===null?(m=r.child,r.child=null):(m=u.sibling,u.sibling=null),hu(r,!1,m,u,v);break;case"backwards":for(u=null,m=r.child,r.child=null;m!==null;){if(i=m.alternate,i!==null&&Sa(i)===null){r.child=m;break}i=m.sibling,m.sibling=u,u=m,m=i}hu(r,!0,u,null,v);break;case"together":hu(r,!1,null,null,void 0);break;default:r.memoizedState=null}return r.child}function Ra(i,r){(r.mode&1)===0&&i!==null&&(i.alternate=null,r.alternate=null,r.flags|=2)}function Kn(i,r,u){if(i!==null&&(r.dependencies=i.dependencies),Ki|=r.lanes,(u&r.childLanes)===0)return null;if(i!==null&&r.child!==i.child)throw Error(t(153));if(r.child!==null){for(i=r.child,u=Ti(i,i.pendingProps),r.child=u,u.return=r;i.sibling!==null;)i=i.sibling,u=u.sibling=Ti(i,i.pendingProps),u.return=r;u.sibling=null}return r.child}function c0(i,r,u){switch(r.tag){case 3:Sp(r),Ps();break;case 5:jf(r);break;case 1:Lt(r.type)&&da(r);break;case 4:Vc(r,r.stateNode.containerInfo);break;case 10:var d=r.type._context,m=r.memoizedProps.value;je(va,d._currentValue),d._currentValue=m;break;case 13:if(d=r.memoizedState,d!==null)return d.dehydrated!==null?(je(qe,qe.current&1),r.flags|=128,null):(u&r.child.childLanes)!==0?Ep(i,r,u):(je(qe,qe.current&1),i=Kn(i,r,u),i!==null?i.sibling:null);je(qe,qe.current&1);break;case 19:if(d=(u&r.childLanes)!==0,(i.flags&128)!==0){if(d)return Tp(i,r,u);r.flags|=128}if(m=r.memoizedState,m!==null&&(m.rendering=null,m.tail=null,m.lastEffect=null),je(qe,qe.current),d)break;return null;case 22:case 23:return r.lanes=0,wp(i,r,u)}return Kn(i,r,u)}var xp,du,kp,Pp;xp=function(i,r){for(var u=r.child;u!==null;){if(u.tag===5||u.tag===6)i.appendChild(u.stateNode);else if(u.tag!==4&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===r)break;for(;u.sibling===null;){if(u.return===null||u.return===r)return;u=u.return}u.sibling.return=u.return,u=u.sibling}},du=function(){},kp=function(i,r,u,d){var m=i.memoizedProps;if(m!==d){i=r.stateNode,qi(xn.current);var v=null;switch(u){case"input":m=Ne(i,m),d=Ne(i,d),v=[];break;case"select":m=Z({},m,{value:void 0}),d=Z({},d,{value:void 0}),v=[];break;case"textarea":m=fr(i,m),d=fr(i,d),v=[];break;default:typeof m.onClick!="function"&&typeof d.onClick=="function"&&(i.onclick=ca)}Gl(u,d);var S;u=null;for(B in m)if(!d.hasOwnProperty(B)&&m.hasOwnProperty(B)&&m[B]!=null)if(B==="style"){var x=m[B];for(S in x)x.hasOwnProperty(S)&&(u||(u={}),u[S]="")}else B!=="dangerouslySetInnerHTML"&&B!=="children"&&B!=="suppressContentEditableWarning"&&B!=="suppressHydrationWarning"&&B!=="autoFocus"&&(s.hasOwnProperty(B)?v||(v=[]):(v=v||[]).push(B,null));for(B in d){var P=d[B];if(x=m?.[B],d.hasOwnProperty(B)&&P!==x&&(P!=null||x!=null))if(B==="style")if(x){for(S in x)!x.hasOwnProperty(S)||P&&P.hasOwnProperty(S)||(u||(u={}),u[S]="");for(S in P)P.hasOwnProperty(S)&&x[S]!==P[S]&&(u||(u={}),u[S]=P[S])}else u||(v||(v=[]),v.push(B,u)),u=P;else B==="dangerouslySetInnerHTML"?(P=P?P.__html:void 0,x=x?x.__html:void 0,P!=null&&x!==P&&(v=v||[]).push(B,P)):B==="children"?typeof P!="string"&&typeof P!="number"||(v=v||[]).push(B,""+P):B!=="suppressContentEditableWarning"&&B!=="suppressHydrationWarning"&&(s.hasOwnProperty(B)?(P!=null&&B==="onScroll"&&He("scroll",i),v||x===P||(v=[])):(v=v||[]).push(B,P))}u&&(v=v||[]).push("style",u);var B=v;(r.updateQueue=B)&&(r.flags|=4)}},Pp=function(i,r,u,d){u!==d&&(r.flags|=4)};function Wr(i,r){if(!$e)switch(i.tailMode){case"hidden":r=i.tail;for(var u=null;r!==null;)r.alternate!==null&&(u=r),r=r.sibling;u===null?i.tail=null:u.sibling=null;break;case"collapsed":u=i.tail;for(var d=null;u!==null;)u.alternate!==null&&(d=u),u=u.sibling;d===null?r||i.tail===null?i.tail=null:i.tail.sibling=null:d.sibling=null}}function bt(i){var r=i.alternate!==null&&i.alternate.child===i.child,u=0,d=0;if(r)for(var m=i.child;m!==null;)u|=m.lanes|m.childLanes,d|=m.subtreeFlags&14680064,d|=m.flags&14680064,m.return=i,m=m.sibling;else for(m=i.child;m!==null;)u|=m.lanes|m.childLanes,d|=m.subtreeFlags,d|=m.flags,m.return=i,m=m.sibling;return i.subtreeFlags|=d,i.childLanes=u,r}function u0(i,r,u){var d=r.pendingProps;switch(Mc(r),r.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return bt(r),null;case 1:return Lt(r.type)&&ha(),bt(r),null;case 3:return d=r.stateNode,Ds(),ze(It),ze(wt),qc(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(i===null||i.child===null)&&(ma(r)?r.flags|=4:i===null||i.memoizedState.isDehydrated&&(r.flags&256)===0||(r.flags|=1024,pn!==null&&(Au(pn),pn=null))),du(i,r),bt(r),null;case 5:Wc(r);var m=qi(jr.current);if(u=r.type,i!==null&&r.stateNode!=null)kp(i,r,u,d,m),i.ref!==r.ref&&(r.flags|=512,r.flags|=2097152);else{if(!d){if(r.stateNode===null)throw Error(t(166));return bt(r),null}if(i=qi(xn.current),ma(r)){d=r.stateNode,u=r.type;var v=r.memoizedProps;switch(d[Tn]=r,d[Nr]=v,i=(r.mode&1)!==0,u){case"dialog":He("cancel",d),He("close",d);break;case"iframe":case"object":case"embed":He("load",d);break;case"video":case"audio":for(m=0;m<Lr.length;m++)He(Lr[m],d);break;case"source":He("error",d);break;case"img":case"image":case"link":He("error",d),He("load",d);break;case"details":He("toggle",d);break;case"input":Je(d,v),He("invalid",d);break;case"select":d._wrapperState={wasMultiple:!!v.multiple},He("invalid",d);break;case"textarea":Bo(d,v),He("invalid",d)}Gl(u,v),m=null;for(var S in v)if(v.hasOwnProperty(S)){var x=v[S];S==="children"?typeof x=="string"?d.textContent!==x&&(v.suppressHydrationWarning!==!0&&la(d.textContent,x,i),m=["children",x]):typeof x=="number"&&d.textContent!==""+x&&(v.suppressHydrationWarning!==!0&&la(d.textContent,x,i),m=["children",""+x]):s.hasOwnProperty(S)&&x!=null&&S==="onScroll"&&He("scroll",d)}switch(u){case"input":Rt(d),li(d,v,!0);break;case"textarea":Rt(d),jo(d);break;case"select":case"option":break;default:typeof v.onClick=="function"&&(d.onclick=ca)}d=m,r.updateQueue=d,d!==null&&(r.flags|=4)}else{S=m.nodeType===9?m:m.ownerDocument,i==="http://www.w3.org/1999/xhtml"&&(i=Ho(u)),i==="http://www.w3.org/1999/xhtml"?u==="script"?(i=S.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild)):typeof d.is=="string"?i=S.createElement(u,{is:d.is}):(i=S.createElement(u),u==="select"&&(S=i,d.multiple?S.multiple=!0:d.size&&(S.size=d.size))):i=S.createElementNS(i,u),i[Tn]=r,i[Nr]=d,xp(i,r,!1,!1),r.stateNode=i;e:{switch(S=ql(u,d),u){case"dialog":He("cancel",i),He("close",i),m=d;break;case"iframe":case"object":case"embed":He("load",i),m=d;break;case"video":case"audio":for(m=0;m<Lr.length;m++)He(Lr[m],i);m=d;break;case"source":He("error",i),m=d;break;case"img":case"image":case"link":He("error",i),He("load",i),m=d;break;case"details":He("toggle",i),m=d;break;case"input":Je(i,d),m=Ne(i,d),He("invalid",i);break;case"option":m=d;break;case"select":i._wrapperState={wasMultiple:!!d.multiple},m=Z({},d,{value:void 0}),He("invalid",i);break;case"textarea":Bo(i,d),m=fr(i,d),He("invalid",i);break;default:m=d}Gl(u,m),x=m;for(v in x)if(x.hasOwnProperty(v)){var P=x[v];v==="style"?yd(i,P):v==="dangerouslySetInnerHTML"?(P=P?P.__html:void 0,P!=null&&hn(i,P)):v==="children"?typeof P=="string"?(u!=="textarea"||P!=="")&&zn(i,P):typeof P=="number"&&zn(i,""+P):v!=="suppressContentEditableWarning"&&v!=="suppressHydrationWarning"&&v!=="autoFocus"&&(s.hasOwnProperty(v)?P!=null&&v==="onScroll"&&He("scroll",i):P!=null&&T(i,v,P,S))}switch(u){case"input":Rt(i),li(i,d,!1);break;case"textarea":Rt(i),jo(i);break;case"option":d.value!=null&&i.setAttribute("value",""+Ce(d.value));break;case"select":i.multiple=!!d.multiple,v=d.value,v!=null?cn(i,!!d.multiple,v,!1):d.defaultValue!=null&&cn(i,!!d.multiple,d.defaultValue,!0);break;default:typeof m.onClick=="function"&&(i.onclick=ca)}switch(u){case"button":case"input":case"select":case"textarea":d=!!d.autoFocus;break e;case"img":d=!0;break e;default:d=!1}}d&&(r.flags|=4)}r.ref!==null&&(r.flags|=512,r.flags|=2097152)}return bt(r),null;case 6:if(i&&r.stateNode!=null)Pp(i,r,i.memoizedProps,d);else{if(typeof d!="string"&&r.stateNode===null)throw Error(t(166));if(u=qi(jr.current),qi(xn.current),ma(r)){if(d=r.stateNode,u=r.memoizedProps,d[Tn]=r,(v=d.nodeValue!==u)&&(i=Ht,i!==null))switch(i.tag){case 3:la(d.nodeValue,u,(i.mode&1)!==0);break;case 5:i.memoizedProps.suppressHydrationWarning!==!0&&la(d.nodeValue,u,(i.mode&1)!==0)}v&&(r.flags|=4)}else d=(u.nodeType===9?u:u.ownerDocument).createTextNode(d),d[Tn]=r,r.stateNode=d}return bt(r),null;case 13:if(ze(qe),d=r.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if($e&&zt!==null&&(r.mode&1)!==0&&(r.flags&128)===0)Lf(),Ps(),r.flags|=98560,v=!1;else if(v=ma(r),d!==null&&d.dehydrated!==null){if(i===null){if(!v)throw Error(t(318));if(v=r.memoizedState,v=v!==null?v.dehydrated:null,!v)throw Error(t(317));v[Tn]=r}else Ps(),(r.flags&128)===0&&(r.memoizedState=null),r.flags|=4;bt(r),v=!1}else pn!==null&&(Au(pn),pn=null),v=!0;if(!v)return r.flags&65536?r:null}return(r.flags&128)!==0?(r.lanes=u,r):(d=d!==null,d!==(i!==null&&i.memoizedState!==null)&&d&&(r.child.flags|=8192,(r.mode&1)!==0&&(i===null||(qe.current&1)!==0?lt===0&&(lt=3):Tu())),r.updateQueue!==null&&(r.flags|=4),bt(r),null);case 4:return Ds(),du(i,r),i===null&&Dr(r.stateNode.containerInfo),bt(r),null;case 10:return jc(r.type._context),bt(r),null;case 17:return Lt(r.type)&&ha(),bt(r),null;case 19:if(ze(qe),v=r.memoizedState,v===null)return bt(r),null;if(d=(r.flags&128)!==0,S=v.rendering,S===null)if(d)Wr(v,!1);else{if(lt!==0||i!==null&&(i.flags&128)!==0)for(i=r.child;i!==null;){if(S=Sa(i),S!==null){for(r.flags|=128,Wr(v,!1),d=S.updateQueue,d!==null&&(r.updateQueue=d,r.flags|=4),r.subtreeFlags=0,d=u,u=r.child;u!==null;)v=u,i=d,v.flags&=14680066,S=v.alternate,S===null?(v.childLanes=0,v.lanes=i,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=S.childLanes,v.lanes=S.lanes,v.child=S.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=S.memoizedProps,v.memoizedState=S.memoizedState,v.updateQueue=S.updateQueue,v.type=S.type,i=S.dependencies,v.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),u=u.sibling;return je(qe,qe.current&1|2),r.child}i=i.sibling}v.tail!==null&&tt()>Fs&&(r.flags|=128,d=!0,Wr(v,!1),r.lanes=4194304)}else{if(!d)if(i=Sa(S),i!==null){if(r.flags|=128,d=!0,u=i.updateQueue,u!==null&&(r.updateQueue=u,r.flags|=4),Wr(v,!0),v.tail===null&&v.tailMode==="hidden"&&!S.alternate&&!$e)return bt(r),null}else 2*tt()-v.renderingStartTime>Fs&&u!==1073741824&&(r.flags|=128,d=!0,Wr(v,!1),r.lanes=4194304);v.isBackwards?(S.sibling=r.child,r.child=S):(u=v.last,u!==null?u.sibling=S:r.child=S,v.last=S)}return v.tail!==null?(r=v.tail,v.rendering=r,v.tail=r.sibling,v.renderingStartTime=tt(),r.sibling=null,u=qe.current,je(qe,d?u&1|2:u&1),r):(bt(r),null);case 22:case 23:return Cu(),d=r.memoizedState!==null,i!==null&&i.memoizedState!==null!==d&&(r.flags|=8192),d&&(r.mode&1)!==0?($t&1073741824)!==0&&(bt(r),r.subtreeFlags&6&&(r.flags|=8192)):bt(r),null;case 24:return null;case 25:return null}throw Error(t(156,r.tag))}function h0(i,r){switch(Mc(r),r.tag){case 1:return Lt(r.type)&&ha(),i=r.flags,i&65536?(r.flags=i&-65537|128,r):null;case 3:return Ds(),ze(It),ze(wt),qc(),i=r.flags,(i&65536)!==0&&(i&128)===0?(r.flags=i&-65537|128,r):null;case 5:return Wc(r),null;case 13:if(ze(qe),i=r.memoizedState,i!==null&&i.dehydrated!==null){if(r.alternate===null)throw Error(t(340));Ps()}return i=r.flags,i&65536?(r.flags=i&-65537|128,r):null;case 19:return ze(qe),null;case 4:return Ds(),null;case 10:return jc(r.type._context),null;case 22:case 23:return Cu(),null;case 24:return null;default:return null}}var Ia=!1,St=!1,d0=typeof WeakSet=="function"?WeakSet:Set,ie=null;function Ns(i,r){var u=i.ref;if(u!==null)if(typeof u=="function")try{u(null)}catch(d){Ze(i,r,d)}else u.current=null}function fu(i,r,u){try{u()}catch(d){Ze(i,r,d)}}var Rp=!1;function f0(i,r){if(Cc=Qo,i=lf(),yc(i)){if("selectionStart"in i)var u={start:i.selectionStart,end:i.selectionEnd};else e:{u=(u=i.ownerDocument)&&u.defaultView||window;var d=u.getSelection&&u.getSelection();if(d&&d.rangeCount!==0){u=d.anchorNode;var m=d.anchorOffset,v=d.focusNode;d=d.focusOffset;try{u.nodeType,v.nodeType}catch{u=null;break e}var S=0,x=-1,P=-1,B=0,G=0,X=i,W=null;t:for(;;){for(var te;X!==u||m!==0&&X.nodeType!==3||(x=S+m),X!==v||d!==0&&X.nodeType!==3||(P=S+d),X.nodeType===3&&(S+=X.nodeValue.length),(te=X.firstChild)!==null;)W=X,X=te;for(;;){if(X===i)break t;if(W===u&&++B===m&&(x=S),W===v&&++G===d&&(P=S),(te=X.nextSibling)!==null)break;X=W,W=X.parentNode}X=te}u=x===-1||P===-1?null:{start:x,end:P}}else u=null}u=u||{start:0,end:0}}else u=null;for(Tc={focusedElem:i,selectionRange:u},Qo=!1,ie=r;ie!==null;)if(r=ie,i=r.child,(r.subtreeFlags&1028)!==0&&i!==null)i.return=r,ie=i;else for(;ie!==null;){r=ie;try{var oe=r.alternate;if((r.flags&1024)!==0)switch(r.tag){case 0:case 11:case 15:break;case 1:if(oe!==null){var ae=oe.memoizedProps,nt=oe.memoizedState,O=r.stateNode,D=O.getSnapshotBeforeUpdate(r.elementType===r.type?ae:gn(r.type,ae),nt);O.__reactInternalSnapshotBeforeUpdate=D}break;case 3:var F=r.stateNode.containerInfo;F.nodeType===1?F.textContent="":F.nodeType===9&&F.documentElement&&F.removeChild(F.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Y){Ze(r,r.return,Y)}if(i=r.sibling,i!==null){i.return=r.return,ie=i;break}ie=r.return}return oe=Rp,Rp=!1,oe}function Gr(i,r,u){var d=r.updateQueue;if(d=d!==null?d.lastEffect:null,d!==null){var m=d=d.next;do{if((m.tag&i)===i){var v=m.destroy;m.destroy=void 0,v!==void 0&&fu(r,u,v)}m=m.next}while(m!==d)}}function La(i,r){if(r=r.updateQueue,r=r!==null?r.lastEffect:null,r!==null){var u=r=r.next;do{if((u.tag&i)===i){var d=u.create;u.destroy=d()}u=u.next}while(u!==r)}}function pu(i){var r=i.ref;if(r!==null){var u=i.stateNode;switch(i.tag){case 5:i=u;break;default:i=u}typeof r=="function"?r(i):r.current=i}}function Ip(i){var r=i.alternate;r!==null&&(i.alternate=null,Ip(r)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(r=i.stateNode,r!==null&&(delete r[Tn],delete r[Nr],delete r[Rc],delete r[Kw],delete r[Yw])),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}function Lp(i){return i.tag===5||i.tag===3||i.tag===4}function Dp(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Lp(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function gu(i,r,u){var d=i.tag;if(d===5||d===6)i=i.stateNode,r?u.nodeType===8?u.parentNode.insertBefore(i,r):u.insertBefore(i,r):(u.nodeType===8?(r=u.parentNode,r.insertBefore(i,u)):(r=u,r.appendChild(i)),u=u._reactRootContainer,u!=null||r.onclick!==null||(r.onclick=ca));else if(d!==4&&(i=i.child,i!==null))for(gu(i,r,u),i=i.sibling;i!==null;)gu(i,r,u),i=i.sibling}function mu(i,r,u){var d=i.tag;if(d===5||d===6)i=i.stateNode,r?u.insertBefore(i,r):u.appendChild(i);else if(d!==4&&(i=i.child,i!==null))for(mu(i,r,u),i=i.sibling;i!==null;)mu(i,r,u),i=i.sibling}var gt=null,mn=!1;function bi(i,r,u){for(u=u.child;u!==null;)Mp(i,r,u),u=u.sibling}function Mp(i,r,u){if(Cn&&typeof Cn.onCommitFiberUnmount=="function")try{Cn.onCommitFiberUnmount(Wo,u)}catch{}switch(u.tag){case 5:St||Ns(u,r);case 6:var d=gt,m=mn;gt=null,bi(i,r,u),gt=d,mn=m,gt!==null&&(mn?(i=gt,u=u.stateNode,i.nodeType===8?i.parentNode.removeChild(u):i.removeChild(u)):gt.removeChild(u.stateNode));break;case 18:gt!==null&&(mn?(i=gt,u=u.stateNode,i.nodeType===8?Pc(i.parentNode,u):i.nodeType===1&&Pc(i,u),Er(i)):Pc(gt,u.stateNode));break;case 4:d=gt,m=mn,gt=u.stateNode.containerInfo,mn=!0,bi(i,r,u),gt=d,mn=m;break;case 0:case 11:case 14:case 15:if(!St&&(d=u.updateQueue,d!==null&&(d=d.lastEffect,d!==null))){m=d=d.next;do{var v=m,S=v.destroy;v=v.tag,S!==void 0&&((v&2)!==0||(v&4)!==0)&&fu(u,r,S),m=m.next}while(m!==d)}bi(i,r,u);break;case 1:if(!St&&(Ns(u,r),d=u.stateNode,typeof d.componentWillUnmount=="function"))try{d.props=u.memoizedProps,d.state=u.memoizedState,d.componentWillUnmount()}catch(x){Ze(u,r,x)}bi(i,r,u);break;case 21:bi(i,r,u);break;case 22:u.mode&1?(St=(d=St)||u.memoizedState!==null,bi(i,r,u),St=d):bi(i,r,u);break;default:bi(i,r,u)}}function Np(i){var r=i.updateQueue;if(r!==null){i.updateQueue=null;var u=i.stateNode;u===null&&(u=i.stateNode=new d0),r.forEach(function(d){var m=S0.bind(null,i,d);u.has(d)||(u.add(d),d.then(m,m))})}}function yn(i,r){var u=r.deletions;if(u!==null)for(var d=0;d<u.length;d++){var m=u[d];try{var v=i,S=r,x=S;e:for(;x!==null;){switch(x.tag){case 5:gt=x.stateNode,mn=!1;break e;case 3:gt=x.stateNode.containerInfo,mn=!0;break e;case 4:gt=x.stateNode.containerInfo,mn=!0;break e}x=x.return}if(gt===null)throw Error(t(160));Mp(v,S,m),gt=null,mn=!1;var P=m.alternate;P!==null&&(P.return=null),m.return=null}catch(B){Ze(m,r,B)}}if(r.subtreeFlags&12854)for(r=r.child;r!==null;)Op(r,i),r=r.sibling}function Op(i,r){var u=i.alternate,d=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:if(yn(r,i),Pn(i),d&4){try{Gr(3,i,i.return),La(3,i)}catch(ae){Ze(i,i.return,ae)}try{Gr(5,i,i.return)}catch(ae){Ze(i,i.return,ae)}}break;case 1:yn(r,i),Pn(i),d&512&&u!==null&&Ns(u,u.return);break;case 5:if(yn(r,i),Pn(i),d&512&&u!==null&&Ns(u,u.return),i.flags&32){var m=i.stateNode;try{zn(m,"")}catch(ae){Ze(i,i.return,ae)}}if(d&4&&(m=i.stateNode,m!=null)){var v=i.memoizedProps,S=u!==null?u.memoizedProps:v,x=i.type,P=i.updateQueue;if(i.updateQueue=null,P!==null)try{x==="input"&&v.type==="radio"&&v.name!=null&&et(m,v),ql(x,S);var B=ql(x,v);for(S=0;S<P.length;S+=2){var G=P[S],X=P[S+1];G==="style"?yd(m,X):G==="dangerouslySetInnerHTML"?hn(m,X):G==="children"?zn(m,X):T(m,G,X,B)}switch(x){case"input":En(m,v);break;case"textarea":Uo(m,v);break;case"select":var W=m._wrapperState.wasMultiple;m._wrapperState.wasMultiple=!!v.multiple;var te=v.value;te!=null?cn(m,!!v.multiple,te,!1):W!==!!v.multiple&&(v.defaultValue!=null?cn(m,!!v.multiple,v.defaultValue,!0):cn(m,!!v.multiple,v.multiple?[]:"",!1))}m[Nr]=v}catch(ae){Ze(i,i.return,ae)}}break;case 6:if(yn(r,i),Pn(i),d&4){if(i.stateNode===null)throw Error(t(162));m=i.stateNode,v=i.memoizedProps;try{m.nodeValue=v}catch(ae){Ze(i,i.return,ae)}}break;case 3:if(yn(r,i),Pn(i),d&4&&u!==null&&u.memoizedState.isDehydrated)try{Er(r.containerInfo)}catch(ae){Ze(i,i.return,ae)}break;case 4:yn(r,i),Pn(i);break;case 13:yn(r,i),Pn(i),m=i.child,m.flags&8192&&(v=m.memoizedState!==null,m.stateNode.isHidden=v,!v||m.alternate!==null&&m.alternate.memoizedState!==null||(wu=tt())),d&4&&Np(i);break;case 22:if(G=u!==null&&u.memoizedState!==null,i.mode&1?(St=(B=St)||G,yn(r,i),St=B):yn(r,i),Pn(i),d&8192){if(B=i.memoizedState!==null,(i.stateNode.isHidden=B)&&!G&&(i.mode&1)!==0)for(ie=i,G=i.child;G!==null;){for(X=ie=G;ie!==null;){switch(W=ie,te=W.child,W.tag){case 0:case 11:case 14:case 15:Gr(4,W,W.return);break;case 1:Ns(W,W.return);var oe=W.stateNode;if(typeof oe.componentWillUnmount=="function"){d=W,u=W.return;try{r=d,oe.props=r.memoizedProps,oe.state=r.memoizedState,oe.componentWillUnmount()}catch(ae){Ze(d,u,ae)}}break;case 5:Ns(W,W.return);break;case 22:if(W.memoizedState!==null){Up(X);continue}}te!==null?(te.return=W,ie=te):Up(X)}G=G.sibling}e:for(G=null,X=i;;){if(X.tag===5){if(G===null){G=X;try{m=X.stateNode,B?(v=m.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none"):(x=X.stateNode,P=X.memoizedProps.style,S=P!=null&&P.hasOwnProperty("display")?P.display:null,x.style.display=md("display",S))}catch(ae){Ze(i,i.return,ae)}}}else if(X.tag===6){if(G===null)try{X.stateNode.nodeValue=B?"":X.memoizedProps}catch(ae){Ze(i,i.return,ae)}}else if((X.tag!==22&&X.tag!==23||X.memoizedState===null||X===i)&&X.child!==null){X.child.return=X,X=X.child;continue}if(X===i)break e;for(;X.sibling===null;){if(X.return===null||X.return===i)break e;G===X&&(G=null),X=X.return}G===X&&(G=null),X.sibling.return=X.return,X=X.sibling}}break;case 19:yn(r,i),Pn(i),d&4&&Np(i);break;case 21:break;default:yn(r,i),Pn(i)}}function Pn(i){var r=i.flags;if(r&2){try{e:{for(var u=i.return;u!==null;){if(Lp(u)){var d=u;break e}u=u.return}throw Error(t(160))}switch(d.tag){case 5:var m=d.stateNode;d.flags&32&&(zn(m,""),d.flags&=-33);var v=Dp(i);mu(i,v,m);break;case 3:case 4:var S=d.stateNode.containerInfo,x=Dp(i);gu(i,x,S);break;default:throw Error(t(161))}}catch(P){Ze(i,i.return,P)}i.flags&=-3}r&4096&&(i.flags&=-4097)}function p0(i,r,u){ie=i,Fp(i)}function Fp(i,r,u){for(var d=(i.mode&1)!==0;ie!==null;){var m=ie,v=m.child;if(m.tag===22&&d){var S=m.memoizedState!==null||Ia;if(!S){var x=m.alternate,P=x!==null&&x.memoizedState!==null||St;x=Ia;var B=St;if(Ia=S,(St=P)&&!B)for(ie=m;ie!==null;)S=ie,P=S.child,S.tag===22&&S.memoizedState!==null?jp(m):P!==null?(P.return=S,ie=P):jp(m);for(;v!==null;)ie=v,Fp(v),v=v.sibling;ie=m,Ia=x,St=B}Bp(i)}else(m.subtreeFlags&8772)!==0&&v!==null?(v.return=m,ie=v):Bp(i)}}function Bp(i){for(;ie!==null;){var r=ie;if((r.flags&8772)!==0){var u=r.alternate;try{if((r.flags&8772)!==0)switch(r.tag){case 0:case 11:case 15:St||La(5,r);break;case 1:var d=r.stateNode;if(r.flags&4&&!St)if(u===null)d.componentDidMount();else{var m=r.elementType===r.type?u.memoizedProps:gn(r.type,u.memoizedProps);d.componentDidUpdate(m,u.memoizedState,d.__reactInternalSnapshotBeforeUpdate)}var v=r.updateQueue;v!==null&&Uf(r,v,d);break;case 3:var S=r.updateQueue;if(S!==null){if(u=null,r.child!==null)switch(r.child.tag){case 5:u=r.child.stateNode;break;case 1:u=r.child.stateNode}Uf(r,S,u)}break;case 5:var x=r.stateNode;if(u===null&&r.flags&4){u=x;var P=r.memoizedProps;switch(r.type){case"button":case"input":case"select":case"textarea":P.autoFocus&&u.focus();break;case"img":P.src&&(u.src=P.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(r.memoizedState===null){var B=r.alternate;if(B!==null){var G=B.memoizedState;if(G!==null){var X=G.dehydrated;X!==null&&Er(X)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}St||r.flags&512&&pu(r)}catch(W){Ze(r,r.return,W)}}if(r===i){ie=null;break}if(u=r.sibling,u!==null){u.return=r.return,ie=u;break}ie=r.return}}function Up(i){for(;ie!==null;){var r=ie;if(r===i){ie=null;break}var u=r.sibling;if(u!==null){u.return=r.return,ie=u;break}ie=r.return}}function jp(i){for(;ie!==null;){var r=ie;try{switch(r.tag){case 0:case 11:case 15:var u=r.return;try{La(4,r)}catch(P){Ze(r,u,P)}break;case 1:var d=r.stateNode;if(typeof d.componentDidMount=="function"){var m=r.return;try{d.componentDidMount()}catch(P){Ze(r,m,P)}}var v=r.return;try{pu(r)}catch(P){Ze(r,v,P)}break;case 5:var S=r.return;try{pu(r)}catch(P){Ze(r,S,P)}}}catch(P){Ze(r,r.return,P)}if(r===i){ie=null;break}var x=r.sibling;if(x!==null){x.return=r.return,ie=x;break}ie=r.return}}var g0=Math.ceil,Da=R.ReactCurrentDispatcher,yu=R.ReactCurrentOwner,en=R.ReactCurrentBatchConfig,Le=0,ut=null,rt=null,mt=0,$t=0,Os=mi(0),lt=0,qr=null,Ki=0,Ma=0,vu=0,Xr=null,Mt=null,wu=0,Fs=1/0,Yn=null,Na=!1,_u=null,Si=null,Oa=!1,Ai=null,Fa=0,Kr=0,bu=null,Ba=-1,Ua=0;function Tt(){return(Le&6)!==0?tt():Ba!==-1?Ba:Ba=tt()}function Ei(i){return(i.mode&1)===0?1:(Le&2)!==0&&mt!==0?mt&-mt:Jw.transition!==null?(Ua===0&&(Ua=Ld()),Ua):(i=Me,i!==0||(i=window.event,i=i===void 0?16:Hd(i.type)),i)}function vn(i,r,u,d){if(50<Kr)throw Kr=0,bu=null,Error(t(185));wr(i,u,d),((Le&2)===0||i!==ut)&&(i===ut&&((Le&2)===0&&(Ma|=u),lt===4&&Ci(i,mt)),Nt(i,d),u===1&&Le===0&&(r.mode&1)===0&&(Fs=tt()+500,fa&&vi()))}function Nt(i,r){var u=i.callbackNode;Jv(i,r);var d=Xo(i,i===ut?mt:0);if(d===0)u!==null&&Pd(u),i.callbackNode=null,i.callbackPriority=0;else if(r=d&-d,i.callbackPriority!==r){if(u!=null&&Pd(u),r===1)i.tag===0?Qw(zp.bind(null,i)):xf(zp.bind(null,i)),qw(function(){(Le&6)===0&&vi()}),u=null;else{switch(Dd(d)){case 1:u=ec;break;case 4:u=Rd;break;case 16:u=Vo;break;case 536870912:u=Id;break;default:u=Vo}u=Yp(u,Hp.bind(null,i))}i.callbackPriority=r,i.callbackNode=u}}function Hp(i,r){if(Ba=-1,Ua=0,(Le&6)!==0)throw Error(t(327));var u=i.callbackNode;if(Bs()&&i.callbackNode!==u)return null;var d=Xo(i,i===ut?mt:0);if(d===0)return null;if((d&30)!==0||(d&i.expiredLanes)!==0||r)r=ja(i,d);else{r=d;var m=Le;Le|=2;var v=Vp();(ut!==i||mt!==r)&&(Yn=null,Fs=tt()+500,Qi(i,r));do try{v0();break}catch(x){$p(i,x)}while(!0);Uc(),Da.current=v,Le=m,rt!==null?r=0:(ut=null,mt=0,r=lt)}if(r!==0){if(r===2&&(m=tc(i),m!==0&&(d=m,r=Su(i,m))),r===1)throw u=qr,Qi(i,0),Ci(i,d),Nt(i,tt()),u;if(r===6)Ci(i,d);else{if(m=i.current.alternate,(d&30)===0&&!m0(m)&&(r=ja(i,d),r===2&&(v=tc(i),v!==0&&(d=v,r=Su(i,v))),r===1))throw u=qr,Qi(i,0),Ci(i,d),Nt(i,tt()),u;switch(i.finishedWork=m,i.finishedLanes=d,r){case 0:case 1:throw Error(t(345));case 2:Ji(i,Mt,Yn);break;case 3:if(Ci(i,d),(d&130023424)===d&&(r=wu+500-tt(),10<r)){if(Xo(i,0)!==0)break;if(m=i.suspendedLanes,(m&d)!==d){Tt(),i.pingedLanes|=i.suspendedLanes&m;break}i.timeoutHandle=kc(Ji.bind(null,i,Mt,Yn),r);break}Ji(i,Mt,Yn);break;case 4:if(Ci(i,d),(d&4194240)===d)break;for(r=i.eventTimes,m=-1;0<d;){var S=31-dn(d);v=1<<S,S=r[S],S>m&&(m=S),d&=~v}if(d=m,d=tt()-d,d=(120>d?120:480>d?480:1080>d?1080:1920>d?1920:3e3>d?3e3:4320>d?4320:1960*g0(d/1960))-d,10<d){i.timeoutHandle=kc(Ji.bind(null,i,Mt,Yn),d);break}Ji(i,Mt,Yn);break;case 5:Ji(i,Mt,Yn);break;default:throw Error(t(329))}}}return Nt(i,tt()),i.callbackNode===u?Hp.bind(null,i):null}function Su(i,r){var u=Xr;return i.current.memoizedState.isDehydrated&&(Qi(i,r).flags|=256),i=ja(i,r),i!==2&&(r=Mt,Mt=u,r!==null&&Au(r)),i}function Au(i){Mt===null?Mt=i:Mt.push.apply(Mt,i)}function m0(i){for(var r=i;;){if(r.flags&16384){var u=r.updateQueue;if(u!==null&&(u=u.stores,u!==null))for(var d=0;d<u.length;d++){var m=u[d],v=m.getSnapshot;m=m.value;try{if(!fn(v(),m))return!1}catch{return!1}}}if(u=r.child,r.subtreeFlags&16384&&u!==null)u.return=r,r=u;else{if(r===i)break;for(;r.sibling===null;){if(r.return===null||r.return===i)return!0;r=r.return}r.sibling.return=r.return,r=r.sibling}}return!0}function Ci(i,r){for(r&=~vu,r&=~Ma,i.suspendedLanes|=r,i.pingedLanes&=~r,i=i.expirationTimes;0<r;){var u=31-dn(r),d=1<<u;i[u]=-1,r&=~d}}function zp(i){if((Le&6)!==0)throw Error(t(327));Bs();var r=Xo(i,0);if((r&1)===0)return Nt(i,tt()),null;var u=ja(i,r);if(i.tag!==0&&u===2){var d=tc(i);d!==0&&(r=d,u=Su(i,d))}if(u===1)throw u=qr,Qi(i,0),Ci(i,r),Nt(i,tt()),u;if(u===6)throw Error(t(345));return i.finishedWork=i.current.alternate,i.finishedLanes=r,Ji(i,Mt,Yn),Nt(i,tt()),null}function Eu(i,r){var u=Le;Le|=1;try{return i(r)}finally{Le=u,Le===0&&(Fs=tt()+500,fa&&vi())}}function Yi(i){Ai!==null&&Ai.tag===0&&(Le&6)===0&&Bs();var r=Le;Le|=1;var u=en.transition,d=Me;try{if(en.transition=null,Me=1,i)return i()}finally{Me=d,en.transition=u,Le=r,(Le&6)===0&&vi()}}function Cu(){$t=Os.current,ze(Os)}function Qi(i,r){i.finishedWork=null,i.finishedLanes=0;var u=i.timeoutHandle;if(u!==-1&&(i.timeoutHandle=-1,Gw(u)),rt!==null)for(u=rt.return;u!==null;){var d=u;switch(Mc(d),d.tag){case 1:d=d.type.childContextTypes,d!=null&&ha();break;case 3:Ds(),ze(It),ze(wt),qc();break;case 5:Wc(d);break;case 4:Ds();break;case 13:ze(qe);break;case 19:ze(qe);break;case 10:jc(d.type._context);break;case 22:case 23:Cu()}u=u.return}if(ut=i,rt=i=Ti(i.current,null),mt=$t=r,lt=0,qr=null,vu=Ma=Ki=0,Mt=Xr=null,Gi!==null){for(r=0;r<Gi.length;r++)if(u=Gi[r],d=u.interleaved,d!==null){u.interleaved=null;var m=d.next,v=u.pending;if(v!==null){var S=v.next;v.next=m,d.next=S}u.pending=d}Gi=null}return i}function $p(i,r){do{var u=rt;try{if(Uc(),Aa.current=xa,Ea){for(var d=Xe.memoizedState;d!==null;){var m=d.queue;m!==null&&(m.pending=null),d=d.next}Ea=!1}if(Xi=0,ct=at=Xe=null,Hr=!1,zr=0,yu.current=null,u===null||u.return===null){lt=1,qr=r,rt=null;break}e:{var v=i,S=u.return,x=u,P=r;if(r=mt,x.flags|=32768,P!==null&&typeof P=="object"&&typeof P.then=="function"){var B=P,G=x,X=G.tag;if((G.mode&1)===0&&(X===0||X===11||X===15)){var W=G.alternate;W?(G.updateQueue=W.updateQueue,G.memoizedState=W.memoizedState,G.lanes=W.lanes):(G.updateQueue=null,G.memoizedState=null)}var te=pp(S);if(te!==null){te.flags&=-257,gp(te,S,x,v,r),te.mode&1&&fp(v,B,r),r=te,P=B;var oe=r.updateQueue;if(oe===null){var ae=new Set;ae.add(P),r.updateQueue=ae}else oe.add(P);break e}else{if((r&1)===0){fp(v,B,r),Tu();break e}P=Error(t(426))}}else if($e&&x.mode&1){var nt=pp(S);if(nt!==null){(nt.flags&65536)===0&&(nt.flags|=256),gp(nt,S,x,v,r),Fc(Ms(P,x));break e}}v=P=Ms(P,x),lt!==4&&(lt=2),Xr===null?Xr=[v]:Xr.push(v),v=S;do{switch(v.tag){case 3:v.flags|=65536,r&=-r,v.lanes|=r;var O=hp(v,P,r);Bf(v,O);break e;case 1:x=P;var D=v.type,F=v.stateNode;if((v.flags&128)===0&&(typeof D.getDerivedStateFromError=="function"||F!==null&&typeof F.componentDidCatch=="function"&&(Si===null||!Si.has(F)))){v.flags|=65536,r&=-r,v.lanes|=r;var Y=dp(v,x,r);Bf(v,Y);break e}}v=v.return}while(v!==null)}Gp(u)}catch(ce){r=ce,rt===u&&u!==null&&(rt=u=u.return);continue}break}while(!0)}function Vp(){var i=Da.current;return Da.current=xa,i===null?xa:i}function Tu(){(lt===0||lt===3||lt===2)&&(lt=4),ut===null||(Ki&268435455)===0&&(Ma&268435455)===0||Ci(ut,mt)}function ja(i,r){var u=Le;Le|=2;var d=Vp();(ut!==i||mt!==r)&&(Yn=null,Qi(i,r));do try{y0();break}catch(m){$p(i,m)}while(!0);if(Uc(),Le=u,Da.current=d,rt!==null)throw Error(t(261));return ut=null,mt=0,lt}function y0(){for(;rt!==null;)Wp(rt)}function v0(){for(;rt!==null&&!$v();)Wp(rt)}function Wp(i){var r=Kp(i.alternate,i,$t);i.memoizedProps=i.pendingProps,r===null?Gp(i):rt=r,yu.current=null}function Gp(i){var r=i;do{var u=r.alternate;if(i=r.return,(r.flags&32768)===0){if(u=u0(u,r,$t),u!==null){rt=u;return}}else{if(u=h0(u,r),u!==null){u.flags&=32767,rt=u;return}if(i!==null)i.flags|=32768,i.subtreeFlags=0,i.deletions=null;else{lt=6,rt=null;return}}if(r=r.sibling,r!==null){rt=r;return}rt=r=i}while(r!==null);lt===0&&(lt=5)}function Ji(i,r,u){var d=Me,m=en.transition;try{en.transition=null,Me=1,w0(i,r,u,d)}finally{en.transition=m,Me=d}return null}function w0(i,r,u,d){do Bs();while(Ai!==null);if((Le&6)!==0)throw Error(t(327));u=i.finishedWork;var m=i.finishedLanes;if(u===null)return null;if(i.finishedWork=null,i.finishedLanes=0,u===i.current)throw Error(t(177));i.callbackNode=null,i.callbackPriority=0;var v=u.lanes|u.childLanes;if(Zv(i,v),i===ut&&(rt=ut=null,mt=0),(u.subtreeFlags&2064)===0&&(u.flags&2064)===0||Oa||(Oa=!0,Yp(Vo,function(){return Bs(),null})),v=(u.flags&15990)!==0,(u.subtreeFlags&15990)!==0||v){v=en.transition,en.transition=null;var S=Me;Me=1;var x=Le;Le|=4,yu.current=null,f0(i,u),Op(u,i),Uw(Tc),Qo=!!Cc,Tc=Cc=null,i.current=u,p0(u),Vv(),Le=x,Me=S,en.transition=v}else i.current=u;if(Oa&&(Oa=!1,Ai=i,Fa=m),v=i.pendingLanes,v===0&&(Si=null),qv(u.stateNode),Nt(i,tt()),r!==null)for(d=i.onRecoverableError,u=0;u<r.length;u++)m=r[u],d(m.value,{componentStack:m.stack,digest:m.digest});if(Na)throw Na=!1,i=_u,_u=null,i;return(Fa&1)!==0&&i.tag!==0&&Bs(),v=i.pendingLanes,(v&1)!==0?i===bu?Kr++:(Kr=0,bu=i):Kr=0,vi(),null}function Bs(){if(Ai!==null){var i=Dd(Fa),r=en.transition,u=Me;try{if(en.transition=null,Me=16>i?16:i,Ai===null)var d=!1;else{if(i=Ai,Ai=null,Fa=0,(Le&6)!==0)throw Error(t(331));var m=Le;for(Le|=4,ie=i.current;ie!==null;){var v=ie,S=v.child;if((ie.flags&16)!==0){var x=v.deletions;if(x!==null){for(var P=0;P<x.length;P++){var B=x[P];for(ie=B;ie!==null;){var G=ie;switch(G.tag){case 0:case 11:case 15:Gr(8,G,v)}var X=G.child;if(X!==null)X.return=G,ie=X;else for(;ie!==null;){G=ie;var W=G.sibling,te=G.return;if(Ip(G),G===B){ie=null;break}if(W!==null){W.return=te,ie=W;break}ie=te}}}var oe=v.alternate;if(oe!==null){var ae=oe.child;if(ae!==null){oe.child=null;do{var nt=ae.sibling;ae.sibling=null,ae=nt}while(ae!==null)}}ie=v}}if((v.subtreeFlags&2064)!==0&&S!==null)S.return=v,ie=S;else e:for(;ie!==null;){if(v=ie,(v.flags&2048)!==0)switch(v.tag){case 0:case 11:case 15:Gr(9,v,v.return)}var O=v.sibling;if(O!==null){O.return=v.return,ie=O;break e}ie=v.return}}var D=i.current;for(ie=D;ie!==null;){S=ie;var F=S.child;if((S.subtreeFlags&2064)!==0&&F!==null)F.return=S,ie=F;else e:for(S=D;ie!==null;){if(x=ie,(x.flags&2048)!==0)try{switch(x.tag){case 0:case 11:case 15:La(9,x)}}catch(ce){Ze(x,x.return,ce)}if(x===S){ie=null;break e}var Y=x.sibling;if(Y!==null){Y.return=x.return,ie=Y;break e}ie=x.return}}if(Le=m,vi(),Cn&&typeof Cn.onPostCommitFiberRoot=="function")try{Cn.onPostCommitFiberRoot(Wo,i)}catch{}d=!0}return d}finally{Me=u,en.transition=r}}return!1}function qp(i,r,u){r=Ms(u,r),r=hp(i,r,1),i=_i(i,r,1),r=Tt(),i!==null&&(wr(i,1,r),Nt(i,r))}function Ze(i,r,u){if(i.tag===3)qp(i,i,u);else for(;r!==null;){if(r.tag===3){qp(r,i,u);break}else if(r.tag===1){var d=r.stateNode;if(typeof r.type.getDerivedStateFromError=="function"||typeof d.componentDidCatch=="function"&&(Si===null||!Si.has(d))){i=Ms(u,i),i=dp(r,i,1),r=_i(r,i,1),i=Tt(),r!==null&&(wr(r,1,i),Nt(r,i));break}}r=r.return}}function _0(i,r,u){var d=i.pingCache;d!==null&&d.delete(r),r=Tt(),i.pingedLanes|=i.suspendedLanes&u,ut===i&&(mt&u)===u&&(lt===4||lt===3&&(mt&130023424)===mt&&500>tt()-wu?Qi(i,0):vu|=u),Nt(i,r)}function Xp(i,r){r===0&&((i.mode&1)===0?r=1:(r=qo,qo<<=1,(qo&130023424)===0&&(qo=4194304)));var u=Tt();i=qn(i,r),i!==null&&(wr(i,r,u),Nt(i,u))}function b0(i){var r=i.memoizedState,u=0;r!==null&&(u=r.retryLane),Xp(i,u)}function S0(i,r){var u=0;switch(i.tag){case 13:var d=i.stateNode,m=i.memoizedState;m!==null&&(u=m.retryLane);break;case 19:d=i.stateNode;break;default:throw Error(t(314))}d!==null&&d.delete(r),Xp(i,u)}var Kp;Kp=function(i,r,u){if(i!==null)if(i.memoizedProps!==r.pendingProps||It.current)Dt=!0;else{if((i.lanes&u)===0&&(r.flags&128)===0)return Dt=!1,c0(i,r,u);Dt=(i.flags&131072)!==0}else Dt=!1,$e&&(r.flags&1048576)!==0&&kf(r,ga,r.index);switch(r.lanes=0,r.tag){case 2:var d=r.type;Ra(i,r),i=r.pendingProps;var m=Ts(r,wt.current);Ls(r,u),m=Yc(null,r,d,i,m,u);var v=Qc();return r.flags|=1,typeof m=="object"&&m!==null&&typeof m.render=="function"&&m.$$typeof===void 0?(r.tag=1,r.memoizedState=null,r.updateQueue=null,Lt(d)?(v=!0,da(r)):v=!1,r.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,$c(r),m.updater=ka,r.stateNode=m,m._reactInternals=r,iu(r,d,i,u),r=au(null,r,d,!0,v,u)):(r.tag=0,$e&&v&&Dc(r),Ct(null,r,m,u),r=r.child),r;case 16:d=r.elementType;e:{switch(Ra(i,r),i=r.pendingProps,m=d._init,d=m(d._payload),r.type=d,m=r.tag=E0(d),i=gn(d,i),m){case 0:r=ou(null,r,d,i,u);break e;case 1:r=bp(null,r,d,i,u);break e;case 11:r=mp(null,r,d,i,u);break e;case 14:r=yp(null,r,d,gn(d.type,i),u);break e}throw Error(t(306,d,""))}return r;case 0:return d=r.type,m=r.pendingProps,m=r.elementType===d?m:gn(d,m),ou(i,r,d,m,u);case 1:return d=r.type,m=r.pendingProps,m=r.elementType===d?m:gn(d,m),bp(i,r,d,m,u);case 3:e:{if(Sp(r),i===null)throw Error(t(387));d=r.pendingProps,v=r.memoizedState,m=v.element,Ff(i,r),ba(r,d,null,u);var S=r.memoizedState;if(d=S.element,v.isDehydrated)if(v={element:d,isDehydrated:!1,cache:S.cache,pendingSuspenseBoundaries:S.pendingSuspenseBoundaries,transitions:S.transitions},r.updateQueue.baseState=v,r.memoizedState=v,r.flags&256){m=Ms(Error(t(423)),r),r=Ap(i,r,d,u,m);break e}else if(d!==m){m=Ms(Error(t(424)),r),r=Ap(i,r,d,u,m);break e}else for(zt=gi(r.stateNode.containerInfo.firstChild),Ht=r,$e=!0,pn=null,u=Nf(r,null,d,u),r.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling;else{if(Ps(),d===m){r=Kn(i,r,u);break e}Ct(i,r,d,u)}r=r.child}return r;case 5:return jf(r),i===null&&Oc(r),d=r.type,m=r.pendingProps,v=i!==null?i.memoizedProps:null,S=m.children,xc(d,m)?S=null:v!==null&&xc(d,v)&&(r.flags|=32),_p(i,r),Ct(i,r,S,u),r.child;case 6:return i===null&&Oc(r),null;case 13:return Ep(i,r,u);case 4:return Vc(r,r.stateNode.containerInfo),d=r.pendingProps,i===null?r.child=Rs(r,null,d,u):Ct(i,r,d,u),r.child;case 11:return d=r.type,m=r.pendingProps,m=r.elementType===d?m:gn(d,m),mp(i,r,d,m,u);case 7:return Ct(i,r,r.pendingProps,u),r.child;case 8:return Ct(i,r,r.pendingProps.children,u),r.child;case 12:return Ct(i,r,r.pendingProps.children,u),r.child;case 10:e:{if(d=r.type._context,m=r.pendingProps,v=r.memoizedProps,S=m.value,je(va,d._currentValue),d._currentValue=S,v!==null)if(fn(v.value,S)){if(v.children===m.children&&!It.current){r=Kn(i,r,u);break e}}else for(v=r.child,v!==null&&(v.return=r);v!==null;){var x=v.dependencies;if(x!==null){S=v.child;for(var P=x.firstContext;P!==null;){if(P.context===d){if(v.tag===1){P=Xn(-1,u&-u),P.tag=2;var B=v.updateQueue;if(B!==null){B=B.shared;var G=B.pending;G===null?P.next=P:(P.next=G.next,G.next=P),B.pending=P}}v.lanes|=u,P=v.alternate,P!==null&&(P.lanes|=u),Hc(v.return,u,r),x.lanes|=u;break}P=P.next}}else if(v.tag===10)S=v.type===r.type?null:v.child;else if(v.tag===18){if(S=v.return,S===null)throw Error(t(341));S.lanes|=u,x=S.alternate,x!==null&&(x.lanes|=u),Hc(S,u,r),S=v.sibling}else S=v.child;if(S!==null)S.return=v;else for(S=v;S!==null;){if(S===r){S=null;break}if(v=S.sibling,v!==null){v.return=S.return,S=v;break}S=S.return}v=S}Ct(i,r,m.children,u),r=r.child}return r;case 9:return m=r.type,d=r.pendingProps.children,Ls(r,u),m=Jt(m),d=d(m),r.flags|=1,Ct(i,r,d,u),r.child;case 14:return d=r.type,m=gn(d,r.pendingProps),m=gn(d.type,m),yp(i,r,d,m,u);case 15:return vp(i,r,r.type,r.pendingProps,u);case 17:return d=r.type,m=r.pendingProps,m=r.elementType===d?m:gn(d,m),Ra(i,r),r.tag=1,Lt(d)?(i=!0,da(r)):i=!1,Ls(r,u),cp(r,d,m),iu(r,d,m,u),au(null,r,d,!0,i,u);case 19:return Tp(i,r,u);case 22:return wp(i,r,u)}throw Error(t(156,r.tag))};function Yp(i,r){return kd(i,r)}function A0(i,r,u,d){this.tag=i,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=r,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=d,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function tn(i,r,u,d){return new A0(i,r,u,d)}function xu(i){return i=i.prototype,!(!i||!i.isReactComponent)}function E0(i){if(typeof i=="function")return xu(i)?1:0;if(i!=null){if(i=i.$$typeof,i===ue)return 11;if(i===ye)return 14}return 2}function Ti(i,r){var u=i.alternate;return u===null?(u=tn(i.tag,r,i.key,i.mode),u.elementType=i.elementType,u.type=i.type,u.stateNode=i.stateNode,u.alternate=i,i.alternate=u):(u.pendingProps=r,u.type=i.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=i.flags&14680064,u.childLanes=i.childLanes,u.lanes=i.lanes,u.child=i.child,u.memoizedProps=i.memoizedProps,u.memoizedState=i.memoizedState,u.updateQueue=i.updateQueue,r=i.dependencies,u.dependencies=r===null?null:{lanes:r.lanes,firstContext:r.firstContext},u.sibling=i.sibling,u.index=i.index,u.ref=i.ref,u}function Ha(i,r,u,d,m,v){var S=2;if(d=i,typeof i=="function")xu(i)&&(S=1);else if(typeof i=="string")S=5;else e:switch(i){case N:return Zi(u.children,m,v,r);case U:S=8,m|=8;break;case z:return i=tn(12,u,r,m|2),i.elementType=z,i.lanes=v,i;case Q:return i=tn(13,u,r,m),i.elementType=Q,i.lanes=v,i;case le:return i=tn(19,u,r,m),i.elementType=le,i.lanes=v,i;case K:return za(u,m,v,r);default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case V:S=10;break e;case q:S=9;break e;case ue:S=11;break e;case ye:S=14;break e;case J:S=16,d=null;break e}throw Error(t(130,i==null?i:typeof i,""))}return r=tn(S,u,r,m),r.elementType=i,r.type=d,r.lanes=v,r}function Zi(i,r,u,d){return i=tn(7,i,d,r),i.lanes=u,i}function za(i,r,u,d){return i=tn(22,i,d,r),i.elementType=K,i.lanes=u,i.stateNode={isHidden:!1},i}function ku(i,r,u){return i=tn(6,i,null,r),i.lanes=u,i}function Pu(i,r,u){return r=tn(4,i.children!==null?i.children:[],i.key,r),r.lanes=u,r.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},r}function C0(i,r,u,d,m){this.tag=r,this.containerInfo=i,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=nc(0),this.expirationTimes=nc(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=nc(0),this.identifierPrefix=d,this.onRecoverableError=m,this.mutableSourceEagerHydrationData=null}function Ru(i,r,u,d,m,v,S,x,P){return i=new C0(i,r,u,x,P),r===1?(r=1,v===!0&&(r|=8)):r=0,v=tn(3,null,null,r),i.current=v,v.stateNode=i,v.memoizedState={element:d,isDehydrated:u,cache:null,transitions:null,pendingSuspenseBoundaries:null},$c(v),i}function T0(i,r,u){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:k,key:d==null?null:""+d,children:i,containerInfo:r,implementation:u}}function Qp(i){if(!i)return yi;i=i._reactInternals;e:{if(Hi(i)!==i||i.tag!==1)throw Error(t(170));var r=i;do{switch(r.tag){case 3:r=r.stateNode.context;break e;case 1:if(Lt(r.type)){r=r.stateNode.__reactInternalMemoizedMergedChildContext;break e}}r=r.return}while(r!==null);throw Error(t(171))}if(i.tag===1){var u=i.type;if(Lt(u))return Cf(i,u,r)}return r}function Jp(i,r,u,d,m,v,S,x,P){return i=Ru(u,d,!0,i,m,v,S,x,P),i.context=Qp(null),u=i.current,d=Tt(),m=Ei(u),v=Xn(d,m),v.callback=r??null,_i(u,v,m),i.current.lanes=m,wr(i,m,d),Nt(i,d),i}function $a(i,r,u,d){var m=r.current,v=Tt(),S=Ei(m);return u=Qp(u),r.context===null?r.context=u:r.pendingContext=u,r=Xn(v,S),r.payload={element:i},d=d===void 0?null:d,d!==null&&(r.callback=d),i=_i(m,r,S),i!==null&&(vn(i,m,S,v),_a(i,m,S)),S}function Va(i){if(i=i.current,!i.child)return null;switch(i.child.tag){case 5:return i.child.stateNode;default:return i.child.stateNode}}function Zp(i,r){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var u=i.retryLane;i.retryLane=u!==0&&u<r?u:r}}function Iu(i,r){Zp(i,r),(i=i.alternate)&&Zp(i,r)}function x0(){return null}var eg=typeof reportError=="function"?reportError:function(i){console.error(i)};function Lu(i){this._internalRoot=i}Wa.prototype.render=Lu.prototype.render=function(i){var r=this._internalRoot;if(r===null)throw Error(t(409));$a(i,r,null,null)},Wa.prototype.unmount=Lu.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var r=i.containerInfo;Yi(function(){$a(null,i,null,null)}),r[$n]=null}};function Wa(i){this._internalRoot=i}Wa.prototype.unstable_scheduleHydration=function(i){if(i){var r=Od();i={blockedOn:null,target:i,priority:r};for(var u=0;u<di.length&&r!==0&&r<di[u].priority;u++);di.splice(u,0,i),u===0&&Ud(i)}};function Du(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function Ga(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11&&(i.nodeType!==8||i.nodeValue!==" react-mount-point-unstable "))}function tg(){}function k0(i,r,u,d,m){if(m){if(typeof d=="function"){var v=d;d=function(){var B=Va(S);v.call(B)}}var S=Jp(r,d,i,0,null,!1,!1,"",tg);return i._reactRootContainer=S,i[$n]=S.current,Dr(i.nodeType===8?i.parentNode:i),Yi(),S}for(;m=i.lastChild;)i.removeChild(m);if(typeof d=="function"){var x=d;d=function(){var B=Va(P);x.call(B)}}var P=Ru(i,0,!1,null,null,!1,!1,"",tg);return i._reactRootContainer=P,i[$n]=P.current,Dr(i.nodeType===8?i.parentNode:i),Yi(function(){$a(r,P,u,d)}),P}function qa(i,r,u,d,m){var v=u._reactRootContainer;if(v){var S=v;if(typeof m=="function"){var x=m;m=function(){var P=Va(S);x.call(P)}}$a(r,S,i,m)}else S=k0(u,r,i,m,d);return Va(S)}Md=function(i){switch(i.tag){case 3:var r=i.stateNode;if(r.current.memoizedState.isDehydrated){var u=vr(r.pendingLanes);u!==0&&(ic(r,u|1),Nt(r,tt()),(Le&6)===0&&(Fs=tt()+500,vi()))}break;case 13:Yi(function(){var d=qn(i,1);if(d!==null){var m=Tt();vn(d,i,1,m)}}),Iu(i,1)}},sc=function(i){if(i.tag===13){var r=qn(i,134217728);if(r!==null){var u=Tt();vn(r,i,134217728,u)}Iu(i,134217728)}},Nd=function(i){if(i.tag===13){var r=Ei(i),u=qn(i,r);if(u!==null){var d=Tt();vn(u,i,r,d)}Iu(i,r)}},Od=function(){return Me},Fd=function(i,r){var u=Me;try{return Me=i,r()}finally{Me=u}},Yl=function(i,r,u){switch(r){case"input":if(En(i,u),r=u.name,u.type==="radio"&&r!=null){for(u=i;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll("input[name="+JSON.stringify(""+r)+'][type="radio"]'),r=0;r<u.length;r++){var d=u[r];if(d!==i&&d.form===i.form){var m=ua(d);if(!m)throw Error(t(90));Xt(d),En(d,m)}}}break;case"textarea":Uo(i,u);break;case"select":r=u.value,r!=null&&cn(i,!!u.multiple,r,!1)}},bd=Eu,Sd=Yi;var P0={usingClientEntryPoint:!1,Events:[Or,Es,ua,wd,_d,Eu]},Yr={findFiberByHostInstance:zi,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},R0={bundleType:Yr.bundleType,version:Yr.version,rendererPackageName:Yr.rendererPackageName,rendererConfig:Yr.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:R.ReactCurrentDispatcher,findHostInstanceByFiber:function(i){return i=Td(i),i===null?null:i.stateNode},findFiberByHostInstance:Yr.findFiberByHostInstance||x0,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Xa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Xa.isDisabled&&Xa.supportsFiber)try{Wo=Xa.inject(R0),Cn=Xa}catch{}}return Ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=P0,Ft.createPortal=function(i,r){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Du(r))throw Error(t(200));return T0(i,r,null,u)},Ft.createRoot=function(i,r){if(!Du(i))throw Error(t(299));var u=!1,d="",m=eg;return r!=null&&(r.unstable_strictMode===!0&&(u=!0),r.identifierPrefix!==void 0&&(d=r.identifierPrefix),r.onRecoverableError!==void 0&&(m=r.onRecoverableError)),r=Ru(i,1,!1,null,null,u,!1,d,m),i[$n]=r.current,Dr(i.nodeType===8?i.parentNode:i),new Lu(r)},Ft.findDOMNode=function(i){if(i==null)return null;if(i.nodeType===1)return i;var r=i._reactInternals;if(r===void 0)throw typeof i.render=="function"?Error(t(188)):(i=Object.keys(i).join(","),Error(t(268,i)));return i=Td(r),i=i===null?null:i.stateNode,i},Ft.flushSync=function(i){return Yi(i)},Ft.hydrate=function(i,r,u){if(!Ga(r))throw Error(t(200));return qa(null,i,r,!0,u)},Ft.hydrateRoot=function(i,r,u){if(!Du(i))throw Error(t(405));var d=u!=null&&u.hydratedSources||null,m=!1,v="",S=eg;if(u!=null&&(u.unstable_strictMode===!0&&(m=!0),u.identifierPrefix!==void 0&&(v=u.identifierPrefix),u.onRecoverableError!==void 0&&(S=u.onRecoverableError)),r=Jp(r,null,i,1,u??null,m,!1,v,S),i[$n]=r.current,Dr(i),d)for(i=0;i<d.length;i++)u=d[i],m=u._getVersion,m=m(u._source),r.mutableSourceEagerHydrationData==null?r.mutableSourceEagerHydrationData=[u,m]:r.mutableSourceEagerHydrationData.push(u,m);return new Wa(r)},Ft.render=function(i,r,u){if(!Ga(r))throw Error(t(200));return qa(null,i,r,!1,u)},Ft.unmountComponentAtNode=function(i){if(!Ga(i))throw Error(t(40));return i._reactRootContainer?(Yi(function(){qa(null,null,i,!1,function(){i._reactRootContainer=null,i[$n]=null})}),!0):!1},Ft.unstable_batchedUpdates=Eu,Ft.unstable_renderSubtreeIntoContainer=function(i,r,u,d){if(!Ga(u))throw Error(t(200));if(i==null||i._reactInternals===void 0)throw Error(t(38));return qa(i,r,u,!1,d)},Ft.version="18.3.1-next-f1338f8080-20240426",Ft}var hg;function B0(){if(hg)return Fu.exports;hg=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(e){console.error(e)}}return a(),Fu.exports=F0(),Fu.exports}var dg;function U0(){if(dg)return Ka;dg=1;var a=B0();return Ka.createRoot=a.createRoot,Ka.hydrateRoot=a.hydrateRoot,Ka}var j0=U0();const H0=Lm(j0);var fg="popstate";function z0(a={}){function e(n,s){let{pathname:o,search:l,hash:c}=n.location;return sh("",{pathname:o,search:l,hash:c},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function t(n,s){return typeof s=="string"?s:uo(s)}return V0(e,t,null,a)}function Ge(a,e){if(a===!1||a===null||typeof a>"u")throw new Error(e)}function on(a,e){if(!a){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function $0(){return Math.random().toString(36).substring(2,10)}function pg(a,e){return{usr:a.state,key:a.key,idx:e}}function sh(a,e,t=null,n){return{pathname:typeof a=="string"?a:a.pathname,search:"",hash:"",...typeof e=="string"?or(e):e,state:t,key:e&&e.key||n||$0()}}function uo({pathname:a="/",search:e="",hash:t=""}){return e&&e!=="?"&&(a+=e.charAt(0)==="?"?e:"?"+e),t&&t!=="#"&&(a+=t.charAt(0)==="#"?t:"#"+t),a}function or(a){let e={};if(a){let t=a.indexOf("#");t>=0&&(e.hash=a.substring(t),a=a.substring(0,t));let n=a.indexOf("?");n>=0&&(e.search=a.substring(n),a=a.substring(0,n)),a&&(e.pathname=a)}return e}function V0(a,e,t,n={}){let{window:s=document.defaultView,v5Compat:o=!1}=n,l=s.history,c="POP",h=null,f=p();f==null&&(f=0,l.replaceState({...l.state,idx:f},""));function p(){return(l.state||{idx:null}).idx}function g(){c="POP";let A=p(),E=A==null?null:A-f;f=A,h&&h({action:c,location:_.location,delta:E})}function y(A,E){c="PUSH";let C=sh(_.location,A,E);f=p()+1;let T=pg(C,f),R=_.createHref(C);try{l.pushState(T,"",R)}catch(L){if(L instanceof DOMException&&L.name==="DataCloneError")throw L;s.location.assign(R)}o&&h&&h({action:c,location:_.location,delta:1})}function w(A,E){c="REPLACE";let C=sh(_.location,A,E);f=p();let T=pg(C,f),R=_.createHref(C);l.replaceState(T,"",R),o&&h&&h({action:c,location:_.location,delta:0})}function b(A){return W0(A)}let _={get action(){return c},get location(){return a(s,l)},listen(A){if(h)throw new Error("A history only accepts one active listener");return s.addEventListener(fg,g),h=A,()=>{s.removeEventListener(fg,g),h=null}},createHref(A){return e(s,A)},createURL:b,encodeLocation(A){let E=b(A);return{pathname:E.pathname,search:E.search,hash:E.hash}},push:y,replace:w,go(A){return l.go(A)}};return _}function W0(a,e=!1){let t="http://localhost";typeof window<"u"&&(t=window.location.origin!=="null"?window.location.origin:window.location.href),Ge(t,"No window.location.(origin|href) available to create URL");let n=typeof a=="string"?a:uo(a);return n=n.replace(/ $/,"%20"),!e&&n.startsWith("//")&&(n=t+n),new URL(n,t)}function Dm(a,e,t="/"){return G0(a,e,t,!1)}function G0(a,e,t,n){let s=typeof e=="string"?or(e):e,o=ii(s.pathname||"/",t);if(o==null)return null;let l=Mm(a);q0(l);let c=null;for(let h=0;c==null&&h<l.length;++h){let f=s_(o);c=n_(l[h],f,n)}return c}function Mm(a,e=[],t=[],n="",s=!1){let o=(l,c,h=s,f)=>{let p={relativePath:f===void 0?l.path||"":f,caseSensitive:l.caseSensitive===!0,childrenIndex:c,route:l};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(n)&&h)return;Ge(p.relativePath.startsWith(n),`Absolute route path "${p.relativePath}" nested under path "${n}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(n.length)}let g=ni([n,p.relativePath]),y=t.concat(p);l.children&&l.children.length>0&&(Ge(l.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),Mm(l.children,e,y,g,h)),!(l.path==null&&!l.index)&&e.push({path:g,score:e_(g,l.index),routesMeta:y})};return a.forEach((l,c)=>{if(l.path===""||!l.path?.includes("?"))o(l,c);else for(let h of Nm(l.path))o(l,c,!0,h)}),e}function Nm(a){let e=a.split("/");if(e.length===0)return[];let[t,...n]=e,s=t.endsWith("?"),o=t.replace(/\?$/,"");if(n.length===0)return s?[o,""]:[o];let l=Nm(n.join("/")),c=[];return c.push(...l.map(h=>h===""?o:[o,h].join("/"))),s&&c.push(...l),c.map(h=>a.startsWith("/")&&h===""?"/":h)}function q0(a){a.sort((e,t)=>e.score!==t.score?t.score-e.score:t_(e.routesMeta.map(n=>n.childrenIndex),t.routesMeta.map(n=>n.childrenIndex)))}var X0=/^:[\w-]+$/,K0=3,Y0=2,Q0=1,J0=10,Z0=-2,gg=a=>a==="*";function e_(a,e){let t=a.split("/"),n=t.length;return t.some(gg)&&(n+=Z0),e&&(n+=Y0),t.filter(s=>!gg(s)).reduce((s,o)=>s+(X0.test(o)?K0:o===""?Q0:J0),n)}function t_(a,e){return a.length===e.length&&a.slice(0,-1).every((n,s)=>n===e[s])?a[a.length-1]-e[e.length-1]:0}function n_(a,e,t=!1){let{routesMeta:n}=a,s={},o="/",l=[];for(let c=0;c<n.length;++c){let h=n[c],f=c===n.length-1,p=o==="/"?e:e.slice(o.length)||"/",g=ml({path:h.relativePath,caseSensitive:h.caseSensitive,end:f},p),y=h.route;if(!g&&f&&t&&!n[n.length-1].route.index&&(g=ml({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},p)),!g)return null;Object.assign(s,g.params),l.push({params:s,pathname:ni([o,g.pathname]),pathnameBase:c_(ni([o,g.pathnameBase])),route:y}),g.pathnameBase!=="/"&&(o=ni([o,g.pathnameBase]))}return l}function ml(a,e){typeof a=="string"&&(a={path:a,caseSensitive:!1,end:!0});let[t,n]=i_(a.path,a.caseSensitive,a.end),s=e.match(t);if(!s)return null;let o=s[0],l=o.replace(/(.)\/+$/,"$1"),c=s.slice(1);return{params:n.reduce((f,{paramName:p,isOptional:g},y)=>{if(p==="*"){let b=c[y]||"";l=o.slice(0,o.length-b.length).replace(/(.)\/+$/,"$1")}const w=c[y];return g&&!w?f[p]=void 0:f[p]=(w||"").replace(/%2F/g,"/"),f},{}),pathname:o,pathnameBase:l,pattern:a}}function i_(a,e=!1,t=!0){on(a==="*"||!a.endsWith("*")||a.endsWith("/*"),`Route path "${a}" will be treated as if it were "${a.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${a.replace(/\*$/,"/*")}".`);let n=[],s="^"+a.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,c,h)=>(n.push({paramName:c,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return a.endsWith("*")?(n.push({paramName:"*"}),s+=a==="*"||a==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":a!==""&&a!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),n]}function s_(a){try{return a.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return on(!1,`The URL path "${a}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),a}}function ii(a,e){if(e==="/")return a;if(!a.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,n=a.charAt(t);return n&&n!=="/"?null:a.slice(t)||"/"}var r_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,o_=a=>r_.test(a);function a_(a,e="/"){let{pathname:t,search:n="",hash:s=""}=typeof a=="string"?or(a):a,o;if(t)if(o_(t))o=t;else{if(t.includes("//")){let l=t;t=t.replace(/\/\/+/g,"/"),on(!1,`Pathnames cannot have embedded double slashes - normalizing ${l} -> ${t}`)}t.startsWith("/")?o=mg(t.substring(1),"/"):o=mg(t,e)}else o=e;return{pathname:o,search:u_(n),hash:h_(s)}}function mg(a,e){let t=e.replace(/\/+$/,"").split("/");return a.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function ju(a,e,t,n){return`Cannot include a '${a}' character in a manually specified \`to.${e}\` field [${JSON.stringify(n)}].  Please separate it out to the \`to.${t}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function l_(a){return a.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function kh(a){let e=l_(a);return e.map((t,n)=>n===e.length-1?t.pathname:t.pathnameBase)}function Ph(a,e,t,n=!1){let s;typeof a=="string"?s=or(a):(s={...a},Ge(!s.pathname||!s.pathname.includes("?"),ju("?","pathname","search",s)),Ge(!s.pathname||!s.pathname.includes("#"),ju("#","pathname","hash",s)),Ge(!s.search||!s.search.includes("#"),ju("#","search","hash",s)));let o=a===""||s.pathname==="",l=o?"/":s.pathname,c;if(l==null)c=t;else{let g=e.length-1;if(!n&&l.startsWith("..")){let y=l.split("/");for(;y[0]==="..";)y.shift(),g-=1;s.pathname=y.join("/")}c=g>=0?e[g]:"/"}let h=a_(s,c),f=l&&l!=="/"&&l.endsWith("/"),p=(o||l===".")&&t.endsWith("/");return!h.pathname.endsWith("/")&&(f||p)&&(h.pathname+="/"),h}var ni=a=>a.join("/").replace(/\/\/+/g,"/"),c_=a=>a.replace(/\/+$/,"").replace(/^\/*/,"/"),u_=a=>!a||a==="?"?"":a.startsWith("?")?a:"?"+a,h_=a=>!a||a==="#"?"":a.startsWith("#")?a:"#"+a;function d_(a){return a!=null&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.internal=="boolean"&&"data"in a}function f_(a){return a.map(e=>e.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Om=["POST","PUT","PATCH","DELETE"];new Set(Om);var p_=["GET",...Om];new Set(p_);var ar=I.createContext(null);ar.displayName="DataRouter";var Pl=I.createContext(null);Pl.displayName="DataRouterState";I.createContext(!1);var Fm=I.createContext({isTransitioning:!1});Fm.displayName="ViewTransition";var g_=I.createContext(new Map);g_.displayName="Fetchers";var m_=I.createContext(null);m_.displayName="Await";var an=I.createContext(null);an.displayName="Navigation";var bo=I.createContext(null);bo.displayName="Location";var ln=I.createContext({outlet:null,matches:[],isDataRoute:!1});ln.displayName="Route";var Rh=I.createContext(null);Rh.displayName="RouteError";function y_(a,{relative:e}={}){Ge(lr(),"useHref() may be used only in the context of a <Router> component.");let{basename:t,navigator:n}=I.useContext(an),{hash:s,pathname:o,search:l}=So(a,{relative:e}),c=o;return t!=="/"&&(c=o==="/"?t:ni([t,o])),n.createHref({pathname:c,search:l,hash:s})}function lr(){return I.useContext(bo)!=null}function Hn(){return Ge(lr(),"useLocation() may be used only in the context of a <Router> component."),I.useContext(bo).location}var Bm="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Um(a){I.useContext(an).static||I.useLayoutEffect(a)}function cr(){let{isDataRoute:a}=I.useContext(ln);return a?L_():v_()}function v_(){Ge(lr(),"useNavigate() may be used only in the context of a <Router> component.");let a=I.useContext(ar),{basename:e,navigator:t}=I.useContext(an),{matches:n}=I.useContext(ln),{pathname:s}=Hn(),o=JSON.stringify(kh(n)),l=I.useRef(!1);return Um(()=>{l.current=!0}),I.useCallback((h,f={})=>{if(on(l.current,Bm),!l.current)return;if(typeof h=="number"){t.go(h);return}let p=Ph(h,JSON.parse(o),s,f.relative==="path");a==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:ni([e,p.pathname])),(f.replace?t.replace:t.push)(p,f.state,f)},[e,t,o,s,a])}var w_=I.createContext(null);function __(a){let e=I.useContext(ln).outlet;return I.useMemo(()=>e&&I.createElement(w_.Provider,{value:a},e),[e,a])}function Ih(){let{matches:a}=I.useContext(ln),e=a[a.length-1];return e?e.params:{}}function So(a,{relative:e}={}){let{matches:t}=I.useContext(ln),{pathname:n}=Hn(),s=JSON.stringify(kh(t));return I.useMemo(()=>Ph(a,JSON.parse(s),n,e==="path"),[a,s,n,e])}function b_(a,e){return jm(a,e)}function jm(a,e,t,n,s){Ge(lr(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:o}=I.useContext(an),{matches:l}=I.useContext(ln),c=l[l.length-1],h=c?c.params:{},f=c?c.pathname:"/",p=c?c.pathnameBase:"/",g=c&&c.route;{let C=g&&g.path||"";Hm(f,!g||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let y=Hn(),w;if(e){let C=typeof e=="string"?or(e):e;Ge(p==="/"||C.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${C.pathname}" was given in the \`location\` prop.`),w=C}else w=y;let b=w.pathname||"/",_=b;if(p!=="/"){let C=p.replace(/^\//,"").split("/");_="/"+b.replace(/^\//,"").split("/").slice(C.length).join("/")}let A=Dm(a,{pathname:_});on(g||A!=null,`No routes matched location "${w.pathname}${w.search}${w.hash}" `),on(A==null||A[A.length-1].route.element!==void 0||A[A.length-1].route.Component!==void 0||A[A.length-1].route.lazy!==void 0,`Matched leaf route at location "${w.pathname}${w.search}${w.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let E=T_(A&&A.map(C=>Object.assign({},C,{params:Object.assign({},h,C.params),pathname:ni([p,o.encodeLocation?o.encodeLocation(C.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?p:ni([p,o.encodeLocation?o.encodeLocation(C.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:C.pathnameBase])})),l,t,n,s);return e&&E?I.createElement(bo.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...w},navigationType:"POP"}},E):E}function S_(){let a=I_(),e=d_(a)?`${a.status} ${a.statusText}`:a instanceof Error?a.message:JSON.stringify(a),t=a instanceof Error?a.stack:null,n="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:n},o={padding:"2px 4px",backgroundColor:n},l=null;return console.error("Error handled by React Router default ErrorBoundary:",a),l=I.createElement(I.Fragment,null,I.createElement("p",null," Hey developer "),I.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",I.createElement("code",{style:o},"ErrorBoundary")," or"," ",I.createElement("code",{style:o},"errorElement")," prop on your route.")),I.createElement(I.Fragment,null,I.createElement("h2",null,"Unexpected Application Error!"),I.createElement("h3",{style:{fontStyle:"italic"}},e),t?I.createElement("pre",{style:s},t):null,l)}var A_=I.createElement(S_,null),E_=class extends I.Component{constructor(a){super(a),this.state={location:a.location,revalidation:a.revalidation,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,e){return e.location!==a.location||e.revalidation!=="idle"&&a.revalidation==="idle"?{error:a.error,location:a.location,revalidation:a.revalidation}:{error:a.error!==void 0?a.error:e.error,location:e.location,revalidation:a.revalidation||e.revalidation}}componentDidCatch(a,e){this.props.onError?this.props.onError(a,e):console.error("React Router caught the following error during render",a)}render(){return this.state.error!==void 0?I.createElement(ln.Provider,{value:this.props.routeContext},I.createElement(Rh.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function C_({routeContext:a,match:e,children:t}){let n=I.useContext(ar);return n&&n.static&&n.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=e.route.id),I.createElement(ln.Provider,{value:a},t)}function T_(a,e=[],t=null,n=null,s=null){if(a==null){if(!t)return null;if(t.errors)a=t.matches;else if(e.length===0&&!t.initialized&&t.matches.length>0)a=t.matches;else return null}let o=a,l=t?.errors;if(l!=null){let p=o.findIndex(g=>g.route.id&&l?.[g.route.id]!==void 0);Ge(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(l).join(",")}`),o=o.slice(0,Math.min(o.length,p+1))}let c=!1,h=-1;if(t)for(let p=0;p<o.length;p++){let g=o[p];if((g.route.HydrateFallback||g.route.hydrateFallbackElement)&&(h=p),g.route.id){let{loaderData:y,errors:w}=t,b=g.route.loader&&!y.hasOwnProperty(g.route.id)&&(!w||w[g.route.id]===void 0);if(g.route.lazy||b){c=!0,h>=0?o=o.slice(0,h+1):o=[o[0]];break}}}let f=t&&n?(p,g)=>{n(p,{location:t.location,params:t.matches?.[0]?.params??{},unstable_pattern:f_(t.matches),errorInfo:g})}:void 0;return o.reduceRight((p,g,y)=>{let w,b=!1,_=null,A=null;t&&(w=l&&g.route.id?l[g.route.id]:void 0,_=g.route.errorElement||A_,c&&(h<0&&y===0?(Hm("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,A=null):h===y&&(b=!0,A=g.route.hydrateFallbackElement||null)));let E=e.concat(o.slice(0,y+1)),C=()=>{let T;return w?T=_:b?T=A:g.route.Component?T=I.createElement(g.route.Component,null):g.route.element?T=g.route.element:T=p,I.createElement(C_,{match:g,routeContext:{outlet:p,matches:E,isDataRoute:t!=null},children:T})};return t&&(g.route.ErrorBoundary||g.route.errorElement||y===0)?I.createElement(E_,{location:t.location,revalidation:t.revalidation,component:_,error:w,children:C(),routeContext:{outlet:null,matches:E,isDataRoute:!0},onError:f}):C()},null)}function Lh(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function x_(a){let e=I.useContext(ar);return Ge(e,Lh(a)),e}function k_(a){let e=I.useContext(Pl);return Ge(e,Lh(a)),e}function P_(a){let e=I.useContext(ln);return Ge(e,Lh(a)),e}function Dh(a){let e=P_(a),t=e.matches[e.matches.length-1];return Ge(t.route.id,`${a} can only be used on routes that contain a unique "id"`),t.route.id}function R_(){return Dh("useRouteId")}function I_(){let a=I.useContext(Rh),e=k_("useRouteError"),t=Dh("useRouteError");return a!==void 0?a:e.errors?.[t]}function L_(){let{router:a}=x_("useNavigate"),e=Dh("useNavigate"),t=I.useRef(!1);return Um(()=>{t.current=!0}),I.useCallback(async(s,o={})=>{on(t.current,Bm),t.current&&(typeof s=="number"?await a.navigate(s):await a.navigate(s,{fromRouteId:e,...o}))},[a,e])}var yg={};function Hm(a,e,t){!e&&!yg[a]&&(yg[a]=!0,on(!1,t))}I.memo(D_);function D_({routes:a,future:e,state:t,unstable_onError:n}){return jm(a,void 0,t,n,e)}function zm({to:a,replace:e,state:t,relative:n}){Ge(lr(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=I.useContext(an);on(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:o}=I.useContext(ln),{pathname:l}=Hn(),c=cr(),h=Ph(a,kh(o),l,n==="path"),f=JSON.stringify(h);return I.useEffect(()=>{c(JSON.parse(f),{replace:e,state:t,relative:n})},[c,f,n,e,t]),null}function $m(a){return __(a.context)}function wn(a){Ge(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function M_({basename:a="/",children:e=null,location:t,navigationType:n="POP",navigator:s,static:o=!1,unstable_useTransitions:l}){Ge(!lr(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=a.replace(/^\/*/,"/"),h=I.useMemo(()=>({basename:c,navigator:s,static:o,unstable_useTransitions:l,future:{}}),[c,s,o,l]);typeof t=="string"&&(t=or(t));let{pathname:f="/",search:p="",hash:g="",state:y=null,key:w="default"}=t,b=I.useMemo(()=>{let _=ii(f,c);return _==null?null:{location:{pathname:_,search:p,hash:g,state:y,key:w},navigationType:n}},[c,f,p,g,y,w,n]);return on(b!=null,`<Router basename="${c}"> is not able to match the URL "${f}${p}${g}" because it does not start with the basename, so the <Router> won't render anything.`),b==null?null:I.createElement(an.Provider,{value:h},I.createElement(bo.Provider,{children:e,value:b}))}function N_({children:a,location:e}){return b_(rh(a),e)}function rh(a,e=[]){let t=[];return I.Children.forEach(a,(n,s)=>{if(!I.isValidElement(n))return;let o=[...e,s];if(n.type===I.Fragment){t.push.apply(t,rh(n.props.children,o));return}Ge(n.type===wn,`[${typeof n.type=="string"?n.type:n.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ge(!n.props.index||!n.props.children,"An index route cannot have child routes.");let l={id:n.props.id||o.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,middleware:n.props.middleware,loader:n.props.loader,action:n.props.action,hydrateFallbackElement:n.props.hydrateFallbackElement,HydrateFallback:n.props.HydrateFallback,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.hasErrorBoundary===!0||n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(l.children=rh(n.props.children,o)),t.push(l)}),t}var ll="get",cl="application/x-www-form-urlencoded";function Rl(a){return typeof HTMLElement<"u"&&a instanceof HTMLElement}function O_(a){return Rl(a)&&a.tagName.toLowerCase()==="button"}function F_(a){return Rl(a)&&a.tagName.toLowerCase()==="form"}function B_(a){return Rl(a)&&a.tagName.toLowerCase()==="input"}function U_(a){return!!(a.metaKey||a.altKey||a.ctrlKey||a.shiftKey)}function j_(a,e){return a.button===0&&(!e||e==="_self")&&!U_(a)}var Ya=null;function H_(){if(Ya===null)try{new FormData(document.createElement("form"),0),Ya=!1}catch{Ya=!0}return Ya}var z_=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Hu(a){return a!=null&&!z_.has(a)?(on(!1,`"${a}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${cl}"`),null):a}function $_(a,e){let t,n,s,o,l;if(F_(a)){let c=a.getAttribute("action");n=c?ii(c,e):null,t=a.getAttribute("method")||ll,s=Hu(a.getAttribute("enctype"))||cl,o=new FormData(a)}else if(O_(a)||B_(a)&&(a.type==="submit"||a.type==="image")){let c=a.form;if(c==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=a.getAttribute("formaction")||c.getAttribute("action");if(n=h?ii(h,e):null,t=a.getAttribute("formmethod")||c.getAttribute("method")||ll,s=Hu(a.getAttribute("formenctype"))||Hu(c.getAttribute("enctype"))||cl,o=new FormData(c,a),!H_()){let{name:f,type:p,value:g}=a;if(p==="image"){let y=f?`${f}.`:"";o.append(`${y}x`,"0"),o.append(`${y}y`,"0")}else f&&o.append(f,g)}}else{if(Rl(a))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');t=ll,n=null,s=cl,l=a}return o&&s==="text/plain"&&(l=o,o=void 0),{action:n,method:t.toLowerCase(),encType:s,formData:o,body:l}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Mh(a,e){if(a===!1||a===null||typeof a>"u")throw new Error(e)}function V_(a,e,t){let n=typeof a=="string"?new URL(a,typeof window>"u"?"server://singlefetch/":window.location.origin):a;return n.pathname==="/"?n.pathname=`_root.${t}`:e&&ii(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.${t}`:n.pathname=`${n.pathname.replace(/\/$/,"")}.${t}`,n}async function W_(a,e){if(a.id in e)return e[a.id];try{let t=await import(a.module);return e[a.id]=t,t}catch(t){return console.error(`Error loading route module \`${a.module}\`, reloading page...`),console.error(t),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function G_(a){return a==null?!1:a.href==null?a.rel==="preload"&&typeof a.imageSrcSet=="string"&&typeof a.imageSizes=="string":typeof a.rel=="string"&&typeof a.href=="string"}async function q_(a,e,t){let n=await Promise.all(a.map(async s=>{let o=e.routes[s.route.id];if(o){let l=await W_(o,t);return l.links?l.links():[]}return[]}));return Q_(n.flat(1).filter(G_).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function vg(a,e,t,n,s,o){let l=(h,f)=>t[f]?h.route.id!==t[f].route.id:!0,c=(h,f)=>t[f].pathname!==h.pathname||t[f].route.path?.endsWith("*")&&t[f].params["*"]!==h.params["*"];return o==="assets"?e.filter((h,f)=>l(h,f)||c(h,f)):o==="data"?e.filter((h,f)=>{let p=n.routes[h.route.id];if(!p||!p.hasLoader)return!1;if(l(h,f)||c(h,f))return!0;if(h.route.shouldRevalidate){let g=h.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:t[0]?.params||{},nextUrl:new URL(a,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof g=="boolean")return g}return!0}):[]}function X_(a,e,{includeHydrateFallback:t}={}){return K_(a.map(n=>{let s=e.routes[n.route.id];if(!s)return[];let o=[s.module];return s.clientActionModule&&(o=o.concat(s.clientActionModule)),s.clientLoaderModule&&(o=o.concat(s.clientLoaderModule)),t&&s.hydrateFallbackModule&&(o=o.concat(s.hydrateFallbackModule)),s.imports&&(o=o.concat(s.imports)),o}).flat(1))}function K_(a){return[...new Set(a)]}function Y_(a){let e={},t=Object.keys(a).sort();for(let n of t)e[n]=a[n];return e}function Q_(a,e){let t=new Set;return new Set(e),a.reduce((n,s)=>{let o=JSON.stringify(Y_(s));return t.has(o)||(t.add(o),n.push({key:o,link:s})),n},[])}function Vm(){let a=I.useContext(ar);return Mh(a,"You must render this element inside a <DataRouterContext.Provider> element"),a}function J_(){let a=I.useContext(Pl);return Mh(a,"You must render this element inside a <DataRouterStateContext.Provider> element"),a}var Nh=I.createContext(void 0);Nh.displayName="FrameworkContext";function Wm(){let a=I.useContext(Nh);return Mh(a,"You must render this element inside a <HydratedRouter> element"),a}function Z_(a,e){let t=I.useContext(Nh),[n,s]=I.useState(!1),[o,l]=I.useState(!1),{onFocus:c,onBlur:h,onMouseEnter:f,onMouseLeave:p,onTouchStart:g}=e,y=I.useRef(null);I.useEffect(()=>{if(a==="render"&&l(!0),a==="viewport"){let _=E=>{E.forEach(C=>{l(C.isIntersecting)})},A=new IntersectionObserver(_,{threshold:.5});return y.current&&A.observe(y.current),()=>{A.disconnect()}}},[a]),I.useEffect(()=>{if(n){let _=setTimeout(()=>{l(!0)},100);return()=>{clearTimeout(_)}}},[n]);let w=()=>{s(!0)},b=()=>{s(!1),l(!1)};return t?a!=="intent"?[o,y,{}]:[o,y,{onFocus:Jr(c,w),onBlur:Jr(h,b),onMouseEnter:Jr(f,w),onMouseLeave:Jr(p,b),onTouchStart:Jr(g,w)}]:[!1,y,{}]}function Jr(a,e){return t=>{a&&a(t),t.defaultPrevented||e(t)}}function eb({page:a,...e}){let{router:t}=Vm(),n=I.useMemo(()=>Dm(t.routes,a,t.basename),[t.routes,a,t.basename]);return n?I.createElement(nb,{page:a,matches:n,...e}):null}function tb(a){let{manifest:e,routeModules:t}=Wm(),[n,s]=I.useState([]);return I.useEffect(()=>{let o=!1;return q_(a,e,t).then(l=>{o||s(l)}),()=>{o=!0}},[a,e,t]),n}function nb({page:a,matches:e,...t}){let n=Hn(),{manifest:s,routeModules:o}=Wm(),{basename:l}=Vm(),{loaderData:c,matches:h}=J_(),f=I.useMemo(()=>vg(a,e,h,s,n,"data"),[a,e,h,s,n]),p=I.useMemo(()=>vg(a,e,h,s,n,"assets"),[a,e,h,s,n]),g=I.useMemo(()=>{if(a===n.pathname+n.search+n.hash)return[];let b=new Set,_=!1;if(e.forEach(E=>{let C=s.routes[E.route.id];!C||!C.hasLoader||(!f.some(T=>T.route.id===E.route.id)&&E.route.id in c&&o[E.route.id]?.shouldRevalidate||C.hasClientLoader?_=!0:b.add(E.route.id))}),b.size===0)return[];let A=V_(a,l,"data");return _&&b.size>0&&A.searchParams.set("_routes",e.filter(E=>b.has(E.route.id)).map(E=>E.route.id).join(",")),[A.pathname+A.search]},[l,c,n,s,f,e,a,o]),y=I.useMemo(()=>X_(p,s),[p,s]),w=tb(p);return I.createElement(I.Fragment,null,g.map(b=>I.createElement("link",{key:b,rel:"prefetch",as:"fetch",href:b,...t})),y.map(b=>I.createElement("link",{key:b,rel:"modulepreload",href:b,...t})),w.map(({key:b,link:_})=>I.createElement("link",{key:b,nonce:t.nonce,..._})))}function ib(...a){return e=>{a.forEach(t=>{typeof t=="function"?t(e):t!=null&&(t.current=e)})}}var Gm=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Gm&&(window.__reactRouterVersion="7.10.1")}catch{}function sb({basename:a,children:e,unstable_useTransitions:t,window:n}){let s=I.useRef();s.current==null&&(s.current=z0({window:n,v5Compat:!0}));let o=s.current,[l,c]=I.useState({action:o.action,location:o.location}),h=I.useCallback(f=>{t===!1?c(f):I.startTransition(()=>c(f))},[t]);return I.useLayoutEffect(()=>o.listen(h),[o,h]),I.createElement(M_,{basename:a,children:e,location:l.location,navigationType:l.action,navigator:o,unstable_useTransitions:t===!0})}var qm=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Oh=I.forwardRef(function({onClick:e,discover:t="render",prefetch:n="none",relative:s,reloadDocument:o,replace:l,state:c,target:h,to:f,preventScrollReset:p,viewTransition:g,...y},w){let{basename:b,unstable_useTransitions:_}=I.useContext(an),A=typeof f=="string"&&qm.test(f),E,C=!1;if(typeof f=="string"&&A&&(E=f,Gm))try{let V=new URL(window.location.href),q=f.startsWith("//")?new URL(V.protocol+f):new URL(f),ue=ii(q.pathname,b);q.origin===V.origin&&ue!=null?f=ue+q.search+q.hash:C=!0}catch{on(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let T=y_(f,{relative:s}),[R,L,k]=Z_(n,y),N=lb(f,{replace:l,state:c,target:h,preventScrollReset:p,relative:s,viewTransition:g,unstable_useTransitions:_});function U(V){e&&e(V),V.defaultPrevented||N(V)}let z=I.createElement("a",{...y,...k,href:E||T,onClick:C||o?e:U,ref:ib(w,L),target:h,"data-discover":!A&&t==="render"?"true":void 0});return R&&!A?I.createElement(I.Fragment,null,z,I.createElement(eb,{page:T})):z});Oh.displayName="Link";var rb=I.forwardRef(function({"aria-current":e="page",caseSensitive:t=!1,className:n="",end:s=!1,style:o,to:l,viewTransition:c,children:h,...f},p){let g=So(l,{relative:f.relative}),y=Hn(),w=I.useContext(Pl),{navigator:b,basename:_}=I.useContext(an),A=w!=null&&fb(g)&&c===!0,E=b.encodeLocation?b.encodeLocation(g).pathname:g.pathname,C=y.pathname,T=w&&w.navigation&&w.navigation.location?w.navigation.location.pathname:null;t||(C=C.toLowerCase(),T=T?T.toLowerCase():null,E=E.toLowerCase()),T&&_&&(T=ii(T,_)||T);const R=E!=="/"&&E.endsWith("/")?E.length-1:E.length;let L=C===E||!s&&C.startsWith(E)&&C.charAt(R)==="/",k=T!=null&&(T===E||!s&&T.startsWith(E)&&T.charAt(E.length)==="/"),N={isActive:L,isPending:k,isTransitioning:A},U=L?e:void 0,z;typeof n=="function"?z=n(N):z=[n,L?"active":null,k?"pending":null,A?"transitioning":null].filter(Boolean).join(" ");let V=typeof o=="function"?o(N):o;return I.createElement(Oh,{...f,"aria-current":U,className:z,ref:p,style:V,to:l,viewTransition:c},typeof h=="function"?h(N):h)});rb.displayName="NavLink";var ob=I.forwardRef(({discover:a="render",fetcherKey:e,navigate:t,reloadDocument:n,replace:s,state:o,method:l=ll,action:c,onSubmit:h,relative:f,preventScrollReset:p,viewTransition:g,...y},w)=>{let{unstable_useTransitions:b}=I.useContext(an),_=hb(),A=db(c,{relative:f}),E=l.toLowerCase()==="get"?"get":"post",C=typeof c=="string"&&qm.test(c),T=R=>{if(h&&h(R),R.defaultPrevented)return;R.preventDefault();let L=R.nativeEvent.submitter,k=L?.getAttribute("formmethod")||l,N=()=>_(L||R.currentTarget,{fetcherKey:e,method:k,navigate:t,replace:s,state:o,relative:f,preventScrollReset:p,viewTransition:g});b&&t!==!1?I.startTransition(()=>N()):N()};return I.createElement("form",{ref:w,method:E,action:A,onSubmit:n?h:T,...y,"data-discover":!C&&a==="render"?"true":void 0})});ob.displayName="Form";function ab(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Xm(a){let e=I.useContext(ar);return Ge(e,ab(a)),e}function lb(a,{target:e,replace:t,state:n,preventScrollReset:s,relative:o,viewTransition:l,unstable_useTransitions:c}={}){let h=cr(),f=Hn(),p=So(a,{relative:o});return I.useCallback(g=>{if(j_(g,e)){g.preventDefault();let y=t!==void 0?t:uo(f)===uo(p),w=()=>h(a,{replace:y,state:n,preventScrollReset:s,relative:o,viewTransition:l});c?I.startTransition(()=>w()):w()}},[f,h,p,t,n,e,a,s,o,l,c])}var cb=0,ub=()=>`__${String(++cb)}__`;function hb(){let{router:a}=Xm("useSubmit"),{basename:e}=I.useContext(an),t=R_(),n=a.fetch,s=a.navigate;return I.useCallback(async(o,l={})=>{let{action:c,method:h,encType:f,formData:p,body:g}=$_(o,e);if(l.navigate===!1){let y=l.fetcherKey||ub();await n(y,t,l.action||c,{preventScrollReset:l.preventScrollReset,formData:p,body:g,formMethod:l.method||h,formEncType:l.encType||f,flushSync:l.flushSync})}else await s(l.action||c,{preventScrollReset:l.preventScrollReset,formData:p,body:g,formMethod:l.method||h,formEncType:l.encType||f,replace:l.replace,state:l.state,fromRouteId:t,flushSync:l.flushSync,viewTransition:l.viewTransition})},[n,s,e,t])}function db(a,{relative:e}={}){let{basename:t}=I.useContext(an),n=I.useContext(ln);Ge(n,"useFormAction must be used inside a RouteContext");let[s]=n.matches.slice(-1),o={...So(a||".",{relative:e})},l=Hn();if(a==null){o.search=l.search;let c=new URLSearchParams(o.search),h=c.getAll("index");if(h.some(p=>p==="")){c.delete("index"),h.filter(g=>g).forEach(g=>c.append("index",g));let p=c.toString();o.search=p?`?${p}`:""}}return(!a||a===".")&&s.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),t!=="/"&&(o.pathname=o.pathname==="/"?t:ni([t,o.pathname])),uo(o)}function fb(a,{relative:e}={}){let t=I.useContext(Fm);Ge(t!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:n}=Xm("useViewTransitionState"),s=So(a,{relative:e});if(!t.isTransitioning)return!1;let o=ii(t.currentLocation.pathname,n)||t.currentLocation.pathname,l=ii(t.nextLocation.pathname,n)||t.nextLocation.pathname;return ml(s.pathname,l)!=null||ml(s.pathname,o)!=null}const pb=()=>{};var wg={};const Km=function(a){const e=[];let t=0;for(let n=0;n<a.length;n++){let s=a.charCodeAt(n);s<128?e[t++]=s:s<2048?(e[t++]=s>>6|192,e[t++]=s&63|128):(s&64512)===55296&&n+1<a.length&&(a.charCodeAt(n+1)&64512)===56320?(s=65536+((s&1023)<<10)+(a.charCodeAt(++n)&1023),e[t++]=s>>18|240,e[t++]=s>>12&63|128,e[t++]=s>>6&63|128,e[t++]=s&63|128):(e[t++]=s>>12|224,e[t++]=s>>6&63|128,e[t++]=s&63|128)}return e},gb=function(a){const e=[];let t=0,n=0;for(;t<a.length;){const s=a[t++];if(s<128)e[n++]=String.fromCharCode(s);else if(s>191&&s<224){const o=a[t++];e[n++]=String.fromCharCode((s&31)<<6|o&63)}else if(s>239&&s<365){const o=a[t++],l=a[t++],c=a[t++],h=((s&7)<<18|(o&63)<<12|(l&63)<<6|c&63)-65536;e[n++]=String.fromCharCode(55296+(h>>10)),e[n++]=String.fromCharCode(56320+(h&1023))}else{const o=a[t++],l=a[t++];e[n++]=String.fromCharCode((s&15)<<12|(o&63)<<6|l&63)}}return e.join("")},Ym={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(a,e){if(!Array.isArray(a))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let s=0;s<a.length;s+=3){const o=a[s],l=s+1<a.length,c=l?a[s+1]:0,h=s+2<a.length,f=h?a[s+2]:0,p=o>>2,g=(o&3)<<4|c>>4;let y=(c&15)<<2|f>>6,w=f&63;h||(w=64,l||(y=64)),n.push(t[p],t[g],t[y],t[w])}return n.join("")},encodeString(a,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(a):this.encodeByteArray(Km(a),e)},decodeString(a,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(a):gb(this.decodeStringToByteArray(a,e))},decodeStringToByteArray(a,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let s=0;s<a.length;){const o=t[a.charAt(s++)],c=s<a.length?t[a.charAt(s)]:0;++s;const f=s<a.length?t[a.charAt(s)]:64;++s;const g=s<a.length?t[a.charAt(s)]:64;if(++s,o==null||c==null||f==null||g==null)throw new mb;const y=o<<2|c>>4;if(n.push(y),f!==64){const w=c<<4&240|f>>2;if(n.push(w),g!==64){const b=f<<6&192|g;n.push(b)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let a=0;a<this.ENCODED_VALS.length;a++)this.byteToCharMap_[a]=this.ENCODED_VALS.charAt(a),this.charToByteMap_[this.byteToCharMap_[a]]=a,this.byteToCharMapWebSafe_[a]=this.ENCODED_VALS_WEBSAFE.charAt(a),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[a]]=a,a>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(a)]=a,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(a)]=a)}}};class mb extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const yb=function(a){const e=Km(a);return Ym.encodeByteArray(e,!0)},Qm=function(a){return yb(a).replace(/\./g,"")},Jm=function(a){try{return Ym.decodeString(a,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function vb(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const wb=()=>vb().__FIREBASE_DEFAULTS__,_b=()=>{if(typeof process>"u"||typeof wg>"u")return;const a=wg.__FIREBASE_DEFAULTS__;if(a)return JSON.parse(a)},bb=()=>{if(typeof document>"u")return;let a;try{a=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=a&&Jm(a[1]);return e&&JSON.parse(e)},Fh=()=>{try{return pb()||wb()||_b()||bb()}catch(a){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${a}`);return}},Sb=a=>Fh()?.emulatorHosts?.[a],Zm=()=>Fh()?.config,ey=a=>Fh()?.[`_${a}`];class Ab{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}function Il(a){try{return(a.startsWith("http://")||a.startsWith("https://")?new URL(a).hostname:a).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Eb(a){return(await fetch(a,{credentials:"include"})).ok}const oo={};function Cb(){const a={prod:[],emulator:[]};for(const e of Object.keys(oo))oo[e]?a.emulator.push(e):a.prod.push(e);return a}function Tb(a){let e=document.getElementById(a),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",a),t=!0),{created:t,element:e}}let _g=!1;function xb(a,e){if(typeof window>"u"||typeof document>"u"||!Il(window.location.host)||oo[a]===e||oo[a]||_g)return;oo[a]=e;function t(y){return`__firebase__banner__${y}`}const n="__firebase__banner",o=Cb().prod.length>0;function l(){const y=document.getElementById(n);y&&y.remove()}function c(y){y.style.display="flex",y.style.background="#7faaf0",y.style.position="fixed",y.style.bottom="5px",y.style.left="5px",y.style.padding=".5em",y.style.borderRadius="5px",y.style.alignItems="center"}function h(y,w){y.setAttribute("width","24"),y.setAttribute("id",w),y.setAttribute("height","24"),y.setAttribute("viewBox","0 0 24 24"),y.setAttribute("fill","none"),y.style.marginLeft="-6px"}function f(){const y=document.createElement("span");return y.style.cursor="pointer",y.style.marginLeft="16px",y.style.fontSize="24px",y.innerHTML=" &times;",y.onclick=()=>{_g=!0,l()},y}function p(y,w){y.setAttribute("id",w),y.innerText="Learn more",y.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",y.setAttribute("target","__blank"),y.style.paddingLeft="5px",y.style.textDecoration="underline"}function g(){const y=Tb(n),w=t("text"),b=document.getElementById(w)||document.createElement("span"),_=t("learnmore"),A=document.getElementById(_)||document.createElement("a"),E=t("preprendIcon"),C=document.getElementById(E)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(y.created){const T=y.element;c(T),p(A,_);const R=f();h(C,E),T.append(C,b,A,R),document.body.appendChild(T)}o?(b.innerText="Preview backend disconnected.",C.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(C.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,b.innerText="Preview backend running in this workspace."),b.setAttribute("id",w)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",g):g()}function Pt(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function kb(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Pt())}function Pb(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Rb(){const a=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof a=="object"&&a.id!==void 0}function Ib(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Lb(){const a=Pt();return a.indexOf("MSIE ")>=0||a.indexOf("Trident/")>=0}function Db(){try{return typeof indexedDB=="object"}catch{return!1}}function Mb(){return new Promise((a,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(n);s.onsuccess=()=>{s.result.close(),t||self.indexedDB.deleteDatabase(n),a(!0)},s.onupgradeneeded=()=>{t=!1},s.onerror=()=>{e(s.error?.message||"")}}catch(t){e(t)}})}const Nb="FirebaseError";class Fi extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=Nb,Object.setPrototypeOf(this,Fi.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Ao.prototype.create)}}class Ao{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},s=`${this.service}/${e}`,o=this.errors[e],l=o?Ob(o,n):"Error",c=`${this.serviceName}: ${l} (${s}).`;return new Fi(s,c,n)}}function Ob(a,e){return a.replace(Fb,(t,n)=>{const s=e[n];return s!=null?String(s):`<${n}?>`})}const Fb=/\{\$([^}]+)}/g;function Bb(a){for(const e in a)if(Object.prototype.hasOwnProperty.call(a,e))return!1;return!0}function er(a,e){if(a===e)return!0;const t=Object.keys(a),n=Object.keys(e);for(const s of t){if(!n.includes(s))return!1;const o=a[s],l=e[s];if(bg(o)&&bg(l)){if(!er(o,l))return!1}else if(o!==l)return!1}for(const s of n)if(!t.includes(s))return!1;return!0}function bg(a){return a!==null&&typeof a=="object"}function Eo(a){const e=[];for(const[t,n]of Object.entries(a))Array.isArray(n)?n.forEach(s=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function Ub(a,e){const t=new jb(a,e);return t.subscribe.bind(t)}class jb{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let s;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");Hb(e,["next","error","complete"])?s=e:s={next:e,error:t,complete:n},s.next===void 0&&(s.next=zu),s.error===void 0&&(s.error=zu),s.complete===void 0&&(s.complete=zu);const o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),o}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Hb(a,e){if(typeof a!="object"||a===null)return!1;for(const t of e)if(t in a&&typeof a[t]=="function")return!0;return!1}function zu(){}function Bi(a){return a&&a._delegate?a._delegate:a}class tr{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const ts="[DEFAULT]";class zb{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new Ab;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:t});s&&n.resolve(s)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(s){if(n)return null;throw s}else{if(n)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(Vb(e))try{this.getOrInitializeService({instanceIdentifier:ts})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(t);try{const o=this.getOrInitializeService({instanceIdentifier:s});n.resolve(o)}catch{}}}}clearInstance(e=ts){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ts){return this.instances.has(e)}getOptions(e=ts){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[o,l]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(o);n===c&&l.resolve(s)}return s}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),s=this.onInitCallbacks.get(n)??new Set;s.add(e),this.onInitCallbacks.set(n,s);const o=this.instances.get(n);return o&&e(o,n),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const s of n)try{s(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:$b(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=ts){return this.component?this.component.multipleInstances?e:ts:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function $b(a){return a===ts?void 0:a}function Vb(a){return a.instantiationMode==="EAGER"}class Wb{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new zb(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var Be;(function(a){a[a.DEBUG=0]="DEBUG",a[a.VERBOSE=1]="VERBOSE",a[a.INFO=2]="INFO",a[a.WARN=3]="WARN",a[a.ERROR=4]="ERROR",a[a.SILENT=5]="SILENT"})(Be||(Be={}));const Gb={debug:Be.DEBUG,verbose:Be.VERBOSE,info:Be.INFO,warn:Be.WARN,error:Be.ERROR,silent:Be.SILENT},qb=Be.INFO,Xb={[Be.DEBUG]:"log",[Be.VERBOSE]:"log",[Be.INFO]:"info",[Be.WARN]:"warn",[Be.ERROR]:"error"},Kb=(a,e,...t)=>{if(e<a.logLevel)return;const n=new Date().toISOString(),s=Xb[e];if(s)console[s](`[${n}]  ${a.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ty{constructor(e){this.name=e,this._logLevel=qb,this._logHandler=Kb,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Be))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Gb[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Be.DEBUG,...e),this._logHandler(this,Be.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Be.VERBOSE,...e),this._logHandler(this,Be.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Be.INFO,...e),this._logHandler(this,Be.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Be.WARN,...e),this._logHandler(this,Be.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Be.ERROR,...e),this._logHandler(this,Be.ERROR,...e)}}const Yb=(a,e)=>e.some(t=>a instanceof t);let Sg,Ag;function Qb(){return Sg||(Sg=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Jb(){return Ag||(Ag=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ny=new WeakMap,oh=new WeakMap,iy=new WeakMap,$u=new WeakMap,Bh=new WeakMap;function Zb(a){const e=new Promise((t,n)=>{const s=()=>{a.removeEventListener("success",o),a.removeEventListener("error",l)},o=()=>{t(Di(a.result)),s()},l=()=>{n(a.error),s()};a.addEventListener("success",o),a.addEventListener("error",l)});return e.then(t=>{t instanceof IDBCursor&&ny.set(t,a)}).catch(()=>{}),Bh.set(e,a),e}function eS(a){if(oh.has(a))return;const e=new Promise((t,n)=>{const s=()=>{a.removeEventListener("complete",o),a.removeEventListener("error",l),a.removeEventListener("abort",l)},o=()=>{t(),s()},l=()=>{n(a.error||new DOMException("AbortError","AbortError")),s()};a.addEventListener("complete",o),a.addEventListener("error",l),a.addEventListener("abort",l)});oh.set(a,e)}let ah={get(a,e,t){if(a instanceof IDBTransaction){if(e==="done")return oh.get(a);if(e==="objectStoreNames")return a.objectStoreNames||iy.get(a);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Di(a[e])},set(a,e,t){return a[e]=t,!0},has(a,e){return a instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in a}};function tS(a){ah=a(ah)}function nS(a){return a===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=a.call(Vu(this),e,...t);return iy.set(n,e.sort?e.sort():[e]),Di(n)}:Jb().includes(a)?function(...e){return a.apply(Vu(this),e),Di(ny.get(this))}:function(...e){return Di(a.apply(Vu(this),e))}}function iS(a){return typeof a=="function"?nS(a):(a instanceof IDBTransaction&&eS(a),Yb(a,Qb())?new Proxy(a,ah):a)}function Di(a){if(a instanceof IDBRequest)return Zb(a);if($u.has(a))return $u.get(a);const e=iS(a);return e!==a&&($u.set(a,e),Bh.set(e,a)),e}const Vu=a=>Bh.get(a);function sS(a,e,{blocked:t,upgrade:n,blocking:s,terminated:o}={}){const l=indexedDB.open(a,e),c=Di(l);return n&&l.addEventListener("upgradeneeded",h=>{n(Di(l.result),h.oldVersion,h.newVersion,Di(l.transaction),h)}),t&&l.addEventListener("blocked",h=>t(h.oldVersion,h.newVersion,h)),c.then(h=>{o&&h.addEventListener("close",()=>o()),s&&h.addEventListener("versionchange",f=>s(f.oldVersion,f.newVersion,f))}).catch(()=>{}),c}const rS=["get","getKey","getAll","getAllKeys","count"],oS=["put","add","delete","clear"],Wu=new Map;function Eg(a,e){if(!(a instanceof IDBDatabase&&!(e in a)&&typeof e=="string"))return;if(Wu.get(e))return Wu.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,s=oS.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(s||rS.includes(t)))return;const o=async function(l,...c){const h=this.transaction(l,s?"readwrite":"readonly");let f=h.store;return n&&(f=f.index(c.shift())),(await Promise.all([f[t](...c),s&&h.done]))[0]};return Wu.set(e,o),o}tS(a=>({...a,get:(e,t,n)=>Eg(e,t)||a.get(e,t,n),has:(e,t)=>!!Eg(e,t)||a.has(e,t)}));class aS{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(lS(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function lS(a){return a.getComponent()?.type==="VERSION"}const lh="@firebase/app",Cg="0.14.6";const si=new ty("@firebase/app"),cS="@firebase/app-compat",uS="@firebase/analytics-compat",hS="@firebase/analytics",dS="@firebase/app-check-compat",fS="@firebase/app-check",pS="@firebase/auth",gS="@firebase/auth-compat",mS="@firebase/database",yS="@firebase/data-connect",vS="@firebase/database-compat",wS="@firebase/functions",_S="@firebase/functions-compat",bS="@firebase/installations",SS="@firebase/installations-compat",AS="@firebase/messaging",ES="@firebase/messaging-compat",CS="@firebase/performance",TS="@firebase/performance-compat",xS="@firebase/remote-config",kS="@firebase/remote-config-compat",PS="@firebase/storage",RS="@firebase/storage-compat",IS="@firebase/firestore",LS="@firebase/ai",DS="@firebase/firestore-compat",MS="firebase",NS="12.6.0";const ch="[DEFAULT]",OS={[lh]:"fire-core",[cS]:"fire-core-compat",[hS]:"fire-analytics",[uS]:"fire-analytics-compat",[fS]:"fire-app-check",[dS]:"fire-app-check-compat",[pS]:"fire-auth",[gS]:"fire-auth-compat",[mS]:"fire-rtdb",[yS]:"fire-data-connect",[vS]:"fire-rtdb-compat",[wS]:"fire-fn",[_S]:"fire-fn-compat",[bS]:"fire-iid",[SS]:"fire-iid-compat",[AS]:"fire-fcm",[ES]:"fire-fcm-compat",[CS]:"fire-perf",[TS]:"fire-perf-compat",[xS]:"fire-rc",[kS]:"fire-rc-compat",[PS]:"fire-gcs",[RS]:"fire-gcs-compat",[IS]:"fire-fst",[DS]:"fire-fst-compat",[LS]:"fire-vertex","fire-js":"fire-js",[MS]:"fire-js-all"};const yl=new Map,FS=new Map,uh=new Map;function Tg(a,e){try{a.container.addComponent(e)}catch(t){si.debug(`Component ${e.name} failed to register with FirebaseApp ${a.name}`,t)}}function ho(a){const e=a.name;if(uh.has(e))return si.debug(`There were multiple attempts to register component ${e}.`),!1;uh.set(e,a);for(const t of yl.values())Tg(t,a);for(const t of FS.values())Tg(t,a);return!0}function sy(a,e){const t=a.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),a.container.getProvider(e)}function Fn(a){return a==null?!1:a.settings!==void 0}const BS={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Mi=new Ao("app","Firebase",BS);class US{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new tr("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Mi.create("app-deleted",{appName:this._name})}}const Co=NS;function ry(a,e={}){let t=a;typeof e!="object"&&(e={name:e});const n={name:ch,automaticDataCollectionEnabled:!0,...e},s=n.name;if(typeof s!="string"||!s)throw Mi.create("bad-app-name",{appName:String(s)});if(t||(t=Zm()),!t)throw Mi.create("no-options");const o=yl.get(s);if(o){if(er(t,o.options)&&er(n,o.config))return o;throw Mi.create("duplicate-app",{appName:s})}const l=new Wb(s);for(const h of uh.values())l.addComponent(h);const c=new US(t,n,l);return yl.set(s,c),c}function jS(a=ch){const e=yl.get(a);if(!e&&a===ch&&Zm())return ry();if(!e)throw Mi.create("no-app",{appName:a});return e}function Vs(a,e,t){let n=OS[a]??a;t&&(n+=`-${t}`);const s=n.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${n}" with version "${e}":`];s&&l.push(`library name "${n}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),si.warn(l.join(" "));return}ho(new tr(`${n}-version`,()=>({library:n,version:e}),"VERSION"))}const HS="firebase-heartbeat-database",zS=1,fo="firebase-heartbeat-store";let Gu=null;function oy(){return Gu||(Gu=sS(HS,zS,{upgrade:(a,e)=>{switch(e){case 0:try{a.createObjectStore(fo)}catch(t){console.warn(t)}}}}).catch(a=>{throw Mi.create("idb-open",{originalErrorMessage:a.message})})),Gu}async function $S(a){try{const t=(await oy()).transaction(fo),n=await t.objectStore(fo).get(ay(a));return await t.done,n}catch(e){if(e instanceof Fi)si.warn(e.message);else{const t=Mi.create("idb-get",{originalErrorMessage:e?.message});si.warn(t.message)}}}async function xg(a,e){try{const n=(await oy()).transaction(fo,"readwrite");await n.objectStore(fo).put(e,ay(a)),await n.done}catch(t){if(t instanceof Fi)si.warn(t.message);else{const n=Mi.create("idb-set",{originalErrorMessage:t?.message});si.warn(n.message)}}}function ay(a){return`${a.name}!${a.options.appId}`}const VS=1024,WS=30;class GS{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new XS(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){try{const t=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),n=kg();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(s=>s.date===n))return;if(this._heartbeatsCache.heartbeats.push({date:n,agent:t}),this._heartbeatsCache.heartbeats.length>WS){const s=KS(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(s,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){si.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=kg(),{heartbeatsToSend:t,unsentEntries:n}=qS(this._heartbeatsCache.heartbeats),s=Qm(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(e){return si.warn(e),""}}}function kg(){return new Date().toISOString().substring(0,10)}function qS(a,e=VS){const t=[];let n=a.slice();for(const s of a){const o=t.find(l=>l.agent===s.agent);if(o){if(o.dates.push(s.date),Pg(t)>e){o.dates.pop();break}}else if(t.push({agent:s.agent,dates:[s.date]}),Pg(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class XS{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return Db()?Mb().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await $S(this.app);return t?.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return xg(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const n=await this.read();return xg(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}else return}}function Pg(a){return Qm(JSON.stringify({version:2,heartbeats:a})).length}function KS(a){if(a.length===0)return-1;let e=0,t=a[0].date;for(let n=1;n<a.length;n++)a[n].date<t&&(t=a[n].date,e=n);return e}function YS(a){ho(new tr("platform-logger",e=>new aS(e),"PRIVATE")),ho(new tr("heartbeat",e=>new GS(e),"PRIVATE")),Vs(lh,Cg,a),Vs(lh,Cg,"esm2020"),Vs("fire-js","")}YS("");var QS="firebase",JS="12.6.0";Vs(QS,JS,"app");function ly(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const ZS=ly,cy=new Ao("auth","Firebase",ly());const vl=new ty("@firebase/auth");function eA(a,...e){vl.logLevel<=Be.WARN&&vl.warn(`Auth (${Co}): ${a}`,...e)}function ul(a,...e){vl.logLevel<=Be.ERROR&&vl.error(`Auth (${Co}): ${a}`,...e)}function jn(a,...e){throw jh(a,...e)}function Sn(a,...e){return jh(a,...e)}function Uh(a,e,t){const n={...ZS(),[e]:t};return new Ao("auth","Firebase",n).create(e,{appName:a.name})}function ls(a){return Uh(a,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function tA(a,e,t){const n=t;if(!(e instanceof n))throw n.name!==e.constructor.name&&jn(a,"argument-error"),Uh(a,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function jh(a,...e){if(typeof a!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=a.name),a._errorFactory.create(t,...n)}return cy.create(a,...e)}function be(a,e,...t){if(!a)throw jh(e,...t)}function ei(a){const e="INTERNAL ASSERTION FAILED: "+a;throw ul(e),new Error(e)}function ri(a,e){a||ei(e)}function hh(){return typeof self<"u"&&self.location?.href||""}function nA(){return Rg()==="http:"||Rg()==="https:"}function Rg(){return typeof self<"u"&&self.location?.protocol||null}function iA(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(nA()||Rb()||"connection"in navigator)?navigator.onLine:!0}function sA(){if(typeof navigator>"u")return null;const a=navigator;return a.languages&&a.languages[0]||a.language||null}class To{constructor(e,t){this.shortDelay=e,this.longDelay=t,ri(t>e,"Short delay should be less than long delay!"),this.isMobile=kb()||Ib()}get(){return iA()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function Hh(a,e){ri(a.emulator,"Emulator should always be set here");const{url:t}=a.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}class uy{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ei("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ei("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ei("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const rA={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const oA=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],aA=new To(3e4,6e4);function zh(a,e){return a.tenantId&&!e.tenantId?{...e,tenantId:a.tenantId}:e}async function ur(a,e,t,n,s={}){return hy(a,s,async()=>{let o={},l={};n&&(e==="GET"?l=n:o={body:JSON.stringify(n)});const c=Eo({key:a.config.apiKey,...l}).slice(1),h=await a._getAdditionalHeaders();h["Content-Type"]="application/json",a.languageCode&&(h["X-Firebase-Locale"]=a.languageCode);const f={method:e,headers:h,...o};return Pb()||(f.referrerPolicy="no-referrer"),a.emulatorConfig&&Il(a.emulatorConfig.host)&&(f.credentials="include"),uy.fetch()(await dy(a,a.config.apiHost,t,c),f)})}async function hy(a,e,t){a._canInitEmulator=!1;const n={...rA,...e};try{const s=new cA(a),o=await Promise.race([t(),s.promise]);s.clearNetworkTimeout();const l=await o.json();if("needConfirmation"in l)throw Qa(a,"account-exists-with-different-credential",l);if(o.ok&&!("errorMessage"in l))return l;{const c=o.ok?l.errorMessage:l.error.message,[h,f]=c.split(" : ");if(h==="FEDERATED_USER_ID_ALREADY_LINKED")throw Qa(a,"credential-already-in-use",l);if(h==="EMAIL_EXISTS")throw Qa(a,"email-already-in-use",l);if(h==="USER_DISABLED")throw Qa(a,"user-disabled",l);const p=n[h]||h.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw Uh(a,p,f);jn(a,p)}}catch(s){if(s instanceof Fi)throw s;jn(a,"network-request-failed",{message:String(s)})}}async function lA(a,e,t,n,s={}){const o=await ur(a,e,t,n,s);return"mfaPendingCredential"in o&&jn(a,"multi-factor-auth-required",{_serverResponse:o}),o}async function dy(a,e,t,n){const s=`${e}${t}?${n}`,o=a,l=o.config.emulator?Hh(a.config,s):`${a.config.apiScheme}://${s}`;return oA.includes(t)&&(await o._persistenceManagerAvailable,o._getPersistenceType()==="COOKIE")?o._getPersistence()._getFinalTarget(l).toString():l}class cA{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(Sn(this.auth,"network-request-failed")),aA.get())})}}function Qa(a,e,t){const n={appName:a.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const s=Sn(a,e,n);return s.customData._tokenResponse=t,s}async function uA(a,e){return ur(a,"POST","/v1/accounts:delete",e)}async function wl(a,e){return ur(a,"POST","/v1/accounts:lookup",e)}function ao(a){if(a)try{const e=new Date(Number(a));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function hA(a,e=!1){const t=Bi(a),n=await t.getIdToken(e),s=$h(n);be(s&&s.exp&&s.auth_time&&s.iat,t.auth,"internal-error");const o=typeof s.firebase=="object"?s.firebase:void 0,l=o?.sign_in_provider;return{claims:s,token:n,authTime:ao(qu(s.auth_time)),issuedAtTime:ao(qu(s.iat)),expirationTime:ao(qu(s.exp)),signInProvider:l||null,signInSecondFactor:o?.sign_in_second_factor||null}}function qu(a){return Number(a)*1e3}function $h(a){const[e,t,n]=a.split(".");if(e===void 0||t===void 0||n===void 0)return ul("JWT malformed, contained fewer than 3 sections"),null;try{const s=Jm(t);return s?JSON.parse(s):(ul("Failed to decode base64 JWT payload"),null)}catch(s){return ul("Caught error parsing JWT payload as JSON",s?.toString()),null}}function Ig(a){const e=$h(a);return be(e,"internal-error"),be(typeof e.exp<"u","internal-error"),be(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function po(a,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof Fi&&dA(n)&&a.auth.currentUser===a&&await a.auth.signOut(),n}}function dA({code:a}){return a==="auth/user-disabled"||a==="auth/user-token-expired"}class fA{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const t=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),t}else{this.errorBackoff=3e4;const n=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class dh{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=ao(this.lastLoginAt),this.creationTime=ao(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function _l(a){const e=a.auth,t=await a.getIdToken(),n=await po(a,wl(e,{idToken:t}));be(n?.users.length,e,"internal-error");const s=n.users[0];a._notifyReloadListener(s);const o=s.providerUserInfo?.length?fy(s.providerUserInfo):[],l=gA(a.providerData,o),c=a.isAnonymous,h=!(a.email&&s.passwordHash)&&!l?.length,f=c?h:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new dh(s.createdAt,s.lastLoginAt),isAnonymous:f};Object.assign(a,p)}async function pA(a){const e=Bi(a);await _l(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function gA(a,e){return[...a.filter(n=>!e.some(s=>s.providerId===n.providerId)),...e]}function fy(a){return a.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}async function mA(a,e){const t=await hy(a,{},async()=>{const n=Eo({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:o}=a.config,l=await dy(a,s,"/v1/token",`key=${o}`),c=await a._getAdditionalHeaders();c["Content-Type"]="application/x-www-form-urlencoded";const h={method:"POST",headers:c,body:n};return a.emulatorConfig&&Il(a.emulatorConfig.host)&&(h.credentials="include"),uy.fetch()(l,h)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function yA(a,e){return ur(a,"POST","/v2/accounts:revokeToken",zh(a,e))}class Ws{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){be(e.idToken,"internal-error"),be(typeof e.idToken<"u","internal-error"),be(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Ig(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){be(e.length!==0,"internal-error");const t=Ig(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(be(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:s,expiresIn:o}=await mA(e,t);this.updateTokensAndExpiration(n,s,Number(o))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:s,expirationTime:o}=t,l=new Ws;return n&&(be(typeof n=="string","internal-error",{appName:e}),l.refreshToken=n),s&&(be(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),o&&(be(typeof o=="number","internal-error",{appName:e}),l.expirationTime=o),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ws,this.toJSON())}_performRefresh(){return ei("not implemented")}}function ki(a,e){be(typeof a=="string"||typeof a>"u","internal-error",{appName:e})}class bn{constructor({uid:e,auth:t,stsTokenManager:n,...s}){this.providerId="firebase",this.proactiveRefresh=new fA(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new dh(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await po(this,this.stsTokenManager.getToken(this.auth,e));return be(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return hA(this,e)}reload(){return pA(this)}_assign(e){this!==e&&(be(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>({...t})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new bn({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){be(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await _l(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Fn(this.auth.app))return Promise.reject(ls(this.auth));const e=await this.getIdToken();return await po(this,uA(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,s=t.email??void 0,o=t.phoneNumber??void 0,l=t.photoURL??void 0,c=t.tenantId??void 0,h=t._redirectEventId??void 0,f=t.createdAt??void 0,p=t.lastLoginAt??void 0,{uid:g,emailVerified:y,isAnonymous:w,providerData:b,stsTokenManager:_}=t;be(g&&_,e,"internal-error");const A=Ws.fromJSON(this.name,_);be(typeof g=="string",e,"internal-error"),ki(n,e.name),ki(s,e.name),be(typeof y=="boolean",e,"internal-error"),be(typeof w=="boolean",e,"internal-error"),ki(o,e.name),ki(l,e.name),ki(c,e.name),ki(h,e.name),ki(f,e.name),ki(p,e.name);const E=new bn({uid:g,auth:e,email:s,emailVerified:y,displayName:n,isAnonymous:w,photoURL:l,phoneNumber:o,tenantId:c,stsTokenManager:A,createdAt:f,lastLoginAt:p});return b&&Array.isArray(b)&&(E.providerData=b.map(C=>({...C}))),h&&(E._redirectEventId=h),E}static async _fromIdTokenResponse(e,t,n=!1){const s=new Ws;s.updateFromServerResponse(t);const o=new bn({uid:t.localId,auth:e,stsTokenManager:s,isAnonymous:n});return await _l(o),o}static async _fromGetAccountInfoResponse(e,t,n){const s=t.users[0];be(s.localId!==void 0,"internal-error");const o=s.providerUserInfo!==void 0?fy(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!o?.length,c=new Ws;c.updateFromIdToken(n);const h=new bn({uid:s.localId,auth:e,stsTokenManager:c,isAnonymous:l}),f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new dh(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!o?.length};return Object.assign(h,f),h}}const Lg=new Map;function ti(a){ri(a instanceof Function,"Expected a class definition");let e=Lg.get(a);return e?(ri(e instanceof a,"Instance stored in cache mismatched with class"),e):(e=new a,Lg.set(a,e),e)}class py{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}py.type="NONE";const Dg=py;function hl(a,e,t){return`firebase:${a}:${e}:${t}`}class Gs{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:s,name:o}=this.auth;this.fullUserKey=hl(this.userKey,s.apiKey,o),this.fullPersistenceKey=hl("persistence",s.apiKey,o),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await wl(this.auth,{idToken:e}).catch(()=>{});return t?bn._fromGetAccountInfoResponse(this.auth,t,e):null}return bn._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Gs(ti(Dg),e,n);const s=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let o=s[0]||ti(Dg);const l=hl(n,e.config.apiKey,e.name);let c=null;for(const f of t)try{const p=await f._get(l);if(p){let g;if(typeof p=="string"){const y=await wl(e,{idToken:p}).catch(()=>{});if(!y)break;g=await bn._fromGetAccountInfoResponse(e,y,p)}else g=bn._fromJSON(e,p);f!==o&&(c=g),o=f;break}}catch{}const h=s.filter(f=>f._shouldAllowMigration);return!o._shouldAllowMigration||!h.length?new Gs(o,e,n):(o=h[0],c&&await o._set(l,c.toJSON()),await Promise.all(t.map(async f=>{if(f!==o)try{await f._remove(l)}catch{}})),new Gs(o,e,n))}}function Mg(a){const e=a.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(vy(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(gy(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(_y(e))return"Blackberry";if(by(e))return"Webos";if(my(e))return"Safari";if((e.includes("chrome/")||yy(e))&&!e.includes("edge/"))return"Chrome";if(wy(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=a.match(t);if(n?.length===2)return n[1]}return"Other"}function gy(a=Pt()){return/firefox\//i.test(a)}function my(a=Pt()){const e=a.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function yy(a=Pt()){return/crios\//i.test(a)}function vy(a=Pt()){return/iemobile/i.test(a)}function wy(a=Pt()){return/android/i.test(a)}function _y(a=Pt()){return/blackberry/i.test(a)}function by(a=Pt()){return/webos/i.test(a)}function Vh(a=Pt()){return/iphone|ipad|ipod/i.test(a)||/macintosh/i.test(a)&&/mobile/i.test(a)}function vA(a=Pt()){return Vh(a)&&!!window.navigator?.standalone}function wA(){return Lb()&&document.documentMode===10}function Sy(a=Pt()){return Vh(a)||wy(a)||by(a)||_y(a)||/windows phone/i.test(a)||vy(a)}function Ay(a,e=[]){let t;switch(a){case"Browser":t=Mg(Pt());break;case"Worker":t=`${Mg(Pt())}-${a}`;break;default:t=a}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Co}/${n}`}class _A{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=o=>new Promise((l,c)=>{try{const h=e(o);l(h)}catch(h){c(h)}});n.onAbort=t,this.queue.push(n);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const s of t)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}async function bA(a,e={}){return ur(a,"GET","/v2/passwordPolicy",zh(a,e))}const SA=6;class AA{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??SA,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),t.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),t.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),t.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),t.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),s&&(t.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let s=0;s<e.length;s++)n=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,s,o){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=o))}}class EA{constructor(e,t,n,s){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Ng(this),this.idTokenSubscription=new Ng(this),this.beforeStateQueue=new _A(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=cy,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(o=>this._resolvePersistenceManagerAvailable=o)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ti(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Gs.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await wl(this,{idToken:e}),n=await bn._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Fn(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=this.redirectUser?._redirectEventId,l=n?._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&c?.user&&(n=c.user,s=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(n)}catch(o){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return be(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await _l(e)}catch(t){if(t?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=sA()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Fn(this.app))return Promise.reject(ls(this));const t=e?Bi(e):null;return t&&be(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&be(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Fn(this.app)?Promise.reject(ls(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Fn(this.app)?Promise.reject(ls(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ti(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await bA(this),t=new AA(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Ao("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await yA(this,n)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ti(e)||this._popupRedirectResolver;be(t,this,"argument-error"),this.redirectPersistenceManager=await Gs.create(this,[ti(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,s){if(this._deleted)return()=>{};const o=typeof t=="function"?t:t.next.bind(t);let l=!1;const c=this._isInitialized?Promise.resolve():this._initializationPromise;if(be(c,this,"internal-error"),c.then(()=>{l||o(this.currentUser)}),typeof t=="function"){const h=e.addObserver(t,n,s);return()=>{l=!0,h()}}else{const h=e.addObserver(t);return()=>{l=!0,h()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return be(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ay(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(Fn(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&eA(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Ll(a){return Bi(a)}class Ng{constructor(e){this.auth=e,this.observer=null,this.addObserver=Ub(t=>this.observer=t)}get next(){return be(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Wh={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function CA(a){Wh=a}function TA(a){return Wh.loadJS(a)}function xA(){return Wh.gapiScript}function kA(a){return`__${a}${Math.floor(Math.random()*1e6)}`}function PA(a,e){const t=sy(a,"auth");if(t.isInitialized()){const s=t.getImmediate(),o=t.getOptions();if(er(o,e??{}))return s;jn(s,"already-initialized")}return t.initialize({options:e})}function RA(a,e){const t=e?.persistence||[],n=(Array.isArray(t)?t:[t]).map(ti);e?.errorMap&&a._updateErrorMap(e.errorMap),a._initializeWithPersistence(n,e?.popupRedirectResolver)}function IA(a,e,t){const n=Ll(a);be(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const s=!1,o=Ey(e),{host:l,port:c}=LA(e),h=c===null?"":`:${c}`,f={url:`${o}//${l}${h}/`},p=Object.freeze({host:l,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!n._canInitEmulator){be(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),be(er(f,n.config.emulator)&&er(p,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=f,n.emulatorConfig=p,n.settings.appVerificationDisabledForTesting=!0,Il(l)?(Eb(`${o}//${l}${h}`),xb("Auth",!0)):DA()}function Ey(a){const e=a.indexOf(":");return e<0?"":a.substr(0,e+1)}function LA(a){const e=Ey(a),t=/(\/\/)?([^?#/]+)/.exec(a.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(n);if(s){const o=s[1];return{host:o,port:Og(n.substr(o.length+1))}}else{const[o,l]=n.split(":");return{host:o,port:Og(l)}}}function Og(a){if(!a)return null;const e=Number(a);return isNaN(e)?null:e}function DA(){function a(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",a):a())}class Cy{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ei("not implemented")}_getIdTokenResponse(e){return ei("not implemented")}_linkToIdToken(e,t){return ei("not implemented")}_getReauthenticationResolver(e){return ei("not implemented")}}async function qs(a,e){return lA(a,"POST","/v1/accounts:signInWithIdp",zh(a,e))}const MA="http://localhost";class cs extends Cy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new cs(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):jn("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:s,...o}=t;if(!n||!s)return null;const l=new cs(n,s);return l.idToken=o.idToken||void 0,l.accessToken=o.accessToken||void 0,l.secret=o.secret,l.nonce=o.nonce,l.pendingToken=o.pendingToken||null,l}_getIdTokenResponse(e){const t=this.buildRequest();return qs(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,qs(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,qs(e,t)}buildRequest(){const e={requestUri:MA,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Eo(t)}return e}}class Gh{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class xo extends Gh{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Pi extends xo{constructor(){super("facebook.com")}static credential(e){return cs._fromParams({providerId:Pi.PROVIDER_ID,signInMethod:Pi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Pi.credentialFromTaggedObject(e)}static credentialFromError(e){return Pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Pi.credential(e.oauthAccessToken)}catch{return null}}}Pi.FACEBOOK_SIGN_IN_METHOD="facebook.com";Pi.PROVIDER_ID="facebook.com";class Zn extends xo{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return cs._fromParams({providerId:Zn.PROVIDER_ID,signInMethod:Zn.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Zn.credentialFromTaggedObject(e)}static credentialFromError(e){return Zn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Zn.credential(t,n)}catch{return null}}}Zn.GOOGLE_SIGN_IN_METHOD="google.com";Zn.PROVIDER_ID="google.com";class Ri extends xo{constructor(){super("github.com")}static credential(e){return cs._fromParams({providerId:Ri.PROVIDER_ID,signInMethod:Ri.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ri.credentialFromTaggedObject(e)}static credentialFromError(e){return Ri.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ri.credential(e.oauthAccessToken)}catch{return null}}}Ri.GITHUB_SIGN_IN_METHOD="github.com";Ri.PROVIDER_ID="github.com";class Ii extends xo{constructor(){super("twitter.com")}static credential(e,t){return cs._fromParams({providerId:Ii.PROVIDER_ID,signInMethod:Ii.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ii.credentialFromTaggedObject(e)}static credentialFromError(e){return Ii.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Ii.credential(t,n)}catch{return null}}}Ii.TWITTER_SIGN_IN_METHOD="twitter.com";Ii.PROVIDER_ID="twitter.com";class nr{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,s=!1){const o=await bn._fromIdTokenResponse(e,n,s),l=Fg(n);return new nr({user:o,providerId:l,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const s=Fg(n);return new nr({user:e,providerId:s,_tokenResponse:n,operationType:t})}}function Fg(a){return a.providerId?a.providerId:"phoneNumber"in a?"phone":null}class bl extends Fi{constructor(e,t,n,s){super(t.code,t.message),this.operationType=n,this.user=s,Object.setPrototypeOf(this,bl.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,s){return new bl(e,t,n,s)}}function Ty(a,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(a):t._getIdTokenResponse(a)).catch(o=>{throw o.code==="auth/multi-factor-auth-required"?bl._fromErrorAndOperation(a,o,e,n):o})}async function NA(a,e,t=!1){const n=await po(a,e._linkToIdToken(a.auth,await a.getIdToken()),t);return nr._forOperation(a,"link",n)}async function OA(a,e,t=!1){const{auth:n}=a;if(Fn(n.app))return Promise.reject(ls(n));const s="reauthenticate";try{const o=await po(a,Ty(n,s,e,a),t);be(o.idToken,n,"internal-error");const l=$h(o.idToken);be(l,n,"internal-error");const{sub:c}=l;return be(a.uid===c,n,"user-mismatch"),nr._forOperation(a,s,o)}catch(o){throw o?.code==="auth/user-not-found"&&jn(n,"user-mismatch"),o}}async function FA(a,e,t=!1){if(Fn(a.app))return Promise.reject(ls(a));const n="signIn",s=await Ty(a,n,e),o=await nr._fromIdTokenResponse(a,n,s);return t||await a._updateCurrentUser(o.user),o}function BA(a,e,t,n){return Bi(a).onIdTokenChanged(e,t,n)}function UA(a,e,t){return Bi(a).beforeAuthStateChanged(e,t)}function jA(a,e,t,n){return Bi(a).onAuthStateChanged(e,t,n)}function HA(a){return Bi(a).signOut()}const Sl="__sak";class xy{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Sl,"1"),this.storage.removeItem(Sl),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const zA=1e3,$A=10;class ky extends xy{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Sy(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),s=this.localCache[t];n!==s&&e(t,s,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((l,c,h)=>{this.notifyListeners(l,h)});return}const n=e.key;t?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(n);!t&&this.localCache[n]===l||this.notifyListeners(n,l)},o=this.storage.getItem(n);wA()&&o!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,$A):s()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},zA)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}ky.type="LOCAL";const VA=ky;class Py extends xy{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Py.type="SESSION";const Ry=Py;function WA(a){return Promise.all(a.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}class Dl{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(s=>s.isListeningto(e));if(t)return t;const n=new Dl(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:s,data:o}=t.data,l=this.handlersMap[s];if(!l?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:s});const c=Array.from(l).map(async f=>f(t.origin,o)),h=await WA(c);t.ports[0].postMessage({status:"done",eventId:n,eventType:s,response:h})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Dl.receivers=[];function qh(a="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return a+t}class GA{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let o,l;return new Promise((c,h)=>{const f=qh("",20);s.port1.start();const p=setTimeout(()=>{h(new Error("unsupported_event"))},n);l={messageChannel:s,onMessage(g){const y=g;if(y.data.eventId===f)switch(y.data.status){case"ack":clearTimeout(p),o=setTimeout(()=>{h(new Error("timeout"))},3e3);break;case"done":clearTimeout(o),c(y.data.response);break;default:clearTimeout(p),clearTimeout(o),h(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}function Un(){return window}function qA(a){Un().location.href=a}function Iy(){return typeof Un().WorkerGlobalScope<"u"&&typeof Un().importScripts=="function"}async function XA(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function KA(){return navigator?.serviceWorker?.controller||null}function YA(){return Iy()?self:null}const Ly="firebaseLocalStorageDb",QA=1,Al="firebaseLocalStorage",Dy="fbase_key";class ko{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Ml(a,e){return a.transaction([Al],e?"readwrite":"readonly").objectStore(Al)}function JA(){const a=indexedDB.deleteDatabase(Ly);return new ko(a).toPromise()}function fh(){const a=indexedDB.open(Ly,QA);return new Promise((e,t)=>{a.addEventListener("error",()=>{t(a.error)}),a.addEventListener("upgradeneeded",()=>{const n=a.result;try{n.createObjectStore(Al,{keyPath:Dy})}catch(s){t(s)}}),a.addEventListener("success",async()=>{const n=a.result;n.objectStoreNames.contains(Al)?e(n):(n.close(),await JA(),e(await fh()))})})}async function Bg(a,e,t){const n=Ml(a,!0).put({[Dy]:e,value:t});return new ko(n).toPromise()}async function ZA(a,e){const t=Ml(a,!1).get(e),n=await new ko(t).toPromise();return n===void 0?null:n.value}function Ug(a,e){const t=Ml(a,!0).delete(e);return new ko(t).toPromise()}const eE=800,tE=3;class My{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fh(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>tE)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Iy()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Dl._getInstance(YA()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await XA(),!this.activeServiceWorker)return;this.sender=new GA(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||KA()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await fh();return await Bg(e,Sl,"1"),await Ug(e,Sl),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Bg(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>ZA(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Ug(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const o=Ml(s,!1).getAll();return new ko(o).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:s,value:o}of e)n.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(o)&&(this.notifyListeners(s,o),t.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!n.has(s)&&(this.notifyListeners(s,null),t.push(s));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const s of Array.from(n))s(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),eE)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}My.type="LOCAL";const nE=My;new To(3e4,6e4);function Ny(a,e){return e?ti(e):(be(a._popupRedirectResolver,a,"argument-error"),a._popupRedirectResolver)}class Xh extends Cy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return qs(e,this._buildIdpRequest())}_linkToIdToken(e,t){return qs(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return qs(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function iE(a){return FA(a.auth,new Xh(a),a.bypassAuthState)}function sE(a){const{auth:e,user:t}=a;return be(t,e,"internal-error"),OA(t,new Xh(a),a.bypassAuthState)}async function rE(a){const{auth:e,user:t}=a;return be(t,e,"internal-error"),NA(t,new Xh(a),a.bypassAuthState)}class Oy{constructor(e,t,n,s,o=!1){this.auth=e,this.resolver=n,this.user=s,this.bypassAuthState=o,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:s,tenantId:o,error:l,type:c}=e;if(l){this.reject(l);return}const h={auth:this.auth,requestUri:t,sessionId:n,tenantId:o||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(c)(h))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return iE;case"linkViaPopup":case"linkViaRedirect":return rE;case"reauthViaPopup":case"reauthViaRedirect":return sE;default:jn(this.auth,"internal-error")}}resolve(e){ri(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ri(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const oE=new To(2e3,1e4);async function aE(a,e,t){if(Fn(a.app))return Promise.reject(Sn(a,"operation-not-supported-in-this-environment"));const n=Ll(a);tA(a,e,Gh);const s=Ny(n,t);return new is(n,"signInViaPopup",e,s).executeNotNull()}class is extends Oy{constructor(e,t,n,s,o){super(e,t,s,o),this.provider=n,this.authWindow=null,this.pollId=null,is.currentPopupAction&&is.currentPopupAction.cancel(),is.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return be(e,this.auth,"internal-error"),e}async onExecution(){ri(this.filter.length===1,"Popup operations only handle one event");const e=qh();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(Sn(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Sn(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,is.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Sn(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,oE.get())};e()}}is.currentPopupAction=null;const lE="pendingRedirect",dl=new Map;class cE extends Oy{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=dl.get(this.auth._key());if(!e){try{const n=await uE(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}dl.set(this.auth._key(),e)}return this.bypassAuthState||dl.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function uE(a,e){const t=fE(e),n=dE(a);if(!await n._isAvailable())return!1;const s=await n._get(t)==="true";return await n._remove(t),s}function hE(a,e){dl.set(a._key(),e)}function dE(a){return ti(a._redirectPersistence)}function fE(a){return hl(lE,a.config.apiKey,a.name)}async function pE(a,e,t=!1){if(Fn(a.app))return Promise.reject(ls(a));const n=Ll(a),s=Ny(n,e),l=await new cE(n,s,t).execute();return l&&!t&&(delete l.user._redirectEventId,await n._persistUserIfCurrent(l.user),await n._setRedirectUser(null,e)),l}const gE=600*1e3;class mE{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!yE(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!Fy(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Sn(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=gE&&this.cachedEventUids.clear(),this.cachedEventUids.has(jg(e))}saveEventToCache(e){this.cachedEventUids.add(jg(e)),this.lastProcessedEventTime=Date.now()}}function jg(a){return[a.type,a.eventId,a.sessionId,a.tenantId].filter(e=>e).join("-")}function Fy({type:a,error:e}){return a==="unknown"&&e?.code==="auth/no-auth-event"}function yE(a){switch(a.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Fy(a);default:return!1}}async function vE(a,e={}){return ur(a,"GET","/v1/projects",e)}const wE=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,_E=/^https?/;async function bE(a){if(a.config.emulator)return;const{authorizedDomains:e}=await vE(a);for(const t of e)try{if(SE(t))return}catch{}jn(a,"unauthorized-domain")}function SE(a){const e=hh(),{protocol:t,hostname:n}=new URL(e);if(a.startsWith("chrome-extension://")){const l=new URL(a);return l.hostname===""&&n===""?t==="chrome-extension:"&&a.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&l.hostname===n}if(!_E.test(t))return!1;if(wE.test(a))return n===a;const s=a.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(n)}const AE=new To(3e4,6e4);function Hg(){const a=Un().___jsl;if(a?.H){for(const e of Object.keys(a.H))if(a.H[e].r=a.H[e].r||[],a.H[e].L=a.H[e].L||[],a.H[e].r=[...a.H[e].L],a.CP)for(let t=0;t<a.CP.length;t++)a.CP[t]=null}}function EE(a){return new Promise((e,t)=>{function n(){Hg(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Hg(),t(Sn(a,"network-request-failed"))},timeout:AE.get()})}if(Un().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Un().gapi?.load)n();else{const s=kA("iframefcb");return Un()[s]=()=>{gapi.load?n():t(Sn(a,"network-request-failed"))},TA(`${xA()}?onload=${s}`).catch(o=>t(o))}}).catch(e=>{throw fl=null,e})}let fl=null;function CE(a){return fl=fl||EE(a),fl}const TE=new To(5e3,15e3),xE="__/auth/iframe",kE="emulator/auth/iframe",PE={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},RE=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function IE(a){const e=a.config;be(e.authDomain,a,"auth-domain-config-required");const t=e.emulator?Hh(e,kE):`https://${a.config.authDomain}/${xE}`,n={apiKey:e.apiKey,appName:a.name,v:Co},s=RE.get(a.config.apiHost);s&&(n.eid=s);const o=a._getFrameworks();return o.length&&(n.fw=o.join(",")),`${t}?${Eo(n).slice(1)}`}async function LE(a){const e=await CE(a),t=Un().gapi;return be(t,a,"internal-error"),e.open({where:document.body,url:IE(a),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:PE,dontclear:!0},n=>new Promise(async(s,o)=>{await n.restyle({setHideOnLeave:!1});const l=Sn(a,"network-request-failed"),c=Un().setTimeout(()=>{o(l)},TE.get());function h(){Un().clearTimeout(c),s(n)}n.ping(h).then(h,()=>{o(l)})}))}const DE={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},ME=500,NE=600,OE="_blank",FE="http://localhost";class zg{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function BE(a,e,t,n=ME,s=NE){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-n)/2,0).toString();let c="";const h={...DE,width:n.toString(),height:s.toString(),top:o,left:l},f=Pt().toLowerCase();t&&(c=yy(f)?OE:t),gy(f)&&(e=e||FE,h.scrollbars="yes");const p=Object.entries(h).reduce((y,[w,b])=>`${y}${w}=${b},`,"");if(vA(f)&&c!=="_self")return UE(e||"",c),new zg(null);const g=window.open(e||"",c,p);be(g,a,"popup-blocked");try{g.focus()}catch{}return new zg(g)}function UE(a,e){const t=document.createElement("a");t.href=a,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}const jE="__/auth/handler",HE="emulator/auth/handler",zE=encodeURIComponent("fac");async function $g(a,e,t,n,s,o){be(a.config.authDomain,a,"auth-domain-config-required"),be(a.config.apiKey,a,"invalid-api-key");const l={apiKey:a.config.apiKey,appName:a.name,authType:t,redirectUrl:n,v:Co,eventId:s};if(e instanceof Gh){e.setDefaultLanguage(a.languageCode),l.providerId=e.providerId||"",Bb(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[p,g]of Object.entries({}))l[p]=g}if(e instanceof xo){const p=e.getScopes().filter(g=>g!=="");p.length>0&&(l.scopes=p.join(","))}a.tenantId&&(l.tid=a.tenantId);const c=l;for(const p of Object.keys(c))c[p]===void 0&&delete c[p];const h=await a._getAppCheckToken(),f=h?`#${zE}=${encodeURIComponent(h)}`:"";return`${$E(a)}?${Eo(c).slice(1)}${f}`}function $E({config:a}){return a.emulator?Hh(a,HE):`https://${a.authDomain}/${jE}`}const Xu="webStorageSupport";class VE{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ry,this._completeRedirectFn=pE,this._overrideRedirectResult=hE}async _openPopup(e,t,n,s){ri(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const o=await $g(e,t,n,hh(),s);return BE(e,o,qh())}async _openRedirect(e,t,n,s){await this._originValidation(e);const o=await $g(e,t,n,hh(),s);return qA(o),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:s,promise:o}=this.eventManagers[t];return s?Promise.resolve(s):(ri(o,"If manager is not set, promise should be"),o)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await LE(e),n=new mE(e);return t.register("authEvent",s=>(be(s?.authEvent,e,"invalid-auth-event"),{status:n.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Xu,{type:Xu},s=>{const o=s?.[0]?.[Xu];o!==void 0&&t(!!o),jn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=bE(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Sy()||my()||Vh()}}const WE=VE;var Vg="@firebase/auth",Wg="1.11.1";class GE{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e(n?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){be(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function qE(a){switch(a){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function XE(a){ho(new tr("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),o=e.getProvider("app-check-internal"),{apiKey:l,authDomain:c}=n.options;be(l&&!l.includes(":"),"invalid-api-key",{appName:n.name});const h={apiKey:l,authDomain:c,clientPlatform:a,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ay(a)},f=new EA(n,s,o,h);return RA(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),ho(new tr("auth-internal",e=>{const t=Ll(e.getProvider("auth").getImmediate());return(n=>new GE(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Vs(Vg,Wg,qE(a)),Vs(Vg,Wg,"esm2020")}const KE=300,YE=ey("authIdTokenMaxAge")||KE;let Gg=null;const QE=a=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>YE)return;const s=t?.token;Gg!==s&&(Gg=s,await fetch(a,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function JE(a=jS()){const e=sy(a,"auth");if(e.isInitialized())return e.getImmediate();const t=PA(a,{popupRedirectResolver:WE,persistence:[nE,VA,Ry]}),n=ey("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const o=new URL(n,location.origin);if(location.origin===o.origin){const l=QE(o.toString());UA(t,l,()=>l(t.currentUser)),BA(t,c=>l(c))}}const s=Sb("auth");return s&&IA(t,`http://${s}`),t}function ZE(){return document.getElementsByTagName("head")?.[0]??document}CA({loadJS(a){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",a),n.onload=e,n.onerror=s=>{const o=Sn("internal-error");o.customData=s,t(o)},n.type="text/javascript",n.charset="UTF-8",ZE().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});XE("Browser");const e1={apiKey:"AIzaSyCJYhtDII3j85EvImn9tTqs6e3PYGrjrqw",authDomain:"gtu-solution.firebaseapp.com",projectId:"gtu-solution",storageBucket:"gtu-solution.firebasestorage.app",messagingSenderId:"658478369866",appId:"1:658478369866:web:3253493605177ca1b86ab3"},t1=ry(e1),ph=JE(t1),n1=new Zn,i1=()=>aE(ph,n1),Nl=I.createContext();function s1({children:a}){const[e,t]=I.useState(null),[n,s]=I.useState(!0);I.useEffect(()=>{const l=jA(ph,c=>{t(c),s(!1)});return()=>l()},[]);const o=()=>HA(ph);return j.jsx(Nl.Provider,{value:{user:e,loading:n,logout:o},children:a})}function By(){const{user:a,logout:e}=I.useContext(Nl),n=Hn().pathname==="/login";return j.jsxs("header",{style:{padding:"1rem 2rem",display:"flex",alignItems:"center",justifyContent:"space-between",position:"sticky",top:0,background:"#dbd4cb",borderBottom:"1px solid #b9a185",zIndex:10},children:[j.jsx("h2",{style:{fontFamily:"Playfair Display",color:"#0c0b07",letterSpacing:"0.5px"},children:"GTUpapers"}),j.jsx("nav",{style:{display:"flex",gap:"1rem",alignItems:"center"},children:a?j.jsxs(j.Fragment,{children:[j.jsx("span",{style:{color:"#0c0b07",fontWeight:"600",fontSize:"0.95rem"}}),j.jsx("button",{onClick:e,style:{padding:"0.6rem 1rem",background:"#6b533c",color:"white",borderRadius:"8px",border:"none",cursor:"pointer",fontSize:"0.9rem"},children:"Logout"})]}):j.jsx(j.Fragment,{children:!n&&j.jsx(Oh,{to:"/login",style:{padding:"0.6rem 1rem",background:"#6b533c",color:"white",borderRadius:"8px",textDecoration:"none",fontSize:"0.9rem"},children:"Login"})})})]})}function r1(){return j.jsx("footer",{style:{padding:"2rem",background:"var(--ebony)",color:"var(--isabelline)",textAlign:"center",marginTop:"2rem"},children:j.jsxs("p",{children:[" ",new Date().getFullYear()," GTUpapers  All Rights Reserved"]})})}function qg({mode:a}){const e=cr(),[t,n]=I.useState(""),s=a==="degree"?["computer-engineering","information-technology","mechanical-engineering","civil-engineering","electronics-communication"]:["diploma-ce","diploma-it","diploma-mechanical","diploma-civil"],o=l=>l.replace(/-/g," ").replace(/\b\w/g,c=>c.toUpperCase());return j.jsxs(j.Fragment,{children:[j.jsxs("nav",{className:"level-nav",children:[j.jsx("button",{className:a==="degree"?"active-tab":"",onClick:()=>e("/"),children:"Degree"}),j.jsx("button",{className:a==="diploma"?"active-tab":"",onClick:()=>e("/diploma"),children:"Diploma"})]}),j.jsxs("main",{className:"main-content",children:[j.jsxs("section",{className:"section hero",children:[j.jsx("h1",{children:a==="degree"?"GTU Degree Papers":"GTU Diploma Papers"}),j.jsx("p",{children:"Your smart destination for previous year papers."})]}),j.jsxs("section",{className:"section",children:[j.jsx("h2",{children:"Popular Branches"}),j.jsx("div",{className:"grid grid-3",children:s.map((l,c)=>j.jsxs("div",{className:"card",children:[j.jsx("h3",{children:o(l)}),j.jsx("button",{className:"btn btn-secondary",onClick:()=>e(`/${a}/branch/${l}`),children:"Explore"})]},c))})]})]})]})}const o1={degree:{"computer-engineering":{1:[{name:"Mathematics-1",pdf:"Ai.pdf"},{name:"AI",pdf:"Ai.pdf"}]}}};function Xg(){const{mode:a,semId:e,branchName:t}=Ih(),n=cr(),s=o1[a]?.[t]?.[e]||[];return j.jsxs("div",{className:"main-content",children:[j.jsxs("h1",{children:[a.toUpperCase(),"  ",t.replace("-"," ").toUpperCase(),"  Semester ",e]}),j.jsx("div",{className:"grid grid-3",children:s.map((o,l)=>j.jsxs("div",{className:"card",children:[j.jsx("h3",{children:o.name}),j.jsx("button",{className:"btn btn-primary",onClick:()=>n(`/${a}/branch/${t}/semester/${e}/subject/${o.pdf.replace(".pdf","")}`),children:"Open"})]},l))})]})}function a1(){const{mode:a,branchName:e}=Ih(),t=cr(),n=a==="degree"?["Semester 1","Semester 2","Semester 3","Semester 4","Semester 5","Semester 6","Semester 7","Semester 8"]:["Semester 1","Semester 2","Semester 3","Semester 4","Semester 5","Semester 6"],s=e.replace(/-/g," ");return j.jsx(j.Fragment,{children:j.jsxs("main",{className:"main-content",children:[j.jsx("h1",{children:s.toUpperCase()}),j.jsx("p",{children:"Select a semester"}),j.jsx("div",{className:"grid grid-4",children:n.map((o,l)=>j.jsxs("div",{className:"card",children:[j.jsx("h3",{children:o}),j.jsx("button",{className:"btn btn-primary",onClick:()=>t(`/${a}/branch/${e}/semester/${l+1}`),children:"Open"})]},l))})]})})}function l1(){return j.jsxs("div",{className:"layout-container",children:[j.jsx(By,{}),j.jsx("main",{className:"main-content",children:j.jsx($m,{})}),j.jsx(r1,{}),"    "]})}function c1(){const a=cr(),{user:e,loading:t}=I.useContext(Nl);I.useEffect(()=>{!t&&e&&a("/",{replace:!0})},[t,e,a]);const n=async()=>{try{const s=await i1();console.log("Google Login:",s.user),a("/")}catch(s){console.log("Google Login Error:",s),alert("Login Failed")}};return j.jsxs(j.Fragment,{children:[j.jsx(By,{}),j.jsx("div",{className:"auth-container",children:j.jsxs("div",{className:"auth-box",children:[j.jsx("h2",{className:"auth-title",children:"Welcome Back"}),j.jsx("p",{className:"auth-subtitle",children:"Login with Google to access GTU Papers"}),j.jsx("button",{className:"google-btn",onClick:n,children:"Continue with Google"})]})})]})}const xt=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),gh=[.001,0,0,.001,0,0],Ku=1.35,Vt={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Bn={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},go="pdfjs_internal_editor_",Se={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},Re={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},Uy={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},yt={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},lo={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},it={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},js={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},Po={ERRORS:0,WARNINGS:1,INFOS:5},ir={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Ja={moveTo:0,lineTo:1,curveTo:2,closePath:3},jy={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let Ol=Po.WARNINGS;function u1(a){Number.isInteger(a)&&(Ol=a)}function h1(){return Ol}function Fl(a){Ol>=Po.INFOS&&console.info(`Info: ${a}`)}function Ae(a){Ol>=Po.WARNINGS&&console.warn(`Warning: ${a}`)}function Ue(a){throw new Error(a)}function Ie(a,e){a||Ue(e)}function d1(a){switch(a?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Kh(a,e=null,t=null){if(!a)return null;if(t&&typeof a=="string"&&(t.addDefaultProtocol&&a.startsWith("www.")&&a.match(/\./g)?.length>=2&&(a=`http://${a}`),t.tryConvertEncoding))try{a=y1(a)}catch{}const n=e?URL.parse(a,e):URL.parse(a);return d1(n)?n:null}function Yh(a,e,t=!1){const n=URL.parse(a);return n?(n.hash=e,n.href):t&&Kh(a,"http://example.com")?a.split("#",1)[0]+`${e?`#${e}`:""}`:""}function Ee(a,e,t,n=!1){return Object.defineProperty(a,e,{value:t,enumerable:!n,configurable:!0,writable:!1}),t}const fs=(function(){function e(t,n){this.message=t,this.name=n}return e.prototype=new Error,e.constructor=e,e})();class Kg extends fs{constructor(e,t){super(e,"PasswordException"),this.code=t}}class Yu extends fs{constructor(e,t){super(e,"UnknownErrorException"),this.details=t}}class El extends fs{constructor(e){super(e,"InvalidPDFException")}}class mo extends fs{constructor(e,t,n){super(e,"ResponseException"),this.status=t,this.missing=n}}class f1 extends fs{constructor(e){super(e,"FormatError")}}class oi extends fs{constructor(e){super(e,"AbortException")}}function Hy(a){(typeof a!="object"||a?.length===void 0)&&Ue("Invalid argument for bytesToString");const e=a.length,t=8192;if(e<t)return String.fromCharCode.apply(null,a);const n=[];for(let s=0;s<e;s+=t){const o=Math.min(s+t,e),l=a.subarray(s,o);n.push(String.fromCharCode.apply(null,l))}return n.join("")}function Ro(a){typeof a!="string"&&Ue("Invalid argument for stringToBytes");const e=a.length,t=new Uint8Array(e);for(let n=0;n<e;++n)t[n]=a.charCodeAt(n)&255;return t}function p1(a){return String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255)}function g1(){const a=new Uint8Array(4);return a[0]=1,new Uint32Array(a.buffer,0,1)[0]===1}function m1(){try{return new Function(""),!0}catch{return!1}}class pt{static get isLittleEndian(){return Ee(this,"isLittleEndian",g1())}static get isEvalSupported(){return Ee(this,"isEvalSupported",m1())}static get isOffscreenCanvasSupported(){return Ee(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return Ee(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get platform(){const{platform:e,userAgent:t}=navigator;return Ee(this,"platform",{isAndroid:t.includes("Android"),isLinux:e.includes("Linux"),isMac:e.includes("Mac"),isWindows:e.includes("Win"),isFirefox:t.includes("Firefox")})}static get isCSSRoundSupported(){return Ee(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Qu=Array.from(Array(256).keys(),a=>a.toString(16).padStart(2,"0"));class re{static makeHexColor(e,t,n){return`#${Qu[e]}${Qu[t]}${Qu[n]}`}static domMatrixToTransform(e){return[e.a,e.b,e.c,e.d,e.e,e.f]}static scaleMinMax(e,t){let n;e[0]?(e[0]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[0],t[2]*=e[0],e[3]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[3],t[3]*=e[3]):(n=t[0],t[0]=t[1],t[1]=n,n=t[2],t[2]=t[3],t[3]=n,e[1]<0&&(n=t[1],t[1]=t[3],t[3]=n),t[1]*=e[1],t[3]*=e[1],e[2]<0&&(n=t[0],t[0]=t[2],t[2]=n),t[0]*=e[2],t[2]*=e[2]),t[0]+=e[4],t[1]+=e[5],t[2]+=e[4],t[3]+=e[5]}static transform(e,t){return[e[0]*t[0]+e[2]*t[1],e[1]*t[0]+e[3]*t[1],e[0]*t[2]+e[2]*t[3],e[1]*t[2]+e[3]*t[3],e[0]*t[4]+e[2]*t[5]+e[4],e[1]*t[4]+e[3]*t[5]+e[5]]}static multiplyByDOMMatrix(e,t){return[e[0]*t.a+e[2]*t.b,e[1]*t.a+e[3]*t.b,e[0]*t.c+e[2]*t.d,e[1]*t.c+e[3]*t.d,e[0]*t.e+e[2]*t.f+e[4],e[1]*t.e+e[3]*t.f+e[5]]}static applyTransform(e,t,n=0){const s=e[n],o=e[n+1];e[n]=s*t[0]+o*t[2]+t[4],e[n+1]=s*t[1]+o*t[3]+t[5]}static applyTransformToBezier(e,t,n=0){const s=t[0],o=t[1],l=t[2],c=t[3],h=t[4],f=t[5];for(let p=0;p<6;p+=2){const g=e[n+p],y=e[n+p+1];e[n+p]=g*s+y*l+h,e[n+p+1]=g*o+y*c+f}}static applyInverseTransform(e,t){const n=e[0],s=e[1],o=t[0]*t[3]-t[1]*t[2];e[0]=(n*t[3]-s*t[2]+t[2]*t[5]-t[4]*t[3])/o,e[1]=(-n*t[1]+s*t[0]+t[4]*t[1]-t[5]*t[0])/o}static axialAlignedBoundingBox(e,t,n){const s=t[0],o=t[1],l=t[2],c=t[3],h=t[4],f=t[5],p=e[0],g=e[1],y=e[2],w=e[3];let b=s*p+h,_=b,A=s*y+h,E=A,C=c*g+f,T=C,R=c*w+f,L=R;if(o!==0||l!==0){const k=o*p,N=o*y,U=l*g,z=l*w;b+=U,E+=U,A+=z,_+=z,C+=k,L+=k,R+=N,T+=N}n[0]=Math.min(n[0],b,A,_,E),n[1]=Math.min(n[1],C,R,T,L),n[2]=Math.max(n[2],b,A,_,E),n[3]=Math.max(n[3],C,R,T,L)}static inverseTransform(e){const t=e[0]*e[3]-e[1]*e[2];return[e[3]/t,-e[1]/t,-e[2]/t,e[0]/t,(e[2]*e[5]-e[4]*e[3])/t,(e[4]*e[1]-e[5]*e[0])/t]}static singularValueDecompose2dScale(e,t){const n=e[0],s=e[1],o=e[2],l=e[3],c=n**2+s**2,h=n*o+s*l,f=o**2+l**2,p=(c+f)/2,g=Math.sqrt(p**2-(c*f-h**2));t[0]=Math.sqrt(p+g||1),t[1]=Math.sqrt(p-g||1)}static normalizeRect(e){const t=e.slice(0);return e[0]>e[2]&&(t[0]=e[2],t[2]=e[0]),e[1]>e[3]&&(t[1]=e[3],t[3]=e[1]),t}static intersect(e,t){const n=Math.max(Math.min(e[0],e[2]),Math.min(t[0],t[2])),s=Math.min(Math.max(e[0],e[2]),Math.max(t[0],t[2]));if(n>s)return null;const o=Math.max(Math.min(e[1],e[3]),Math.min(t[1],t[3])),l=Math.min(Math.max(e[1],e[3]),Math.max(t[1],t[3]));return o>l?null:[n,o,s,l]}static pointBoundingBox(e,t,n){n[0]=Math.min(n[0],e),n[1]=Math.min(n[1],t),n[2]=Math.max(n[2],e),n[3]=Math.max(n[3],t)}static rectBoundingBox(e,t,n,s,o){o[0]=Math.min(o[0],e,n),o[1]=Math.min(o[1],t,s),o[2]=Math.max(o[2],e,n),o[3]=Math.max(o[3],t,s)}static#e(e,t,n,s,o,l,c,h,f,p){if(f<=0||f>=1)return;const g=1-f,y=f*f,w=y*f,b=g*(g*(g*e+3*f*t)+3*y*n)+w*s,_=g*(g*(g*o+3*f*l)+3*y*c)+w*h;p[0]=Math.min(p[0],b),p[1]=Math.min(p[1],_),p[2]=Math.max(p[2],b),p[3]=Math.max(p[3],_)}static#t(e,t,n,s,o,l,c,h,f,p,g,y){if(Math.abs(f)<1e-12){Math.abs(p)>=1e-12&&this.#e(e,t,n,s,o,l,c,h,-g/p,y);return}const w=p**2-4*g*f;if(w<0)return;const b=Math.sqrt(w),_=2*f;this.#e(e,t,n,s,o,l,c,h,(-p+b)/_,y),this.#e(e,t,n,s,o,l,c,h,(-p-b)/_,y)}static bezierBoundingBox(e,t,n,s,o,l,c,h,f){f[0]=Math.min(f[0],e,c),f[1]=Math.min(f[1],t,h),f[2]=Math.max(f[2],e,c),f[3]=Math.max(f[3],t,h),this.#t(e,n,o,c,t,s,l,h,3*(-e+3*(n-o)+c),6*(e-2*n+o),3*(n-e),f),this.#t(e,n,o,c,t,s,l,h,3*(-t+3*(s-l)+h),6*(t-2*s+l),3*(s-t),f)}}function y1(a){return decodeURIComponent(escape(a))}let Ju=null,Yg=null;function zy(a){return Ju||(Ju=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Yg=new Map([["","t"]])),a.replaceAll(Ju,(e,t,n)=>t?t.normalize("NFKC"):Yg.get(n))}function Qh(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const a=new Uint8Array(32);return crypto.getRandomValues(a),Hy(a)}const Jh="pdfjs_internal_id_";function v1(a,e,t){if(!Array.isArray(t)||t.length<2)return!1;const[n,s,...o]=t;if(!a(n)&&!Number.isInteger(n)||!e(s))return!1;const l=o.length;let c=!0;switch(s.name){case"XYZ":if(l<2||l>3)return!1;break;case"Fit":case"FitB":return l===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(l>1)return!1;break;case"FitR":if(l!==4)return!1;c=!1;break;default:return!1}for(const h of o)if(!(typeof h=="number"||c&&h===null))return!1;return!0}function At(a,e,t){return Math.min(Math.max(a,e),t)}function $y(a){return Uint8Array.prototype.toBase64?a.toBase64():btoa(Hy(a))}function w1(a){return Uint8Array.fromBase64?Uint8Array.fromBase64(a):Ro(atob(a))}typeof Promise.try!="function"&&(Promise.try=function(a,...e){return new Promise(t=>{t(a(...e))})});typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(a){return a.reduce((e,t)=>e+t,0)});class yo{static textContent(e){const t=[],n={items:t,styles:Object.create(null)};function s(o){if(!o)return;let l=null;const c=o.name;if(c==="#text")l=o.value;else if(yo.shouldBuildText(c))o?.attributes?.textContent?l=o.attributes.textContent:o.value&&(l=o.value);else return;if(l!==null&&t.push({str:l}),!!o.children)for(const h of o.children)s(h)}return s(e),n}static shouldBuildText(e){return!(e==="textarea"||e==="input"||e==="option"||e==="select")}}class Zh{static setupStorage(e,t,n,s,o){const l=s.getValue(t,{value:null});switch(n.name){case"textarea":if(l.value!==null&&(e.textContent=l.value),o==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})});break;case"input":if(n.attributes.type==="radio"||n.attributes.type==="checkbox"){if(l.value===n.attributes.xfaOn?e.setAttribute("checked",!0):l.value===n.attributes.xfaOff&&e.removeAttribute("checked"),o==="print")break;e.addEventListener("change",c=>{s.setValue(t,{value:c.target.checked?c.target.getAttribute("xfaOn"):c.target.getAttribute("xfaOff")})})}else{if(l.value!==null&&e.setAttribute("value",l.value),o==="print")break;e.addEventListener("input",c=>{s.setValue(t,{value:c.target.value})})}break;case"select":if(l.value!==null){e.setAttribute("value",l.value);for(const c of n.children)c.attributes.value===l.value?c.attributes.selected=!0:c.attributes.hasOwnProperty("selected")&&delete c.attributes.selected}e.addEventListener("input",c=>{const h=c.target.options,f=h.selectedIndex===-1?"":h[h.selectedIndex].value;s.setValue(t,{value:f})});break}}static setAttributes({html:e,element:t,storage:n=null,intent:s,linkService:o}){const{attributes:l}=t,c=e instanceof HTMLAnchorElement;l.type==="radio"&&(l.name=`${l.name}-${s}`);for(const[h,f]of Object.entries(l))if(f!=null)switch(h){case"class":f.length&&e.setAttribute(h,f.join(" "));break;case"dataId":break;case"id":e.setAttribute("data-element-id",f);break;case"style":Object.assign(e.style,f);break;case"textContent":e.textContent=f;break;default:(!c||h!=="href"&&h!=="newWindow")&&e.setAttribute(h,f)}c&&o.addLinkAttributes(e,l.href,l.newWindow),n&&l.dataId&&this.setupStorage(e,l.dataId,t,n)}static render(e){const t=e.annotationStorage,n=e.linkService,s=e.xfaHtml,o=e.intent||"display",l=document.createElement(s.name);s.attributes&&this.setAttributes({html:l,element:s,intent:o,linkService:n});const c=o!=="richText",h=e.div;if(h.append(l),e.viewport){const g=`matrix(${e.viewport.transform.join(",")})`;h.style.transform=g}c&&h.setAttribute("class","xfaLayer xfaFont");const f=[];if(s.children.length===0){if(s.value){const g=document.createTextNode(s.value);l.append(g),c&&yo.shouldBuildText(s.name)&&f.push(g)}return{textDivs:f}}const p=[[s,-1,l]];for(;p.length>0;){const[g,y,w]=p.at(-1);if(y+1===g.children.length){p.pop();continue}const b=g.children[++p.at(-1)[1]];if(b===null)continue;const{name:_}=b;if(_==="#text"){const E=document.createTextNode(b.value);f.push(E),w.append(E);continue}const A=b?.attributes?.xmlns?document.createElementNS(b.attributes.xmlns,_):document.createElement(_);if(w.append(A),b.attributes&&this.setAttributes({html:A,element:b,storage:t,intent:o,linkService:n}),b.children?.length>0)p.push([b,-1,A]);else if(b.value){const E=document.createTextNode(b.value);c&&yo.shouldBuildText(_)&&f.push(E),A.append(E)}}for(const g of h.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))g.setAttribute("readOnly",!0);return{textDivs:f}}static update(e){const t=`matrix(${e.viewport.transform.join(",")})`;e.div.style.transform=t,e.div.hidden=!1}}const Qn="http://www.w3.org/2000/svg";class us{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function hr(a,e="text"){if(io(a,document.baseURI)){const t=await fetch(a);if(!t.ok)throw new Error(t.statusText);switch(e){case"arraybuffer":return t.arrayBuffer();case"blob":return t.blob();case"json":return t.json()}return t.text()}return new Promise((t,n)=>{const s=new XMLHttpRequest;s.open("GET",a,!0),s.responseType=e,s.onreadystatechange=()=>{if(s.readyState===XMLHttpRequest.DONE){if(s.status===200||s.status===0){switch(e){case"arraybuffer":case"blob":case"json":t(s.response);return}t(s.responseText);return}n(new Error(s.statusText))}},s.send(null)})}class Io{constructor({viewBox:e,userUnit:t,scale:n,rotation:s,offsetX:o=0,offsetY:l=0,dontFlip:c=!1}){this.viewBox=e,this.userUnit=t,this.scale=n,this.rotation=s,this.offsetX=o,this.offsetY=l,n*=t;const h=(e[2]+e[0])/2,f=(e[3]+e[1])/2;let p,g,y,w;switch(s%=360,s<0&&(s+=360),s){case 180:p=-1,g=0,y=0,w=1;break;case 90:p=0,g=1,y=1,w=0;break;case 270:p=0,g=-1,y=-1,w=0;break;case 0:p=1,g=0,y=0,w=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}c&&(y=-y,w=-w);let b,_,A,E;p===0?(b=Math.abs(f-e[1])*n+o,_=Math.abs(h-e[0])*n+l,A=(e[3]-e[1])*n,E=(e[2]-e[0])*n):(b=Math.abs(h-e[0])*n+o,_=Math.abs(f-e[1])*n+l,A=(e[2]-e[0])*n,E=(e[3]-e[1])*n),this.transform=[p*n,g*n,y*n,w*n,b-p*n*h-y*n*f,_-g*n*h-w*n*f],this.width=A,this.height=E}get rawDims(){const e=this.viewBox;return Ee(this,"rawDims",{pageWidth:e[2]-e[0],pageHeight:e[3]-e[1],pageX:e[0],pageY:e[1]})}clone({scale:e=this.scale,rotation:t=this.rotation,offsetX:n=this.offsetX,offsetY:s=this.offsetY,dontFlip:o=!1}={}){return new Io({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:o})}convertToViewportPoint(e,t){const n=[e,t];return re.applyTransform(n,this.transform),n}convertToViewportRectangle(e){const t=[e[0],e[1]];re.applyTransform(t,this.transform);const n=[e[2],e[3]];return re.applyTransform(n,this.transform),[t[0],t[1],n[0],n[1]]}convertToPdfPoint(e,t){const n=[e,t];return re.applyInverseTransform(n,this.transform),n}}class Bl extends fs{constructor(e,t=0){super(e,"RenderingCancelledException"),this.extraDelay=t}}function Lo(a){const e=a.length;let t=0;for(;t<e&&a[t].trim()==="";)t++;return a.substring(t,t+5).toLowerCase()==="data:"}function Ul(a){return typeof a=="string"&&/\.pdf$/i.test(a)}function Vy(a){return[a]=a.split(/[#?]/,1),a.substring(a.lastIndexOf("/")+1)}function Wy(a,e="document.pdf"){if(typeof a!="string")return e;if(Lo(a))return Ae('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),e;const n=(c=>{try{return new URL(c)}catch{try{return new URL(decodeURIComponent(c))}catch{try{return new URL(c,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(c),"https://foo.bar")}catch{return null}}}}})(a);if(!n)return e;const s=c=>{try{let h=decodeURIComponent(c);return h.includes("/")?(h=h.split("/").at(-1),h.test(/^\.pdf$/i)?h:c):h}catch{return c}},o=/\.pdf$/i,l=n.pathname.split("/").at(-1);if(o.test(l))return s(l);if(n.searchParams.size>0){const c=Array.from(n.searchParams.values()).reverse();for(const f of c)if(o.test(f))return s(f);const h=Array.from(n.searchParams.keys()).reverse();for(const f of h)if(o.test(f))return s(f)}if(n.hash){const h=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(n.hash);if(h)return s(h[0])}return e}class Qg{started=Object.create(null);times=[];time(e){e in this.started&&Ae(`Timer is already running for ${e}`),this.started[e]=Date.now()}timeEnd(e){e in this.started||Ae(`Timer has not been started for ${e}`),this.times.push({name:e,start:this.started[e],end:Date.now()}),delete this.started[e]}toString(){const e=[];let t=0;for(const{name:n}of this.times)t=Math.max(n.length,t);for(const{name:n,start:s,end:o}of this.times)e.push(`${n.padEnd(t)} ${o-s}ms
`);return e.join("")}}function io(a,e){const t=e?URL.parse(a,e):URL.parse(a);return t?.protocol==="http:"||t?.protocol==="https:"}function qt(a){a.preventDefault()}function Ye(a){a.preventDefault(),a.stopPropagation()}function _1(a){console.log("Deprecated API usage: "+a)}class Cl{static#e;static toDateObject(e){if(e instanceof Date)return e;if(!e||typeof e!="string")return null;this.#e||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const t=this.#e.exec(e);if(!t)return null;const n=parseInt(t[1],10);let s=parseInt(t[2],10);s=s>=1&&s<=12?s-1:0;let o=parseInt(t[3],10);o=o>=1&&o<=31?o:1;let l=parseInt(t[4],10);l=l>=0&&l<=23?l:0;let c=parseInt(t[5],10);c=c>=0&&c<=59?c:0;let h=parseInt(t[6],10);h=h>=0&&h<=59?h:0;const f=t[7]||"Z";let p=parseInt(t[8],10);p=p>=0&&p<=23?p:0;let g=parseInt(t[9],10)||0;return g=g>=0&&g<=59?g:0,f==="-"?(l+=p,c+=g):f==="+"&&(l-=p,c-=g),new Date(Date.UTC(n,s,o,l,c,h))}}function Gy(a,{scale:e=1,rotation:t=0}){const{width:n,height:s}=a.attributes.style,o=[0,0,parseInt(n),parseInt(s)];return new Io({viewBox:o,userUnit:1,scale:e,rotation:t})}function dr(a){if(a.startsWith("#")){const e=parseInt(a.slice(1),16);return[(e&16711680)>>16,(e&65280)>>8,e&255]}return a.startsWith("rgb(")?a.slice(4,-1).split(",").map(e=>parseInt(e)):a.startsWith("rgba(")?a.slice(5,-1).split(",").map(e=>parseInt(e)).slice(0,3):(Ae(`Not a valid color format: "${a}"`),[0,0,0])}function b1(a){const e=document.createElement("span");e.style.visibility="hidden",e.style.colorScheme="only light",document.body.append(e);for(const t of a.keys()){e.style.color=t;const n=window.getComputedStyle(e).color;a.set(t,dr(n))}e.remove()}function Ke(a){const{a:e,b:t,c:n,d:s,e:o,f:l}=a.getTransform();return[e,t,n,s,o,l]}function Ln(a){const{a:e,b:t,c:n,d:s,e:o,f:l}=a.getTransform().invertSelf();return[e,t,n,s,o,l]}function Oi(a,e,t=!1,n=!0){if(e instanceof Io){const{pageWidth:s,pageHeight:o}=e.rawDims,{style:l}=a,c=pt.isCSSRoundSupported,h=`var(--total-scale-factor) * ${s}px`,f=`var(--total-scale-factor) * ${o}px`,p=c?`round(down, ${h}, var(--scale-round-x))`:`calc(${h})`,g=c?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!t||e.rotation%180===0?(l.width=p,l.height=g):(l.width=g,l.height=p)}n&&a.setAttribute("data-main-rotation",e.rotation)}class An{constructor(){const{pixelRatio:e}=An;this.sx=e,this.sy=e}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(e,t,n,s,o=-1){let l=1/0,c=1/0,h=1/0;n=An.capPixels(n,o),n>0&&(l=Math.sqrt(n/(e*t))),s!==-1&&(c=s/e,h=s/t);const f=Math.min(l,c,h);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(e,t){if(t>=0){const n=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+t/100));return e>0?Math.min(e,n):n}return e}}const Tl=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class S1{static get isDarkMode(){return Ee(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class qy{static get commentForegroundColor(){const e=document.createElement("span");e.classList.add("comment","sidebar");const{style:t}=e;t.width=t.height="0",t.display="none",t.color="var(--comment-fg-color)",document.body.append(e);const{color:n}=window.getComputedStyle(e);return e.remove(),Ee(this,"commentForegroundColor",dr(n))}}function Xy(a,e,t,n){n=Math.min(Math.max(n??1,0),1);const s=255*(1-n);return a=Math.round(a*n+s),e=Math.round(e*n+s),t=Math.round(t*n+s),[a,e,t]}function Jg(a,e){const t=a[0]/255,n=a[1]/255,s=a[2]/255,o=Math.max(t,n,s),l=Math.min(t,n,s),c=(o+l)/2;if(o===l)e[0]=e[1]=0;else{const h=o-l;switch(e[1]=c<.5?h/(o+l):h/(2-o-l),o){case t:e[0]=((n-s)/h+(n<s?6:0))*60;break;case n:e[0]=((s-t)/h+2)*60;break;case s:e[0]=((t-n)/h+4)*60;break}}e[2]=c}function mh(a,e){const t=a[0],n=a[1],s=a[2],o=(1-Math.abs(2*s-1))*n,l=o*(1-Math.abs(t/60%2-1)),c=s-o/2;switch(Math.floor(t/60)){case 0:e[0]=o+c,e[1]=l+c,e[2]=c;break;case 1:e[0]=l+c,e[1]=o+c,e[2]=c;break;case 2:e[0]=c,e[1]=o+c,e[2]=l+c;break;case 3:e[0]=c,e[1]=l+c,e[2]=o+c;break;case 4:e[0]=l+c,e[1]=c,e[2]=o+c;break;case 5:case 6:e[0]=o+c,e[1]=c,e[2]=l+c;break}}function Zg(a){return a<=.03928?a/12.92:((a+.055)/1.055)**2.4}function em(a,e,t){mh(a,t),t.map(Zg);const n=.2126*t[0]+.7152*t[1]+.0722*t[2];mh(e,t),t.map(Zg);const s=.2126*t[0]+.7152*t[1]+.0722*t[2];return n>s?(n+.05)/(s+.05):(s+.05)/(n+.05)}const tm=new Map;function Ky(a,e){const t=a[0]+a[1]*256+a[2]*65536+e[0]*16777216+e[1]*4294967296+e[2]*1099511627776;let n=tm.get(t);if(n)return n;const s=new Float32Array(9),o=s.subarray(0,3),l=s.subarray(3,6);Jg(a,l);const c=s.subarray(6,9);Jg(e,c);const h=c[2]<.5,f=h?12:4.5;if(l[2]=h?Math.sqrt(l[2]):1-Math.sqrt(1-l[2]),em(l,c,o)<f){let p,g;h?(p=l[2],g=1):(p=0,g=l[2]);const y=.005;for(;g-p>y;){const w=l[2]=(p+g)/2;h===em(l,c,o)<f?p=w:g=w}l[2]=h?g:p}return mh(l,o),n=re.makeHexColor(Math.round(o[0]*255),Math.round(o[1]*255),Math.round(o[2]*255)),tm.set(t,n),n}function ed({html:a,dir:e,className:t},n){const s=document.createDocumentFragment();if(typeof a=="string"){const o=document.createElement("p");o.dir=e||"auto";const l=a.split(/(?:\r\n?|\n)/);for(let c=0,h=l.length;c<h;++c){const f=l[c];o.append(document.createTextNode(f)),c<h-1&&o.append(document.createElement("br"))}s.append(o)}else Zh.render({xfaHtml:a,div:s,intent:"richText"});s.firstChild.classList.add("richText",t),n.append(s)}class co{#e=null;#t=null;#i;#n=null;#o=null;#s=null;#r=null;#a=null;static#c=null;constructor(e){this.#i=e,co.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const e=this.#e=document.createElement("div");e.classList.add("editToolbar","hidden"),e.setAttribute("role","toolbar");const t=this.#i._uiManager._signal;t instanceof AbortSignal&&!t.aborted&&(e.addEventListener("contextmenu",qt,{signal:t}),e.addEventListener("pointerdown",co.#l,{signal:t}));const n=this.#n=document.createElement("div");n.className="buttons",e.append(n);const s=this.#i.toolbarPosition;if(s){const{style:o}=e,l=this.#i._uiManager.direction==="ltr"?1-s[0]:s[0];o.insetInlineEnd=`${100*l}%`,o.top=`calc(${100*s[1]}% + var(--editor-toolbar-vert-offset))`}return e}get div(){return this.#e}static#l(e){e.stopPropagation()}#d(e){this.#i._focusEventsAllowed=!1,Ye(e)}#h(e){this.#i._focusEventsAllowed=!0,Ye(e)}#f(e){const t=this.#i._uiManager._signal;return!(t instanceof AbortSignal)||t.aborted?!1:(e.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:t}),e.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:t}),e.addEventListener("contextmenu",qt,{signal:t}),!0)}hide(){this.#e.classList.add("hidden"),this.#t?.hideDropdown()}show(){this.#e.classList.remove("hidden"),this.#o?.shown(),this.#s?.shown()}addDeleteButton(){const{editorType:e,_uiManager:t}=this.#i,n=document.createElement("button");n.classList.add("basic","deleteButton"),n.tabIndex=0,n.setAttribute("data-l10n-id",co.#c[e]),this.#f(n)&&n.addEventListener("click",s=>{t.delete()},{signal:t._signal}),this.#n.append(n)}get#m(){const e=document.createElement("div");return e.className="divider",e}async addAltText(e){const t=await e.render();this.#f(t),this.#n.append(t,this.#m),this.#o=e}addComment(e,t=null){if(this.#s)return;const n=e.renderForToolbar();if(!n)return;this.#f(n);const s=this.#r=this.#m;t?(this.#n.insertBefore(n,t),this.#n.insertBefore(s,t)):this.#n.append(n,s),this.#s=e,e.toolbar=this}addColorPicker(e){if(this.#t)return;this.#t=e;const t=e.renderButton();this.#f(t),this.#n.append(t,this.#m)}async addEditSignatureButton(e){const t=this.#a=await e.renderEditButton(this.#i);this.#f(t),this.#n.append(t,this.#m)}removeButton(e){switch(e){case"comment":this.#s?.removeToolbarCommentButton(),this.#s=null,this.#r?.remove(),this.#r=null;break}}async addButton(e,t){switch(e){case"colorPicker":this.addColorPicker(t);break;case"altText":await this.addAltText(t);break;case"editSignature":await this.addEditSignatureButton(t);break;case"delete":this.addDeleteButton();break;case"comment":this.addComment(t);break}}async addButtonBefore(e,t,n){const s=this.#n.querySelector(n);s&&e==="comment"&&this.addComment(t,s)}updateEditSignatureButton(e){this.#a&&(this.#a.title=e)}remove(){this.#e.remove(),this.#t?.destroy(),this.#t=null}}class A1{#e=null;#t=null;#i;constructor(e){this.#i=e}#n(){const e=this.#t=document.createElement("div");e.className="editToolbar",e.setAttribute("role","toolbar");const t=this.#i._signal;t instanceof AbortSignal&&!t.aborted&&e.addEventListener("contextmenu",qt,{signal:t});const n=this.#e=document.createElement("div");return n.className="buttons",e.append(n),this.#i.hasCommentManager()&&this.#s("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#i.commentSelection("floating_button")}),this.#s("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#i.highlightSelection("floating_button")}),e}#o(e,t){let n=0,s=0;for(const o of e){const l=o.y+o.height;if(l<n)continue;const c=o.x+(t?o.width:0);if(l>n){s=c,n=l;continue}t?c>s&&(s=c):c<s&&(s=c)}return[t?1-s:s,n]}show(e,t,n){const[s,o]=this.#o(t,n),{style:l}=this.#t||=this.#n();e.append(this.#t),l.insetInlineEnd=`${100*s}%`,l.top=`calc(${100*o}% + var(--editor-toolbar-vert-offset))`}hide(){this.#t.remove()}#s(e,t,n,s){const o=document.createElement("button");o.classList.add("basic",e),o.tabIndex=0,o.setAttribute("data-l10n-id",t);const l=document.createElement("span");o.append(l),l.className="visuallyHidden",l.setAttribute("data-l10n-id",n);const c=this.#i._signal;c instanceof AbortSignal&&!c.aborted&&(o.addEventListener("contextmenu",qt,{signal:c}),o.addEventListener("click",s,{signal:c})),this.#e.append(o)}}function Yy(a,e,t){for(const n of t)e.addEventListener(n,a[n].bind(a))}class E1{#e=0;get id(){return`${go}${this.#e++}`}}class td{#e=Qh();#t=0;#i=null;static get _isSVGFittingCanvas(){const e='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',n=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),s=new Image;s.src=e;const o=s.decode().then(()=>(n.drawImage(s,0,0,1,1,0,0,1,3),new Uint32Array(n.getImageData(0,0,1,1).data.buffer)[0]===0));return Ee(this,"_isSVGFittingCanvas",o)}async#n(e,t){this.#i||=new Map;let n=this.#i.get(e);if(n===null)return null;if(n?.bitmap)return n.refCounter+=1,n;try{n||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let s;if(typeof t=="string"?(n.url=t,s=await hr(t,"blob")):t instanceof File?s=n.file=t:t instanceof Blob&&(s=t),s.type==="image/svg+xml"){const o=td._isSVGFittingCanvas,l=new FileReader,c=new Image,h=new Promise((f,p)=>{c.onload=()=>{n.bitmap=c,n.isSvg=!0,f()},l.onload=async()=>{const g=n.svgUrl=l.result;c.src=await o?`${g}#svgView(preserveAspectRatio(none))`:g},c.onerror=l.onerror=p});l.readAsDataURL(s),await h}else n.bitmap=await createImageBitmap(s);n.refCounter=1}catch(s){Ae(s),n=null}return this.#i.set(e,n),n&&this.#i.set(n.id,n),n}async getFromFile(e){const{lastModified:t,name:n,size:s,type:o}=e;return this.#n(`${t}_${n}_${s}_${o}`,e)}async getFromUrl(e){return this.#n(e,e)}async getFromBlob(e,t){const n=await t;return this.#n(e,n)}async getFromId(e){this.#i||=new Map;const t=this.#i.get(e);if(!t)return null;if(t.bitmap)return t.refCounter+=1,t;if(t.file)return this.getFromFile(t.file);if(t.blobPromise){const{blobPromise:n}=t;return delete t.blobPromise,this.getFromBlob(t.id,n)}return this.getFromUrl(t.url)}getFromCanvas(e,t){this.#i||=new Map;let n=this.#i.get(e);if(n?.bitmap)return n.refCounter+=1,n;const s=new OffscreenCanvas(t.width,t.height);return s.getContext("2d").drawImage(t,0,0),n={bitmap:s.transferToImageBitmap(),id:`image_${this.#e}_${this.#t++}`,refCounter:1,isSvg:!1},this.#i.set(e,n),this.#i.set(n.id,n),n}getSvgUrl(e){const t=this.#i.get(e);return t?.isSvg?t.svgUrl:null}deleteId(e){this.#i||=new Map;const t=this.#i.get(e);if(!t||(t.refCounter-=1,t.refCounter!==0))return;const{bitmap:n}=t;if(!t.url&&!t.file){const s=new OffscreenCanvas(n.width,n.height);s.getContext("bitmaprenderer").transferFromImageBitmap(n),t.blobPromise=s.convertToBlob()}n.close?.(),t.bitmap=null}isValidId(e){return e.startsWith(`image_${this.#e}_`)}}class C1{#e=[];#t=!1;#i;#n=-1;constructor(e=128){this.#i=e}add({cmd:e,undo:t,post:n,mustExec:s,type:o=NaN,overwriteIfSameType:l=!1,keepUndo:c=!1}){if(s&&e(),this.#t)return;const h={cmd:e,undo:t,post:n,type:o};if(this.#n===-1){this.#e.length>0&&(this.#e.length=0),this.#n=0,this.#e.push(h);return}if(l&&this.#e[this.#n].type===o){c&&(h.undo=this.#e[this.#n].undo),this.#e[this.#n]=h;return}const f=this.#n+1;f===this.#i?this.#e.splice(0,1):(this.#n=f,f<this.#e.length&&this.#e.splice(f)),this.#e.push(h)}undo(){if(this.#n===-1)return;this.#t=!0;const{undo:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1,this.#n-=1}redo(){if(this.#n<this.#e.length-1){this.#n+=1,this.#t=!0;const{cmd:e,post:t}=this.#e[this.#n];e(),t?.(),this.#t=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#e.length-1}cleanType(e){if(this.#n!==-1){for(let t=this.#n;t>=0;t--)if(this.#e[t].type!==e){this.#e.splice(t+1,this.#n-t),this.#n=t;return}this.#e.length=0,this.#n=-1}}destroy(){this.#e=null}}class Do{constructor(e){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:t}=pt.platform;for(const[n,s,o={}]of e)for(const l of n){const c=l.startsWith("mac+");t&&c?(this.callbacks.set(l.slice(4),{callback:s,options:o}),this.allKeys.add(l.split("+").at(-1))):!t&&!c&&(this.callbacks.set(l,{callback:s,options:o}),this.allKeys.add(l.split("+").at(-1)))}}#e(e){e.altKey&&this.buffer.push("alt"),e.ctrlKey&&this.buffer.push("ctrl"),e.metaKey&&this.buffer.push("meta"),e.shiftKey&&this.buffer.push("shift"),this.buffer.push(e.key);const t=this.buffer.join("+");return this.buffer.length=0,t}exec(e,t){if(!this.allKeys.has(t.key))return;const n=this.callbacks.get(this.#e(t));if(!n)return;const{callback:s,options:{bubbles:o=!1,args:l=[],checker:c=null}}=n;c&&!c(e,t)||(s.bind(e,...l,t)(),o||Ye(t))}}class nd{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const e=new Map([["CanvasText",null],["Canvas",null]]);return b1(e),Ee(this,"_colors",e)}convert(e){const t=dr(e);if(!window.matchMedia("(forced-colors: active)").matches)return t;for(const[n,s]of this._colors)if(s.every((o,l)=>o===t[l]))return nd._colorsMapping.get(n);return t}getHexCode(e){const t=this._colors.get(e);return t?re.makeHexColor(...t):e}}class ai{#e=new AbortController;#t=null;#i=null;#n=new Map;#o=new Map;#s=null;#r=null;#a=null;#c=new C1;#l=null;#d=null;#h=null;#f=0;#m=new Set;#p=null;#u=null;#g=new Set;_editorUndoBar=null;#y=!1;#w=!1;#v=!1;#C=null;#A=null;#_=null;#x=null;#S=!1;#E=null;#R=new E1;#k=!1;#P=!1;#F=!1;#L=null;#M=null;#B=null;#N=null;#V=null;#T=Se.NONE;#b=new Set;#D=null;#U=null;#H=null;#q=null;#G=null;#X={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#z=[0,0];#O=null;#W=null;#J=null;#Z=null;#j=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const e=ai.prototype,t=l=>l.#W.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&l.hasSomethingToControl(),n=(l,{target:c})=>{if(c instanceof HTMLInputElement){const{type:h}=c;return h!=="text"&&h!=="number"}return!0},s=this.TRANSLATE_SMALL,o=this.TRANSLATE_BIG;return Ee(this,"_keyboardManager",new Do([[["ctrl+a","mac+meta+a"],e.selectAll,{checker:n}],[["ctrl+z","mac+meta+z"],e.undo,{checker:n}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],e.redo,{checker:n}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],e.delete,{checker:n}],[["Enter","mac+Enter"],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&l.#W.contains(c)&&!l.isEnterHandled}],[[" ","mac+ "],e.addNewEditorFromKeyboard,{checker:(l,{target:c})=>!(c instanceof HTMLButtonElement)&&l.#W.contains(document.activeElement)}],[["Escape","mac+Escape"],e.unselectAll],[["ArrowLeft","mac+ArrowLeft"],e.translateSelectedEditors,{args:[-s,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e.translateSelectedEditors,{args:[-o,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e.translateSelectedEditors,{args:[s,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e.translateSelectedEditors,{args:[o,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e.translateSelectedEditors,{args:[0,-s],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e.translateSelectedEditors,{args:[0,-o],checker:t}],[["ArrowDown","mac+ArrowDown"],e.translateSelectedEditors,{args:[0,s],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e.translateSelectedEditors,{args:[0,o],checker:t}]]))}constructor(e,t,n,s,o,l,c,h,f,p,g,y,w,b,_,A){const E=this._signal=this.#e.signal;this.#W=e,this.#J=t,this.#Z=n,this.#s=s,this.#l=o,this.#U=l,this.#G=h,this._eventBus=c,c._on("editingaction",this.onEditingAction.bind(this),{signal:E}),c._on("pagechanging",this.onPageChanging.bind(this),{signal:E}),c._on("scalechanging",this.onScaleChanging.bind(this),{signal:E}),c._on("rotationchanging",this.onRotationChanging.bind(this),{signal:E}),c._on("setpreference",this.onSetPreference.bind(this),{signal:E}),c._on("switchannotationeditorparams",C=>this.updateParams(C.type,C.value),{signal:E}),window.addEventListener("pointerdown",()=>{this.#P=!0},{capture:!0,signal:E}),window.addEventListener("pointerup",()=>{this.#P=!1},{capture:!0,signal:E}),this.#le(),this.#de(),this.#te(),this.#r=h.annotationStorage,this.#C=h.filterFactory,this.#H=f,this.#x=p||null,this.#y=g,this.#w=y,this.#v=w,this.#V=b||null,this.viewParameters={realScale:us.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=_||null,this._supportsPinchToZoom=A!==!1,o?.setSidebarUiManager(this)}destroy(){this.#j?.resolve(),this.#j=null,this.#e?.abort(),this.#e=null,this._signal=null;for(const e of this.#o.values())e.destroy();this.#o.clear(),this.#n.clear(),this.#g.clear(),this.#N?.clear(),this.#t=null,this.#b.clear(),this.#c.destroy(),this.#s?.destroy(),this.#l?.destroy(),this.#U?.destroy(),this.#E?.hide(),this.#E=null,this.#B?.destroy(),this.#B=null,this.#i=null,this.#A&&(clearTimeout(this.#A),this.#A=null),this.#O&&(clearTimeout(this.#O),this.#O=null),this._editorUndoBar?.destroy(),this.#G=null}combinedSignal(e){return AbortSignal.any([this._signal,e.signal])}get mlManager(){return this.#V}get useNewAltTextFlow(){return this.#w}get useNewAltTextWhenAddingImage(){return this.#v}get hcmFilter(){return Ee(this,"hcmFilter",this.#H?this.#C.addHCMFilter(this.#H.foreground,this.#H.background):"none")}get direction(){return Ee(this,"direction",getComputedStyle(this.#W).direction)}get _highlightColors(){return Ee(this,"_highlightColors",this.#x?new Map(this.#x.split(",").map(e=>(e=e.split("=").map(t=>t.trim()),e[1]=e[1].toUpperCase(),e))):null)}get highlightColors(){const{_highlightColors:e}=this;if(!e)return Ee(this,"highlightColors",null);const t=new Map,n=!!this.#H;for(const[s,o]of e){const l=s.endsWith("_HCM");if(n&&l){t.set(s.replace("_HCM",""),o);continue}!n&&!l&&t.set(s,o)}return Ee(this,"highlightColors",t)}get highlightColorNames(){return Ee(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,e=>e.reverse())):null)}getNonHCMColor(e){if(!this._highlightColors)return e;const t=this.highlightColorNames.get(e);return this._highlightColors.get(t)||e}getNonHCMColorName(e){return this.highlightColorNames.get(e)||e}setCurrentDrawingSession(e){e?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=e}setMainHighlightColorPicker(e){this.#B=e}editAltText(e,t=!1){this.#s?.editAltText(this,e,t)}hasCommentManager(){return!!this.#l}editComment(e,t,n,s){this.#l?.showDialog(this,e,t,n,s)}selectComment(e,t){this.#o.get(e)?.getEditorByUID(t)?.toggleComment(!0,!0)}updateComment(e){this.#l?.updateComment(e.getData())}updatePopupColor(e){this.#l?.updatePopupColor(e)}removeComment(e){this.#l?.removeComments([e.uid])}toggleComment(e,t,n=void 0){this.#l?.toggleCommentPopup(e,t,n)}makeCommentColor(e,t){return e&&this.#l?.makeCommentColor(e,t)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(e){if(this.#o.has(e-1))return;const{resolve:t,promise:n}=Promise.withResolvers(),s=o=>{o.pageNumber===e&&(this._eventBus._off("editorsrendered",s),t())};this._eventBus.on("editorsrendered",s),await n}getSignature(e){this.#U?.getSignature({uiManager:this,editor:e})}get signatureManager(){return this.#U}switchToMode(e,t){this._eventBus.on("annotationeditormodechanged",t,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:e})}setPreference(e,t){this._eventBus.dispatch("setpreference",{source:this,name:e,value:t})}onSetPreference({name:e,value:t}){switch(e){case"enableNewAltTextWhenAddingImage":this.#v=t;break}}onPageChanging({pageNumber:e}){this.#f=e-1}focusMainContainer(){this.#W.focus()}findParent(e,t){for(const n of this.#o.values()){const{x:s,y:o,width:l,height:c}=n.div.getBoundingClientRect();if(e>=s&&e<=s+l&&t>=o&&t<=o+c)return n}return null}disableUserSelect(e=!1){this.#J.classList.toggle("noUserSelect",e)}addShouldRescale(e){this.#g.add(e)}removeShouldRescale(e){this.#g.delete(e)}onScaleChanging({scale:e}){this.commitOrRemove(),this.viewParameters.realScale=e*us.PDF_TO_CSS_UNITS;for(const t of this.#g)t.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:e}){this.commitOrRemove(),this.viewParameters.rotation=e}#Q({anchorNode:e}){return e.nodeType===Node.TEXT_NODE?e.parentElement:e}#ee(e){const{currentLayer:t}=this;if(t.hasTextLayer(e))return t;for(const n of this.#o.values())if(n.hasTextLayer(e))return n;return null}highlightSelection(e="",t=!1){const n=document.getSelection();if(!n||n.isCollapsed)return;const{anchorNode:s,anchorOffset:o,focusNode:l,focusOffset:c}=n,h=n.toString(),p=this.#Q(n).closest(".textLayer"),g=this.getSelectionBoxes(p);if(!g)return;n.empty();const y=this.#ee(p),w=this.#T===Se.NONE,b=()=>{const _=y?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:e,boxes:g,anchorNode:s,anchorOffset:o,focusNode:l,focusOffset:c,text:h});w&&this.showAllEditors("highlight",!0,!0),t&&_?.editComment()};if(w){this.switchToMode(Se.HIGHLIGHT,b);return}b()}commentSelection(e=""){this.highlightSelection(e,!0)}#oe(){const e=document.getSelection();if(!e||e.isCollapsed)return;const n=this.#Q(e).closest(".textLayer"),s=this.getSelectionBoxes(n);s&&(this.#E||=new A1(this),this.#E.show(n,s,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(e){if(!this.#r)return null;const t=`${go}${e}`,n=this.#r.getRawValue(t);return n&&this.#r.remove(t),n}addToAnnotationStorage(e){!e.isEmpty()&&this.#r&&!this.#r.has(e.id)&&this.#r.setValue(e.id,e)}a11yAlert(e,t=null){const n=this.#Z;n&&(n.setAttribute("data-l10n-id",e),t?n.setAttribute("data-l10n-args",JSON.stringify(t)):n.removeAttribute("data-l10n-args"))}#ae(){const e=document.getSelection();if(!e||e.isCollapsed){this.#D&&(this.#E?.hide(),this.#D=null,this.#I({hasSelectedText:!1}));return}const{anchorNode:t}=e;if(t===this.#D)return;const s=this.#Q(e).closest(".textLayer");if(!s){this.#D&&(this.#E?.hide(),this.#D=null,this.#I({hasSelectedText:!1}));return}if(this.#E?.hide(),this.#D=t,this.#I({hasSelectedText:!0}),!(this.#T!==Se.HIGHLIGHT&&this.#T!==Se.NONE)&&(this.#T===Se.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#S=this.isShiftKeyDown,!this.isShiftKeyDown)){const o=this.#T===Se.HIGHLIGHT?this.#ee(s):null;if(o?.toggleDrawing(),this.#P){const l=new AbortController,c=this.combinedSignal(l),h=f=>{f.type==="pointerup"&&f.button!==0||(l.abort(),o?.toggleDrawing(!0),f.type==="pointerup"&&this.#K("main_toolbar"))};window.addEventListener("pointerup",h,{signal:c}),window.addEventListener("blur",h,{signal:c})}else o?.toggleDrawing(!0),this.#K("main_toolbar")}}#K(e=""){this.#T===Se.HIGHLIGHT?this.highlightSelection(e):this.#y&&this.#oe()}#le(){document.addEventListener("selectionchange",this.#ae.bind(this),{signal:this._signal})}#ce(){if(this.#_)return;this.#_=new AbortController;const e=this.combinedSignal(this.#_);window.addEventListener("focus",this.focus.bind(this),{signal:e}),window.addEventListener("blur",this.blur.bind(this),{signal:e})}#ue(){this.#_?.abort(),this.#_=null}blur(){if(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#K("main_toolbar")),!this.hasSelection)return;const{activeElement:e}=document;for(const t of this.#b)if(t.div.contains(e)){this.#M=[t,e],t._focusEventsAllowed=!1;break}}focus(){if(!this.#M)return;const[e,t]=this.#M;this.#M=null,t.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this._signal}),t.focus()}#te(){if(this.#L)return;this.#L=new AbortController;const e=this.combinedSignal(this.#L);window.addEventListener("keydown",this.keydown.bind(this),{signal:e}),window.addEventListener("keyup",this.keyup.bind(this),{signal:e})}#he(){this.#L?.abort(),this.#L=null}#ne(){if(this.#d)return;this.#d=new AbortController;const e=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:e}),document.addEventListener("cut",this.cut.bind(this),{signal:e}),document.addEventListener("paste",this.paste.bind(this),{signal:e})}#ie(){this.#d?.abort(),this.#d=null}#de(){const e=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:e}),document.addEventListener("drop",this.drop.bind(this),{signal:e})}addEditListeners(){this.#te(),this.#ne()}removeEditListeners(){this.#he(),this.#ie()}dragOver(e){for(const{type:t}of e.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(t)){e.dataTransfer.dropEffect="copy",e.preventDefault();return}}drop(e){for(const t of e.dataTransfer.items)for(const n of this.#u)if(n.isHandlingMimeForPasting(t.type)){n.paste(t,this.currentLayer),e.preventDefault();return}}copy(e){if(e.preventDefault(),this.#t?.commitOrRemove(),!this.hasSelection)return;const t=[];for(const n of this.#b){const s=n.serialize(!0);s&&t.push(s)}t.length!==0&&e.clipboardData.setData("application/pdfjs",JSON.stringify(t))}cut(e){this.copy(e),this.delete()}async paste(e){e.preventDefault();const{clipboardData:t}=e;for(const o of t.items)for(const l of this.#u)if(l.isHandlingMimeForPasting(o.type)){l.paste(o,this.currentLayer);return}let n=t.getData("application/pdfjs");if(!n)return;try{n=JSON.parse(n)}catch(o){Ae(`paste: "${o.message}".`);return}if(!Array.isArray(n))return;this.unselectAll();const s=this.currentLayer;try{const o=[];for(const h of n){const f=await s.deserialize(h);if(!f)return;o.push(f)}const l=()=>{for(const h of o)this.#se(h);this.#re(o)},c=()=>{for(const h of o)h.remove()};this.addCommands({cmd:l,undo:c,mustExec:!0})}catch(o){Ae(`paste: "${o.message}".`)}}keydown(e){!this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==Se.NONE&&!this.isEditorHandlingKeyboard&&ai._keyboardManager.exec(this,e)}keyup(e){this.isShiftKeyDown&&e.key==="Shift"&&(this.isShiftKeyDown=!1,this.#S&&(this.#S=!1,this.#K("main_toolbar")))}onEditingAction({name:e}){switch(e){case"undo":case"redo":case"delete":case"selectAll":this[e]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#I(e){Object.entries(e).some(([n,s])=>this.#X[n]!==s)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#X,e)}),this.#T===Se.HIGHLIGHT&&e.hasSelectedEditor===!1&&this.#$([[Re.HIGHLIGHT_FREE,!0]]))}#$(e){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:e})}setEditingState(e){e?(this.#ce(),this.#ne(),this.#I({isEditing:this.#T!==Se.NONE,isEmpty:this.#Y(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#ue(),this.#ie(),this.#I({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(e){if(!this.#u){this.#u=e;for(const t of this.#u)this.#$(t.defaultPropertiesToUpdate)}}getId(){return this.#R.id}get currentLayer(){return this.#o.get(this.#f)}getLayer(e){return this.#o.get(e)}get currentPageIndex(){return this.#f}addLayer(e){this.#o.set(e.pageIndex,e),this.#k?e.enable():e.disable()}removeLayer(e){this.#o.delete(e.pageIndex)}async updateMode(e,t=null,n=!1,s=!1,o=!1){if(this.#T!==e&&!(this.#j&&(await this.#j.promise,!this.#j))){if(this.#j=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#T===Se.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#T=e,e===Se.NONE){this.setEditingState(!1),this.#pe();for(const l of this.#n.values())l.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#j.resolve();return}for(const l of this.#n.values())l.addStandaloneCommentButton();e===Se.SIGNATURE&&await this.#U?.loadSignatures(),this.setEditingState(!0),await this.#fe(),this.unselectAll();for(const l of this.#o.values())l.updateMode(e);if(e===Se.POPUP){this.#i||=await this.#G.getAnnotationsByType(new Set(this.#u.map(h=>h._editorType)));const l=new Set,c=[];for(const h of this.#n.values()){const{annotationElementId:f,hasComment:p,deleted:g}=h;f&&l.add(f),p&&!g&&c.push(h.getData())}for(const h of this.#i){const{id:f,popupRef:p,contentsObj:g}=h;p&&g?.str&&!l.has(f)&&!this.#m.has(f)&&c.push(h)}this.#l?.showSidebar(c)}if(!t){n&&this.addNewEditorFromKeyboard(),this.#j.resolve();return}for(const l of this.#n.values())l.uid===t?(this.setSelected(l),o?l.editComment():s?l.enterInEditMode():l.focus()):l.unselect();this.#j.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(e){e.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...e})}updateParams(e,t){if(this.#u){switch(e){case Re.CREATE:this.currentLayer.addNewEditor(t);return;case Re.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#q||=new Map).set(e,t),this.showAllEditors("highlight",t);break}if(this.hasSelection)for(const n of this.#b)n.updateParams(e,t);else for(const n of this.#u)n.updateDefaultParams(e,t)}}showAllEditors(e,t,n=!1){for(const o of this.#n.values())o.editorType===e&&o.show(t);(this.#q?.get(Re.HIGHLIGHT_SHOW_ALL)??!0)!==t&&this.#$([[Re.HIGHLIGHT_SHOW_ALL,t]])}enableWaiting(e=!1){if(this.#F!==e){this.#F=e;for(const t of this.#o.values())e?t.disableClick():t.enableClick(),t.div.classList.toggle("waiting",e)}}async#fe(){if(!this.#k){this.#k=!0;const e=[];for(const t of this.#o.values())e.push(t.enable());await Promise.all(e);for(const t of this.#n.values())t.enable()}}#pe(){if(this.unselectAll(),this.#k){this.#k=!1;for(const e of this.#o.values())e.disable();for(const e of this.#n.values())e.disable()}}*getEditors(e){for(const t of this.#n.values())t.pageIndex===e&&(yield t)}getEditor(e){return this.#n.get(e)}addEditor(e){this.#n.set(e.id,e)}removeEditor(e){e.div.contains(document.activeElement)&&(this.#A&&clearTimeout(this.#A),this.#A=setTimeout(()=>{this.focusMainContainer(),this.#A=null},0)),this.#n.delete(e.id),e.annotationElementId&&this.#N?.delete(e.annotationElementId),this.unselect(e),(!e.annotationElementId||!this.#m.has(e.annotationElementId))&&this.#r?.remove(e.id)}addDeletedAnnotationElement(e){this.#m.add(e.annotationElementId),this.addChangedExistingAnnotation(e),e.deleted=!0}isDeletedAnnotationElement(e){return this.#m.has(e)}removeDeletedAnnotationElement(e){this.#m.delete(e.annotationElementId),this.removeChangedExistingAnnotation(e),e.deleted=!1}#se(e){const t=this.#o.get(e.pageIndex);t?t.addOrRebuild(e):(this.addEditor(e),this.addToAnnotationStorage(e))}setActiveEditor(e){this.#t!==e&&(this.#t=e,e&&this.#$(e.propertiesToUpdate))}get#ge(){let e=null;for(e of this.#b);return e}updateUI(e){this.#ge===e&&this.#$(e.propertiesToUpdate)}updateUIForDefaultProperties(e){this.#$(e.defaultPropertiesToUpdate)}toggleSelected(e){if(this.#b.has(e)){this.#b.delete(e),e.unselect(),this.#I({hasSelectedEditor:this.hasSelection});return}this.#b.add(e),e.select(),this.#$(e.propertiesToUpdate),this.#I({hasSelectedEditor:!0})}setSelected(e){this.updateToolbar({mode:e.mode,editId:e.id}),this.#h?.commitOrRemove();for(const t of this.#b)t!==e&&t.unselect();this.#b.clear(),this.#b.add(e),e.select(),this.#$(e.propertiesToUpdate),this.#I({hasSelectedEditor:!0})}isSelected(e){return this.#b.has(e)}get firstSelectedEditor(){return this.#b.values().next().value}unselect(e){e.unselect(),this.#b.delete(e),this.#I({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#b.size!==0}get isEnterHandled(){return this.#b.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#I({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Y()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#I({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#Y()})}addCommands(e){this.#c.add(e),this.#I({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Y()})}cleanUndoStack(e){this.#c.cleanType(e)}#Y(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const e of this.#n.values())return e.isEmpty();return!1}delete(){this.commitOrRemove();const e=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!e)return;const t=e?[e]:[...this.#b],n=()=>{this._editorUndoBar?.show(s,t.length===1?t[0].editorType:t.length);for(const o of t)o.remove()},s=()=>{for(const o of t)this.#se(o)};this.addCommands({cmd:n,undo:s,mustExec:!0})}commitOrRemove(){this.#t?.commitOrRemove()}hasSomethingToControl(){return this.#t||this.hasSelection}#re(e){for(const t of this.#b)t.unselect();this.#b.clear();for(const t of e)t.isEmpty()||(this.#b.add(t),t.select());this.#I({hasSelectedEditor:this.hasSelection})}selectAll(){for(const e of this.#b)e.commit();this.#re(this.#n.values())}unselectAll(){if(!(this.#t&&(this.#t.commitOrRemove(),this.#T!==Se.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const e of this.#b)e.unselect();this.#b.clear(),this.#I({hasSelectedEditor:!1})}}translateSelectedEditors(e,t,n=!1){if(n||this.commitOrRemove(),!this.hasSelection)return;this.#z[0]+=e,this.#z[1]+=t;const[s,o]=this.#z,l=[...this.#b],c=1e3;this.#O&&clearTimeout(this.#O),this.#O=setTimeout(()=>{this.#O=null,this.#z[0]=this.#z[1]=0,this.addCommands({cmd:()=>{for(const h of l)this.#n.has(h.id)&&(h.translateInPage(s,o),h.translationDone())},undo:()=>{for(const h of l)this.#n.has(h.id)&&(h.translateInPage(-s,-o),h.translationDone())},mustExec:!1})},c);for(const h of l)h.translateInPage(e,t),h.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#p=new Map;for(const e of this.#b)this.#p.set(e,{savedX:e.x,savedY:e.y,savedPageIndex:e.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#p)return!1;this.disableUserSelect(!1);const e=this.#p;this.#p=null;let t=!1;for(const[{x:s,y:o,pageIndex:l},c]of e)c.newX=s,c.newY=o,c.newPageIndex=l,t||=s!==c.savedX||o!==c.savedY||l!==c.savedPageIndex;if(!t)return!1;const n=(s,o,l,c)=>{if(this.#n.has(s.id)){const h=this.#o.get(c);h?s._setParentAndPosition(h,o,l):(s.pageIndex=c,s.x=o,s.y=l)}};return this.addCommands({cmd:()=>{for(const[s,{newX:o,newY:l,newPageIndex:c}]of e)n(s,o,l,c)},undo:()=>{for(const[s,{savedX:o,savedY:l,savedPageIndex:c}]of e)n(s,o,l,c)},mustExec:!0}),!0}dragSelectedEditors(e,t){if(this.#p)for(const n of this.#p.keys())n.drag(e,t)}rebuild(e){if(e.parent===null){const t=this.getLayer(e.pageIndex);t?(t.changeParent(e),t.addOrRebuild(e)):(this.addEditor(e),this.addToAnnotationStorage(e),e.rebuild())}else e.parent.addOrRebuild(e)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#b.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(e){return this.#t===e}getActive(){return this.#t}getMode(){return this.#T}isEditingMode(){return this.#T!==Se.NONE}get imageManager(){return Ee(this,"imageManager",new td)}getSelectionBoxes(e){if(!e)return null;const t=document.getSelection();for(let f=0,p=t.rangeCount;f<p;f++)if(!e.contains(t.getRangeAt(f).commonAncestorContainer))return null;const{x:n,y:s,width:o,height:l}=e.getBoundingClientRect();let c;switch(e.getAttribute("data-main-rotation")){case"90":c=(f,p,g,y)=>({x:(p-s)/l,y:1-(f+g-n)/o,width:y/l,height:g/o});break;case"180":c=(f,p,g,y)=>({x:1-(f+g-n)/o,y:1-(p+y-s)/l,width:g/o,height:y/l});break;case"270":c=(f,p,g,y)=>({x:1-(p+y-s)/l,y:(f-n)/o,width:y/l,height:g/o});break;default:c=(f,p,g,y)=>({x:(f-n)/o,y:(p-s)/l,width:g/o,height:y/l});break}const h=[];for(let f=0,p=t.rangeCount;f<p;f++){const g=t.getRangeAt(f);if(!g.collapsed)for(const{x:y,y:w,width:b,height:_}of g.getClientRects())b===0||_===0||h.push(c(y,w,b,_))}return h.length===0?null:h}addChangedExistingAnnotation({annotationElementId:e,id:t}){(this.#a||=new Map).set(e,t)}removeChangedExistingAnnotation({annotationElementId:e}){this.#a?.delete(e)}renderAnnotationElement(e){const t=this.#a?.get(e.data.id);if(!t)return;const n=this.#r.getRawValue(t);n&&(this.#T===Se.NONE&&!n.hasBeenModified||n.renderAnnotationElement(e))}setMissingCanvas(e,t,n){const s=this.#N?.get(e);s&&(s.setCanvas(t,n),this.#N.delete(e))}addMissingCanvas(e,t){(this.#N||=new Map).set(e,t)}}class Nn{#e=null;#t=!1;#i=null;#n=null;#o=null;#s=null;#r=!1;#a=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(e){this.#c=e,this.#h=e._uiManager.useNewAltTextFlow,Nn.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(e){Nn._l10n??=e}async render(){const e=this.#i=document.createElement("button");e.className="altText",e.tabIndex="0";const t=this.#n=document.createElement("span");e.append(t),this.#h?(e.classList.add("new"),e.setAttribute("data-l10n-id",Nn.#f.missing),t.setAttribute("data-l10n-id",Nn.#f["missing-label"])):(e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const n=this.#c._uiManager._signal;e.addEventListener("contextmenu",qt,{signal:n}),e.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const s=o=>{o.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#m}})};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",o=>{o.target===e&&o.key==="Enter"&&(this.#r=!0,s(o))},{signal:n}),await this.#p(),e}get#m(){return this.#e&&"added"||this.#e===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#r}),this.#r=!1)}isEmpty(){return this.#h?this.#e===null:!this.#e&&!this.#t}hasData(){return this.#h?this.#e!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(e){this.#e===null&&(this.#l=e,this.#d=await Nn._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:e}),this.#p())}toggleAltTextBadge(e=!1){if(!this.#h||this.#e){this.#a?.remove(),this.#a=null;return}if(!this.#a){const t=this.#a=document.createElement("div");t.className="noAltTextBadge",this.#c.div.append(t)}this.#a.classList.toggle("hidden",!e)}serialize(e){let t=this.#e;return!e&&this.#l===t&&(t=this.#d),{altText:t,decorative:this.#t,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#e,decorative:this.#t}}set data({altText:e,decorative:t,guessedText:n,textWithDisclaimer:s,cancel:o=!1}){n&&(this.#l=n,this.#d=s),!(this.#e===e&&this.#t===t)&&(o||(this.#e=e,this.#t=t),this.#p())}toggle(e=!1){this.#i&&(!e&&this.#s&&(clearTimeout(this.#s),this.#s=null),this.#i.disabled=!e)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#m}})}destroy(){this.#i?.remove(),this.#i=null,this.#n=null,this.#o=null,this.#a?.remove(),this.#a=null}async#p(){const e=this.#i;if(!e)return;if(this.#h){if(e.classList.toggle("done",!!this.#e),e.setAttribute("data-l10n-id",Nn.#f[this.#m]),this.#n?.setAttribute("data-l10n-id",Nn.#f[`${this.#m}-label`]),!this.#e){this.#o?.remove();return}}else{if(!this.#e&&!this.#t){e.classList.remove("done"),this.#o?.remove();return}e.classList.add("done"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let t=this.#o;if(!t){this.#o=t=document.createElement("span"),t.className="tooltip",t.setAttribute("role","tooltip"),t.id=`alt-text-tooltip-${this.#c.id}`;const s=100,o=this.#c._uiManager._signal;o.addEventListener("abort",()=>{clearTimeout(this.#s),this.#s=null},{once:!0}),e.addEventListener("mouseenter",()=>{this.#s=setTimeout(()=>{this.#s=null,this.#o.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},s)},{signal:o}),e.addEventListener("mouseleave",()=>{this.#s&&(clearTimeout(this.#s),this.#s=null),this.#o?.classList.remove("show")},{signal:o})}this.#t?t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(t.removeAttribute("data-l10n-id"),t.textContent=this.#e),t.parentNode||e.append(t),this.#c.getElementForAltText()?.setAttribute("aria-describedby",t.id)}}class Za{#e=null;#t=null;#i=!1;#n=null;#o=null;#s=null;#r=null;#a=null;#c=!1;#l=null;constructor(e){this.#n=e}renderForToolbar(){const e=this.#t=document.createElement("button");return e.className="comment",this.#d(e,!1)}renderForStandalone(){const e=this.#e=document.createElement("button");e.className="annotationCommentButton";const t=this.#n.commentButtonPosition;if(t){const{style:n}=e;n.insetInlineEnd=`calc(${100*(this.#n._uiManager.direction==="ltr"?1-t[0]:t[0])}% - var(--comment-button-dim))`,n.top=`calc(${100*t[1]}% - var(--comment-button-dim))`;const s=this.#n.commentButtonColor;s&&(n.backgroundColor=s)}return this.#d(e,!0)}focusButton(){setTimeout(()=>{(this.#e??this.#t)?.focus()},0)}onUpdatedColor(){if(!this.#e)return;const e=this.#n.commentButtonColor;e&&(this.#e.style.backgroundColor=e),this.#n._uiManager.updatePopupColor(this.#n)}get commentButtonWidth(){return(this.#e?.getBoundingClientRect().width??0)/this.#n.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#e)return null;const{x:e,y:t,height:n}=this.#e.getBoundingClientRect(),{x:s,y:o,width:l,height:c}=this.#n.parent.boundingClientRect;return[(e-s)/l,(t+n-o)/c]}set commentPopupPositionInLayer(e){this.#l=e}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#e?.remove(),this.#e=null}removeToolbarCommentButton(){this.#t?.remove(),this.#t=null}setCommentButtonStates({selected:e,hasPopup:t}){this.#e&&(this.#e.classList.toggle("selected",e),this.#e.ariaExpanded=t)}#d(e,t){if(!this.#n._uiManager.hasCommentManager())return null;e.tabIndex="0",e.ariaHasPopup="dialog",t?(e.ariaControls="commentPopup",e.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(e.ariaControlsElements=[this.#n._uiManager.getCommentDialogElement()],e.setAttribute("data-l10n-id","pdfjs-editor-edit-comment-button"));const n=this.#n._uiManager._signal;if(!(n instanceof AbortSignal)||n.aborted)return e;e.addEventListener("contextmenu",qt,{signal:n}),t&&(e.addEventListener("focusin",o=>{this.#n._focusEventsAllowed=!1,Ye(o)},{capture:!0,signal:n}),e.addEventListener("focusout",o=>{this.#n._focusEventsAllowed=!0,Ye(o)},{capture:!0,signal:n})),e.addEventListener("pointerdown",o=>o.stopPropagation(),{signal:n});const s=o=>{o.preventDefault(),e===this.#t?this.edit():this.#n.toggleComment(!0)};return e.addEventListener("click",s,{capture:!0,signal:n}),e.addEventListener("keydown",o=>{o.target===e&&o.key==="Enter"&&(this.#i=!0,s(o))},{signal:n}),e.addEventListener("pointerenter",()=>{this.#n.toggleComment(!1,!0)},{signal:n}),e.addEventListener("pointerleave",()=>{this.#n.toggleComment(!1,!1)},{signal:n}),e}edit(e){const t=this.commentPopupPositionInLayer;let n,s;if(t)[n,s]=t;else{[n,s]=this.#n.commentButtonPosition;const{width:p,height:g,x:y,y:w}=this.#n;n=y+n*p,s=w+s*g}const o=this.#n.parent.boundingClientRect,{x:l,y:c,width:h,height:f}=o;this.#n._uiManager.editComment(this.#n,l+n*h,c+s*f,{...e,parentDimensions:o})}finish(){this.#t&&(this.#t.focus({focusVisible:this.#i}),this.#i=!1)}isDeleted(){return this.#c||this.#r===""}isEmpty(){return this.#r===null}hasBeenEdited(){return this.isDeleted()||this.#r!==this.#o}serialize(){return this.data}get data(){return{text:this.#r,richText:this.#s,date:this.#a,deleted:this.isDeleted()}}set data(e){if(e!==this.#r&&(this.#s=null),e===null){this.#r="",this.#c=!0;return}this.#r=e,this.#a=new Date,this.#c=!1}setInitialText(e,t=null){this.#o=e,this.data=e,this.#a=null,this.#s=t}shown(){}destroy(){this.#t?.remove(),this.#t=null,this.#e?.remove(),this.#e=null,this.#r="",this.#s=null,this.#a=null,this.#n=null,this.#i=!1,this.#c=!1}}class Mo{#e;#t=!1;#i=null;#n;#o;#s;#r;#a=null;#c;#l=null;#d;#h=null;constructor({container:e,isPinchingDisabled:t=null,isPinchingStopped:n=null,onPinchStart:s=null,onPinching:o=null,onPinchEnd:l=null,signal:c}){this.#e=e,this.#i=n,this.#n=t,this.#o=s,this.#s=o,this.#r=l,this.#d=new AbortController,this.#c=AbortSignal.any([c,this.#d.signal]),e.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/An.pixelRatio}#f(e){if(this.#n?.())return;if(e.touches.length===1){if(this.#a)return;const s=this.#a=new AbortController,o=AbortSignal.any([this.#c,s.signal]),l=this.#e,c={capture:!0,signal:o,passive:!1},h=f=>{f.pointerType==="touch"&&(this.#a?.abort(),this.#a=null)};l.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(Ye(f),h(f))},c),l.addEventListener("pointerup",h,c),l.addEventListener("pointercancel",h,c);return}if(!this.#h){this.#h=new AbortController;const s=AbortSignal.any([this.#c,this.#h.signal]),o=this.#e,l={signal:s,capture:!1,passive:!1};o.addEventListener("touchmove",this.#m.bind(this),l);const c=this.#p.bind(this);o.addEventListener("touchend",c,l),o.addEventListener("touchcancel",c,l),l.capture=!0,o.addEventListener("pointerdown",Ye,l),o.addEventListener("pointermove",Ye,l),o.addEventListener("pointercancel",Ye,l),o.addEventListener("pointerup",Ye,l),this.#o?.()}if(Ye(e),e.touches.length!==2||this.#i?.()){this.#l=null;return}let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]),this.#l={touch0X:t.screenX,touch0Y:t.screenY,touch1X:n.screenX,touch1Y:n.screenY}}#m(e){if(!this.#l||e.touches.length!==2)return;Ye(e);let[t,n]=e.touches;t.identifier>n.identifier&&([t,n]=[n,t]);const{screenX:s,screenY:o}=t,{screenX:l,screenY:c}=n,h=this.#l,{touch0X:f,touch0Y:p,touch1X:g,touch1Y:y}=h,w=g-f,b=y-p,_=l-s,A=c-o,E=Math.hypot(_,A)||1,C=Math.hypot(w,b)||1;if(!this.#t&&Math.abs(C-E)<=Mo.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(h.touch0X=s,h.touch0Y=o,h.touch1X=l,h.touch1Y=c,!this.#t){this.#t=!0;return}const T=[(s+l)/2,(o+c)/2];this.#s?.(T,C,E)}#p(e){e.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#r?.()),this.#l&&(Ye(e),this.#l=null,this.#t=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#a?.abort(),this.#a=null}}class he{#e=null;#t=null;#i=null;#n=null;#o=null;#s=!1;#r=null;#a="";#c=null;#l=null;#d=null;#h=null;#f=null;#m="";#p=!1;#u=null;#g=!1;#y=!1;#w=!1;#v=null;#C=0;#A=0;#_=null;#x=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#S=!1;#E=he._zIndex++;static _borderLineWidth=-1;static _colorManager=new nd;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const e=he.prototype._resizeWithKeyboard,t=ai.TRANSLATE_SMALL,n=ai.TRANSLATE_BIG;return Ee(this,"_resizerKeyboardManager",new Do([[["ArrowLeft","mac+ArrowLeft"],e,{args:[-t,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e,{args:[-n,0]}],[["ArrowRight","mac+ArrowRight"],e,{args:[t,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e,{args:[n,0]}],[["ArrowUp","mac+ArrowUp"],e,{args:[0,-t]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e,{args:[0,-n]}],[["ArrowDown","mac+ArrowDown"],e,{args:[0,t]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e,{args:[0,n]}],[["Escape","mac+Escape"],he.prototype._stopResizingWithKeyboard]]))}constructor(e){this.parent=e.parent,this.id=e.id,this.width=this.height=null,this.pageIndex=e.parent.pageIndex,this.name=e.name,this.div=null,this._uiManager=e.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=e.isCentered,this._structTreeParentId=null,this.annotationElementId=e.annotationElementId||null,this.creationDate=e.creationDate||new Date,this.modificationDate=e.modificationDate||null;const{rotation:t,rawDims:{pageWidth:n,pageHeight:s,pageX:o,pageY:l}}=this.parent.viewport;this.rotation=t,this.pageRotation=(360+t-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[n,s],this.pageTranslation=[o,l];const[c,h]=this.parentDimensions;this.x=e.x/c,this.y=e.y/h,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return Ee(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(e){const t=new T1({id:e.parent.getNextId(),parent:e.parent,uiManager:e._uiManager});t.annotationElementId=e.annotationElementId,t.deleted=!0,t._uiManager.addToAnnotationStorage(t)}static initialize(e,t){if(he._l10n??=e,he._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),he._borderLineWidth!==-1)return;const n=getComputedStyle(document.documentElement);he._borderLineWidth=parseFloat(n.getPropertyValue("--outline-width"))||0}static updateDefaultParams(e,t){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(e){return!1}static paste(e,t){Ue("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#S}set _isDraggable(e){this.#S=e,this.div?.classList.toggle("draggable",e)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[e,t]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*t/(e*2),this.y+=this.width*e/(t*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*t/(e*2),this.y-=this.width*e/(t*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(e){this._uiManager.addCommands(e)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#E}setParent(e){e!==null?(this.pageIndex=e.pageIndex,this.pageDimensions=e.pageDimensions):(this.#O(),this.#h?.remove(),this.#h=null),this.parent=e}focusin(e){this._focusEventsAllowed&&(this.#p?this.#p=!1:this.parent.setSelected(this))}focusout(e){!this._focusEventsAllowed||!this.isAttachedToDOM||e.relatedTarget?.closest(`#${this.id}`)||(e.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(e,t,n,s){const[o,l]=this.parentDimensions;[n,s]=this.screenToPageTranslation(n,s),this.x=(e+n)/o,this.y=(t+s)/l,this.fixAndSetPosition()}_moveAfterPaste(e,t){const[n,s]=this.parentDimensions;this.setAt(e*n,t*s,this.width*n,this.height*s),this._onTranslated()}#R([e,t],n,s){[n,s]=this.screenToPageTranslation(n,s),this.x+=n/e,this.y+=s/t,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(e,t){this.#R(this.parentDimensions,e,t)}translateInPage(e,t){this.#u||=[this.x,this.y,this.width,this.height],this.#R(this.pageDimensions,e,t),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(e,t){this.#u||=[this.x,this.y,this.width,this.height];const{div:n,parentDimensions:[s,o]}=this;if(this.x+=e/s,this.y+=t/o,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:g,y}=this.div.getBoundingClientRect();this.parent.findNewParent(this,g,y)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:l,y:c}=this;const[h,f]=this.getBaseTranslation();l+=h,c+=f;const{style:p}=n;p.left=`${(100*l).toFixed(2)}%`,p.top=`${(100*c).toFixed(2)}%`,this._onTranslating(l,c),n.scrollIntoView({block:"nearest"})}_onTranslating(e,t){}_onTranslated(e,t){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[e,t]=this.parentDimensions,{_borderLineWidth:n}=he,s=n/e,o=n/t;switch(this.rotation){case 90:return[-s,o];case 180:return[s,o];case 270:return[s,-o];default:return[-s,-o]}}get _mustFixPosition(){return!0}fixAndSetPosition(e=this.rotation){const{div:{style:t},pageDimensions:[n,s]}=this;let{x:o,y:l,width:c,height:h}=this;if(c*=n,h*=s,o*=n,l*=s,this._mustFixPosition)switch(e){case 0:o=At(o,0,n-c),l=At(l,0,s-h);break;case 90:o=At(o,0,n-h),l=At(l,c,s);break;case 180:o=At(o,c,n),l=At(l,h,s);break;case 270:o=At(o,h,n),l=At(l,0,s-c);break}this.x=o/=n,this.y=l/=s;const[f,p]=this.getBaseTranslation();o+=f,l+=p,t.left=`${(100*o).toFixed(2)}%`,t.top=`${(100*l).toFixed(2)}%`,this.moveInDOM()}static#k(e,t,n){switch(n){case 90:return[t,-e];case 180:return[-e,-t];case 270:return[-t,e];default:return[e,t]}}screenToPageTranslation(e,t){return he.#k(e,t,this.parentRotation)}pageTranslationToScreen(e,t){return he.#k(e,t,360-this.parentRotation)}#P(e){switch(e){case 90:{const[t,n]=this.pageDimensions;return[0,-t/n,n/t,0]}case 180:return[-1,0,0,-1];case 270:{const[t,n]=this.pageDimensions;return[0,t/n,-n/t,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:e,pageDimensions:[t,n]}=this;return[t*e,n*e]}setDims(){const{div:{style:e},width:t,height:n}=this;e.width=`${(100*t).toFixed(2)}%`,e.height=`${(100*n).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#F(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const e=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],t=this._uiManager._signal;for(const n of e){const s=document.createElement("div");this.#c.append(s),s.classList.add("resizer",n),s.setAttribute("data-resizer-name",n),s.addEventListener("pointerdown",this.#L.bind(this,n),{signal:t}),s.addEventListener("contextmenu",qt,{signal:t}),s.tabIndex=-1}this.div.prepend(this.#c)}#L(e,t){t.preventDefault();const{isMac:n}=pt.platform;if(t.button!==0||t.ctrlKey&&n)return;this.#i?.toggle(!1);const s=this._isDraggable;this._isDraggable=!1,this.#l=[t.screenX,t.screenY];const o=new AbortController,l=this._uiManager.combinedSignal(o);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#N.bind(this,e),{passive:!0,capture:!0,signal:l}),window.addEventListener("touchmove",Ye,{passive:!1,signal:l}),window.addEventListener("contextmenu",qt,{signal:l}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const c=this.parent.div.style.cursor,h=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(t.target).cursor;const f=()=>{o.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=s,this.parent.div.style.cursor=c,this.div.style.cursor=h,this.#B()};window.addEventListener("pointerup",f,{signal:l}),window.addEventListener("blur",f,{signal:l})}#M(e,t,n,s){this.width=n,this.height=s,this.x=e,this.y=t,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#B(){if(!this.#d)return;const{savedX:e,savedY:t,savedWidth:n,savedHeight:s}=this.#d;this.#d=null;const o=this.x,l=this.y,c=this.width,h=this.height;o===e&&l===t&&c===n&&h===s||this.addCommands({cmd:this.#M.bind(this,o,l,c,h),undo:this.#M.bind(this,e,t,n,s),mustExec:!0})}static _round(e){return Math.round(e*1e4)/1e4}#N(e,t){const[n,s]=this.parentDimensions,o=this.x,l=this.y,c=this.width,h=this.height,f=he.MIN_SIZE/n,p=he.MIN_SIZE/s,g=this.#P(this.rotation),y=(J,K)=>[g[0]*J+g[2]*K,g[1]*J+g[3]*K],w=this.#P(360-this.rotation),b=(J,K)=>[w[0]*J+w[2]*K,w[1]*J+w[3]*K];let _,A,E=!1,C=!1;switch(e){case"topLeft":E=!0,_=(J,K)=>[0,0],A=(J,K)=>[J,K];break;case"topMiddle":_=(J,K)=>[J/2,0],A=(J,K)=>[J/2,K];break;case"topRight":E=!0,_=(J,K)=>[J,0],A=(J,K)=>[0,K];break;case"middleRight":C=!0,_=(J,K)=>[J,K/2],A=(J,K)=>[0,K/2];break;case"bottomRight":E=!0,_=(J,K)=>[J,K],A=(J,K)=>[0,0];break;case"bottomMiddle":_=(J,K)=>[J/2,K],A=(J,K)=>[J/2,0];break;case"bottomLeft":E=!0,_=(J,K)=>[0,K],A=(J,K)=>[J,0];break;case"middleLeft":C=!0,_=(J,K)=>[0,K/2],A=(J,K)=>[J,K/2];break}const T=_(c,h),R=A(c,h);let L=y(...R);const k=he._round(o+L[0]),N=he._round(l+L[1]);let U=1,z=1,V,q;if(t.fromKeyboard)({deltaX:V,deltaY:q}=t);else{const{screenX:J,screenY:K}=t,[$,ee]=this.#l;[V,q]=this.screenToPageTranslation(J-$,K-ee),this.#l[0]=J,this.#l[1]=K}if([V,q]=b(V/n,q/s),E){const J=Math.hypot(c,h);U=z=Math.max(Math.min(Math.hypot(R[0]-T[0]-V,R[1]-T[1]-q)/J,1/c,1/h),f/c,p/h)}else C?U=At(Math.abs(R[0]-T[0]-V),f,1)/c:z=At(Math.abs(R[1]-T[1]-q),p,1)/h;const ue=he._round(c*U),Q=he._round(h*z);L=y(...A(ue,Q));const le=k-L[0],ye=N-L[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=ue,this.height=Q,this.x=le,this.y=ye,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new co(this),this.div.append(this._editToolbar.render());const{toolbarButtons:e}=this;if(e)for(const[t,n]of e)await this._editToolbar.addButton(t,n);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#i?.destroy()}addContainer(e){const t=this._editToolbar?.div;t?t.before(e):this.div.append(e)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#i||(Nn.initialize(he._l10n),this.#i=new Nn(this),this.#e&&(this.#i.data=this.#e,this.#e=null)),this.#i}get altTextData(){return this.#i?.data}set altTextData(e){this.#i&&(this.#i.data=e)}get guessedAltText(){return this.#i?.guessedText}async setGuessedAltText(e){await this.#i?.setGuessedText(e)}serializeAltText(e){return this.#i?.serialize(e)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}focusCommentButton(){this.#n?.focusButton()}addCommentButton(){return this.#n||=new Za(this)}addStandaloneCommentButton(){if(this.#o){this._uiManager.isEditingMode()&&this.#o.classList.remove("hidden");return}this.hasComment&&(this.#o=this.#n.renderForStandalone(),this.div.append(this.#o))}removeStandaloneCommentButton(){this.#n.removeStandaloneCommentButton(),this.#o=null}hideStandaloneCommentButton(){this.#o?.classList.add("hidden")}get comment(){const{data:{richText:e,text:t,date:n,deleted:s}}=this.#n;return{text:t,richText:e,date:n,deleted:s,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(e){this.#n||=new Za(this),this.#n.data=e,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:e,popupRef:t,richText:n}){if(!t||(this.#n||=new Za(this),this.#n.setInitialText(e,n),!this.annotationElementId))return;const s=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);s&&this.updateFromAnnotationLayer(s)}get hasEditedComment(){return this.#n?.hasBeenEdited()}get hasDeletedComment(){return this.#n?.isDeleted()}get hasComment(){return!!this.#n&&!this.#n.isEmpty()&&!this.#n.isDeleted()}async editComment(e){this.#n||=new Za(this),this.#n.edit(e)}toggleComment(e,t=void 0){this.hasComment&&this._uiManager.toggleComment(this,e,t)}setSelectedCommentButton(e){this.#n.setSelectedButton(e)}addComment(e){if(this.hasEditedComment){const[,,,s]=e.rect,[o]=this.pageDimensions,[l]=this.pageTranslation,c=l+o+1,h=s-100,f=c+180;e.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[c,h,f,s]}}}updateFromAnnotationLayer({popup:{contents:e,deleted:t}}){this.#n.data=t?null:e}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const e=this.div=document.createElement("div");e.setAttribute("data-editor-rotation",(360-this.rotation)%360),e.className=this.name,e.setAttribute("id",this.id),e.tabIndex=this.#s?-1:0,e.setAttribute("role","application"),this.defaultL10nId&&e.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||e.classList.add("hidden"),this.setInForeground(),this.#H();const[t,n]=this.parentDimensions;this.parentRotation%180!==0&&(e.style.maxWidth=`${(100*n/t).toFixed(2)}%`,e.style.maxHeight=`${(100*t/n).toFixed(2)}%`);const[s,o]=this.getInitialTranslation();return this.translate(s,o),Yy(this,e,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#x||=new Mo({container:e,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#V.bind(this),onPinching:this.#T.bind(this),onPinchEnd:this.#b.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),e}#V(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#T(e,t,n){let o=.7*(n/t)+1-.7;if(o===1)return;const l=this.#P(this.rotation),c=(k,N)=>[l[0]*k+l[2]*N,l[1]*k+l[3]*N],[h,f]=this.parentDimensions,p=this.x,g=this.y,y=this.width,w=this.height,b=he.MIN_SIZE/h,_=he.MIN_SIZE/f;o=Math.max(Math.min(o,1/y,1/w),b/y,_/w);const A=he._round(y*o),E=he._round(w*o);if(A===y&&E===w)return;this.#u||=[p,g,y,w];const C=c(y/2,w/2),T=he._round(p+C[0]),R=he._round(g+C[1]),L=c(A/2,E/2);this.x=T-L[0],this.y=R-L[1],this.width=A,this.height=E,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#b(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#B()}pointerdown(e){const{isMac:t}=pt.platform;if(e.button!==0||e.ctrlKey&&t){e.preventDefault();return}if(this.#p=!0,this._isDraggable){this.#U(e);return}this.#D(e)}#D(e){const{isMac:t}=pt.platform;e.ctrlKey&&!t||e.shiftKey||e.metaKey&&t?this.parent.toggleSelected(this):this.parent.setSelected(this)}#U(e){const{isSelected:t}=this;this._uiManager.setUpDragSession();let n=!1;const s=new AbortController,o=this._uiManager.combinedSignal(s),l={capture:!0,passive:!1,signal:o},c=f=>{s.abort(),this.#r=null,this.#p=!1,this._uiManager.endDragSession()||this.#D(f),n&&this._onStopDragging()};t&&(this.#C=e.clientX,this.#A=e.clientY,this.#r=e.pointerId,this.#a=e.pointerType,window.addEventListener("pointermove",f=>{n||(n=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:p,clientY:g,pointerId:y}=f;if(y!==this.#r){Ye(f);return}const[w,b]=this.screenToPageTranslation(p-this.#C,g-this.#A);this.#C=p,this.#A=g,this._uiManager.dragSelectedEditors(w,b)},l),window.addEventListener("touchmove",Ye,l),window.addEventListener("pointerdown",f=>{f.pointerType===this.#a&&(this.#x||f.isPrimary)&&c(f),Ye(f)},l));const h=f=>{if(!this.#r||this.#r===f.pointerId){c(f);return}Ye(f)};window.addEventListener("pointerup",h,{signal:o}),window.addEventListener("blur",h,{signal:o})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#v&&clearTimeout(this.#v),this.#v=setTimeout(()=>{this.#v=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(e,t,n){e.changeParent(this),this.x=t,this.y=n,this.fixAndSetPosition(),this._onTranslated()}getRect(e,t,n=this.rotation){const s=this.parentScale,[o,l]=this.pageDimensions,[c,h]=this.pageTranslation,f=e/s,p=t/s,g=this.x*o,y=this.y*l,w=this.width*o,b=this.height*l;switch(n){case 0:return[g+f+c,l-y-p-b+h,g+f+w+c,l-y-p+h];case 90:return[g+p+c,l-y+f+h,g+p+b+c,l-y+f+w+h];case 180:return[g-f-w+c,l-y+p+h,g-f+c,l-y+p+b+h];case 270:return[g-p-b+c,l-y-f-w+h,g-p+c,l-y-f+h];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(e,t){const[n,s,o,l]=e,c=o-n,h=l-s;switch(this.rotation){case 0:return[n,t-l,c,h];case 90:return[n,t-s,h,c];case 180:return[o,t-s,c,h];case 270:return[o,t-l,h,c];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&he._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#n?.onUpdatedColor()}getData(){const{comment:{text:e,color:t,date:n,opacity:s,deleted:o,richText:l},uid:c,pageIndex:h,creationDate:f,modificationDate:p}=this;return{id:c,pageIndex:h,rect:this.getPDFRect(),richText:l,contentsObj:{str:e},creationDate:f,modificationDate:n||p,popupRef:!o,color:t,opacity:s}}onceAdded(e){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#w}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:e,left:t,bottom:n,right:s}=this.getClientDimensions(),{innerHeight:o,innerWidth:l}=window;return t<l&&s>0&&e<o&&n>0}#H(){if(this.#f||!this.div)return;this.#f=new AbortController;const e=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:e}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:e})}rebuild(){this.#H()}rotate(e){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(e=!1,t=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(e,t,n){const s=new this.prototype.constructor({parent:t,id:t.getNextId(),uiManager:n,annotationElementId:e.annotationElementId,creationDate:e.creationDate,modificationDate:e.modificationDate});s.rotation=e.rotation,s.#e=e.accessibilityData,s._isCopy=e.isCopy||!1;const[o,l]=s.pageDimensions,[c,h,f,p]=s.getRectInCurrentCoords(e.rect,l);return s.x=c/o,s.y=h/l,s.width=f/o,s.height=p/l,s}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#v&&(clearTimeout(this.#v),this.#v=null),this.#O(),this.removeEditToolbar(),this.#_){for(const e of this.#_.values())clearTimeout(e);this.#_=null}this.parent=null,this.#x?.destroy(),this.#x=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#F(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[e,t]}=this,[n,s,o,l]=this.getPDFRect();return[he._round(n+(o-n)*e),he._round(s+(l-s)*(1-t))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#n.commentPopupPositionInLayer}set commentPopupPosition(e){this.#n.commentPopupPositionInLayer=e}hasDefaultPopupPosition(){return this.#n.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#n.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(e){this.#n.setCommentButtonStates(e)}keydown(e){if(!this.isResizable||e.target!==this.div||e.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const t=this.#c.children;if(!this.#t){this.#t=Array.from(t);const l=this.#q.bind(this),c=this.#G.bind(this),h=this._uiManager._signal;for(const f of this.#t){const p=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",l,{signal:h}),f.addEventListener("blur",c,{signal:h}),f.addEventListener("focus",this.#X.bind(this,p),{signal:h}),f.setAttribute("data-l10n-id",he._l10nResizer[p])}}const n=this.#t[0];let s=0;for(const l of t){if(l===n)break;s++}const o=(360-this.rotation+this.parentRotation)%360/90*(this.#t.length/4);if(o!==s){if(o<s)for(let c=0;c<s-o;c++)this.#c.append(this.#c.firstChild);else if(o>s)for(let c=0;c<o-s;c++)this.#c.firstChild.before(this.#c.lastChild);let l=0;for(const c of t){const f=this.#t[l++].getAttribute("data-resizer-name");c.setAttribute("data-l10n-id",he._l10nResizer[f])}}this.#z(0),this.#w=!0,this.#c.firstChild.focus({focusVisible:!0}),e.preventDefault(),e.stopImmediatePropagation()}#q(e){he._resizerKeyboardManager.exec(this,e)}#G(e){this.#w&&e.relatedTarget?.parentNode!==this.#c&&this.#O()}#X(e){this.#m=this.#w?e:""}#z(e){if(this.#t)for(const t of this.#t)t.tabIndex=e}_resizeWithKeyboard(e,t){this.#w&&this.#N(this.#m,{deltaX:e,deltaY:t,fromKeyboard:!0})}#O(){this.#w=!1,this.#z(-1),this.#B()}_stopResizingWithKeyboard(){this.#O(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0),this.hasComment&&this._uiManager.toggleComment(this,!1,!1))}updateParams(e,t){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(e){e.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.id}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#g}set isEditing(e){this.#g=e,this.parent&&(e?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(e,t=!1){if(t){this.#_||=new Map;const{action:n}=e;let s=this.#_.get(n);s&&clearTimeout(s),s=setTimeout(()=>{this._reportTelemetry(e),this.#_.delete(n),this.#_.size===0&&(this.#_=null)},he._telemetryTimeout),this.#_.set(n,s);return}e.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:e}})}show(e=this._isVisible){this.div.classList.toggle("hidden",!e),this._isVisible=e}enable(){this.div&&(this.div.tabIndex=0),this.#s=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#s=!0}updateFakeAnnotationElement(e){if(!this.#h&&!this.deleted){this.#h=e.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;let t=e.container.querySelector(".annotationContent");if(!t)t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),e.container.prepend(t);else if(t.nodeName==="CANVAS"){const n=t;t=document.createElement("div"),t.classList.add("annotationContent",this.editorType),n.before(t)}return t}resetAnnotationElement(e){const{firstChild:t}=e.container;t?.nodeName==="DIV"&&t.classList.contains("annotationContent")&&t.remove()}}class T1 extends he{constructor(e){super(e),this.annotationElementId=e.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const nm=3285377520,nn=4294901760,Dn=65535;class Qy{constructor(e){this.h1=e?e&4294967295:nm,this.h2=e?e&4294967295:nm}update(e){let t,n;if(typeof e=="string"){t=new Uint8Array(e.length*2),n=0;for(let _=0,A=e.length;_<A;_++){const E=e.charCodeAt(_);E<=255?t[n++]=E:(t[n++]=E>>>8,t[n++]=E&255)}}else if(ArrayBuffer.isView(e))t=e.slice(),n=t.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const s=n>>2,o=n-s*4,l=new Uint32Array(t.buffer,0,s);let c=0,h=0,f=this.h1,p=this.h2;const g=3432918353,y=461845907,w=g&Dn,b=y&Dn;for(let _=0;_<s;_++)_&1?(c=l[_],c=c*g&nn|c*w&Dn,c=c<<15|c>>>17,c=c*y&nn|c*b&Dn,f^=c,f=f<<13|f>>>19,f=f*5+3864292196):(h=l[_],h=h*g&nn|h*w&Dn,h=h<<15|h>>>17,h=h*y&nn|h*b&Dn,p^=h,p=p<<13|p>>>19,p=p*5+3864292196);switch(c=0,o){case 3:c^=t[s*4+2]<<16;case 2:c^=t[s*4+1]<<8;case 1:c^=t[s*4],c=c*g&nn|c*w&Dn,c=c<<15|c>>>17,c=c*y&nn|c*b&Dn,s&1?f^=c:p^=c}this.h1=f,this.h2=p}hexdigest(){let e=this.h1,t=this.h2;return e^=t>>>1,e=e*3981806797&nn|e*36045&Dn,t=t*4283543511&nn|((t<<16|e>>>16)*2950163797&nn)>>>16,e^=t>>>1,e=e*444984403&nn|e*60499&Dn,t=t*3301882366&nn|((t<<16|e>>>16)*3120437893&nn)>>>16,e^=t>>>1,(e>>>0).toString(16).padStart(8,"0")+(t>>>0).toString(16).padStart(8,"0")}}const yh=Object.freeze({map:null,hash:"",transfer:void 0});class id{#e=!1;#t=null;#i=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(e,t){const n=this.#n.get(e);return n===void 0?t:Object.assign(t,n)}getRawValue(e){return this.#n.get(e)}remove(e){const t=this.#n.get(e);if(t!==void 0&&(t instanceof he&&this.#i.delete(t.annotationElementId),this.#n.delete(e),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const n of this.#n.values())if(n instanceof he)return;this.onAnnotationEditor(null)}}setValue(e,t){const n=this.#n.get(e);let s=!1;if(n!==void 0)for(const[o,l]of Object.entries(t))n[o]!==l&&(s=!0,n[o]=l);else s=!0,this.#n.set(e,t);s&&this.#o(),t instanceof he&&((this.#i||=new Map).set(t.annotationElementId,t),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(t.constructor._type))}has(e){return this.#n.has(e)}get size(){return this.#n.size}#o(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Jy(this)}get serializable(){if(this.#n.size===0)return yh;const e=new Map,t=new Qy,n=[],s=Object.create(null);let o=!1;for(const[l,c]of this.#n){const h=c instanceof he?c.serialize(!1,s):c;h&&(e.set(l,h),t.update(`${l}:${JSON.stringify(h)}`),o||=!!h.bitmap)}if(o)for(const l of e.values())l.bitmap&&n.push(l.bitmap);return e.size>0?{map:e,hash:t.hexdigest(),transfer:n}:yh}get editorStats(){let e=null;const t=new Map;let n=0,s=0;for(const o of this.#n.values()){if(!(o instanceof he)){o.popup&&(o.popup.deleted?s+=1:n+=1);continue}o.isCommentDeleted?s+=1:o.hasEditedComment&&(n+=1);const l=o.telemetryFinalData;if(!l)continue;const{type:c}=l;t.has(c)||t.set(c,Object.getPrototypeOf(o).constructor),e||=Object.create(null);const h=e[c]||=new Map;for(const[f,p]of Object.entries(l)){if(f==="type")continue;let g=h.get(f);g||(g=new Map,h.set(f,g));const y=g.get(p)??0;g.set(p,y+1)}}if((s>0||n>0)&&(e||=Object.create(null),e.comments={deleted:s,edited:n}),!e)return null;for(const[o,l]of t)e[o]=l.computeTelemetryFinalData(e[o]);return e}resetModifiedIds(){this.#t=null}updateEditor(e,t){const n=this.#i?.get(e);return n?(n.updateFromAnnotationLayer(t),!0):!1}getEditor(e){return this.#i?.get(e)||null}get modifiedIds(){if(this.#t)return this.#t;const e=[];if(this.#i)for(const t of this.#i.values())t.serialize()&&e.push(t.annotationElementId);return this.#t={ids:new Set(e),hash:e.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class Jy extends id{#e;constructor(e){super();const{map:t,hash:n,transfer:s}=e.serializable,o=structuredClone(t,s?{transfer:s}:null);this.#e={map:o,hash:n,transfer:s}}get print(){Ue("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}get modifiedIds(){return Ee(this,"modifiedIds",{ids:new Set,hash:""})}}class x1{#e=new Set;constructor({ownerDocument:e=globalThis.document,styleElement:t=null}){this._document=e,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(e){this.nativeFontFaces.add(e),this._document.fonts.add(e)}removeNativeFontFace(e){this.nativeFontFaces.delete(e),this._document.fonts.delete(e)}insertRule(e){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const t=this.styleElement.sheet;t.insertRule(e,t.cssRules.length)}clear(){for(const e of this.nativeFontFaces)this._document.fonts.delete(e);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:e,disableFontFace:t,_inspectFont:n}){if(!(!e||this.#e.has(e.loadedName))){if(Ie(!t,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:s,src:o,style:l}=e,c=new FontFace(s,o,l);this.addNativeFontFace(c);try{await c.load(),this.#e.add(s),n?.(e)}catch{Ae(`Cannot load system font: ${e.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(c)}return}Ue("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(e){if(e.attached||e.missingFile&&!e.systemFontInfo)return;if(e.attached=!0,e.systemFontInfo){await this.loadSystemFont(e);return}if(this.isFontLoadingAPISupported){const n=e.createNativeFontFace();if(n){this.addNativeFontFace(n);try{await n.loaded}catch(s){throw Ae(`Failed to load font '${n.family}': '${s}'.`),e.disableFontFace=!0,s}}return}const t=e.createFontFaceRule();if(t){if(this.insertRule(t),this.isSyncFontLoadingSupported)return;await new Promise(n=>{const s=this._queueLoadingCallback(n);this._prepareFontLoadEvent(e,s)})}}get isFontLoadingAPISupported(){const e=!!this._document?.fonts;return Ee(this,"isFontLoadingAPISupported",e)}get isSyncFontLoadingSupported(){return Ee(this,"isSyncFontLoadingSupported",xt||pt.platform.isFirefox)}_queueLoadingCallback(e){function t(){for(Ie(!s.done,"completeRequest() cannot be called twice."),s.done=!0;n.length>0&&n[0].done;){const o=n.shift();setTimeout(o.callback,0)}}const{loadingRequests:n}=this,s={done:!1,complete:t,callback:e};return n.push(s),s}get _loadTestFont(){const e=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return Ee(this,"_loadTestFont",e)}_prepareFontLoadEvent(e,t){function n(R,L){return R.charCodeAt(L)<<24|R.charCodeAt(L+1)<<16|R.charCodeAt(L+2)<<8|R.charCodeAt(L+3)&255}function s(R,L,k,N){const U=R.substring(0,L),z=R.substring(L+k);return U+N+z}let o,l;const c=this._document.createElement("canvas");c.width=1,c.height=1;const h=c.getContext("2d");let f=0;function p(R,L){if(++f>30){Ae("Load test font never loaded."),L();return}if(h.font="30px "+R,h.fillText(".",0,20),h.getImageData(0,0,1,1).data[3]>0){L();return}setTimeout(p.bind(null,R,L))}const g=`lt${Date.now()}${this.loadTestFontId++}`;let y=this._loadTestFont;y=s(y,976,g.length,g);const b=16,_=1482184792;let A=n(y,b);for(o=0,l=g.length-3;o<l;o+=4)A=A-_+n(g,o)|0;o<g.length&&(A=A-_+n(g+"XXX",o)|0),y=s(y,b,4,p1(A));const E=`url(data:font/opentype;base64,${btoa(y)});`,C=`@font-face {font-family:"${g}";src:${E}}`;this.insertRule(C);const T=this._document.createElement("div");T.style.visibility="hidden",T.style.width=T.style.height="10px",T.style.position="absolute",T.style.top=T.style.left="0px";for(const R of[e.loadedName,g]){const L=this._document.createElement("span");L.textContent="Hi",L.style.fontFamily=R,T.append(L)}this._document.body.append(T),p(g,()=>{T.remove(),t.complete()})}}class k1{#e;constructor(e,t=null,n,s){this.compiledGlyphs=Object.create(null),this.#e=e,this._inspectFont=t,n&&Object.assign(this,n),s&&(this.charProcOperatorList=s)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let e;if(!this.cssFontInfo)e=new FontFace(this.loadedName,this.data,{});else{const t={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(t.style=`oblique ${this.cssFontInfo.italicAngle}deg`),e=new FontFace(this.cssFontInfo.fontFamily,this.data,t)}return this._inspectFont?.(this),e}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const e=`url(data:${this.mimetype};base64,${$y(this.data)});`;let t;if(!this.cssFontInfo)t=`@font-face {font-family:"${this.loadedName}";src:${e}}`;else{let n=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(n+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),t=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${n}src:${e}}`}return this._inspectFont?.(this,e),t}getPathGenerator(e,t){if(this.compiledGlyphs[t]!==void 0)return this.compiledGlyphs[t];const n=this.loadedName+"_path_"+t;let s;try{s=e.get(n)}catch(l){Ae(`getPathGenerator - ignoring character: "${l}".`)}const o=new Path2D(s||"");return this.fontExtraProperties||e.delete(n),this.compiledGlyphs[t]=o}get black(){return this.#e.black}get bold(){return this.#e.bold}get disableFontFace(){return this.#e.disableFontFace??!1}get fontExtraProperties(){return this.#e.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#e.isInvalidPDFjsFont}get isType3Font(){return this.#e.isType3Font}get italic(){return this.#e.italic}get missingFile(){return this.#e.missingFile}get remeasure(){return this.#e.remeasure}get vertical(){return this.#e.vertical}get ascent(){return this.#e.ascent}get defaultWidth(){return this.#e.defaultWidth}get descent(){return this.#e.descent}get bbox(){return this.#e.bbox}get fontMatrix(){return this.#e.fontMatrix}get fallbackName(){return this.#e.fallbackName}get loadedName(){return this.#e.loadedName}get mimetype(){return this.#e.mimetype}get name(){return this.#e.name}get data(){return this.#e.data}clearData(){this.#e.clearData()}get cssFontInfo(){return this.#e.cssFontInfo}get systemFontInfo(){return this.#e.systemFontInfo}get defaultVMetrics(){return this.#e.defaultVMetrics}}function P1(a){if(a instanceof URL)return a.href;if(typeof a=="string"){if(xt)return a;const e=URL.parse(a,window.location);if(e)return e.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function R1(a){if(xt&&typeof Buffer<"u"&&a instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength)return a;if(typeof a=="string")return Ro(a);if(a instanceof ArrayBuffer||ArrayBuffer.isView(a)||typeof a=="object"&&!isNaN(a?.length))return new Uint8Array(a);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function el(a){if(typeof a!="string")return null;if(a.endsWith("/"))return a;throw new Error(`Invalid factory url: "${a}" must include trailing slash.`)}const vh=a=>typeof a=="object"&&Number.isInteger(a?.num)&&a.num>=0&&Number.isInteger(a?.gen)&&a.gen>=0,I1=a=>typeof a=="object"&&typeof a?.name=="string",Zy=v1.bind(null,vh,I1);class L1{#e=new Map;#t=Promise.resolve();postMessage(e,t){const n={data:structuredClone(e,t?{transfer:t}:null)};this.#t.then(()=>{for(const[s]of this.#e)s.call(this,n)})}addEventListener(e,t,n=null){let s=null;if(n?.signal instanceof AbortSignal){const{signal:o}=n;if(o.aborted){Ae("LoopbackPort - cannot use an `aborted` signal.");return}const l=()=>this.removeEventListener(e,t);s=()=>o.removeEventListener("abort",l),o.addEventListener("abort",l)}this.#e.set(t,s)}removeEventListener(e,t){this.#e.get(t)?.(),this.#e.delete(t)}terminate(){for(const[,e]of this.#e)e?.();this.#e.clear()}}const tl={DATA:1,ERROR:2},ot={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function im(){}function Bt(a){if(a instanceof oi||a instanceof El||a instanceof Kg||a instanceof mo||a instanceof Yu)return a;switch(a instanceof Error||typeof a=="object"&&a!==null||Ue('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),a.name){case"AbortException":return new oi(a.message);case"InvalidPDFException":return new El(a.message);case"PasswordException":return new Kg(a.message,a.code);case"ResponseException":return new mo(a.message,a.status,a.missing);case"UnknownErrorException":return new Yu(a.message,a.details)}return new Yu(a.message,a.toString())}class so{#e=new AbortController;constructor(e,t,n){this.sourceName=e,this.targetName=t,this.comObj=n,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),n.addEventListener("message",this.#t.bind(this),{signal:this.#e.signal})}#t({data:e}){if(e.targetName!==this.sourceName)return;if(e.stream){this.#n(e);return}if(e.callback){const n=e.callbackId,s=this.callbackCapabilities[n];if(!s)throw new Error(`Cannot resolve callback ${n}`);if(delete this.callbackCapabilities[n],e.callback===tl.DATA)s.resolve(e.data);else if(e.callback===tl.ERROR)s.reject(Bt(e.reason));else throw new Error("Unexpected callback case");return}const t=this.actionHandler[e.action];if(!t)throw new Error(`Unknown action from worker: ${e.action}`);if(e.callbackId){const n=this.sourceName,s=e.sourceName,o=this.comObj;Promise.try(t,e.data).then(function(l){o.postMessage({sourceName:n,targetName:s,callback:tl.DATA,callbackId:e.callbackId,data:l})},function(l){o.postMessage({sourceName:n,targetName:s,callback:tl.ERROR,callbackId:e.callbackId,reason:Bt(l)})});return}if(e.streamId){this.#i(e);return}t(e.data)}on(e,t){const n=this.actionHandler;if(n[e])throw new Error(`There is already an actionName called "${e}"`);n[e]=t}send(e,t,n){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,data:t},n)}sendWithPromise(e,t,n){const s=this.callbackId++,o=Promise.withResolvers();this.callbackCapabilities[s]=o;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:e,callbackId:s,data:t},n)}catch(l){o.reject(l)}return o.promise}sendWithStream(e,t,n,s){const o=this.streamId++,l=this.sourceName,c=this.targetName,h=this.comObj;return new ReadableStream({start:f=>{const p=Promise.withResolvers();return this.streamControllers[o]={controller:f,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},h.postMessage({sourceName:l,targetName:c,action:e,streamId:o,data:t,desiredSize:f.desiredSize},s),p.promise},pull:f=>{const p=Promise.withResolvers();return this.streamControllers[o].pullCall=p,h.postMessage({sourceName:l,targetName:c,stream:ot.PULL,streamId:o,desiredSize:f.desiredSize}),p.promise},cancel:f=>{Ie(f instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[o].cancelCall=p,this.streamControllers[o].isClosed=!0,h.postMessage({sourceName:l,targetName:c,stream:ot.CANCEL,streamId:o,reason:Bt(f)}),p.promise}},n)}#i(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,o=this.comObj,l=this,c=this.actionHandler[e.action],h={enqueue(f,p=1,g){if(this.isCancelled)return;const y=this.desiredSize;this.desiredSize-=p,y>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),o.postMessage({sourceName:n,targetName:s,stream:ot.ENQUEUE,streamId:t,chunk:f},g)},close(){this.isCancelled||(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:s,stream:ot.CLOSE,streamId:t}),delete l.streamSinks[t])},error(f){Ie(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,o.postMessage({sourceName:n,targetName:s,stream:ot.ERROR,streamId:t,reason:Bt(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:e.desiredSize,ready:null};h.sinkCapability.resolve(),h.ready=h.sinkCapability.promise,this.streamSinks[t]=h,Promise.try(c,e.data,h).then(function(){o.postMessage({sourceName:n,targetName:s,stream:ot.START_COMPLETE,streamId:t,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:ot.START_COMPLETE,streamId:t,reason:Bt(f)})})}#n(e){const t=e.streamId,n=this.sourceName,s=e.sourceName,o=this.comObj,l=this.streamControllers[t],c=this.streamSinks[t];switch(e.stream){case ot.START_COMPLETE:e.success?l.startCall.resolve():l.startCall.reject(Bt(e.reason));break;case ot.PULL_COMPLETE:e.success?l.pullCall.resolve():l.pullCall.reject(Bt(e.reason));break;case ot.PULL:if(!c){o.postMessage({sourceName:n,targetName:s,stream:ot.PULL_COMPLETE,streamId:t,success:!0});break}c.desiredSize<=0&&e.desiredSize>0&&c.sinkCapability.resolve(),c.desiredSize=e.desiredSize,Promise.try(c.onPull||im).then(function(){o.postMessage({sourceName:n,targetName:s,stream:ot.PULL_COMPLETE,streamId:t,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:ot.PULL_COMPLETE,streamId:t,reason:Bt(f)})});break;case ot.ENQUEUE:if(Ie(l,"enqueue should have stream controller"),l.isClosed)break;l.controller.enqueue(e.chunk);break;case ot.CLOSE:if(Ie(l,"close should have stream controller"),l.isClosed)break;l.isClosed=!0,l.controller.close(),this.#o(l,t);break;case ot.ERROR:Ie(l,"error should have stream controller"),l.controller.error(Bt(e.reason)),this.#o(l,t);break;case ot.CANCEL_COMPLETE:e.success?l.cancelCall.resolve():l.cancelCall.reject(Bt(e.reason)),this.#o(l,t);break;case ot.CANCEL:if(!c)break;const h=Bt(e.reason);Promise.try(c.onCancel||im,h).then(function(){o.postMessage({sourceName:n,targetName:s,stream:ot.CANCEL_COMPLETE,streamId:t,success:!0})},function(f){o.postMessage({sourceName:n,targetName:s,stream:ot.CANCEL_COMPLETE,streamId:t,reason:Bt(f)})}),c.sinkCapability.reject(h),c.isCancelled=!0,delete this.streamSinks[t];break;default:throw new Error("Unexpected stream case")}}async#o(e,t){await Promise.allSettled([e.startCall?.promise,e.pullCall?.promise,e.cancelCall?.promise]),delete this.streamControllers[t]}destroy(){this.#e?.abort(),this.#e=null}}class ev{#e=!1;constructor({enableHWA:e=!1}){this.#e=e}create(e,t){if(e<=0||t<=0)throw new Error("Invalid canvas size");const n=this._createCanvas(e,t);return{canvas:n,context:n.getContext("2d",{willReadFrequently:!this.#e})}}reset(e,t,n){if(!e.canvas)throw new Error("Canvas is not specified");if(t<=0||n<=0)throw new Error("Invalid canvas size");e.canvas.width=t,e.canvas.height=n}destroy(e){if(!e.canvas)throw new Error("Canvas is not specified");e.canvas.width=0,e.canvas.height=0,e.canvas=null,e.context=null}_createCanvas(e,t){Ue("Abstract method `_createCanvas` called.")}}class D1 extends ev{constructor({ownerDocument:e=globalThis.document,enableHWA:t=!1}){super({enableHWA:t}),this._document=e}_createCanvas(e,t){const n=this._document.createElement("canvas");return n.width=e,n.height=t,n}}class tv{constructor({baseUrl:e=null,isCompressed:t=!0}){this.baseUrl=e,this.isCompressed=t}async fetch({name:e}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!e)throw new Error("CMap name must be specified.");const t=this.baseUrl+e+(this.isCompressed?".bcmap":"");return this._fetch(t).then(n=>({cMapData:n,isCompressed:this.isCompressed})).catch(n=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${t}`)})}async _fetch(e){Ue("Abstract method `_fetch` called.")}}class sm extends tv{async _fetch(e){const t=await hr(e,this.isCompressed?"arraybuffer":"text");return t instanceof ArrayBuffer?new Uint8Array(t):Ro(t)}}class nv{addFilter(e){return"none"}addHCMFilter(e,t){return"none"}addAlphaFilter(e){return"none"}addLuminosityFilter(e){return"none"}addHighlightHCMFilter(e,t,n,s,o){return"none"}destroy(e=!1){}}class M1 extends nv{#e;#t;#i;#n;#o;#s;#r=0;constructor({docId:e,ownerDocument:t=globalThis.document}){super(),this.#n=e,this.#o=t}get#a(){return this.#t||=new Map}get#c(){return this.#s||=new Map}get#l(){if(!this.#i){const e=this.#o.createElement("div"),{style:t}=e;t.visibility="hidden",t.contain="strict",t.width=t.height=0,t.position="absolute",t.top=t.left=0,t.zIndex=-1;const n=this.#o.createElementNS(Qn,"svg");n.setAttribute("width",0),n.setAttribute("height",0),this.#i=this.#o.createElementNS(Qn,"defs"),e.append(n),n.append(this.#i),this.#o.body.append(e)}return this.#i}#d(e){if(e.length===1){const h=e[0],f=new Array(256);for(let g=0;g<256;g++)f[g]=h[g]/255;const p=f.join(",");return[p,p,p]}const[t,n,s]=e,o=new Array(256),l=new Array(256),c=new Array(256);for(let h=0;h<256;h++)o[h]=t[h]/255,l[h]=n[h]/255,c[h]=s[h]/255;return[o.join(","),l.join(","),c.join(",")]}#h(e){if(this.#e===void 0){this.#e="";const t=this.#o.URL;t!==this.#o.baseURI&&(Lo(t)?Ae('#createUrl: ignore "data:"-URL for performance reasons.'):this.#e=Yh(t,""))}return`url(${this.#e}#${e})`}addFilter(e){if(!e)return"none";let t=this.#a.get(e);if(t)return t;const[n,s,o]=this.#d(e),l=e.length===1?n:`${n}${s}${o}`;if(t=this.#a.get(l),t)return this.#a.set(e,t),t;const c=`g_${this.#n}_transfer_map_${this.#r++}`,h=this.#h(c);this.#a.set(e,h),this.#a.set(l,h);const f=this.#p(c);return this.#g(n,s,o,f),h}addHCMFilter(e,t){const n=`${e}-${t}`,s="base";let o=this.#c.get(s);if(o?.key===n||(o?(o.filter?.remove(),o.key=n,o.url="none",o.filter=null):(o={key:n,url:"none",filter:null},this.#c.set(s,o)),!e||!t))return o.url;const l=this.#w(e);e=re.makeHexColor(...l);const c=this.#w(t);if(t=re.makeHexColor(...c),this.#l.style.color="",e==="#000000"&&t==="#ffffff"||e===t)return o.url;const h=new Array(256);for(let w=0;w<=255;w++){const b=w/255;h[w]=b<=.03928?b/12.92:((b+.055)/1.055)**2.4}const f=h.join(","),p=`g_${this.#n}_hcm_filter`,g=o.filter=this.#p(p);this.#g(f,f,f,g),this.#m(g);const y=(w,b)=>{const _=l[w]/255,A=c[w]/255,E=new Array(b+1);for(let C=0;C<=b;C++)E[C]=_+C/b*(A-_);return E.join(",")};return this.#g(y(0,5),y(1,5),y(2,5),g),o.url=this.#h(p),o.url}addAlphaFilter(e){let t=this.#a.get(e);if(t)return t;const[n]=this.#d([e]),s=`alpha_${n}`;if(t=this.#a.get(s),t)return this.#a.set(e,t),t;const o=`g_${this.#n}_alpha_map_${this.#r++}`,l=this.#h(o);this.#a.set(e,l),this.#a.set(s,l);const c=this.#p(o);return this.#y(n,c),l}addLuminosityFilter(e){let t=this.#a.get(e||"luminosity");if(t)return t;let n,s;if(e?([n]=this.#d([e]),s=`luminosity_${n}`):s="luminosity",t=this.#a.get(s),t)return this.#a.set(e,t),t;const o=`g_${this.#n}_luminosity_map_${this.#r++}`,l=this.#h(o);this.#a.set(e,l),this.#a.set(s,l);const c=this.#p(o);return this.#f(c),e&&this.#y(n,c),l}addHighlightHCMFilter(e,t,n,s,o){const l=`${t}-${n}-${s}-${o}`;let c=this.#c.get(e);if(c?.key===l||(c?(c.filter?.remove(),c.key=l,c.url="none",c.filter=null):(c={key:l,url:"none",filter:null},this.#c.set(e,c)),!t||!n))return c.url;const[h,f]=[t,n].map(this.#w.bind(this));let p=Math.round(.2126*h[0]+.7152*h[1]+.0722*h[2]),g=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[y,w]=[s,o].map(this.#w.bind(this));g<p&&([p,g,y,w]=[g,p,w,y]),this.#l.style.color="";const b=(E,C,T)=>{const R=new Array(256),L=(g-p)/T,k=E/255,N=(C-E)/(255*T);let U=0;for(let z=0;z<=T;z++){const V=Math.round(p+z*L),q=k+z*N;for(let ue=U;ue<=V;ue++)R[ue]=q;U=V+1}for(let z=U;z<256;z++)R[z]=R[U-1];return R.join(",")},_=`g_${this.#n}_hcm_${e}_filter`,A=c.filter=this.#p(_);return this.#m(A),this.#g(b(y[0],w[0],5),b(y[1],w[1],5),b(y[2],w[2],5),A),c.url=this.#h(_),c.url}destroy(e=!1){e&&this.#s?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#t?.clear(),this.#t=null,this.#s?.clear(),this.#s=null,this.#r=0)}#f(e){const t=this.#o.createElementNS(Qn,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),e.append(t)}#m(e){const t=this.#o.createElementNS(Qn,"feColorMatrix");t.setAttribute("type","matrix"),t.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),e.append(t)}#p(e){const t=this.#o.createElementNS(Qn,"filter");return t.setAttribute("color-interpolation-filters","sRGB"),t.setAttribute("id",e),this.#l.append(t),t}#u(e,t,n){const s=this.#o.createElementNS(Qn,t);s.setAttribute("type","discrete"),s.setAttribute("tableValues",n),e.append(s)}#g(e,t,n,s){const o=this.#o.createElementNS(Qn,"feComponentTransfer");s.append(o),this.#u(o,"feFuncR",e),this.#u(o,"feFuncG",t),this.#u(o,"feFuncB",n)}#y(e,t){const n=this.#o.createElementNS(Qn,"feComponentTransfer");t.append(n),this.#u(n,"feFuncA",e)}#w(e){return this.#l.style.color=e,dr(getComputedStyle(this.#l).getPropertyValue("color"))}}class iv{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!e)throw new Error("Font filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load font data at: ${t}`)})}async _fetch(e){Ue("Abstract method `_fetch` called.")}}class rm extends iv{async _fetch(e){const t=await hr(e,"arraybuffer");return new Uint8Array(t)}}class sv{constructor({baseUrl:e=null}){this.baseUrl=e}async fetch({filename:e}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!e)throw new Error("Wasm filename must be specified.");const t=`${this.baseUrl}${e}`;return this._fetch(t).catch(n=>{throw new Error(`Unable to load wasm data at: ${t}`)})}async _fetch(e){Ue("Abstract method `_fetch` called.")}}class om extends sv{async _fetch(e){const t=await hr(e,"arraybuffer");return new Uint8Array(t)}}xt&&Ae("Please use the `legacy` build in Node.js environments.");async function sd(a){const t=await process.getBuiltinModule("fs").promises.readFile(a);return new Uint8Array(t)}class N1 extends nv{}class O1 extends ev{_createCanvas(e,t){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(e,t)}}class F1 extends tv{async _fetch(e){return sd(e)}}class B1 extends iv{async _fetch(e){return sd(e)}}class U1 extends sv{async _fetch(e){return sd(e)}}const Us="__forcedDependency",{floor:am,ceil:lm}=Math;function nl(a,e,t,n,s,o){a[e*4+0]=Math.min(a[e*4+0],t),a[e*4+1]=Math.min(a[e*4+1],n),a[e*4+2]=Math.max(a[e*4+2],s),a[e*4+3]=Math.max(a[e*4+3],o)}const wh=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class j1{#e;#t;constructor(e,t){this.#e=e,this.#t=t}get length(){return this.#e.length}isEmpty(e){return this.#e[e]===wh}minX(e){return this.#t[e*4+0]/256}minY(e){return this.#t[e*4+1]/256}maxX(e){return(this.#t[e*4+2]+1)/256}maxY(e){return(this.#t[e*4+3]+1)/256}}const il=(a,e)=>{if(!a)return;let t=a.get(e);return t||(t={dependencies:new Set,isRenderingOperation:!1},a.set(e,t)),t};class H1{#e={__proto__:null};#t={__proto__:null,transform:[],moveText:[],sameLineText:[],[Us]:[]};#i=new Map;#n=[];#o=[];#s=[[1,0,0,1,0,0]];#r=[-1/0,-1/0,1/0,1/0];#a=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#m;#p;#u;#g;constructor(e,t,n=!1){this.#f=e.width,this.#m=e.height,this.#y(t),n&&(this.#g=new Map)}growOperationsCount(e){e>=this.#u.length&&this.#y(e,this.#u)}#y(e,t){const n=new ArrayBuffer(e*4);this.#p=new Uint8ClampedArray(n),this.#u=new Uint32Array(n),t&&t.length>0?(this.#u.set(t),this.#u.fill(wh,t.length)):this.#u.fill(wh)}save(e){return this.#e={__proto__:this.#e},this.#t={__proto__:this.#t,transform:{__proto__:this.#t.transform},moveText:{__proto__:this.#t.moveText},sameLineText:{__proto__:this.#t.sameLineText},[Us]:{__proto__:this.#t[Us]}},this.#r={__proto__:this.#r},this.#n.push(e),this}restore(e){const t=Object.getPrototypeOf(this.#e);if(t===null)return this;this.#e=t,this.#t=Object.getPrototypeOf(this.#t),this.#r=Object.getPrototypeOf(this.#r);const n=this.#n.pop();return n!==void 0&&(il(this.#g,e)?.dependencies.add(n),this.#u[e]=this.#u[n]),this}recordOpenMarker(e){return this.#n.push(e),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)}recordCloseMarker(e){const t=this.#n.pop();return t!==void 0&&(il(this.#g,e)?.dependencies.add(t),this.#u[e]=this.#u[t]),this}beginMarkedContent(e){return this.#o.push(e),this}endMarkedContent(e){const t=this.#o.pop();return t!==void 0&&(il(this.#g,e)?.dependencies.add(t),this.#u[e]=this.#u[t]),this}pushBaseTransform(e){return this.#s.push(re.multiplyByDOMMatrix(this.#s.at(-1),e.getTransform())),this}popBaseTransform(){return this.#s.length>1&&this.#s.pop(),this}recordSimpleData(e,t){return this.#e[e]=t,this}recordIncrementalData(e,t){return this.#t[e].push(t),this}resetIncrementalData(e,t){return this.#t[e].length=0,this}recordNamedData(e,t){return this.#i.set(e,t),this}recordSimpleDataFromNamed(e,t,n){this.#e[e]=this.#i.get(t)??n}recordFutureForcedDependency(e,t){return this.recordIncrementalData(Us,t),this}inheritSimpleDataAsFutureForcedDependencies(e){for(const t of e)t in this.#e&&this.recordFutureForcedDependency(t,this.#e[t]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const e of this.#l)this.recordFutureForcedDependency(Us,e);return this}resetBBox(e){return this.#c!==e&&(this.#c=e,this.#a[0]=1/0,this.#a[1]=1/0,this.#a[2]=-1/0,this.#a[3]=-1/0),this}recordClipBox(e,t,n,s,o,l){const c=re.multiplyByDOMMatrix(this.#s.at(-1),t.getTransform()),h=[1/0,1/0,-1/0,-1/0];re.axialAlignedBoundingBox([n,o,s,l],c,h);const f=re.intersect(this.#r,h);return f?(this.#r[0]=f[0],this.#r[1]=f[1],this.#r[2]=f[2],this.#r[3]=f[3]):(this.#r[0]=this.#r[1]=1/0,this.#r[2]=this.#r[3]=-1/0),this}recordBBox(e,t,n,s,o,l){const c=this.#r;if(c[0]===1/0)return this;const h=re.multiplyByDOMMatrix(this.#s.at(-1),t.getTransform());if(c[0]===-1/0)return re.axialAlignedBoundingBox([n,o,s,l],h,this.#a),this;const f=[1/0,1/0,-1/0,-1/0];return re.axialAlignedBoundingBox([n,o,s,l],h,f),this.#a[0]=Math.min(this.#a[0],Math.max(f[0],c[0])),this.#a[1]=Math.min(this.#a[1],Math.max(f[1],c[1])),this.#a[2]=Math.max(this.#a[2],Math.min(f[2],c[2])),this.#a[3]=Math.max(this.#a[3],Math.min(f[3],c[3])),this}recordCharacterBBox(e,t,n,s=1,o=0,l=0,c){const h=n.bbox;let f,p;if(h&&(f=h[2]!==h[0]&&h[3]!==h[1]&&this.#h.get(n),f!==!1&&(p=[0,0,0,0],re.axialAlignedBoundingBox(h,n.fontMatrix,p),(s!==1||o!==0||l!==0)&&re.scaleMinMax([s,0,0,-s,o,l],p),f)))return this.recordBBox(e,t,p[0],p[2],p[1],p[3]);if(!c)return this.recordFullPageBBox(e);const g=c();return h&&p&&f===void 0&&(f=p[0]<=o-g.actualBoundingBoxLeft&&p[2]>=o+g.actualBoundingBoxRight&&p[1]<=l-g.actualBoundingBoxAscent&&p[3]>=l+g.actualBoundingBoxDescent,this.#h.set(n,f),f)?this.recordBBox(e,t,p[0],p[2],p[1],p[3]):this.recordBBox(e,t,o-g.actualBoundingBoxLeft,o+g.actualBoundingBoxRight,l-g.actualBoundingBoxAscent,l+g.actualBoundingBoxDescent)}recordFullPageBBox(e){return this.#a[0]=Math.max(0,this.#r[0]),this.#a[1]=Math.max(0,this.#r[1]),this.#a[2]=Math.min(this.#f,this.#r[2]),this.#a[3]=Math.min(this.#m,this.#r[3]),this}getSimpleIndex(e){return this.#e[e]}recordDependencies(e,t){const n=this.#l,s=this.#e,o=this.#t;for(const l of t)l in this.#e?n.add(s[l]):l in o&&o[l].forEach(n.add,n);return this}recordNamedDependency(e,t){return this.#i.has(t)&&this.#l.add(this.#i.get(t)),this}recordOperation(e,t=!1){if(this.recordDependencies(e,[Us]),this.#g){const n=il(this.#g,e),{dependencies:s}=n;this.#l.forEach(s.add,s),this.#n.forEach(s.add,s),this.#o.forEach(s.add,s),s.delete(e),n.isRenderingOperation=!0}if(this.#c===e){const n=am(this.#a[0]*256/this.#f),s=am(this.#a[1]*256/this.#m),o=lm(this.#a[2]*256/this.#f),l=lm(this.#a[3]*256/this.#m);nl(this.#p,e,n,s,o,l);for(const c of this.#l)c!==e&&nl(this.#p,c,n,s,o,l);for(const c of this.#n)c!==e&&nl(this.#p,c,n,s,o,l);for(const c of this.#o)c!==e&&nl(this.#p,c,n,s,o,l);t||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(e,t=!1){const n=Array.from(this.#l);this.recordOperation(e,t),this.recordIncrementalData("sameLineText",e);for(const s of n)this.recordIncrementalData("sameLineText",s);return this}bboxToClipBoxDropOperation(e,t=!1){return this.#c===e&&(this.#c=-1,this.#r[0]=Math.max(this.#r[0],this.#a[0]),this.#r[1]=Math.max(this.#r[1],this.#a[1]),this.#r[2]=Math.min(this.#r[2],this.#a[2]),this.#r[3]=Math.min(this.#r[3],this.#a[3]),t||this.#l.clear()),this}_takePendingDependencies(){const e=this.#l;return this.#l=new Set,e}_extractOperation(e){const t=this.#d.get(e);return this.#d.delete(e),t}_pushPendingDependencies(e){for(const t of e)this.#l.add(t)}take(){return this.#h.clear(),new j1(this.#u,this.#p)}takeDebugMetadata(){return this.#g}}class xl{#e;#t;#i;#n=0;#o=0;constructor(e,t,n){if(e instanceof xl&&e.#i===!!n)return e;this.#e=e,this.#t=t,this.#i=!!n}growOperationsCount(){throw new Error("Unreachable")}save(e){return this.#o++,this.#e.save(this.#t),this}restore(e){return this.#o>0&&(this.#e.restore(this.#t),this.#o--),this}recordOpenMarker(e){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#t:this.#e.getOpenMarker()}recordCloseMarker(e){return this.#n--,this}beginMarkedContent(e){return this}endMarkedContent(e){return this}pushBaseTransform(e){return this.#e.pushBaseTransform(e),this}popBaseTransform(){return this.#e.popBaseTransform(),this}recordSimpleData(e,t){return this.#e.recordSimpleData(e,this.#t),this}recordIncrementalData(e,t){return this.#e.recordIncrementalData(e,this.#t),this}resetIncrementalData(e,t){return this.#e.resetIncrementalData(e,this.#t),this}recordNamedData(e,t){return this}recordSimpleDataFromNamed(e,t,n){return this.#e.recordSimpleDataFromNamed(e,t,this.#t),this}recordFutureForcedDependency(e,t){return this.#e.recordFutureForcedDependency(e,this.#t),this}inheritSimpleDataAsFutureForcedDependencies(e){return this.#e.inheritSimpleDataAsFutureForcedDependencies(e),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#e.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(e){return this.#i||this.#e.resetBBox(this.#t),this}recordClipBox(e,t,n,s,o,l){return this.#i||this.#e.recordClipBox(this.#t,t,n,s,o,l),this}recordBBox(e,t,n,s,o,l){return this.#i||this.#e.recordBBox(this.#t,t,n,s,o,l),this}recordCharacterBBox(e,t,n,s,o,l,c){return this.#i||this.#e.recordCharacterBBox(this.#t,t,n,s,o,l,c),this}recordFullPageBBox(e){return this.#i||this.#e.recordFullPageBBox(this.#t),this}getSimpleIndex(e){return this.#e.getSimpleIndex(e)}recordDependencies(e,t){return this.#e.recordDependencies(this.#t,t),this}recordNamedDependency(e,t){return this.#e.recordNamedDependency(this.#t,t),this}recordOperation(e){return this.#e.recordOperation(this.#t,!0),this}recordShowTextOperation(e){return this.#e.recordShowTextOperation(this.#t,!0),this}bboxToClipBoxDropOperation(e){return this.#i||this.#e.bboxToClipBoxDropOperation(this.#t,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const sn={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},vt={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function _h(a,e){if(!e)return;const t=e[2]-e[0],n=e[3]-e[1],s=new Path2D;s.rect(e[0],e[1],t,n),a.clip(s)}class rd{isModifyingCurrentTransform(){return!1}getPattern(){Ue("Abstract method `getPattern` called.")}}class z1 extends rd{constructor(e){super(),this._type=e[1],this._bbox=e[2],this._colorStops=e[3],this._p0=e[4],this._p1=e[5],this._r0=e[6],this._r1=e[7],this.matrix=null}_createGradient(e){let t;this._type==="axial"?t=e.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(t=e.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const n of this._colorStops)t.addColorStop(n[0],n[1]);return t}getPattern(e,t,n,s){let o;if(s===vt.STROKE||s===vt.FILL){const l=t.current.getClippedPathBoundingBox(s,Ke(e))||[0,0,0,0],c=Math.ceil(l[2]-l[0])||1,h=Math.ceil(l[3]-l[1])||1,f=t.cachedCanvases.getCanvas("pattern",c,h),p=f.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-l[0],-l[1]),n=re.transform(n,[1,0,0,1,l[0],l[1]]),p.transform(...t.baseTransform),this.matrix&&p.transform(...this.matrix),_h(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),o=e.createPattern(f.canvas,"no-repeat");const g=new DOMMatrix(n);o.setTransform(g)}else _h(e,this._bbox),o=this._createGradient(e);return o}}function Zu(a,e,t,n,s,o,l,c){const h=e.coords,f=e.colors,p=a.data,g=a.width*4;let y;h[t+1]>h[n+1]&&(y=t,t=n,n=y,y=o,o=l,l=y),h[n+1]>h[s+1]&&(y=n,n=s,s=y,y=l,l=c,c=y),h[t+1]>h[n+1]&&(y=t,t=n,n=y,y=o,o=l,l=y);const w=(h[t]+e.offsetX)*e.scaleX,b=(h[t+1]+e.offsetY)*e.scaleY,_=(h[n]+e.offsetX)*e.scaleX,A=(h[n+1]+e.offsetY)*e.scaleY,E=(h[s]+e.offsetX)*e.scaleX,C=(h[s+1]+e.offsetY)*e.scaleY;if(b>=C)return;const T=f[o],R=f[o+1],L=f[o+2],k=f[l],N=f[l+1],U=f[l+2],z=f[c],V=f[c+1],q=f[c+2],ue=Math.round(b),Q=Math.round(C);let le,ye,J,K,$,ee,Z,M;for(let H=ue;H<=Q;H++){if(H<A){const fe=H<b?0:(b-H)/(b-A);le=w-(w-_)*fe,ye=T-(T-k)*fe,J=R-(R-N)*fe,K=L-(L-U)*fe}else{let fe;H>C?fe=1:A===C?fe=0:fe=(A-H)/(A-C),le=_-(_-E)*fe,ye=k-(k-z)*fe,J=N-(N-V)*fe,K=U-(U-q)*fe}let ne;H<b?ne=0:H>C?ne=1:ne=(b-H)/(b-C),$=w-(w-E)*ne,ee=T-(T-z)*ne,Z=R-(R-V)*ne,M=L-(L-q)*ne;const de=Math.round(Math.min(le,$)),we=Math.round(Math.max(le,$));let ve=g*H+de*4;for(let fe=de;fe<=we;fe++)ne=(le-fe)/(le-$),ne<0?ne=0:ne>1&&(ne=1),p[ve++]=ye-(ye-ee)*ne|0,p[ve++]=J-(J-Z)*ne|0,p[ve++]=K-(K-M)*ne|0,p[ve++]=255}}function $1(a,e,t){const n=e.coords,s=e.colors;let o,l;switch(e.type){case"lattice":const c=e.verticesPerRow,h=Math.floor(n.length/c)-1,f=c-1;for(o=0;o<h;o++){let p=o*c;for(let g=0;g<f;g++,p++)Zu(a,t,n[p],n[p+1],n[p+c],s[p],s[p+1],s[p+c]),Zu(a,t,n[p+c+1],n[p+1],n[p+c],s[p+c+1],s[p+1],s[p+c])}break;case"triangles":for(o=0,l=n.length;o<l;o+=3)Zu(a,t,n[o],n[o+1],n[o+2],s[o],s[o+1],s[o+2]);break;default:throw new Error("illegal figure")}}class V1 extends rd{constructor(e){super(),this._coords=e[2],this._colors=e[3],this._figures=e[4],this._bounds=e[5],this._bbox=e[6],this._background=e[7],this.matrix=null}_createMeshCanvas(e,t,n){const c=Math.floor(this._bounds[0]),h=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-c,p=Math.ceil(this._bounds[3])-h,g=Math.min(Math.ceil(Math.abs(f*e[0]*1.1)),3e3),y=Math.min(Math.ceil(Math.abs(p*e[1]*1.1)),3e3),w=f/g,b=p/y,_={coords:this._coords,colors:this._colors,offsetX:-c,offsetY:-h,scaleX:1/w,scaleY:1/b},A=g+4,E=y+4,C=n.getCanvas("mesh",A,E),T=C.context,R=T.createImageData(g,y);if(t){const k=R.data;for(let N=0,U=k.length;N<U;N+=4)k[N]=t[0],k[N+1]=t[1],k[N+2]=t[2],k[N+3]=255}for(const k of this._figures)$1(R,k,_);return T.putImageData(R,2,2),{canvas:C.canvas,offsetX:c-2*w,offsetY:h-2*b,scaleX:w,scaleY:b}}isModifyingCurrentTransform(){return!0}getPattern(e,t,n,s){_h(e,this._bbox);const o=new Float32Array(2);if(s===vt.SHADING)re.singularValueDecompose2dScale(Ke(e),o);else if(this.matrix){re.singularValueDecompose2dScale(this.matrix,o);const[c,h]=o;re.singularValueDecompose2dScale(t.baseTransform,o),o[0]*=c,o[1]*=h}else re.singularValueDecompose2dScale(t.baseTransform,o);const l=this._createMeshCanvas(o,s===vt.SHADING?null:this._background,t.cachedCanvases);return s!==vt.SHADING&&(e.setTransform(...t.baseTransform),this.matrix&&e.transform(...this.matrix)),e.translate(l.offsetX,l.offsetY),e.scale(l.scaleX,l.scaleY),e.createPattern(l.canvas,"no-repeat")}}class W1 extends rd{getPattern(){return"hotpink"}}function G1(a){switch(a[0]){case"RadialAxial":return new z1(a);case"Mesh":return new V1(a);case"Dummy":return new W1}throw new Error(`Unknown IR type: ${a[0]}`)}const cm={COLORED:1,UNCOLORED:2};class od{static MAX_PATTERN_SIZE=3e3;constructor(e,t,n,s){this.color=e[1],this.operatorList=e[2],this.matrix=e[3],this.bbox=e[4],this.xstep=e[5],this.ystep=e[6],this.paintType=e[7],this.tilingType=e[8],this.ctx=t,this.canvasGraphicsFactory=n,this.baseTransform=s}createPatternCanvas(e,t){const{bbox:n,operatorList:s,paintType:o,tilingType:l,color:c,canvasGraphicsFactory:h}=this;let{xstep:f,ystep:p}=this;f=Math.abs(f),p=Math.abs(p),Fl("TilingType: "+l);const g=n[0],y=n[1],w=n[2],b=n[3],_=w-g,A=b-y,E=new Float32Array(2);re.singularValueDecompose2dScale(this.matrix,E);const[C,T]=E;re.singularValueDecompose2dScale(this.baseTransform,E);const R=C*E[0],L=T*E[1];let k=_,N=A,U=!1,z=!1;const V=Math.ceil(f*R),q=Math.ceil(p*L),ue=Math.ceil(_*R),Q=Math.ceil(A*L);V>=ue?k=f:U=!0,q>=Q?N=p:z=!0;const le=this.getSizeAndScale(k,this.ctx.canvas.width,R),ye=this.getSizeAndScale(N,this.ctx.canvas.height,L),J=e.cachedCanvases.getCanvas("pattern",le.size,ye.size),K=J.context,$=h.createCanvasGraphics(K,t);if($.groupLevel=e.groupLevel,this.setFillAndStrokeStyleToContext($,o,c),K.translate(-le.scale*g,-ye.scale*y),$.transform(0,le.scale,0,0,ye.scale,0,0),K.save(),$.dependencyTracker?.save(),this.clipBbox($,g,y,w,b),$.baseTransform=Ke($.ctx),$.executeOperatorList(s),$.endDrawing(),$.dependencyTracker?.restore(),K.restore(),U||z){const ee=J.canvas;U&&(k=f),z&&(N=p);const Z=this.getSizeAndScale(k,this.ctx.canvas.width,R),M=this.getSizeAndScale(N,this.ctx.canvas.height,L),H=Z.size,ne=M.size,de=e.cachedCanvases.getCanvas("pattern-workaround",H,ne),we=de.context,ve=U?Math.floor(_/f):0,fe=z?Math.floor(A/p):0;for(let Ce=0;Ce<=ve;Ce++)for(let Te=0;Te<=fe;Te++)we.drawImage(ee,H*Ce,ne*Te,H,ne,0,0,H,ne);return{canvas:de.canvas,scaleX:Z.scale,scaleY:M.scale,offsetX:g,offsetY:y}}return{canvas:J.canvas,scaleX:le.scale,scaleY:ye.scale,offsetX:g,offsetY:y}}getSizeAndScale(e,t,n){const s=Math.max(od.MAX_PATTERN_SIZE,t);let o=Math.ceil(e*n);return o>=s?o=s:n=o/e,{scale:n,size:o}}clipBbox(e,t,n,s,o){const l=s-t,c=o-n;e.ctx.rect(t,n,l,c),re.axialAlignedBoundingBox([t,n,s,o],Ke(e.ctx),e.current.minMax),e.clip(),e.endPath()}setFillAndStrokeStyleToContext(e,t,n){const s=e.ctx,o=e.current;switch(t){case cm.COLORED:const{fillStyle:l,strokeStyle:c}=this.ctx;s.fillStyle=o.fillColor=l,s.strokeStyle=o.strokeColor=c;break;case cm.UNCOLORED:s.fillStyle=s.strokeStyle=n,o.fillColor=o.strokeColor=n;break;default:throw new f1(`Unsupported paint type: ${t}`)}}isModifyingCurrentTransform(){return!1}getPattern(e,t,n,s,o){let l=n;s!==vt.SHADING&&(l=re.transform(l,t.baseTransform),this.matrix&&(l=re.transform(l,this.matrix)));const c=this.createPatternCanvas(t,o);let h=new DOMMatrix(l);h=h.translate(c.offsetX,c.offsetY),h=h.scale(1/c.scaleX,1/c.scaleY);const f=e.createPattern(c.canvas,"repeat");return f.setTransform(h),f}}function q1({src:a,srcPos:e=0,dest:t,width:n,height:s,nonBlackColor:o=4294967295,inverseDecode:l=!1}){const c=pt.isLittleEndian?4278190080:255,[h,f]=l?[o,c]:[c,o],p=n>>3,g=n&7,y=a.length;t=new Uint32Array(t.buffer);let w=0;for(let b=0;b<s;b++){for(const A=e+p;e<A;e++){const E=e<y?a[e]:255;t[w++]=E&128?f:h,t[w++]=E&64?f:h,t[w++]=E&32?f:h,t[w++]=E&16?f:h,t[w++]=E&8?f:h,t[w++]=E&4?f:h,t[w++]=E&2?f:h,t[w++]=E&1?f:h}if(g===0)continue;const _=e<y?a[e++]:255;for(let A=0;A<g;A++)t[w++]=_&1<<7-A?f:h}return{srcPos:e,destPos:w}}const um=16,hm=100,X1=15,dm=10,Ut=16,eh=new DOMMatrix,Gt=new Float32Array(2),zs=new Float32Array([1/0,1/0,-1/0,-1/0]);function K1(a,e){if(a._removeMirroring)throw new Error("Context is already forwarding operations.");a.__originalSave=a.save,a.__originalRestore=a.restore,a.__originalRotate=a.rotate,a.__originalScale=a.scale,a.__originalTranslate=a.translate,a.__originalTransform=a.transform,a.__originalSetTransform=a.setTransform,a.__originalResetTransform=a.resetTransform,a.__originalClip=a.clip,a.__originalMoveTo=a.moveTo,a.__originalLineTo=a.lineTo,a.__originalBezierCurveTo=a.bezierCurveTo,a.__originalRect=a.rect,a.__originalClosePath=a.closePath,a.__originalBeginPath=a.beginPath,a._removeMirroring=()=>{a.save=a.__originalSave,a.restore=a.__originalRestore,a.rotate=a.__originalRotate,a.scale=a.__originalScale,a.translate=a.__originalTranslate,a.transform=a.__originalTransform,a.setTransform=a.__originalSetTransform,a.resetTransform=a.__originalResetTransform,a.clip=a.__originalClip,a.moveTo=a.__originalMoveTo,a.lineTo=a.__originalLineTo,a.bezierCurveTo=a.__originalBezierCurveTo,a.rect=a.__originalRect,a.closePath=a.__originalClosePath,a.beginPath=a.__originalBeginPath,delete a._removeMirroring},a.save=function(){e.save(),this.__originalSave()},a.restore=function(){e.restore(),this.__originalRestore()},a.translate=function(t,n){e.translate(t,n),this.__originalTranslate(t,n)},a.scale=function(t,n){e.scale(t,n),this.__originalScale(t,n)},a.transform=function(t,n,s,o,l,c){e.transform(t,n,s,o,l,c),this.__originalTransform(t,n,s,o,l,c)},a.setTransform=function(t,n,s,o,l,c){e.setTransform(t,n,s,o,l,c),this.__originalSetTransform(t,n,s,o,l,c)},a.resetTransform=function(){e.resetTransform(),this.__originalResetTransform()},a.rotate=function(t){e.rotate(t),this.__originalRotate(t)},a.clip=function(t){e.clip(t),this.__originalClip(t)},a.moveTo=function(t,n){e.moveTo(t,n),this.__originalMoveTo(t,n)},a.lineTo=function(t,n){e.lineTo(t,n),this.__originalLineTo(t,n)},a.bezierCurveTo=function(t,n,s,o,l,c){e.bezierCurveTo(t,n,s,o,l,c),this.__originalBezierCurveTo(t,n,s,o,l,c)},a.rect=function(t,n,s,o){e.rect(t,n,s,o),this.__originalRect(t,n,s,o)},a.closePath=function(){e.closePath(),this.__originalClosePath()},a.beginPath=function(){e.beginPath(),this.__originalBeginPath()}}class Y1{constructor(e){this.canvasFactory=e,this.cache=Object.create(null)}getCanvas(e,t,n){let s;return this.cache[e]!==void 0?(s=this.cache[e],this.canvasFactory.reset(s,t,n)):(s=this.canvasFactory.create(t,n),this.cache[e]=s),s}delete(e){delete this.cache[e]}clear(){for(const e in this.cache){const t=this.cache[e];this.canvasFactory.destroy(t),delete this.cache[e]}}}function sl(a,e,t,n,s,o,l,c,h,f){const[p,g,y,w,b,_]=Ke(a);if(g===0&&y===0){const C=l*p+b,T=Math.round(C),R=c*w+_,L=Math.round(R),k=(l+h)*p+b,N=Math.abs(Math.round(k)-T)||1,U=(c+f)*w+_,z=Math.abs(Math.round(U)-L)||1;return a.setTransform(Math.sign(p),0,0,Math.sign(w),T,L),a.drawImage(e,t,n,s,o,0,0,N,z),a.setTransform(p,g,y,w,b,_),[N,z]}if(p===0&&w===0){const C=c*y+b,T=Math.round(C),R=l*g+_,L=Math.round(R),k=(c+f)*y+b,N=Math.abs(Math.round(k)-T)||1,U=(l+h)*g+_,z=Math.abs(Math.round(U)-L)||1;return a.setTransform(0,Math.sign(g),Math.sign(y),0,T,L),a.drawImage(e,t,n,s,o,0,0,z,N),a.setTransform(p,g,y,w,b,_),[z,N]}a.drawImage(e,t,n,s,o,l,c,h,f);const A=Math.hypot(p,g),E=Math.hypot(y,w);return[A*h,E*f]}class fm{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=gh;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=yt.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(e,t,n){n?.(this),this.clipBox=new Float32Array([0,0,e,t]),this.minMax=zs.slice()}clone(){const e=Object.create(this);return e.clipBox=this.clipBox.slice(),e.minMax=this.minMax.slice(),e}getPathBoundingBox(e=vt.FILL,t=null){const n=this.minMax.slice();if(e===vt.STROKE){t||Ue("Stroke bounding box must include transform."),re.singularValueDecompose2dScale(t,Gt);const s=Gt[0]*this.lineWidth/2,o=Gt[1]*this.lineWidth/2;n[0]-=s,n[1]-=o,n[2]+=s,n[3]+=o}return n}updateClipFromPath(){const e=re.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(e||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(e){this.clipBox.set(e,0),this.minMax.set(zs,0)}getClippedPathBoundingBox(e=vt.FILL,t=null){return re.intersect(this.clipBox,this.getPathBoundingBox(e,t))}}function pm(a,e){if(e instanceof ImageData){a.putImageData(e,0,0);return}const t=e.height,n=e.width,s=t%Ut,o=(t-s)/Ut,l=s===0?o:o+1,c=a.createImageData(n,Ut);let h=0,f;const p=e.data,g=c.data;let y,w,b,_;if(e.kind===lo.GRAYSCALE_1BPP){const A=p.byteLength,E=new Uint32Array(g.buffer,0,g.byteLength>>2),C=E.length,T=n+7>>3,R=4294967295,L=pt.isLittleEndian?4278190080:255;for(y=0;y<l;y++){for(b=y<o?Ut:s,f=0,w=0;w<b;w++){const k=A-h;let N=0;const U=k>T?n:k*8-7,z=U&-8;let V=0,q=0;for(;N<z;N+=8)q=p[h++],E[f++]=q&128?R:L,E[f++]=q&64?R:L,E[f++]=q&32?R:L,E[f++]=q&16?R:L,E[f++]=q&8?R:L,E[f++]=q&4?R:L,E[f++]=q&2?R:L,E[f++]=q&1?R:L;for(;N<U;N++)V===0&&(q=p[h++],V=128),E[f++]=q&V?R:L,V>>=1}for(;f<C;)E[f++]=0;a.putImageData(c,0,y*Ut)}}else if(e.kind===lo.RGBA_32BPP){for(w=0,_=n*Ut*4,y=0;y<o;y++)g.set(p.subarray(h,h+_)),h+=_,a.putImageData(c,0,w),w+=Ut;y<l&&(_=n*s*4,g.set(p.subarray(h,h+_)),a.putImageData(c,0,w))}else if(e.kind===lo.RGB_24BPP)for(b=Ut,_=n*b,y=0;y<l;y++){for(y>=o&&(b=s,_=n*b),f=0,w=_;w--;)g[f++]=p[h++],g[f++]=p[h++],g[f++]=p[h++],g[f++]=255;a.putImageData(c,0,y*Ut)}else throw new Error(`bad image kind: ${e.kind}`)}function gm(a,e){if(e.bitmap){a.drawImage(e.bitmap,0,0);return}const t=e.height,n=e.width,s=t%Ut,o=(t-s)/Ut,l=s===0?o:o+1,c=a.createImageData(n,Ut);let h=0;const f=e.data,p=c.data;for(let g=0;g<l;g++){const y=g<o?Ut:s;({srcPos:h}=q1({src:f,srcPos:h,dest:p,width:n,height:y,nonBlackColor:0})),a.putImageData(c,0,g*Ut)}}function Zr(a,e){const t=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const n of t)a[n]!==void 0&&(e[n]=a[n]);a.setLineDash!==void 0&&(e.setLineDash(a.getLineDash()),e.lineDashOffset=a.lineDashOffset)}function rl(a){a.strokeStyle=a.fillStyle="#000000",a.fillRule="nonzero",a.globalAlpha=1,a.lineWidth=1,a.lineCap="butt",a.lineJoin="miter",a.miterLimit=10,a.globalCompositeOperation="source-over",a.font="10px sans-serif",a.setLineDash!==void 0&&(a.setLineDash([]),a.lineDashOffset=0);const{filter:e}=a;e!=="none"&&e!==""&&(a.filter="none")}function mm(a,e){if(e)return!0;re.singularValueDecompose2dScale(a,Gt);const t=Math.fround(An.pixelRatio*us.PDF_TO_CSS_UNITS);return Gt[0]<=t&&Gt[1]<=t}const Q1=["butt","round","square"],J1=["miter","round","bevel"],Z1={},ym={};class Xs{constructor(e,t,n,s,o,{optionalContentConfig:l,markedContentStack:c=null},h,f,p){this.ctx=e,this.current=new fm(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=t,this.objs=n,this.canvasFactory=s,this.filterFactory=o,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=c||[],this.optionalContentConfig=l,this.cachedCanvases=new Y1(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=h,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(e,t,n=null){return typeof t=="string"?(this.dependencyTracker?.recordNamedDependency(e,t),t.startsWith("g_")?this.commonObjs.get(t):this.objs.get(t)):n}beginDrawing({transform:e,viewport:t,transparency:n=!1,background:s=null}){const o=this.ctx.canvas.width,l=this.ctx.canvas.height,c=this.ctx.fillStyle;if(this.ctx.fillStyle=s||"#ffffff",this.ctx.fillRect(0,0,o,l),this.ctx.fillStyle=c,n){const h=this.cachedCanvases.getCanvas("transparent",o,l);this.compositeCtx=this.ctx,this.transparentCanvas=h.canvas,this.ctx=h.context,this.ctx.save(),this.ctx.transform(...Ke(this.compositeCtx))}this.ctx.save(),rl(this.ctx),e&&(this.ctx.transform(...e),this.outputScaleX=e[0],this.outputScaleY=e[0]),this.ctx.transform(...t.transform),this.viewportScale=t.scale,this.baseTransform=Ke(this.ctx)}executeOperatorList(e,t,n,s,o){const l=e.argsArray,c=e.fnArray;let h=t||0;const f=l.length;if(f===h)return h;const p=f-h>dm&&typeof n=="function",g=p?Date.now()+X1:0;let y=0;const w=this.commonObjs,b=this.objs;let _,A;for(;;){if(s!==void 0&&h===s.nextBreakPoint)return s.breakIt(h,n),h;if(!o||o(h))if(_=c[h],A=l[h]??null,_!==ir.dependency)A===null?this[_](h):this[_](h,...A);else for(const E of A){this.dependencyTracker?.recordNamedData(E,h);const C=E.startsWith("g_")?w:b;if(!C.has(E))return C.get(E,n),h}if(h++,h===f)return h;if(p&&++y>dm){if(Date.now()>g)return n(),h;y=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const e of this._cachedBitmapsMap.values()){for(const t of e.values())typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement&&(t.width=t.height=0);e.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const e=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(e!=="none"){const t=this.ctx.filter;this.ctx.filter=e,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=t}}}_scaleImage(e,t){const n=e.width??e.displayWidth,s=e.height??e.displayHeight;let o=Math.max(Math.hypot(t[0],t[1]),1),l=Math.max(Math.hypot(t[2],t[3]),1),c=n,h=s,f="prescale1",p,g;for(;o>2&&c>1||l>2&&h>1;){let y=c,w=h;o>2&&c>1&&(y=c>=16384?Math.floor(c/2)-1||1:Math.ceil(c/2),o/=c/y),l>2&&h>1&&(w=h>=16384?Math.floor(h/2)-1||1:Math.ceil(h)/2,l/=h/w),p=this.cachedCanvases.getCanvas(f,y,w),g=p.context,g.clearRect(0,0,y,w),g.drawImage(e,0,0,c,h,0,0,y,w),e=p.canvas,c=y,h=w,f=f==="prescale1"?"prescale2":"prescale1"}return{img:e,paintWidth:c,paintHeight:h}}_createMaskCanvas(e,t){const n=this.ctx,{width:s,height:o}=t,l=this.current.fillColor,c=this.current.patternFill,h=Ke(n);let f,p,g,y;if((t.bitmap||t.data)&&t.count>1){const V=t.bitmap||t.data.buffer;p=JSON.stringify(c?h:[h.slice(0,4),l]),f=this._cachedBitmapsMap.get(V),f||(f=new Map,this._cachedBitmapsMap.set(V,f));const q=f.get(p);if(q&&!c){const ue=Math.round(Math.min(h[0],h[2])+h[4]),Q=Math.round(Math.min(h[1],h[3])+h[5]);return this.dependencyTracker?.recordDependencies(e,sn.transformAndFill),{canvas:q,offsetX:ue,offsetY:Q}}g=q}g||(y=this.cachedCanvases.getCanvas("maskCanvas",s,o),gm(y.context,t));let w=re.transform(h,[1/s,0,0,-1/o,0,0]);w=re.transform(w,[1,0,0,1,0,-o]);const b=zs.slice();re.axialAlignedBoundingBox([0,0,s,o],w,b);const[_,A,E,C]=b,T=Math.round(E-_)||1,R=Math.round(C-A)||1,L=this.cachedCanvases.getCanvas("fillCanvas",T,R),k=L.context,N=_,U=A;k.translate(-N,-U),k.transform(...w),g||(g=this._scaleImage(y.canvas,Ln(k)),g=g.img,f&&c&&f.set(p,g)),k.imageSmoothingEnabled=mm(Ke(k),t.interpolate),sl(k,g,0,0,g.width,g.height,0,0,s,o),k.globalCompositeOperation="source-in";const z=re.transform(Ln(k),[1,0,0,1,-N,-U]);return k.fillStyle=c?l.getPattern(n,this,z,vt.FILL,e):l,k.fillRect(0,0,s,o),f&&!c&&(this.cachedCanvases.delete("fillCanvas"),f.set(p,L.canvas)),this.dependencyTracker?.recordDependencies(e,sn.transformAndFill),{canvas:L.canvas,offsetX:Math.round(N),offsetY:Math.round(U)}}setLineWidth(e,t){this.dependencyTracker?.recordSimpleData("lineWidth",e),t!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=t,this.ctx.lineWidth=t}setLineCap(e,t){this.dependencyTracker?.recordSimpleData("lineCap",e),this.ctx.lineCap=Q1[t]}setLineJoin(e,t){this.dependencyTracker?.recordSimpleData("lineJoin",e),this.ctx.lineJoin=J1[t]}setMiterLimit(e,t){this.dependencyTracker?.recordSimpleData("miterLimit",e),this.ctx.miterLimit=t}setDash(e,t,n){this.dependencyTracker?.recordSimpleData("dash",e);const s=this.ctx;s.setLineDash!==void 0&&(s.setLineDash(t),s.lineDashOffset=n)}setRenderingIntent(e,t){}setFlatness(e,t){}setGState(e,t){for(const[n,s]of t)switch(n){case"LW":this.setLineWidth(e,s);break;case"LC":this.setLineCap(e,s);break;case"LJ":this.setLineJoin(e,s);break;case"ML":this.setMiterLimit(e,s);break;case"D":this.setDash(e,s[0],s[1]);break;case"RI":this.setRenderingIntent(e,s);break;case"FL":this.setFlatness(e,s);break;case"Font":this.setFont(e,s[0],s[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",e),this.current.strokeAlpha=s;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",e),this.ctx.globalAlpha=this.current.fillAlpha=s;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",e),this.ctx.globalCompositeOperation=s;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",e),this.current.activeSMask=s?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",e),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(s);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const e=this.inSMaskMode;this.current.activeSMask&&!e?this.beginSMaskMode():!this.current.activeSMask&&e&&this.endSMaskMode()}beginSMaskMode(e){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const t=this.ctx.canvas.width,n=this.ctx.canvas.height,s="smaskGroupAt"+this.groupLevel,o=this.cachedCanvases.getCanvas(s,t,n);this.suspendedCtx=this.ctx;const l=this.ctx=o.context;l.setTransform(this.suspendedCtx.getTransform()),Zr(this.suspendedCtx,l),K1(l,this.suspendedCtx),this.setGState(e,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Zr(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(e){if(!this.current.activeSMask)return;e?(e[0]=Math.floor(e[0]),e[1]=Math.floor(e[1]),e[2]=Math.ceil(e[2]),e[3]=Math.ceil(e[3])):e=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const t=this.current.activeSMask,n=this.suspendedCtx;this.composeSMask(n,t,this.ctx,e),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(e,t,n,s){const o=s[0],l=s[1],c=s[2]-o,h=s[3]-l;c===0||h===0||(this.genericComposeSMask(t.context,n,c,h,t.subtype,t.backdrop,t.transferMap,o,l,t.offsetX,t.offsetY),e.save(),e.globalAlpha=1,e.globalCompositeOperation="source-over",e.setTransform(1,0,0,1,0,0),e.drawImage(n.canvas,0,0),e.restore())}genericComposeSMask(e,t,n,s,o,l,c,h,f,p,g){let y=e.canvas,w=h-p,b=f-g;if(l)if(w<0||b<0||w+n>y.width||b+s>y.height){const A=this.cachedCanvases.getCanvas("maskExtension",n,s),E=A.context;E.drawImage(y,-w,-b),E.globalCompositeOperation="destination-atop",E.fillStyle=l,E.fillRect(0,0,n,s),E.globalCompositeOperation="source-over",y=A.canvas,w=b=0}else{e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0);const A=new Path2D;A.rect(w,b,n,s),e.clip(A),e.globalCompositeOperation="destination-atop",e.fillStyle=l,e.fillRect(w,b,n,s),e.restore()}t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0),o==="Alpha"&&c?t.filter=this.filterFactory.addAlphaFilter(c):o==="Luminosity"&&(t.filter=this.filterFactory.addLuminosityFilter(c));const _=new Path2D;_.rect(h,f,n,s),t.clip(_),t.globalCompositeOperation="destination-in",t.drawImage(y,w,b,n,s,h,f,n,s),t.restore()}save(e){this.inSMaskMode&&Zr(this.ctx,this.suspendedCtx),this.ctx.save();const t=this.current;this.stateStack.push(t),this.current=t.clone(),this.dependencyTracker?.save(e)}restore(e){if(this.dependencyTracker?.restore(e),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Zr(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(e,t,n,s,o,l,c){this.dependencyTracker?.recordIncrementalData("transform",e),this.ctx.transform(t,n,s,o,l,c),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(e,t,n,s){let[o]=n;if(!s){o||=n[0]=new Path2D,this[t](e,o);return}if(this.dependencyTracker!==null){const l=t===ir.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(e).recordBBox(e,this.ctx,s[0]-l,s[2]+l,s[1]-l,s[3]+l).recordDependencies(e,["transform"])}if(!(o instanceof Path2D)){const l=n[0]=new Path2D;for(let c=0,h=o.length;c<h;)switch(o[c++]){case Ja.moveTo:l.moveTo(o[c++],o[c++]);break;case Ja.lineTo:l.lineTo(o[c++],o[c++]);break;case Ja.curveTo:l.bezierCurveTo(o[c++],o[c++],o[c++],o[c++],o[c++],o[c++]);break;case Ja.closePath:l.closePath();break;default:Ae(`Unrecognized drawing path operator: ${o[c-1]}`);break}o=l}re.axialAlignedBoundingBox(s,Ke(this.ctx),this.current.minMax),this[t](e,o),this._pathStartIdx=e}closePath(e){this.ctx.closePath()}stroke(e,t,n=!0){const s=this.ctx,o=this.current.strokeColor;if(s.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof o=="object"&&o?.getPattern){const l=o.isModifyingCurrentTransform()?s.getTransform():null;if(s.save(),s.strokeStyle=o.getPattern(s,this,Ln(s),vt.STROKE,e),l){const c=new Path2D;c.addPath(t,s.getTransform().invertSelf().multiplySelf(l)),t=c}this.rescaleAndStroke(t,!1),s.restore()}else this.rescaleAndStroke(t,!0);this.dependencyTracker?.recordDependencies(e,sn.stroke),n&&this.consumePath(e,t,this.current.getClippedPathBoundingBox(vt.STROKE,Ke(this.ctx))),s.globalAlpha=this.current.fillAlpha}closeStroke(e,t){this.stroke(e,t)}fill(e,t,n=!0){const s=this.ctx,o=this.current.fillColor,l=this.current.patternFill;let c=!1;if(l){const f=o.isModifyingCurrentTransform()?s.getTransform():null;if(this.dependencyTracker?.save(e),s.save(),s.fillStyle=o.getPattern(s,this,Ln(s),vt.FILL,e),f){const p=new Path2D;p.addPath(t,s.getTransform().invertSelf().multiplySelf(f)),t=p}c=!0}const h=this.current.getClippedPathBoundingBox();this.contentVisible&&h!==null&&(this.pendingEOFill?(s.fill(t,"evenodd"),this.pendingEOFill=!1):s.fill(t)),this.dependencyTracker?.recordDependencies(e,sn.fill),c&&(s.restore(),this.dependencyTracker?.restore(e)),n&&this.consumePath(e,t,h)}eoFill(e,t){this.pendingEOFill=!0,this.fill(e,t)}fillStroke(e,t){this.fill(e,t,!1),this.stroke(e,t,!1),this.consumePath(e,t)}eoFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}closeFillStroke(e,t){this.fillStroke(e,t)}closeEOFillStroke(e,t){this.pendingEOFill=!0,this.fillStroke(e,t)}endPath(e,t){this.consumePath(e,t)}rawFillPath(e,t){this.ctx.fill(t),this.dependencyTracker?.recordDependencies(e,sn.rawFillPath).recordOperation(e)}clip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=Z1}eoClip(e){this.dependencyTracker?.recordFutureForcedDependency("clipMode",e),this.pendingClip=ym}beginText(e){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(e).resetIncrementalData("sameLineText").resetIncrementalData("moveText",e)}endText(e){const t=this.pendingTextPaths,n=this.ctx;if(this.dependencyTracker){const{dependencyTracker:s}=this;t!==void 0&&s.recordFutureForcedDependency("textClip",s.getOpenMarker()).recordFutureForcedDependency("textClip",e),s.recordCloseMarker(e)}if(t!==void 0){const s=new Path2D,o=n.getTransform().invertSelf();for(const{transform:l,x:c,y:h,fontSize:f,path:p}of t)p&&s.addPath(p,new DOMMatrix(l).preMultiplySelf(o).translate(c,h).scale(f,-f));n.clip(s)}delete this.pendingTextPaths}setCharSpacing(e,t){this.dependencyTracker?.recordSimpleData("charSpacing",e),this.current.charSpacing=t}setWordSpacing(e,t){this.dependencyTracker?.recordSimpleData("wordSpacing",e),this.current.wordSpacing=t}setHScale(e,t){this.dependencyTracker?.recordSimpleData("hScale",e),this.current.textHScale=t/100}setLeading(e,t){this.dependencyTracker?.recordSimpleData("leading",e),this.current.leading=-t}setFont(e,t,n){this.dependencyTracker?.recordSimpleData("font",e).recordSimpleDataFromNamed("fontObj",t,e);const s=this.commonObjs.get(t),o=this.current;if(!s)throw new Error(`Can't find font for ${t}`);if(o.fontMatrix=s.fontMatrix||gh,(o.fontMatrix[0]===0||o.fontMatrix[3]===0)&&Ae("Invalid font matrix for font "+t),n<0?(n=-n,o.fontDirection=-1):o.fontDirection=1,this.current.font=s,this.current.fontSize=n,s.isType3Font)return;const l=s.loadedName||"sans-serif",c=s.systemFontInfo?.css||`"${l}", ${s.fallbackName}`;let h="normal";s.black?h="900":s.bold&&(h="bold");const f=s.italic?"italic":"normal";let p=n;n<um?p=um:n>hm&&(p=hm),this.current.fontSizeScale=n/p,this.ctx.font=`${f} ${h} ${p}px ${c}`}setTextRenderingMode(e,t){this.dependencyTracker?.recordSimpleData("textRenderingMode",e),this.current.textRenderingMode=t}setTextRise(e,t){this.dependencyTracker?.recordSimpleData("textRise",e),this.current.textRise=t}moveText(e,t,n){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",e),this.current.x=this.current.lineX+=t,this.current.y=this.current.lineY+=n}setLeadingMoveText(e,t,n){this.setLeading(e,-n),this.moveText(e,t,n)}setTextMatrix(e,t){this.dependencyTracker?.recordSimpleData("textMatrix",e);const{current:n}=this;n.textMatrix=t,n.textMatrixScale=Math.hypot(t[0],t[1]),n.x=n.lineX=0,n.y=n.lineY=0}nextLine(e){this.moveText(e,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??e)}#i(e,t,n){const s=new Path2D;return s.addPath(e,new DOMMatrix(n).invertSelf().multiplySelf(t)),s}paintChar(e,t,n,s,o,l){const c=this.ctx,h=this.current,f=h.font,p=h.textRenderingMode,g=h.fontSize/h.fontSizeScale,y=p&yt.FILL_STROKE_MASK,w=!!(p&yt.ADD_TO_PATH_FLAG),b=h.patternFill&&!f.missingFile,_=h.patternStroke&&!f.missingFile;let A;if((f.disableFontFace||w||b||_)&&!f.missingFile&&(A=f.getPathGenerator(this.commonObjs,t)),A&&(f.disableFontFace||b||_)){c.save(),c.translate(n,s),c.scale(g,-g),this.dependencyTracker?.recordCharacterBBox(e,c,f);let E;if(y===yt.FILL||y===yt.FILL_STROKE)if(o){E=c.getTransform(),c.setTransform(...o);const C=this.#i(A,E,o);c.fill(C)}else c.fill(A);if(y===yt.STROKE||y===yt.FILL_STROKE)if(l){E||=c.getTransform(),c.setTransform(...l);const{a:C,b:T,c:R,d:L}=E,k=re.inverseTransform(l),N=re.transform([C,T,R,L,0,0],k);re.singularValueDecompose2dScale(N,Gt),c.lineWidth*=Math.max(Gt[0],Gt[1])/g,c.stroke(this.#i(A,E,l))}else c.lineWidth/=g,c.stroke(A);c.restore()}else(y===yt.FILL||y===yt.FILL_STROKE)&&(c.fillText(t,n,s),this.dependencyTracker?.recordCharacterBBox(e,c,f,g,n,s,()=>c.measureText(t))),(y===yt.STROKE||y===yt.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(e,c,f,g,n,s,()=>c.measureText(t)).recordDependencies(e,sn.stroke),c.strokeText(t,n,s));w&&((this.pendingTextPaths||=[]).push({transform:Ke(c),x:n,y:s,fontSize:g,path:A}),this.dependencyTracker?.recordCharacterBBox(e,c,f,g,n,s))}get isFontSubpixelAAEnabled(){const{context:e}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);e.scale(1.5,1),e.fillText("I",0,10);const t=e.getImageData(0,0,10,10).data;let n=!1;for(let s=3;s<t.length;s+=4)if(t[s]>0&&t[s]<255){n=!0;break}return Ee(this,"isFontSubpixelAAEnabled",n)}showText(e,t){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(e,sn.showText).resetBBox(e),this.current.textRenderingMode&yt.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",e).inheritPendingDependenciesAsFutureForcedDependencies());const n=this.current,s=n.font;if(s.isType3Font){this.showType3Text(e,t),this.dependencyTracker?.recordShowTextOperation(e);return}const o=n.fontSize;if(o===0){this.dependencyTracker?.recordOperation(e);return}const l=this.ctx,c=n.fontSizeScale,h=n.charSpacing,f=n.wordSpacing,p=n.fontDirection,g=n.textHScale*p,y=t.length,w=s.vertical,b=w?1:-1,_=s.defaultVMetrics,A=o*n.fontMatrix[0],E=n.textRenderingMode===yt.FILL&&!s.disableFontFace&&!n.patternFill;l.save(),n.textMatrix&&l.transform(...n.textMatrix),l.translate(n.x,n.y+n.textRise),p>0?l.scale(g,-1):l.scale(g,1);let C,T;if(n.patternFill){l.save();const U=n.fillColor.getPattern(l,this,Ln(l),vt.FILL,e);C=Ke(l),l.restore(),l.fillStyle=U}if(n.patternStroke){l.save();const U=n.strokeColor.getPattern(l,this,Ln(l),vt.STROKE,e);T=Ke(l),l.restore(),l.strokeStyle=U}let R=n.lineWidth;const L=n.textMatrixScale;if(L===0||R===0){const U=n.textRenderingMode&yt.FILL_STROKE_MASK;(U===yt.STROKE||U===yt.FILL_STROKE)&&(R=this.getSinglePixelWidth())}else R/=L;if(c!==1&&(l.scale(c,c),R/=c),l.lineWidth=R,s.isInvalidPDFjsFont){const U=[];let z=0;for(const q of t)U.push(q.unicode),z+=q.width;const V=U.join("");if(l.fillText(V,0,0),this.dependencyTracker!==null){const q=l.measureText(V);this.dependencyTracker.recordBBox(e,this.ctx,-q.actualBoundingBoxLeft,q.actualBoundingBoxRight,-q.actualBoundingBoxAscent,q.actualBoundingBoxDescent).recordShowTextOperation(e)}n.x+=z*A*g,l.restore(),this.compose();return}let k=0,N;for(N=0;N<y;++N){const U=t[N];if(typeof U=="number"){k+=b*U*o/1e3;continue}let z=!1;const V=(U.isSpace?f:0)+h,q=U.fontChar,ue=U.accent;let Q,le,ye=U.width;if(w){const $=U.vmetric||_,ee=-(U.vmetric?$[1]:ye*.5)*A,Z=$[2]*A;ye=$?-$[0]:ye,Q=ee/c,le=(k+Z)/c}else Q=k/c,le=0;let J;if(s.remeasure&&ye>0){J=l.measureText(q);const $=J.width*1e3/o*c;if(ye<$&&this.isFontSubpixelAAEnabled){const ee=ye/$;z=!0,l.save(),l.scale(ee,1),Q/=ee}else ye!==$&&(Q+=(ye-$)/2e3*o/c)}if(this.contentVisible&&(U.isInFont||s.missingFile)){if(E&&!ue)l.fillText(q,Q,le),this.dependencyTracker?.recordCharacterBBox(e,l,J?{bbox:null}:s,o/c,Q,le,()=>J??l.measureText(q));else if(this.paintChar(e,q,Q,le,C,T),ue){const $=Q+o*ue.offset.x/c,ee=le-o*ue.offset.y/c;this.paintChar(e,ue.fontChar,$,ee,C,T)}}const K=w?ye*A-V*p:ye*A+V*p;k+=K,z&&l.restore()}w?n.y-=k:n.x+=k*g,l.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(e)}showType3Text(e,t){const n=this.ctx,s=this.current,o=s.font,l=s.fontSize,c=s.fontDirection,h=o.vertical?1:-1,f=s.charSpacing,p=s.wordSpacing,g=s.textHScale*c,y=s.fontMatrix||gh,w=t.length,b=s.textRenderingMode===yt.INVISIBLE;let _,A,E,C;if(b||l===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,n.save(),s.textMatrix&&n.transform(...s.textMatrix),n.translate(s.x,s.y+s.textRise),n.scale(g,c);const T=this.dependencyTracker;for(this.dependencyTracker=T?new xl(T,e):null,_=0;_<w;++_){if(A=t[_],typeof A=="number"){C=h*A*l/1e3,this.ctx.translate(C,0),s.x+=C*g;continue}const R=(A.isSpace?p:0)+f,L=o.charProcOperatorList[A.operatorListId];L?this.contentVisible&&(this.save(),n.scale(l,l),n.transform(...y),this.executeOperatorList(L),this.restore()):Ae(`Type3 character "${A.operatorListId}" is not available.`);const k=[A.width,0];re.applyTransform(k,y),E=k[0]*l+R,n.translate(E,0),s.x+=E*g}n.restore(),T&&(this.dependencyTracker=T)}setCharWidth(e,t,n){}setCharWidthAndBounds(e,t,n,s,o,l,c){const h=new Path2D;h.rect(s,o,l-s,c-o),this.ctx.clip(h),this.dependencyTracker?.recordBBox(e,this.ctx,s,l,o,c).recordClipBox(e,this.ctx,s,l,o,c),this.endPath(e)}getColorN_Pattern(e,t){let n;if(t[0]==="TilingPattern"){const s=this.baseTransform||Ke(this.ctx),o={createCanvasGraphics:(l,c)=>new Xs(l,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new xl(this.dependencyTracker,c,!0):null)};n=new od(t,this.ctx,o,s)}else n=this._getPattern(e,t[1],t[2]);return n}setStrokeColorN(e,...t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.current.strokeColor=this.getColorN_Pattern(e,t),this.current.patternStroke=!0}setFillColorN(e,...t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.current.fillColor=this.getColorN_Pattern(e,t),this.current.patternFill=!0}setStrokeRGBColor(e,t){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor=t,this.current.patternStroke=!1}setStrokeTransparent(e){this.dependencyTracker?.recordSimpleData("strokeColor",e),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(e,t){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor=t,this.current.patternFill=!1}setFillTransparent(e){this.dependencyTracker?.recordSimpleData("fillColor",e),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(e,t,n=null){let s;return this.cachedPatterns.has(t)?s=this.cachedPatterns.get(t):(s=G1(this.getObject(e,t)),this.cachedPatterns.set(t,s)),n&&(s.matrix=n),s}shadingFill(e,t){if(!this.contentVisible)return;const n=this.ctx;this.save(e);const s=this._getPattern(e,t);n.fillStyle=s.getPattern(n,this,Ln(n),vt.SHADING,e);const o=Ln(n);if(o){const{width:l,height:c}=n.canvas,h=zs.slice();re.axialAlignedBoundingBox([0,0,l,c],o,h);const[f,p,g,y]=h;this.ctx.fillRect(f,p,g-f,y-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(e).recordFullPageBBox(e).recordDependencies(e,sn.transform).recordDependencies(e,sn.fill).recordOperation(e),this.compose(this.current.getClippedPathBoundingBox()),this.restore(e)}beginInlineImage(){Ue("Should not call beginInlineImage")}beginImageData(){Ue("Should not call beginImageData")}paintFormXObjectBegin(e,t,n){if(this.contentVisible&&(this.save(e),this.baseTransformStack.push(this.baseTransform),t&&this.transform(e,...t),this.baseTransform=Ke(this.ctx),n)){re.axialAlignedBoundingBox(n,this.baseTransform,this.current.minMax);const[s,o,l,c]=n,h=new Path2D;h.rect(s,o,l-s,c-o),this.ctx.clip(h),this.dependencyTracker?.recordClipBox(e,this.ctx,s,l,o,c),this.endPath(e)}}paintFormXObjectEnd(e){this.contentVisible&&(this.restore(e),this.baseTransform=this.baseTransformStack.pop())}beginGroup(e,t){if(!this.contentVisible)return;this.save(e),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const n=this.ctx;t.isolated||Fl("TODO: Support non-isolated groups."),t.knockout&&Ae("Knockout groups not supported.");const s=Ke(n);if(t.matrix&&n.transform(...t.matrix),!t.bbox)throw new Error("Bounding box is required.");let o=zs.slice();re.axialAlignedBoundingBox(t.bbox,Ke(n),o);const l=[0,0,n.canvas.width,n.canvas.height];o=re.intersect(o,l)||[0,0,0,0];const c=Math.floor(o[0]),h=Math.floor(o[1]),f=Math.max(Math.ceil(o[2])-c,1),p=Math.max(Math.ceil(o[3])-h,1);this.current.startNewPathAndClipBox([0,0,f,p]);let g="groupAt"+this.groupLevel;t.smask&&(g+="_smask_"+this.smaskCounter++%2);const y=this.cachedCanvases.getCanvas(g,f,p),w=y.context;w.translate(-c,-h),w.transform(...s);let b=new Path2D;const[_,A,E,C]=t.bbox;if(b.rect(_,A,E-_,C-A),t.matrix){const T=new Path2D;T.addPath(b,new DOMMatrix(t.matrix)),b=T}w.clip(b),t.smask&&this.smaskStack.push({canvas:y.canvas,context:w,offsetX:c,offsetY:h,subtype:t.smask.subtype,backdrop:t.smask.backdrop,transferMap:t.smask.transferMap||null,startTransformInverse:null}),(!t.smask||this.dependencyTracker)&&(n.setTransform(1,0,0,1,0,0),n.translate(c,h),n.save()),Zr(n,w),this.ctx=w,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(n),this.setGState(e,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(n),this.groupLevel++}endGroup(e,t){if(!this.contentVisible)return;this.groupLevel--;const n=this.ctx,s=this.groupStack.pop();if(this.ctx=s,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),t.smask)this.tempSMask=this.smaskStack.pop(),this.restore(e),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const o=Ke(this.ctx);this.restore(e),this.ctx.save(),this.ctx.setTransform(...o);const l=zs.slice();re.axialAlignedBoundingBox([0,0,n.canvas.width,n.canvas.height],o,l),this.ctx.drawImage(n.canvas,0,0),this.ctx.restore(),this.compose(l)}}beginAnnotation(e,t,n,s,o,l){if(this.#e(),rl(this.ctx),this.ctx.save(),this.save(e),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),n){const c=n[2]-n[0],h=n[3]-n[1];if(l&&this.annotationCanvasMap){s=s.slice(),s[4]-=n[0],s[5]-=n[1],n=n.slice(),n[0]=n[1]=0,n[2]=c,n[3]=h,re.singularValueDecompose2dScale(Ke(this.ctx),Gt);const{viewportScale:f}=this,p=Math.ceil(c*this.outputScaleX*f),g=Math.ceil(h*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(p,g);const{canvas:y,context:w}=this.annotationCanvas;this.annotationCanvasMap.set(t,y),this.annotationCanvas.savedCtx=this.ctx,this.ctx=w,this.ctx.save(),this.ctx.setTransform(Gt[0],0,0,-Gt[1],0,h*Gt[1]),rl(this.ctx)}else{rl(this.ctx),this.endPath(e);const f=new Path2D;f.rect(n[0],n[1],c,h),this.ctx.clip(f)}}this.current=new fm(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(e,...s),this.transform(e,...o)}endAnnotation(e){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(e,t){if(!this.contentVisible)return;const n=t.count;t=this.getObject(e,t.data,t),t.count=n;const s=this.ctx,o=this._createMaskCanvas(e,t),l=o.canvas;s.save(),s.setTransform(1,0,0,1,0,0),s.drawImage(l,o.offsetX,o.offsetY),this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,o.offsetX,o.offsetX+l.width,o.offsetY,o.offsetY+l.height).recordOperation(e),s.restore(),this.compose()}paintImageMaskXObjectRepeat(e,t,n,s=0,o=0,l,c){if(!this.contentVisible)return;t=this.getObject(e,t.data,t);const h=this.ctx;h.save();const f=Ke(h);h.transform(n,s,o,l,0,0);const p=this._createMaskCanvas(e,t);h.setTransform(1,0,0,1,p.offsetX-f[4],p.offsetY-f[5]),this.dependencyTracker?.resetBBox(e);for(let g=0,y=c.length;g<y;g+=2){const w=re.transform(f,[n,s,o,l,c[g],c[g+1]]);h.drawImage(p.canvas,w[4],w[5]),this.dependencyTracker?.recordBBox(e,this.ctx,w[4],w[4]+p.canvas.width,w[5],w[5]+p.canvas.height)}h.restore(),this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageMaskXObjectGroup(e,t){if(!this.contentVisible)return;const n=this.ctx,s=this.current.fillColor,o=this.current.patternFill;this.dependencyTracker?.resetBBox(e).recordDependencies(e,sn.transformAndFill);for(const l of t){const{data:c,width:h,height:f,transform:p}=l,g=this.cachedCanvases.getCanvas("maskCanvas",h,f),y=g.context;y.save();const w=this.getObject(e,c,l);gm(y,w),y.globalCompositeOperation="source-in",y.fillStyle=o?s.getPattern(y,this,Ln(n),vt.FILL,e):s,y.fillRect(0,0,h,f),y.restore(),n.save(),n.transform(...p),n.scale(1,-1),sl(n,g.canvas,0,0,h,f,0,-1,1,1),this.dependencyTracker?.recordBBox(e,n,0,h,0,f),n.restore()}this.compose(),this.dependencyTracker?.recordOperation(e)}paintImageXObject(e,t){if(!this.contentVisible)return;const n=this.getObject(e,t);if(!n){Ae("Dependent image isn't ready yet");return}this.paintInlineImageXObject(e,n)}paintImageXObjectRepeat(e,t,n,s,o){if(!this.contentVisible)return;const l=this.getObject(e,t);if(!l){Ae("Dependent image isn't ready yet");return}const c=l.width,h=l.height,f=[];for(let p=0,g=o.length;p<g;p+=2)f.push({transform:[n,0,0,s,o[p],o[p+1]],x:0,y:0,w:c,h});this.paintInlineImageXObjectGroup(e,l,f)}applyTransferMapsToCanvas(e){return this.current.transferMaps!=="none"&&(e.filter=this.current.transferMaps,e.drawImage(e.canvas,0,0),e.filter="none"),e.canvas}applyTransferMapsToBitmap(e){if(this.current.transferMaps==="none")return e.bitmap;const{bitmap:t,width:n,height:s}=e,o=this.cachedCanvases.getCanvas("inlineImage",n,s),l=o.context;return l.filter=this.current.transferMaps,l.drawImage(t,0,0),l.filter="none",o.canvas}paintInlineImageXObject(e,t){if(!this.contentVisible)return;const n=t.width,s=t.height,o=this.ctx;this.save(e);const{filter:l}=o;l!=="none"&&l!==""&&(o.filter="none"),o.scale(1/n,-1/s);let c;if(t.bitmap)c=this.applyTransferMapsToBitmap(t);else if(typeof HTMLElement=="function"&&t instanceof HTMLElement||!t.data)c=t;else{const p=this.cachedCanvases.getCanvas("inlineImage",n,s).context;pm(p,t),c=this.applyTransferMapsToCanvas(p)}const h=this._scaleImage(c,Ln(o));o.imageSmoothingEnabled=mm(Ke(o),t.interpolate),this.dependencyTracker?.resetBBox(e).recordBBox(e,o,0,n,-s,0).recordDependencies(e,sn.imageXObject).recordOperation(e),sl(o,h.img,0,0,h.paintWidth,h.paintHeight,0,-s,n,s),this.compose(),this.restore(e)}paintInlineImageXObjectGroup(e,t,n){if(!this.contentVisible)return;const s=this.ctx;let o;if(t.bitmap)o=t.bitmap;else{const l=t.width,c=t.height,f=this.cachedCanvases.getCanvas("inlineImage",l,c).context;pm(f,t),o=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(e);for(const l of n)s.save(),s.transform(...l.transform),s.scale(1,-1),sl(s,o,l.x,l.y,l.w,l.h,0,-1,1,1),this.dependencyTracker?.recordBBox(e,s,0,1,-1,0),s.restore();this.dependencyTracker?.recordOperation(e),this.compose()}paintSolidColorImageMask(e){this.contentVisible&&(this.dependencyTracker?.resetBBox(e).recordBBox(e,this.ctx,0,1,0,1).recordDependencies(e,sn.fill).recordOperation(e),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(e,t){}markPointProps(e,t,n){}beginMarkedContent(e,t){this.dependencyTracker?.beginMarkedContent(e),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(e,t,n){this.dependencyTracker?.beginMarkedContent(e),t==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(n)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(e){this.dependencyTracker?.endMarkedContent(e),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(e){}endCompat(e){}consumePath(e,t,n){const s=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(n);const o=this.ctx;this.pendingClip?(s||(this.pendingClip===ym?o.clip(t,"evenodd"):o.clip(t)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(e).recordFutureForcedDependency("clipPath",e)):this.dependencyTracker?.recordOperation(e),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const e=Ke(this.ctx);if(e[1]===0&&e[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(e[0]),Math.abs(e[3]));else{const t=Math.abs(e[0]*e[3]-e[2]*e[1]),n=Math.hypot(e[0],e[2]),s=Math.hypot(e[1],e[3]);this._cachedGetSinglePixelWidth=Math.max(n,s)/t}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:e}=this.current,{a:t,b:n,c:s,d:o}=this.ctx.getTransform();let l,c;if(n===0&&s===0){const h=Math.abs(t),f=Math.abs(o);if(h===f)if(e===0)l=c=1/h;else{const p=h*e;l=c=p<1?1/p:1}else if(e===0)l=1/h,c=1/f;else{const p=h*e,g=f*e;l=p<1?1/p:1,c=g<1?1/g:1}}else{const h=Math.abs(t*o-n*s),f=Math.hypot(t,n),p=Math.hypot(s,o);if(e===0)l=p/h,c=f/h;else{const g=e*h;l=p>g?p/g:1,c=f>g?f/g:1}}this._cachedScaleForStroking[0]=l,this._cachedScaleForStroking[1]=c}return this._cachedScaleForStroking}rescaleAndStroke(e,t){const{ctx:n,current:{lineWidth:s}}=this,[o,l]=this.getScaleForStroking();if(o===l){n.lineWidth=(s||1)*o,n.stroke(e);return}const c=n.getLineDash();t&&n.save(),n.scale(o,l),eh.a=1/o,eh.d=1/l;const h=new Path2D;if(h.addPath(e,eh),c.length>0){const f=Math.max(o,l);n.setLineDash(c.map(p=>p/f)),n.lineDashOffset/=f}n.lineWidth=s||1,n.stroke(h),t&&n.restore()}isContentVisible(){for(let e=this.markedContentStack.length-1;e>=0;e--)if(!this.markedContentStack[e].visible)return!1;return!0}}for(const a in ir)Xs.prototype[a]!==void 0&&(Xs.prototype[ir[a]]=Xs.prototype[a]);class Ks{#e;#t;#i;static strings=["fontFamily","fontWeight","italicAngle"];static write(e){const t=new TextEncoder,n={};let s=0;for(const f of Ks.strings){const p=t.encode(e[f]);n[f]=p,s+=4+p.length}const o=new ArrayBuffer(s),l=new Uint8Array(o),c=new DataView(o);let h=0;for(const f of Ks.strings){const p=n[f],g=p.length;c.setUint32(h,g),l.set(p,h+4),h+=4+g}return Ie(h===o.byteLength,"CssFontInfo.write: Buffer overflow"),o}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#i=new TextDecoder}#n(e){Ie(e<Ks.strings.length,"Invalid string index");let t=0;for(let s=0;s<e;s++)t+=this.#t.getUint32(t)+4;const n=this.#t.getUint32(t);return this.#i.decode(new Uint8Array(this.#e,t+4,n))}get fontFamily(){return this.#n(0)}get fontWeight(){return this.#n(1)}get italicAngle(){return this.#n(2)}}class Ys{#e;#t;#i;static strings=["css","loadedName","baseFontName","src"];static write(e){const t=new TextEncoder,n={};let s=0;for(const y of Ys.strings){const w=t.encode(e[y]);n[y]=w,s+=4+w.length}s+=4;let o,l,c=1+s;e.style&&(o=t.encode(e.style.style),l=t.encode(e.style.weight),c+=4+o.length+4+l.length);const h=new ArrayBuffer(c),f=new Uint8Array(h),p=new DataView(h);let g=0;p.setUint8(g++,e.guessFallback?1:0),p.setUint32(g,0),g+=4,s=0;for(const y of Ys.strings){const w=n[y],b=w.length;s+=4+b,p.setUint32(g,b),f.set(w,g+4),g+=4+b}return p.setUint32(g-s-4,s),e.style&&(p.setUint32(g,o.length),f.set(o,g+4),g+=4+o.length,p.setUint32(g,l.length),f.set(l,g+4),g+=4+l.length),Ie(g<=h.byteLength,"SubstitionInfo.write: Buffer overflow"),h.transferToFixedLength(g)}constructor(e){this.#e=e,this.#t=new DataView(this.#e),this.#i=new TextDecoder}get guessFallback(){return this.#t.getUint8(0)!==0}#n(e){Ie(e<Ys.strings.length,"Invalid string index");let t=5;for(let s=0;s<e;s++)t+=this.#t.getUint32(t)+4;const n=this.#t.getUint32(t);return this.#i.decode(new Uint8Array(this.#e,t+4,n))}get css(){return this.#n(0)}get loadedName(){return this.#n(1)}get baseFontName(){return this.#n(2)}get src(){return this.#n(3)}get style(){let e=1;e+=4+this.#t.getUint32(e);const t=this.#t.getUint32(e),n=this.#i.decode(new Uint8Array(this.#e,e+4,t));e+=4+t;const s=this.#t.getUint32(e),o=this.#i.decode(new Uint8Array(this.#e,e+4,s));return{style:n,weight:o}}}class Oe{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#e=Math.ceil(this.bools.length*2/8);static#t=this.#e+this.numbers.length*8;static#i=this.#t+1+8;static#n=this.#i+1+48;static#o=this.#n+1+6;#s;#r;#a;constructor({data:e,extra:t}){this.#s=e,this.#r=new TextDecoder,this.#a=new DataView(this.#s),t&&Object.assign(this,t)}#c(e){Ie(e<Oe.bools.length,"Invalid boolean index");const t=Math.floor(e/4),n=e*2%8,s=this.#a.getUint8(t)>>n&3;return s===0?void 0:s===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(e){return Ie(e<Oe.numbers.length,"Invalid number index"),this.#a.getFloat64(Oe.#e+e*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let e=Oe.#t;if(this.#a.getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<4;s++)n.push(this.#a.getInt16(e,!0)),e+=2;return n}get fontMatrix(){let e=Oe.#i;if(this.#a.getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<6;s++)n.push(this.#a.getFloat64(e,!0)),e+=8;return n}get defaultVMetrics(){let e=Oe.#n;if(this.#a.getUint8(e)===0)return;e+=1;const n=[];for(let s=0;s<3;s++)n.push(this.#a.getInt16(e,!0)),e+=2;return n}#d(e){Ie(e<Oe.strings.length,"Invalid string index");let t=Oe.#o+4;for(let o=0;o<e;o++)t+=this.#a.getUint32(t)+4;const n=this.#a.getUint32(t),s=new Uint8Array(n);return s.set(new Uint8Array(this.#s,t+4,n)),this.#r.decode(s)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let e=Oe.#o;const t=this.#a.getUint32(e);e+=4+t;const n=this.#a.getUint32(e);e+=4+n;const s=this.#a.getUint32(e);e+=4+s;const o=this.#a.getUint32(e);if(o!==0)return new Uint8Array(this.#s,e+4,o)}clearData(){let e=Oe.#o;const t=this.#a.getUint32(e);e+=4+t;const n=this.#a.getUint32(e);e+=4+n;const s=this.#a.getUint32(e);e+=4+s;const o=this.#a.getUint32(e);new Uint8Array(this.#s,e+4,o).fill(0),this.#a.setUint32(e,0)}get cssFontInfo(){let e=Oe.#o;const t=this.#a.getUint32(e);e+=4+t;const n=this.#a.getUint32(e);e+=4+n;const s=this.#a.getUint32(e);if(s===0)return null;const o=new Uint8Array(s);return o.set(new Uint8Array(this.#s,e+4,s)),new Ks(o.buffer)}get systemFontInfo(){let e=Oe.#o;const t=this.#a.getUint32(e);e+=4+t;const n=this.#a.getUint32(e);if(n===0)return null;const s=new Uint8Array(n);return s.set(new Uint8Array(this.#s,e+4,n)),new Ys(s.buffer)}static write(e){const t=e.systemFontInfo?Ys.write(e.systemFontInfo):null,n=e.cssFontInfo?Ks.write(e.cssFontInfo):null,s=new TextEncoder,o={};let l=0;for(const _ of Oe.strings)o[_]=s.encode(e[_]),l+=4+o[_].length;const c=Oe.#o+4+l+4+(t?t.byteLength:0)+4+(n?n.byteLength:0)+4+(e.data?e.data.length:0),h=new ArrayBuffer(c),f=new Uint8Array(h),p=new DataView(h);let g=0;const y=Oe.bools.length;let w=0,b=0;for(let _=0;_<y;_++){const A=e[Oe.bools[_]];w|=(A===void 0?0:A?2:1)<<b,b+=2,(b===8||_===y-1)&&(p.setUint8(g++,w),w=0,b=0)}Ie(g===Oe.#e,"FontInfo.write: Boolean properties offset mismatch");for(const _ of Oe.numbers)p.setFloat64(g,e[_]),g+=8;if(Ie(g===Oe.#t,"FontInfo.write: Number properties offset mismatch"),e.bbox){p.setUint8(g++,4);for(const _ of e.bbox)p.setInt16(g,_,!0),g+=2}else p.setUint8(g++,0),g+=8;if(Ie(g===Oe.#i,"FontInfo.write: BBox properties offset mismatch"),e.fontMatrix){p.setUint8(g++,6);for(const _ of e.fontMatrix)p.setFloat64(g,_,!0),g+=8}else p.setUint8(g++,0),g+=48;if(Ie(g===Oe.#n,"FontInfo.write: FontMatrix properties offset mismatch"),e.defaultVMetrics){p.setUint8(g++,1);for(const _ of e.defaultVMetrics)p.setInt16(g,_,!0),g+=2}else p.setUint8(g++,0),g+=6;Ie(g===Oe.#o,"FontInfo.write: DefaultVMetrics properties offset mismatch"),p.setUint32(Oe.#o,0),g+=4;for(const _ of Oe.strings){const A=o[_],E=A.length;p.setUint32(g,E),f.set(A,g+4),g+=4+E}if(p.setUint32(Oe.#o,g-Oe.#o-4),!t)p.setUint32(g,0),g+=4;else{const _=t.byteLength;p.setUint32(g,_),Ie(g+4+_<=h.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(t),g+4),g+=4+_}if(!n)p.setUint32(g,0),g+=4;else{const _=n.byteLength;p.setUint32(g,_),Ie(g+4+_<=h.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(n),g+4),g+=4+_}return e.data===void 0?(p.setUint32(g,0),g+=4):(p.setUint32(g,e.data.length),f.set(e.data,g+4),g+=4+e.data.length),Ie(g<=h.byteLength,"FontInfo.write: Buffer overflow"),h.transferToFixedLength(g)}}class Ni{static#e=null;static#t="";static get workerPort(){return this.#e}static set workerPort(e){if(!(typeof Worker<"u"&&e instanceof Worker)&&e!==null)throw new Error("Invalid `workerPort` type.");this.#e=e}static get workerSrc(){return this.#t}static set workerSrc(e){if(typeof e!="string")throw new Error("Invalid `workerSrc` type.");this.#t=e}}class eC{#e;#t;constructor({parsedData:e,rawData:t}){this.#e=e,this.#t=t}getRaw(){return this.#t}get(e){return this.#e.get(e)??null}[Symbol.iterator](){return this.#e.entries()}}const Hs=Symbol("INTERNAL");class tC{#e=!1;#t=!1;#i=!1;#n=!0;constructor(e,{name:t,intent:n,usage:s,rbGroups:o}){this.#e=!!(e&Vt.DISPLAY),this.#t=!!(e&Vt.PRINT),this.name=t,this.intent=n,this.usage=s,this.rbGroups=o}get visible(){if(this.#i)return this.#n;if(!this.#n)return!1;const{print:e,view:t}=this.usage;return this.#e?t?.viewState!=="OFF":this.#t?e?.printState!=="OFF":!0}_setVisible(e,t,n=!1){e!==Hs&&Ue("Internal method `_setVisible` called."),this.#i=n,this.#n=t}}class nC{#e=null;#t=new Map;#i=null;#n=null;constructor(e,t=Vt.DISPLAY){if(this.renderingIntent=t,this.name=null,this.creator=null,e!==null){this.name=e.name,this.creator=e.creator,this.#n=e.order;for(const n of e.groups)this.#t.set(n.id,new tC(t,n));if(e.baseState==="OFF")for(const n of this.#t.values())n._setVisible(Hs,!1);for(const n of e.on)this.#t.get(n)._setVisible(Hs,!0);for(const n of e.off)this.#t.get(n)._setVisible(Hs,!1);this.#i=this.getHash()}}#o(e){const t=e.length;if(t<2)return!0;const n=e[0];for(let s=1;s<t;s++){const o=e[s];let l;if(Array.isArray(o))l=this.#o(o);else if(this.#t.has(o))l=this.#t.get(o).visible;else return Ae(`Optional content group not found: ${o}`),!0;switch(n){case"And":if(!l)return!1;break;case"Or":if(l)return!0;break;case"Not":return!l;default:return!0}}return n==="And"}isVisible(e){if(this.#t.size===0)return!0;if(!e)return Fl("Optional content group not defined."),!0;if(e.type==="OCG")return this.#t.has(e.id)?this.#t.get(e.id).visible:(Ae(`Optional content group not found: ${e.id}`),!0);if(e.type==="OCMD"){if(e.expression)return this.#o(e.expression);if(!e.policy||e.policy==="AnyOn"){for(const t of e.ids){if(!this.#t.has(t))return Ae(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOn"){for(const t of e.ids){if(!this.#t.has(t))return Ae(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!1}return!0}else if(e.policy==="AnyOff"){for(const t of e.ids){if(!this.#t.has(t))return Ae(`Optional content group not found: ${t}`),!0;if(!this.#t.get(t).visible)return!0}return!1}else if(e.policy==="AllOff"){for(const t of e.ids){if(!this.#t.has(t))return Ae(`Optional content group not found: ${t}`),!0;if(this.#t.get(t).visible)return!1}return!0}return Ae(`Unknown optional content policy ${e.policy}.`),!0}return Ae(`Unknown group type ${e.type}.`),!0}setVisibility(e,t=!0,n=!0){const s=this.#t.get(e);if(!s){Ae(`Optional content group not found: ${e}`);return}if(n&&t&&s.rbGroups.length)for(const o of s.rbGroups)for(const l of o)l!==e&&this.#t.get(l)?._setVisible(Hs,!1,!0);s._setVisible(Hs,!!t,!0),this.#e=null}setOCGState({state:e,preserveRB:t}){let n;for(const s of e){switch(s){case"ON":case"OFF":case"Toggle":n=s;continue}const o=this.#t.get(s);if(o)switch(n){case"ON":this.setVisibility(s,!0,t);break;case"OFF":this.setVisibility(s,!1,t);break;case"Toggle":this.setVisibility(s,!o.visible,t);break}}this.#e=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#t.size?this.#n?this.#n.slice():[...this.#t.keys()]:null}getGroup(e){return this.#t.get(e)||null}getHash(){if(this.#e!==null)return this.#e;const e=new Qy;for(const[t,n]of this.#t)e.update(`${t}:${n.visible}`);return this.#e=e.hexdigest()}[Symbol.iterator](){return this.#t.entries()}}class iC{constructor(e,{disableRange:t=!1,disableStream:n=!1}){Ie(e,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.');const{length:s,initialData:o,progressiveDone:l,contentDispositionFilename:c}=e;if(this._queuedChunks=[],this._progressiveDone=l,this._contentDispositionFilename=c,o?.length>0){const h=o instanceof Uint8Array&&o.byteLength===o.buffer.byteLength?o.buffer:new Uint8Array(o).buffer;this._queuedChunks.push(h)}this._pdfDataRangeTransport=e,this._isStreamingSupported=!n,this._isRangeSupported=!t,this._contentLength=s,this._fullRequestReader=null,this._rangeReaders=[],e.addRangeListener((h,f)=>{this._onReceiveData({begin:h,chunk:f})}),e.addProgressListener((h,f)=>{this._onProgress({loaded:h,total:f})}),e.addProgressiveReadListener(h=>{this._onReceiveData({chunk:h})}),e.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),e.transportReady()}_onReceiveData({begin:e,chunk:t}){const n=t instanceof Uint8Array&&t.byteLength===t.buffer.byteLength?t.buffer:new Uint8Array(t).buffer;if(e===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(n):this._queuedChunks.push(n);else{const s=this._rangeReaders.some(function(o){return o._begin!==e?!1:(o._enqueue(n),!0)});Ie(s,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(e){e.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:e.loaded}):this._fullRequestReader?.onProgress?.({loaded:e.loaded,total:e.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(e){const t=this._rangeReaders.indexOf(e);t>=0&&this._rangeReaders.splice(t,1)}getFullReader(){Ie(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const e=this._queuedChunks;return this._queuedChunks=null,new sC(this,e,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new rC(this,e,t);return this._pdfDataRangeTransport.requestDataRange(e,t),this._rangeReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeReaders.slice(0))t.cancel(e);this._pdfDataRangeTransport.abort()}}class sC{constructor(e,t,n=!1,s=null){this._stream=e,this._done=n||!1,this._filename=Ul(s)?s:null,this._queuedChunks=t||[],this._loaded=0;for(const o of this._queuedChunks)this._loaded+=o.byteLength;this._requests=[],this._headersReady=Promise.resolve(),e._fullRequestReader=this,this.onProgress=null}_enqueue(e){this._done||(this._requests.length>0?this._requests.shift().resolve({value:e,done:!1}):this._queuedChunks.push(e),this._loaded+=e.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class rC{constructor(e,t,n){this._stream=e,this._begin=t,this._end=n,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(e){if(!this._done){if(this._requests.length===0)this._queuedChunk=e;else{this._requests.shift().resolve({value:e,done:!1});for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}function oC(a){let e=!0,t=n("filename\\*","i").exec(a);if(t){t=t[1];let p=c(t);return p=unescape(p),p=h(p),p=f(p),o(p)}if(t=l(a),t){const p=f(t);return o(p)}if(t=n("filename","i").exec(a),t){t=t[1];let p=c(t);return p=f(p),o(p)}function n(p,g){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',g)}function s(p,g){if(p){if(!/^[\x00-\xFF]+$/.test(g))return g;try{const y=new TextDecoder(p,{fatal:!0}),w=Ro(g);g=y.decode(w),e=!1}catch{}}return g}function o(p){return e&&/[\x80-\xff]/.test(p)&&(p=s("utf-8",p),e&&(p=s("iso-8859-1",p))),p}function l(p){const g=[];let y;const w=n("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(y=w.exec(p))!==null;){let[,_,A,E]=y;if(_=parseInt(_,10),_ in g){if(_===0)break;continue}g[_]=[A,E]}const b=[];for(let _=0;_<g.length&&_ in g;++_){let[A,E]=g[_];E=c(E),A&&(E=unescape(E),_===0&&(E=h(E))),b.push(E)}return b.join("")}function c(p){if(p.startsWith('"')){const g=p.slice(1).split('\\"');for(let y=0;y<g.length;++y){const w=g[y].indexOf('"');w!==-1&&(g[y]=g[y].slice(0,w),g.length=y+1),g[y]=g[y].replaceAll(/\\(.)/g,"$1")}p=g.join('"')}return p}function h(p){const g=p.indexOf("'");if(g===-1)return p;const y=p.slice(0,g),b=p.slice(g+1).replace(/^[^']*'/,"");return s(y,b)}function f(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(g,y,w,b){if(w==="q"||w==="Q")return b=b.replaceAll("_"," "),b=b.replaceAll(/=([0-9a-fA-F]{2})/g,function(_,A){return String.fromCharCode(parseInt(A,16))}),s(y,b);try{b=atob(b)}catch{}return s(y,b)})}return""}function rv(a,e){const t=new Headers;if(!a||!e||typeof e!="object")return t;for(const n in e){const s=e[n];s!==void 0&&t.append(n,s)}return t}function jl(a){return URL.parse(a)?.origin??null}function ov({responseHeaders:a,isHttp:e,rangeChunkSize:t,disableRange:n}){const s={allowRangeRequests:!1,suggestedLength:void 0},o=parseInt(a.get("Content-Length"),10);return!Number.isInteger(o)||(s.suggestedLength=o,o<=2*t)||n||!e||a.get("Accept-Ranges")!=="bytes"||(a.get("Content-Encoding")||"identity")!=="identity"||(s.allowRangeRequests=!0),s}function av(a){const e=a.get("Content-Disposition");if(e){let t=oC(e);if(t.includes("%"))try{t=decodeURIComponent(t)}catch{}if(Ul(t))return t}return null}function No(a,e){return new mo(`Unexpected server response (${a}) while retrieving PDF "${e}".`,a,a===404||a===0&&e.startsWith("file:"))}function lv(a){return a===200||a===206}function cv(a,e,t){return{method:"GET",headers:a,signal:t.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"}}function uv(a){return a instanceof Uint8Array?a.buffer:a instanceof ArrayBuffer?a:(Ae(`getArrayBuffer - unexpected data format: ${a}`),new Uint8Array(a).buffer)}class aC{_responseOrigin=null;constructor(e){this.source=e,this.isHttp=/^https?:/i.test(e.url),this.headers=rv(this.isHttp,e.httpHeaders),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Ie(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new lC(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new cC(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class lC{constructor(e){this._stream=e,this._reader=null,this._loaded=0,this._filename=null;const t=e.source;this._withCredentials=t.withCredentials||!1,this._contentLength=t.length,this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange;const n=new Headers(e.headers),s=t.url;fetch(s,cv(n,this._withCredentials,this._abortController)).then(o=>{if(e._responseOrigin=jl(o.url),!lv(o.status))throw No(o.status,s);this._reader=o.body.getReader(),this._headersCapability.resolve();const l=o.headers,{allowRangeRequests:c,suggestedLength:h}=ov({responseHeaders:l,isHttp:e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=c,this._contentLength=h||this._contentLength,this._filename=av(l),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new oi("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:uv(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}class cC{constructor(e,t,n){this._stream=e,this._reader=null,this._loaded=0;const s=e.source;this._withCredentials=s.withCredentials||!1,this._readCapability=Promise.withResolvers(),this._isStreamingSupported=!s.disableStream,this._abortController=new AbortController;const o=new Headers(e.headers);o.append("Range",`bytes=${t}-${n-1}`);const l=s.url;fetch(l,cv(o,this._withCredentials,this._abortController)).then(c=>{const h=jl(c.url);if(h!==e._responseOrigin)throw new Error(`Expected range response-origin "${h}" to match "${e._responseOrigin}".`);if(!lv(c.status))throw No(c.status,l);this._readCapability.resolve(),this._reader=c.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:e,done:t}=await this._reader.read();return t?{value:e,done:t}:(this._loaded+=e.byteLength,this.onProgress?.({loaded:this._loaded}),{value:uv(e),done:!1})}cancel(e){this._reader?.cancel(e),this._abortController.abort()}}const th=200,nh=206;function uC(a){const e=a.response;return typeof e!="string"?e:Ro(e).buffer}class hC{_responseOrigin=null;constructor({url:e,httpHeaders:t,withCredentials:n}){this.url=e,this.isHttp=/^https?:/i.test(e),this.headers=rv(this.isHttp,t),this.withCredentials=n||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}request(e){const t=new XMLHttpRequest,n=this.currXhrId++,s=this.pendingRequests[n]={xhr:t};t.open("GET",this.url),t.withCredentials=this.withCredentials;for(const[o,l]of this.headers)t.setRequestHeader(o,l);return this.isHttp&&"begin"in e&&"end"in e?(t.setRequestHeader("Range",`bytes=${e.begin}-${e.end-1}`),s.expectedStatus=nh):s.expectedStatus=th,t.responseType="arraybuffer",Ie(e.onError,"Expected `onError` callback to be provided."),t.onerror=()=>{e.onError(t.status)},t.onreadystatechange=this.onStateChange.bind(this,n),t.onprogress=this.onProgress.bind(this,n),s.onHeadersReceived=e.onHeadersReceived,s.onDone=e.onDone,s.onError=e.onError,s.onProgress=e.onProgress,t.send(null),n}onProgress(e,t){const n=this.pendingRequests[e];n&&n.onProgress?.(t)}onStateChange(e,t){const n=this.pendingRequests[e];if(!n)return;const s=n.xhr;if(s.readyState>=2&&n.onHeadersReceived&&(n.onHeadersReceived(),delete n.onHeadersReceived),s.readyState!==4||!(e in this.pendingRequests))return;if(delete this.pendingRequests[e],s.status===0&&this.isHttp){n.onError(s.status);return}const o=s.status||th;if(!(o===th&&n.expectedStatus===nh)&&o!==n.expectedStatus){n.onError(s.status);return}const c=uC(s);if(o===nh){const h=s.getResponseHeader("Content-Range"),f=/bytes (\d+)-(\d+)\/(\d+)/.exec(h);f?n.onDone({begin:parseInt(f[1],10),chunk:c}):(Ae('Missing or invalid "Content-Range" header.'),n.onError(0))}else c?n.onDone({begin:0,chunk:c}):n.onError(s.status)}getRequestXhr(e){return this.pendingRequests[e].xhr}isPendingRequest(e){return e in this.pendingRequests}abortRequest(e){const t=this.pendingRequests[e].xhr;delete this.pendingRequests[e],t.abort()}}class dC{constructor(e){this._source=e,this._manager=new hC(e),this._rangeChunkSize=e.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(e){const t=this._rangeRequestReaders.indexOf(e);t>=0&&this._rangeRequestReaders.splice(t,1)}getFullReader(){return Ie(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new fC(this._manager,this._source),this._fullRequestReader}getRangeReader(e,t){const n=new pC(this._manager,e,t);return n.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class fC{constructor(e,t){this._manager=e,this._url=t.url,this._fullRequestId=e.request({onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._headersCapability=Promise.withResolvers(),this._disableRange=t.disableRange||!1,this._contentLength=t.length,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const e=this._fullRequestId,t=this._manager.getRequestXhr(e);this._manager._responseOrigin=jl(t.responseURL);const n=t.getAllResponseHeaders(),s=new Headers(n?n.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(c=>{const[h,...f]=c.split(": ");return[h,f.join(": ")]}):[]),{allowRangeRequests:o,suggestedLength:l}=ov({responseHeaders:s,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});o&&(this._isRangeSupported=!0),this._contentLength=l||this._contentLength,this._filename=av(s),this._isRangeSupported&&this._manager.abortRequest(e),this._headersCapability.resolve()}_onDone(e){if(e&&(this._requests.length>0?this._requests.shift().resolve({value:e.chunk,done:!1}):this._cachedChunks.push(e.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(e){this._storedError=No(e,this._url),this._headersCapability.reject(this._storedError);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(e){this.onProgress?.({loaded:e.loaded,total:e.lengthComputable?e.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersCapability.promise}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0,this._headersCapability.reject(e);for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class pC{constructor(e,t,n){this._manager=e,this._url=e.url,this._requestId=e.request({begin:t,end:n,onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)}),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_onHeadersReceived(){const e=jl(this._manager.getRequestXhr(this._requestId)?.responseURL);e!==this._manager._responseOrigin&&(this._storedError=new Error(`Expected range response-origin "${e}" to match "${this._manager._responseOrigin}".`),this._onError(0))}_close(){this.onClosed?.(this)}_onDone(e){const t=e.chunk;this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const n of this._requests)n.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(e){this._storedError??=No(e,this._url);for(const t of this._requests)t.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(e){this.isStreamingSupported||this.onProgress?.({loaded:e.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const t=this._queuedChunk;return this._queuedChunk=null,{value:t,done:!1}}if(this._done)return{value:void 0,done:!0};const e=Promise.withResolvers();return this._requests.push(e),e.promise}cancel(e){this._done=!0;for(const t of this._requests)t.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}const gC=/^[a-z][a-z0-9\-+.]+:/i;function mC(a){if(gC.test(a))return new URL(a);const e=process.getBuiltinModule("url");return new URL(e.pathToFileURL(a))}class yC{constructor(e){this.source=e,this.url=mC(e.url),Ie(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs."),this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return Ie(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=new vC(this),this._fullRequestReader}getRangeReader(e,t){if(t<=this._progressiveDataLength)return null;const n=new wC(this,e,t);return this._rangeRequestReaders.push(n),n}cancelAllRequests(e){this._fullRequestReader?.cancel(e);for(const t of this._rangeRequestReaders.slice(0))t.cancel(e)}}class vC{constructor(e){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null;const t=e.source;this._contentLength=t.length,this._loaded=0,this._filename=null,this._disableRange=t.disableRange||!1,this._rangeChunkSize=t.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!t.disableStream,this._isRangeSupported=!t.disableRange,this._readableStream=null,this._readCapability=Promise.withResolvers(),this._headersCapability=Promise.withResolvers();const n=process.getBuiltinModule("fs");n.promises.lstat(this._url).then(s=>{this._contentLength=s.size,this._setReadableStream(n.createReadStream(this._url)),this._headersCapability.resolve()},s=>{s.code==="ENOENT"&&(s=No(0,this._url.href)),this._storedError=s,this._headersCapability.reject(s)})}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new oi("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class wC{constructor(e,t,n){this._url=e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=Promise.withResolvers();const s=e.source;this._isStreamingSupported=!s.disableStream;const o=process.getBuiltinModule("fs");this._setReadableStream(o.createReadStream(this._url,{start:t,end:n-1}))}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const e=this._readableStream.read();return e===null?(this._readCapability=Promise.withResolvers(),this.read()):(this._loaded+=e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array(e).buffer,done:!1})}cancel(e){if(!this._readableStream){this._error(e);return}this._readableStream.destroy(e)}_error(e){this._storedError=e,this._readCapability.resolve()}_setReadableStream(e){this._readableStream=e,e.on("readable",()=>{this._readCapability.resolve()}),e.on("end",()=>{e.destroy(),this._done=!0,this._readCapability.resolve()}),e.on("error",t=>{this._error(t)}),this._storedError&&this._readableStream.destroy(this._storedError)}}const eo=Symbol("INITIAL_DATA");class hv{#e=Object.create(null);#t(e){return this.#e[e]||={...Promise.withResolvers(),data:eo}}get(e,t=null){if(t){const s=this.#t(e);return s.promise.then(()=>t(s.data)),null}const n=this.#e[e];if(!n||n.data===eo)throw new Error(`Requesting object that isn't resolved yet ${e}.`);return n.data}has(e){const t=this.#e[e];return!!t&&t.data!==eo}delete(e){const t=this.#e[e];return!t||t.data===eo?!1:(delete this.#e[e],!0)}resolve(e,t=null){const n=this.#t(e);n.data=t,n.resolve()}clear(){for(const e in this.#e){const{data:t}=this.#e[e];t?.bitmap?.close()}this.#e=Object.create(null)}*[Symbol.iterator](){for(const e in this.#e){const{data:t}=this.#e[e];t!==eo&&(yield[e,t])}}}const _C=1e5,vm=30;let vo=class rn{#e=Promise.withResolvers();#t=null;#i=!1;#n=!!globalThis.FontInspector?.enabled;#o=null;#s=null;#r=0;#a=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#m=[];#p=null;#u=[];#g=new WeakMap;#y=null;static#w=new Map;static#v=new Map;static#C=new WeakMap;static#A=null;static#_=new Set;constructor({textContentSource:e,container:t,viewport:n}){if(e instanceof ReadableStream)this.#p=e;else if(typeof e=="object")this.#p=new ReadableStream({start(h){h.enqueue(e),h.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#t=this.#l=t,this.#h=n.scale*An.pixelRatio,this.#d=n.rotation,this.#s={div:null,properties:null,ctx:null};const{pageWidth:s,pageHeight:o,pageX:l,pageY:c}=n.rawDims;this.#y=[1,0,0,-1,-l,c+o],this.#a=s,this.#r=o,rn.#P(),Oi(t,n),this.#e.promise.finally(()=>{rn.#_.delete(this),this.#s=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:e,isFirefox:t}=pt.platform;return Ee(this,"fontFamilyMap",new Map([["sans-serif",`${e&&t?"Calibri, ":""}sans-serif`],["monospace",`${e&&t?"Lucida Console, ":""}monospace`]]))}render(){const e=()=>{this.#c.read().then(({value:t,done:n})=>{if(n){this.#e.resolve();return}this.#o??=t.lang,Object.assign(this.#f,t.styles),this.#x(t.items),e()},this.#e.reject)};return this.#c=this.#p.getReader(),rn.#_.add(this),e(),this.#e.promise}update({viewport:e,onBefore:t=null}){const n=e.scale*An.pixelRatio,s=e.rotation;if(s!==this.#d&&(t?.(),this.#d=s,Oi(this.#l,{rotation:s})),n!==this.#h){t?.(),this.#h=n;const o={div:null,properties:null,ctx:rn.#R(this.#o)};for(const l of this.#u)o.properties=this.#g.get(l),o.div=l,this.#E(o)}}cancel(){const e=new oi("TextLayer task cancelled.");this.#c?.cancel(e).catch(()=>{}),this.#c=null,this.#e.reject(e)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#m}#x(e){if(this.#i)return;this.#s.ctx??=rn.#R(this.#o);const t=this.#u,n=this.#m;for(const s of e){if(t.length>_C){Ae("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(s.str===void 0){if(s.type==="beginMarkedContentProps"||s.type==="beginMarkedContent"){const o=this.#t;this.#t=document.createElement("span"),this.#t.classList.add("markedContent"),s.id&&this.#t.setAttribute("id",`${s.id}`),o.append(this.#t)}else s.type==="endMarkedContent"&&(this.#t=this.#t.parentNode);continue}n.push(s.str),this.#S(s)}}#S(e){const t=document.createElement("span"),n={angle:0,canvasWidth:0,hasText:e.str!=="",hasEOL:e.hasEOL,fontSize:0};this.#u.push(t);const s=re.transform(this.#y,e.transform);let o=Math.atan2(s[1],s[0]);const l=this.#f[e.fontName];l.vertical&&(o+=Math.PI/2);let c=this.#n&&l.fontSubstitution||l.fontFamily;c=rn.fontFamilyMap.get(c)||c;const h=Math.hypot(s[2],s[3]),f=h*rn.#F(c,l,this.#o);let p,g;o===0?(p=s[4],g=s[5]-f):(p=s[4]+f*Math.sin(o),g=s[5]-f*Math.cos(o));const y="calc(var(--total-scale-factor) *",w=t.style;this.#t===this.#l?(w.left=`${(100*p/this.#a).toFixed(2)}%`,w.top=`${(100*g/this.#r).toFixed(2)}%`):(w.left=`${y}${p.toFixed(2)}px)`,w.top=`${y}${g.toFixed(2)}px)`),w.fontSize=`${y}${(rn.#A*h).toFixed(2)}px)`,w.fontFamily=c,n.fontSize=h,t.setAttribute("role","presentation"),t.textContent=e.str,t.dir=e.dir,this.#n&&(t.dataset.fontName=l.fontSubstitutionLoadedName||e.fontName),o!==0&&(n.angle=o*(180/Math.PI));let b=!1;if(e.str.length>1)b=!0;else if(e.str!==" "&&e.transform[0]!==e.transform[3]){const _=Math.abs(e.transform[0]),A=Math.abs(e.transform[3]);_!==A&&Math.max(_,A)/Math.min(_,A)>1.5&&(b=!0)}if(b&&(n.canvasWidth=l.vertical?e.height:e.width),this.#g.set(t,n),this.#s.div=t,this.#s.properties=n,this.#E(this.#s),n.hasText&&this.#t.append(t),n.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),this.#t.append(_)}}#E(e){const{div:t,properties:n,ctx:s}=e,{style:o}=t;let l="";if(rn.#A>1&&(l=`scale(${1/rn.#A})`),n.canvasWidth!==0&&n.hasText){const{fontFamily:c}=o,{canvasWidth:h,fontSize:f}=n;rn.#k(s,f*this.#h,c);const{width:p}=s.measureText(t.textContent);p>0&&(l=`scaleX(${h*this.#h/p}) ${l}`)}n.angle!==0&&(l=`rotate(${n.angle}deg) ${l}`),l.length>0&&(o.transform=l)}static cleanup(){if(!(this.#_.size>0)){this.#w.clear();for(const{canvas:e}of this.#v.values())e.remove();this.#v.clear()}}static#R(e=null){let t=this.#v.get(e||="");if(!t){const n=document.createElement("canvas");n.className="hiddenCanvasElement",n.lang=e,document.body.append(n),t=n.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#v.set(e,t),this.#C.set(t,{size:0,family:""})}return t}static#k(e,t,n){const s=this.#C.get(e);t===s.size&&n===s.family||(e.font=`${t}px ${n}`,s.size=t,s.family=n)}static#P(){if(this.#A!==null)return;const e=document.createElement("div");e.style.opacity=0,e.style.lineHeight=1,e.style.fontSize="1px",e.style.position="absolute",e.textContent="X",document.body.append(e),this.#A=e.getBoundingClientRect().height,e.remove()}static#F(e,t,n){const s=this.#w.get(e);if(s)return s;const o=this.#R(n);o.canvas.width=o.canvas.height=vm,this.#k(o,vm,e);const l=o.measureText(""),c=l.fontBoundingBoxAscent,h=Math.abs(l.fontBoundingBoxDescent);o.canvas.width=o.canvas.height=0;let f=.8;return c?f=c/(c+h):(pt.platform.isFirefox&&Ae("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),t.ascent?f=t.ascent:t.descent&&(f=1+t.descent)),this.#w.set(e,f),f}};const bC=100;function ad(a={}){typeof a=="string"||a instanceof URL?a={url:a}:(a instanceof ArrayBuffer||ArrayBuffer.isView(a))&&(a={data:a});const e=new ld,{docId:t}=e,n=a.url?P1(a.url):null,s=a.data?R1(a.data):null,o=a.httpHeaders||null,l=a.withCredentials===!0,c=a.password??null,h=a.range instanceof cd?a.range:null,f=Number.isInteger(a.rangeChunkSize)&&a.rangeChunkSize>0?a.rangeChunkSize:2**16;let p=a.worker instanceof sr?a.worker:null;const g=a.verbosity,y=typeof a.docBaseUrl=="string"&&!Lo(a.docBaseUrl)?a.docBaseUrl:null,w=el(a.cMapUrl),b=a.cMapPacked!==!1,_=a.CMapReaderFactory||(xt?F1:sm),A=el(a.iccUrl),E=el(a.standardFontDataUrl),C=a.StandardFontDataFactory||(xt?B1:rm),T=el(a.wasmUrl),R=a.WasmFactory||(xt?U1:om),L=a.stopAtErrors!==!0,k=Number.isInteger(a.maxImageSize)&&a.maxImageSize>-1?a.maxImageSize:-1,N=a.isEvalSupported!==!1,U=typeof a.isOffscreenCanvasSupported=="boolean"?a.isOffscreenCanvasSupported:!xt,z=typeof a.isImageDecoderSupported=="boolean"?a.isImageDecoderSupported:!xt&&(pt.platform.isFirefox||!globalThis.chrome),V=Number.isInteger(a.canvasMaxAreaInBytes)?a.canvasMaxAreaInBytes:-1,q=typeof a.disableFontFace=="boolean"?a.disableFontFace:xt,ue=a.fontExtraProperties===!0,Q=a.enableXfa===!0,le=a.ownerDocument||globalThis.document,ye=a.disableRange===!0,J=a.disableStream===!0,K=a.disableAutoFetch===!0,$=a.pdfBug===!0,ee=a.CanvasFactory||(xt?O1:D1),Z=a.FilterFactory||(xt?N1:M1),M=a.enableHWA===!0,H=a.useWasm!==!1,ne=h?h.length:a.length??NaN,de=typeof a.useSystemFonts=="boolean"?a.useSystemFonts:!xt&&!q,we=typeof a.useWorkerFetch=="boolean"?a.useWorkerFetch:!!(_===sm&&C===rm&&R===om&&w&&E&&T&&io(w,document.baseURI)&&io(E,document.baseURI)&&io(T,document.baseURI)),ve=null;u1(g);const fe={canvasFactory:new ee({ownerDocument:le,enableHWA:M}),filterFactory:new Z({docId:t,ownerDocument:le}),cMapReaderFactory:we?null:new _({baseUrl:w,isCompressed:b}),standardFontDataFactory:we?null:new C({baseUrl:E}),wasmFactory:we?null:new R({baseUrl:T})};p||(p=sr.create({verbosity:g,port:Ni.workerPort}),e._worker=p);const Ce={docId:t,apiVersion:"5.4.296",data:s,password:c,disableAutoFetch:K,rangeChunkSize:f,length:ne,docBaseUrl:y,enableXfa:Q,evaluatorOptions:{maxImageSize:k,disableFontFace:q,ignoreErrors:L,isEvalSupported:N,isOffscreenCanvasSupported:U,isImageDecoderSupported:z,canvasMaxAreaInBytes:V,fontExtraProperties:ue,useSystemFonts:de,useWasm:H,useWorkerFetch:we,cMapUrl:w,iccUrl:A,standardFontDataUrl:E,wasmUrl:T}},Te={ownerDocument:le,pdfBug:$,styleElement:ve,loadingParams:{disableAutoFetch:K,enableXfa:Q}};return p.promise.then(function(){if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const ke=p.messageHandler.sendWithPromise("GetDocRequest",Ce,s?[s.buffer]:null);let Rt;if(h)Rt=new iC(h,{disableRange:ye,disableStream:J});else if(!s){if(!n)throw new Error("getDocument - no `url` parameter provided.");const Xt=io(n)?aC:xt?yC:dC;Rt=new Xt({url:n,length:ne,httpHeaders:o,withCredentials:l,rangeChunkSize:f,disableRange:ye,disableStream:J})}return ke.then(Xt=>{if(e.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Pe=new so(t,Xt,p.port),Ne=new EC(Pe,e,Rt,Te,fe,M);e._transport=Ne,Pe.send("Ready",null)})}).catch(e._capability.reject),e}class ld{static#e=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${ld.#e++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(e){throw this._worker?.port&&delete this._worker._pendingDestroy,e}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}let cd=class{#e=Promise.withResolvers();#t=[];#i=[];#n=[];#o=[];constructor(e,t,n=!1,s=null){this.length=e,this.initialData=t,this.progressiveDone=n,this.contentDispositionFilename=s}addRangeListener(e){this.#o.push(e)}addProgressListener(e){this.#n.push(e)}addProgressiveReadListener(e){this.#i.push(e)}addProgressiveDoneListener(e){this.#t.push(e)}onDataRange(e,t){for(const n of this.#o)n(e,t)}onDataProgress(e,t){this.#e.promise.then(()=>{for(const n of this.#n)n(e,t)})}onDataProgressiveRead(e){this.#e.promise.then(()=>{for(const t of this.#i)t(e)})}onDataProgressiveDone(){this.#e.promise.then(()=>{for(const e of this.#t)e()})}transportReady(){this.#e.resolve()}requestDataRange(e,t){Ue("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}};class SC{constructor(e,t){this._pdfInfo=e,this._transport=t}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return Ee(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(e){return this._transport.getPage(e)}getPageIndex(e){return this._transport.getPageIndex(e)}getDestinations(){return this._transport.getDestinations()}getDestination(e){return this._transport.getDestination(e)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(e,t){return this._transport.getAnnotationsByType(e,t)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getOptionalContentConfig(t)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(e=!1){return this._transport.startCleanup(e||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(e){return this._transport.cachedPageNumber(e)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class AC{#e=!1;constructor(e,t,n,s=!1){this._pageIndex=e,this._pageInfo=t,this._transport=n,this._stats=s?new Qg:null,this._pdfBug=s,this.commonObjs=n.commonObjs,this.objs=new hv,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:e,rotation:t=this.rotate,offsetX:n=0,offsetY:s=0,dontFlip:o=!1}={}){return new Io({viewBox:this.view,userUnit:this.userUnit,scale:e,rotation:t,offsetX:n,offsetY:s,dontFlip:o})}getAnnotations({intent:e="display"}={}){const{renderingIntent:t}=this._transport.getRenderingIntent(e);return this._transport.getAnnotations(this._pageIndex,t)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return Ee(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:e,canvas:t=e.canvas,viewport:n,intent:s="display",annotationMode:o=Bn.ENABLE,transform:l=null,background:c=null,optionalContentConfigPromise:h=null,annotationCanvasMap:f=null,pageColors:p=null,printAnnotationStorage:g=null,isEditing:y=!1,recordOperations:w=!1,operationsFilter:b=null}){this._stats?.time("Overall");const _=this._transport.getRenderingIntent(s,o,g,y),{renderingIntent:A,cacheKey:E}=_;this.#e=!1,h||=this._transport.getOptionalContentConfig(A);let C=this._intentStates.get(E);C||(C=Object.create(null),this._intentStates.set(E,C)),C.streamReaderCancelTimeout&&(clearTimeout(C.streamReaderCancelTimeout),C.streamReaderCancelTimeout=null);const T=!!(A&Vt.PRINT);C.displayReadyCapability||(C.displayReadyCapability=Promise.withResolvers(),C.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(_));const R=!!(this._pdfBug&&globalThis.StepperManager?.enabled),L=!this.recordedBBoxes&&(w||R),k=z=>{if(C.renderTasks.delete(N),L){const V=N.gfx?.dependencyTracker.take();V&&(N.stepper&&N.stepper.setOperatorBBoxes(V,N.gfx.dependencyTracker.takeDebugMetadata()),w&&(this.recordedBBoxes=V))}T&&(this.#e=!0),this.#t(),z?(N.capability.reject(z),this._abortOperatorList({intentState:C,reason:z instanceof Error?z:new Error(z)})):N.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},N=new $s({callback:k,params:{canvas:t,canvasContext:e,dependencyTracker:L?new H1(t,C.operatorList.length,R):null,viewport:n,transform:l,background:c},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:C.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!T,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:b});(C.renderTasks||=new Set).add(N);const U=N.task;return Promise.all([C.displayReadyCapability.promise,h]).then(([z,V])=>{if(this.destroyed){k();return}if(this._stats?.time("Rendering"),!(V.renderingIntent&A))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");N.initializeGraphics({transparency:z,optionalContentConfig:V}),N.operatorListChanged()}).catch(k),U}getOperatorList({intent:e="display",annotationMode:t=Bn.ENABLE,printAnnotationStorage:n=null,isEditing:s=!1}={}){function o(){c.operatorList.lastChunk&&(c.opListReadCapability.resolve(c.operatorList),c.renderTasks.delete(h))}const l=this._transport.getRenderingIntent(e,t,n,s,!0);let c=this._intentStates.get(l.cacheKey);c||(c=Object.create(null),this._intentStates.set(l.cacheKey,c));let h;return c.opListReadCapability||(h=Object.create(null),h.operatorListChanged=o,c.opListReadCapability=Promise.withResolvers(),(c.renderTasks||=new Set).add(h),c.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(l)),c.opListReadCapability.promise}streamTextContent({includeMarkedContent:e=!1,disableNormalization:t=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:e===!0,disableNormalization:t===!0},{highWaterMark:100,size(s){return s.items.length}})}getTextContent(e={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>yo.textContent(n));const t=this.streamTextContent(e);return new Promise(function(n,s){function o(){l.read().then(function({value:h,done:f}){if(f){n(c);return}c.lang??=h.lang,Object.assign(c.styles,h.styles),c.items.push(...h.items),o()},s)}const l=t.getReader(),c={items:[],styles:Object.create(null),lang:null};o()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const e=[];for(const t of this._intentStates.values())if(this._abortOperatorList({intentState:t,reason:new Error("Page was destroyed."),force:!0}),!t.opListReadCapability)for(const n of t.renderTasks)e.push(n.completed),n.cancel();return this.objs.clear(),this.#e=!1,Promise.all(e)}cleanup(e=!1){this.#e=!0;const t=this.#t();return e&&t&&(this._stats&&=new Qg),t}#t(){if(!this.#e||this.destroyed)return!1;for(const{renderTasks:e,operatorList:t}of this._intentStates.values())if(e.size>0||!t.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#e=!1,!0}_startRenderPage(e,t){const n=this._intentStates.get(t);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(e))}_renderPageChunk(e,t){for(let n=0,s=e.length;n<s;n++)t.operatorList.fnArray.push(e.fnArray[n]),t.operatorList.argsArray.push(e.argsArray[n]);t.operatorList.lastChunk=e.lastChunk,t.operatorList.separateAnnots=e.separateAnnots;for(const n of t.renderTasks)n.operatorListChanged();e.lastChunk&&this.#t()}_pumpOperatorList({renderingIntent:e,cacheKey:t,annotationStorageSerializable:n,modifiedIds:s}){const{map:o,transfer:l}=n,h=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:e,cacheKey:t,annotationStorage:o,modifiedIds:s},l).getReader(),f=this._intentStates.get(t);f.streamReader=h;const p=()=>{h.read().then(({value:g,done:y})=>{if(y){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(g,f),p())},g=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const y of f.renderTasks)y.operatorListChanged();this.#t()}if(f.displayReadyCapability)f.displayReadyCapability.reject(g);else if(f.opListReadCapability)f.opListReadCapability.reject(g);else throw g}})};p()}_abortOperatorList({intentState:e,reason:t,force:n=!1}){if(e.streamReader){if(e.streamReaderCancelTimeout&&(clearTimeout(e.streamReaderCancelTimeout),e.streamReaderCancelTimeout=null),!n){if(e.renderTasks.size>0)return;if(t instanceof Bl){let s=bC;t.extraDelay>0&&t.extraDelay<1e3&&(s+=t.extraDelay),e.streamReaderCancelTimeout=setTimeout(()=>{e.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:e,reason:t,force:!0})},s);return}}if(e.streamReader.cancel(new oi(t.message)).catch(()=>{}),e.streamReader=null,!this._transport.destroyed){for(const[s,o]of this._intentStates)if(o===e){this._intentStates.delete(s);break}this.cleanup()}}}get stats(){return this._stats}}var Li,_n,Jn,rs,kl,os,as,kt,pl,dv,fv,ro,Zs,gl;const We=class We{constructor({name:e=null,port:t=null,verbosity:n=h1()}={}){Rn(this,kt);Rn(this,Li,Promise.withResolvers());Rn(this,_n,null);Rn(this,Jn,null);Rn(this,rs,null);if(this.name=e,this.destroyed=!1,this.verbosity=n,t){if(Ve(We,as).has(t))throw new Error("Cannot use more than one PDFWorker per port.");Ve(We,as).set(t,this),In(this,kt,dv).call(this,t)}else In(this,kt,fv).call(this)}get promise(){return Ve(this,Li).promise}get port(){return Ve(this,Jn)}get messageHandler(){return Ve(this,_n)}destroy(){this.destroyed=!0,Ve(this,rs)?.terminate(),Ot(this,rs,null),Ve(We,as).delete(Ve(this,Jn)),Ot(this,Jn,null),Ve(this,_n)?.destroy(),Ot(this,_n,null)}static create(e){const t=Ve(this,as).get(e?.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new We(e)}static get workerSrc(){if(Ni.workerSrc)return Ni.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return Ee(this,"_setupFakeWorkerGlobal",(async()=>Ve(this,Zs,gl)?Ve(this,Zs,gl):(await import(this.workerSrc)).WorkerMessageHandler)())}};Li=new WeakMap,_n=new WeakMap,Jn=new WeakMap,rs=new WeakMap,kl=new WeakMap,os=new WeakMap,as=new WeakMap,kt=new WeakSet,pl=function(){Ve(this,Li).resolve(),Ve(this,_n).send("configure",{verbosity:this.verbosity})},dv=function(e){Ot(this,Jn,e),Ot(this,_n,new so("main","worker",e)),Ve(this,_n).on("ready",()=>{}),In(this,kt,pl).call(this)},fv=function(){if(Ve(We,os)||Ve(We,Zs,gl)){In(this,kt,ro).call(this);return}let{workerSrc:e}=We;try{We._isSameOrigin(window.location,e)||(e=We._createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e,{type:"module"}),n=new so("main","worker",t),s=()=>{o.abort(),n.destroy(),t.terminate(),this.destroyed?Ve(this,Li).reject(new Error("Worker was destroyed")):In(this,kt,ro).call(this)},o=new AbortController;t.addEventListener("error",()=>{Ve(this,rs)||s()},{signal:o.signal}),n.on("test",c=>{if(o.abort(),this.destroyed||!c){s();return}Ot(this,_n,n),Ot(this,Jn,t),Ot(this,rs,t),In(this,kt,pl).call(this)}),n.on("ready",c=>{if(o.abort(),this.destroyed){s();return}try{l()}catch{In(this,kt,ro).call(this)}});const l=()=>{const c=new Uint8Array;n.send("test",c,[c.buffer])};l();return}catch{Fl("The worker has been disabled.")}In(this,kt,ro).call(this)},ro=function(){Ve(We,os)||(Ae("Setting up fake worker."),Ot(We,os,!0)),We._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){Ve(this,Li).reject(new Error("Worker was destroyed"));return}const t=new L1;Ot(this,Jn,t);const n=`fake${ig(We,kl)._++}`,s=new so(n+"_worker",n,t);e.setup(s,t),Ot(this,_n,new so(n,n+"_worker",t)),In(this,kt,pl).call(this)}).catch(e=>{Ve(this,Li).reject(new Error(`Setting up fake worker failed: "${e.message}".`))})},Zs=new WeakSet,gl=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},Rn(We,Zs),Rn(We,kl,0),Rn(We,os,!1),Rn(We,as,new WeakMap),xt&&(Ot(We,os,!0),Ni.workerSrc||="./pdf.worker.mjs"),We._isSameOrigin=(e,t)=>{const n=URL.parse(e);if(!n?.origin||n.origin==="null")return!1;const s=new URL(t,n);return n.origin===s.origin},We._createCDNWrapper=e=>{const t=`await import("${e}");`;return URL.createObjectURL(new Blob([t],{type:"text/javascript"}))},We.fromPort=e=>{if(_1("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return We.create(e)};let sr=We;class EC{#e=new Map;#t=new Map;#i=new Map;#n=new Map;#o=null;constructor(e,t,n,s,o,l){this.messageHandler=e,this.loadingTask=t,this.commonObjs=new hv,this.fontLoader=new x1({ownerDocument:s.ownerDocument,styleElement:s.styleElement}),this.loadingParams=s.loadingParams,this._params=s,this.canvasFactory=o.canvasFactory,this.filterFactory=o.filterFactory,this.cMapReaderFactory=o.cMapReaderFactory,this.standardFontDataFactory=o.standardFontDataFactory,this.wasmFactory=o.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=Promise.withResolvers(),this.enableHWA=l,this.setupMessageHandler()}#s(e,t=null){const n=this.#e.get(e);if(n)return n;const s=this.messageHandler.sendWithPromise(e,t);return this.#e.set(e,s),s}get annotationStorage(){return Ee(this,"annotationStorage",new id)}getRenderingIntent(e,t=Bn.ENABLE,n=null,s=!1,o=!1){let l=Vt.DISPLAY,c=yh;switch(e){case"any":l=Vt.ANY;break;case"display":break;case"print":l=Vt.PRINT;break;default:Ae(`getRenderingIntent - invalid intent: ${e}`)}const h=l&Vt.PRINT&&n instanceof Jy?n:this.annotationStorage;switch(t){case Bn.DISABLE:l+=Vt.ANNOTATIONS_DISABLE;break;case Bn.ENABLE:break;case Bn.ENABLE_FORMS:l+=Vt.ANNOTATIONS_FORMS;break;case Bn.ENABLE_STORAGE:l+=Vt.ANNOTATIONS_STORAGE,c=h.serializable;break;default:Ae(`getRenderingIntent - invalid annotationMode: ${t}`)}s&&(l+=Vt.IS_EDITING),o&&(l+=Vt.OPLIST);const{ids:f,hash:p}=h.modifiedIds,g=[l,c.hash,p];return{renderingIntent:l,cacheKey:g.join("_"),annotationStorageSerializable:c,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#o?.reject(new Error("Worker was destroyed during onPassword callback"));const e=[];for(const n of this.#t.values())e.push(n._destroy());this.#t.clear(),this.#i.clear(),this.#n.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const t=this.messageHandler.sendWithPromise("Terminate",null);return e.push(t),Promise.all(e).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),vo.cleanup(),this._networkStream?.cancelAllRequests(new oi("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:e,loadingTask:t}=this;e.on("GetReader",(n,s)=>{Ie(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=o=>{this._lastProgress={loaded:o.loaded,total:o.total}},s.onPull=()=>{this._fullReader.read().then(function({value:o,done:l}){if(l){s.close();return}Ie(o instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(o),1,[o])}).catch(o=>{s.error(o)})},s.onCancel=o=>{this._fullReader.cancel(o),s.ready.catch(l=>{if(!this.destroyed)throw l})}}),e.on("ReaderHeadersReady",async n=>{await this._fullReader.headersReady;const{isStreamingSupported:s,isRangeSupported:o,contentLength:l}=this._fullReader;return(!s||!o)&&(this._lastProgress&&t.onProgress?.(this._lastProgress),this._fullReader.onProgress=c=>{t.onProgress?.({loaded:c.loaded,total:c.total})}),{isStreamingSupported:s,isRangeSupported:o,contentLength:l}}),e.on("GetRangeReader",(n,s)=>{Ie(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const o=this._networkStream.getRangeReader(n.begin,n.end);if(!o){s.close();return}s.onPull=()=>{o.read().then(function({value:l,done:c}){if(c){s.close();return}Ie(l instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),s.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{s.error(l)})},s.onCancel=l=>{o.cancel(l),s.ready.catch(c=>{if(!this.destroyed)throw c})}}),e.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,t._capability.resolve(new SC(n,this))}),e.on("DocException",n=>{t._capability.reject(Bt(n))}),e.on("PasswordRequest",n=>{this.#o=Promise.withResolvers();try{if(!t.onPassword)throw Bt(n);const s=o=>{o instanceof Error?this.#o.reject(o):this.#o.resolve({password:o})};t.onPassword(s,n.code)}catch(s){this.#o.reject(s)}return this.#o.promise}),e.on("DataLoaded",n=>{t.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),e.on("StartRenderPage",n=>{if(this.destroyed)return;this.#t.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),e.on("commonobj",([n,s,o])=>{if(this.destroyed||this.commonObjs.has(n))return null;switch(s){case"Font":if("error"in o){const p=o.error;Ae(`Error during font loading: ${p}`),this.commonObjs.resolve(n,p);break}const l=new Oe(o),c=this._params.pdfBug&&globalThis.FontInspector?.enabled?(p,g)=>globalThis.FontInspector.fontAdded(p,g):null,h=new k1(l,c,o.extra,o.charProcOperatorList);this.fontLoader.bind(h).catch(()=>e.sendWithPromise("FontFallback",{id:n})).finally(()=>{!h.fontExtraProperties&&h.data&&h.clearData(),this.commonObjs.resolve(n,h)});break;case"CopyLocalImage":const{imageRef:f}=o;Ie(f,"The imageRef must be defined.");for(const p of this.#t.values())for(const[,g]of p.objs)if(g?.ref===f)return g.dataLen?(this.commonObjs.resolve(n,structuredClone(g)),g.dataLen):null;break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,o);break;default:throw new Error(`Got unknown common object type ${s}`)}return null}),e.on("obj",([n,s,o,l])=>{if(this.destroyed)return;const c=this.#t.get(s);if(!c.objs.has(n)){if(c._intentStates.size===0){l?.bitmap?.close();return}switch(o){case"Image":case"Pattern":c.objs.resolve(n,l);break;default:throw new Error(`Got unknown object type ${o}`)}}}),e.on("DocProgress",n=>{this.destroyed||t.onProgress?.({loaded:n.loaded,total:n.total})}),e.on("FetchBinaryData",async n=>{if(this.destroyed)throw new Error("Worker was destroyed.");const s=this[n.type];if(!s)throw new Error(`${n.type} not initialized, see the \`useWorkerFetch\` parameter.`);return s.fetch(n)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&Ae("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:e,transfer:t}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:e,filename:this._fullReader?.filename??null},t).finally(()=>{this.annotationStorage.resetModified()})}getPage(e){if(!Number.isInteger(e)||e<=0||e>this._numPages)return Promise.reject(new Error("Invalid page request."));const t=e-1,n=this.#i.get(t);if(n)return n;const s=this.messageHandler.sendWithPromise("GetPage",{pageIndex:t}).then(o=>{if(this.destroyed)throw new Error("Transport destroyed");o.refStr&&this.#n.set(o.refStr,e);const l=new AC(t,o,this,this._params.pdfBug);return this.#t.set(t,l),l});return this.#i.set(t,s),s}getPageIndex(e){return vh(e)?this.messageHandler.sendWithPromise("GetPageIndex",{num:e.num,gen:e.gen}):Promise.reject(new Error("Invalid pageIndex request."))}getAnnotations(e,t){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:e,intent:t})}getFieldObjects(){return this.#s("GetFieldObjects")}hasJSActions(){return this.#s("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(e){return typeof e!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:e})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(e,t){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:e,pageIndexesToSkip:t})}getDocJSActions(){return this.#s("GetDocJSActions")}getPageJSActions(e){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:e})}getStructTree(e){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:e})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(e){return this.#s("GetOptionalContentConfig").then(t=>new nC(t,e))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const e="GetMetadata",t=this.#e.get(e);if(t)return t;const n=this.messageHandler.sendWithPromise(e,null).then(s=>({info:s[0],metadata:s[1]?new eC(s[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(e,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(e=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const t of this.#t.values())if(!t.cleanup())throw new Error(`startCleanup: Page ${t.pageNumber} is currently rendering.`);this.commonObjs.clear(),e||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),vo.cleanup()}}cachedPageNumber(e){if(!vh(e))return null;const t=e.gen===0?`${e.num}R`:`${e.num}R${e.gen}`;return this.#n.get(t)??null}}class CC{#e=null;onContinue=null;onError=null;constructor(e){this.#e=e}get promise(){return this.#e.capability.promise}cancel(e=0){this.#e.cancel(null,e)}get separateAnnots(){const{separateAnnots:e}=this.#e.operatorList;if(!e)return!1;const{annotationCanvasMap:t}=this.#e;return e.form||e.canvas&&t?.size>0}}class $s{#e=null;static#t=new WeakSet;constructor({callback:e,params:t,objs:n,commonObjs:s,annotationCanvasMap:o,operatorList:l,pageIndex:c,canvasFactory:h,filterFactory:f,useRequestAnimationFrame:p=!1,pdfBug:g=!1,pageColors:y=null,enableHWA:w=!1,operationsFilter:b=null}){this.callback=e,this.params=t,this.objs=n,this.commonObjs=s,this.annotationCanvasMap=o,this.operatorListIdx=null,this.operatorList=l,this._pageIndex=c,this.canvasFactory=h,this.filterFactory=f,this._pdfBug=g,this.pageColors=y,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new CC(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=t.canvas,this._canvasContext=t.canvas?null:t.canvasContext,this._enableHWA=w,this._dependencyTracker=t.dependencyTracker,this._operationsFilter=b}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:e=!1,optionalContentConfig:t}){if(this.cancelled)return;if(this._canvas){if($s.#t.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");$s.#t.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:n,transform:s,background:o,dependencyTracker:l}=this.params,c=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new Xs(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:t},this.annotationCanvasMap,this.pageColors,l),this.gfx.beginDrawing({transform:s,viewport:n,transparency:e,background:o}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(e=null,t=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#e&&(window.cancelAnimationFrame(this.#e),this.#e=null),$s.#t.delete(this._canvas),e||=new Bl(`Rendering cancelled, page ${this._pageIndex+1}`,t),this.callback(e),this.task.onError?.(e)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#e=window.requestAnimationFrame(()=>{this.#e=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),$s.#t.delete(this._canvas),this.callback())))}}const pv="5.4.296",gv="f56dc8601";class Wt{#e=null;#t=null;#i;#n=null;#o=!1;#s=!1;#r=null;#a;#c=null;#l=null;static#d=null;static get _keyboardManager(){return Ee(this,"_keyboardManager",new Do([[["Escape","mac+Escape"],Wt.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Wt.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Wt.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Wt.prototype._moveToPrevious],[["Home","mac+Home"],Wt.prototype._moveToBeginning],[["End","mac+End"],Wt.prototype._moveToEnd]]))}constructor({editor:e=null,uiManager:t=null}){e?(this.#s=!1,this.#r=e):this.#s=!0,this.#l=e?._uiManager||t,this.#a=this.#l._eventBus,this.#i=e?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",Wt.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const e=this.#e=document.createElement("button");e.className="colorPicker",e.tabIndex="0",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),e.ariaHasPopup="true",this.#r&&(e.ariaControls=`${this.#r.id}_colorpicker_dropdown`);const t=this.#l._signal;e.addEventListener("click",this.#p.bind(this),{signal:t}),e.addEventListener("keydown",this.#m.bind(this),{signal:t});const n=this.#t=document.createElement("span");return n.className="swatch",n.ariaHidden="true",n.style.backgroundColor=this.#i,e.append(n),e}renderMainDropdown(){const e=this.#n=this.#h();return e.ariaOrientation="horizontal",e.ariaLabelledBy="highlightColorPickerLabel",e}#h(){const e=document.createElement("div"),t=this.#l._signal;e.addEventListener("contextmenu",qt,{signal:t}),e.className="dropdown",e.role="listbox",e.ariaMultiSelectable="false",e.ariaOrientation="vertical",e.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#r&&(e.id=`${this.#r.id}_colorpicker_dropdown`);for(const[n,s]of this.#l.highlightColors){const o=document.createElement("button");o.tabIndex="0",o.role="option",o.setAttribute("data-color",s),o.title=n,o.setAttribute("data-l10n-id",Wt.#d[n]);const l=document.createElement("span");o.append(l),l.className="swatch",l.style.backgroundColor=s,o.ariaSelected=s===this.#i,o.addEventListener("click",this.#f.bind(this,s),{signal:t}),e.append(o)}return e.addEventListener("keydown",this.#m.bind(this),{signal:t}),e}#f(e,t){t.stopPropagation(),this.#a.dispatch("switchannotationeditorparams",{source:this,type:Re.HIGHLIGHT_COLOR,value:e}),this.updateColor(e)}_colorSelectFromKeyboard(e){if(e.target===this.#e){this.#p(e);return}const t=e.target.getAttribute("data-color");t&&this.#f(t,e)}_moveToNext(e){if(!this.#g){this.#p(e);return}if(e.target===this.#e){this.#n.firstChild?.focus();return}e.target.nextSibling?.focus()}_moveToPrevious(e){if(e.target===this.#n?.firstChild||e.target===this.#e){this.#g&&this._hideDropdownFromKeyboard();return}this.#g||this.#p(e),e.target.previousSibling?.focus()}_moveToBeginning(e){if(!this.#g){this.#p(e);return}this.#n.firstChild?.focus()}_moveToEnd(e){if(!this.#g){this.#p(e);return}this.#n.lastChild?.focus()}#m(e){Wt._keyboardManager.exec(this,e)}#p(e){if(this.#g){this.hideDropdown();return}if(this.#o=e.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#e.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const t=this.#n=this.#h();this.#e.append(t)}#u(e){this.#n?.contains(e.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#e.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#g(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#s){if(!this.#g){this.#r?.unselect();return}this.hideDropdown(),this.#e.focus({preventScroll:!0,focusVisible:this.#o})}}updateColor(e){if(this.#t&&(this.#t.style.backgroundColor=e),!this.#n)return;const t=this.#l.highlightColors.values();for(const n of this.#n.children)n.ariaSelected=t.next().value===e.toUpperCase()}destroy(){this.#e?.remove(),this.#e=null,this.#t=null,this.#n?.remove(),this.#n=null}}class wo{#e=null;#t=null;#i=null;static#n=null;constructor(e){this.#t=e,this.#i=e._uiManager,wo.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#e)return this.#e;const{editorType:e,colorType:t,colorValue:n}=this.#t,s=this.#e=document.createElement("input");return s.type="color",s.value=n||"#000000",s.className="basicColorPicker",s.tabIndex=0,s.setAttribute("data-l10n-id",wo.#n[e]),s.addEventListener("input",()=>{this.#i.updateParams(t,s.value)},{signal:this.#i._signal}),s}update(e){this.#e&&(this.#e.value=e)}destroy(){this.#e?.remove(),this.#e=null}hideDropdown(){}}function wm(a){return Math.floor(Math.max(0,Math.min(1,a))*255).toString(16).padStart(2,"0")}function to(a){return Math.max(0,Math.min(255,255*a))}class _m{static CMYK_G([e,t,n,s]){return["G",1-Math.min(1,.3*e+.59*n+.11*t+s)]}static G_CMYK([e]){return["CMYK",0,0,0,1-e]}static G_RGB([e]){return["RGB",e,e,e]}static G_rgb([e]){return e=to(e),[e,e,e]}static G_HTML([e]){const t=wm(e);return`#${t}${t}${t}`}static RGB_G([e,t,n]){return["G",.3*e+.59*t+.11*n]}static RGB_rgb(e){return e.map(to)}static RGB_HTML(e){return`#${e.map(wm).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([e,t,n,s]){return["RGB",1-Math.min(1,e+s),1-Math.min(1,n+s),1-Math.min(1,t+s)]}static CMYK_rgb([e,t,n,s]){return[to(1-Math.min(1,e+s)),to(1-Math.min(1,n+s)),to(1-Math.min(1,t+s))]}static CMYK_HTML(e){const t=this.CMYK_RGB(e).slice(1);return this.RGB_HTML(t)}static RGB_CMYK([e,t,n]){const s=1-e,o=1-t,l=1-n,c=Math.min(s,o,l);return["CMYK",s,o,l,c]}}class TC{create(e,t,n=!1){if(e<=0||t<=0)throw new Error("Invalid SVG dimensions");const s=this._createSVG("svg:svg");return s.setAttribute("version","1.1"),n||(s.setAttribute("width",`${e}px`),s.setAttribute("height",`${t}px`)),s.setAttribute("preserveAspectRatio","none"),s.setAttribute("viewBox",`0 0 ${e} ${t}`),s}createElement(e){if(typeof e!="string")throw new Error("Invalid SVG element type");return this._createSVG(e)}_createSVG(e){Ue("Abstract method `_createSVG` called.")}}class _o extends TC{_createSVG(e){return document.createElementNS(Qn,e)}}const xC=9,hs=new WeakSet,kC=new Date().getTimezoneOffset()*60*1e3;class bm{static create(e){switch(e.data.annotationType){case it.LINK:return new ud(e);case it.TEXT:return new RC(e);case it.WIDGET:switch(e.data.fieldType){case"Tx":return new IC(e);case"Btn":return e.data.radioButton?new mv(e):e.data.checkBox?new DC(e):new MC(e);case"Ch":return new NC(e);case"Sig":return new LC(e)}return new ps(e);case it.POPUP:return new bh(e);case it.FREETEXT:return new yv(e);case it.LINE:return new FC(e);case it.SQUARE:return new BC(e);case it.CIRCLE:return new UC(e);case it.POLYLINE:return new vv(e);case it.CARET:return new HC(e);case it.INK:return new hd(e);case it.POLYGON:return new jC(e);case it.HIGHLIGHT:return new wv(e);case it.UNDERLINE:return new zC(e);case it.SQUIGGLY:return new $C(e);case it.STRIKEOUT:return new VC(e);case it.STAMP:return new _v(e);case it.FILEATTACHMENT:return new WC(e);default:return new Qe(e)}}}class Qe{#e=null;#t=!1;#i=null;constructor(e,{isRenderable:t=!1,ignoreBorder:n=!1,createQuadrilaterals:s=!1}={}){this.isRenderable=t,this.data=e.data,this.layer=e.layer,this.linkService=e.linkService,this.downloadManager=e.downloadManager,this.imageResourcesPath=e.imageResourcesPath,this.renderForms=e.renderForms,this.svgFactory=e.svgFactory,this.annotationStorage=e.annotationStorage,this.enableComment=e.enableComment,this.enableScripting=e.enableScripting,this.hasJSActions=e.hasJSActions,this._fieldObjects=e.fieldObjects,this.parent=e.parent,t&&(this.container=this._createContainer(n)),s&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:e,richText:t}){return!!(e?.str||t?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Qe._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:e}=this,t=this.annotationStorage?.getEditor(e.id);return t?t.getData():e}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const e=this.annotationStorage?.getEditor(this.data.id);if(e)return e.commentButtonPositionInPage;const{quadPoints:t,inkLists:n,rect:s}=this.data;let o=-1/0,l=-1/0;if(t?.length>=8){for(let c=0;c<t.length;c+=8)t[c+1]>l?(l=t[c+1],o=t[c+2]):t[c+1]===l&&(o=Math.max(o,t[c+2]));return[o,l]}if(n?.length>=1){for(const c of n)for(let h=0,f=c.length;h<f;h+=2)c[h+1]>l?(l=c[h+1],o=c[h]):c[h+1]===l&&(o=Math.max(o,c[h]));if(o!==1/0)return[o,l]}return s?[s[2],s[3]]:null}_normalizePoint(e){const{page:{view:t},viewport:{rawDims:{pageWidth:n,pageHeight:s,pageX:o,pageY:l}}}=this.parent;return e[1]=t[3]-e[1]+t[1],e[0]=100*(e[0]-o)/n,e[1]=100*(e[1]-l)/s,e}get commentText(){const{data:e}=this;return this.annotationStorage.getRawValue(`${go}${e.id}`)?.popup?.contents||e.contentsObj?.str||""}set commentText(e){const{data:t}=this,n={deleted:!e,contents:e||""};this.annotationStorage.updateEditor(t.id,{popup:n})||this.annotationStorage.setValue(`${go}${t.id}`,{id:t.id,annotationType:t.annotationType,pageIndex:this.parent.page._pageIndex,popup:n,popupRef:t.popupRef,modificationDate:new Date}),e||this.removePopup()}removePopup(){(this.#i?.popup||this.popup)?.remove(),this.#i=this.popup=null}updateEdited(e){if(!this.container)return;e.rect&&(this.#e||={rect:this.data.rect.slice(0)});const{rect:t,popup:n}=e;t&&this.#n(t);let s=this.#i?.popup||this.popup;!s&&n?.text&&(this._createPopup(n),s=this.#i.popup),s&&(s.updateEdited(e),n?.deleted&&(s.remove(),this.#i=null,this.popup=null))}resetEdited(){this.#e&&(this.#n(this.#e.rect),this.#i?.popup.resetEdited(),this.#e=null)}#n(e){const{container:{style:t},data:{rect:n,rotation:s},parent:{viewport:{rawDims:{pageWidth:o,pageHeight:l,pageX:c,pageY:h}}}}=this;n?.splice(0,4,...e),t.left=`${100*(e[0]-c)/o}%`,t.top=`${100*(l-e[3]+h)/l}%`,s===0?(t.width=`${100*(e[2]-e[0])/o}%`,t.height=`${100*(e[3]-e[1])/l}%`):this.setRotation(s)}_createContainer(e){const{data:t,parent:{page:n,viewport:s}}=this,o=document.createElement("section");o.setAttribute("data-annotation-id",t.id),!(this instanceof ps)&&!(this instanceof ud)&&(o.tabIndex=0);const{style:l}=o;if(l.zIndex=this.parent.zIndex,this.parent.zIndex+=2,t.alternativeText&&(o.title=t.alternativeText),t.noRotate&&o.classList.add("norotate"),!t.rect||this instanceof bh){const{rotation:_}=t;return!t.hasOwnCanvas&&_!==0&&this.setRotation(_,o),o}const{width:c,height:h}=this;if(!e&&t.borderStyle.width>0){l.borderWidth=`${t.borderStyle.width}px`;const _=t.borderStyle.horizontalCornerRadius,A=t.borderStyle.verticalCornerRadius;if(_>0||A>0){const C=`calc(${_}px * var(--total-scale-factor)) / calc(${A}px * var(--total-scale-factor))`;l.borderRadius=C}else if(this instanceof mv){const C=`calc(${c}px * var(--total-scale-factor)) / calc(${h}px * var(--total-scale-factor))`;l.borderRadius=C}switch(t.borderStyle.style){case js.SOLID:l.borderStyle="solid";break;case js.DASHED:l.borderStyle="dashed";break;case js.BEVELED:Ae("Unimplemented border style: beveled");break;case js.INSET:Ae("Unimplemented border style: inset");break;case js.UNDERLINE:l.borderBottomStyle="solid";break}const E=t.borderColor||null;E?(this.#t=!0,l.borderColor=re.makeHexColor(E[0]|0,E[1]|0,E[2]|0)):l.borderWidth=0}const f=re.normalizeRect([t.rect[0],n.view[3]-t.rect[1]+n.view[1],t.rect[2],n.view[3]-t.rect[3]+n.view[1]]),{pageWidth:p,pageHeight:g,pageX:y,pageY:w}=s.rawDims;l.left=`${100*(f[0]-y)/p}%`,l.top=`${100*(f[1]-w)/g}%`;const{rotation:b}=t;return t.hasOwnCanvas||b===0?(l.width=`${100*c/p}%`,l.height=`${100*h/g}%`):this.setRotation(b,o),o}setRotation(e,t=this.container){if(!this.data.rect)return;const{pageWidth:n,pageHeight:s}=this.parent.viewport.rawDims;let{width:o,height:l}=this;e%180!==0&&([o,l]=[l,o]),t.style.width=`${100*o/n}%`,t.style.height=`${100*l/s}%`,t.setAttribute("data-main-rotation",(360-e)%360)}get _commonActions(){const e=(t,n,s)=>{const o=s.detail[t],l=o[0],c=o.slice(1);s.target.style[n]=_m[`${l}_HTML`](c),this.annotationStorage.setValue(this.data.id,{[n]:_m[`${l}_rgb`](c)})};return Ee(this,"_commonActions",{display:t=>{const{display:n}=t.detail,s=n%2===1;this.container.style.visibility=s?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:s,noPrint:n===1||n===2})},print:t=>{this.annotationStorage.setValue(this.data.id,{noPrint:!t.detail.print})},hidden:t=>{const{hidden:n}=t.detail;this.container.style.visibility=n?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:n,noView:n})},focus:t=>{setTimeout(()=>t.target.focus({preventScroll:!1}),0)},userName:t=>{t.target.title=t.detail.userName},readonly:t=>{t.target.disabled=t.detail.readonly},required:t=>{this._setRequired(t.target,t.detail.required)},bgColor:t=>{e("bgColor","backgroundColor",t)},fillColor:t=>{e("fillColor","backgroundColor",t)},fgColor:t=>{e("fgColor","color",t)},textColor:t=>{e("textColor","color",t)},borderColor:t=>{e("borderColor","borderColor",t)},strokeColor:t=>{e("strokeColor","borderColor",t)},rotation:t=>{const n=t.detail.rotation;this.setRotation(n),this.annotationStorage.setValue(this.data.id,{rotation:n})}})}_dispatchEventFromSandbox(e,t){const n=this._commonActions;for(const s of Object.keys(t.detail))(e[s]||n[s])?.(t)}_setDefaultPropertiesFromJS(e){if(!this.enableScripting)return;const t=this.annotationStorage.getRawValue(this.data.id);if(!t)return;const n=this._commonActions;for(const[s,o]of Object.entries(t)){const l=n[s];if(l){const c={detail:{[s]:o},target:e};l(c),delete t[s]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:e}=this.data;if(!e)return;const[t,n,s,o]=this.data.rect.map(_=>Math.fround(_));if(e.length===8){const[_,A,E,C]=e.subarray(2,6);if(s===_&&o===A&&t===E&&n===C)return}const{style:l}=this.container;let c;if(this.#t){const{borderColor:_,borderWidth:A}=l;l.borderWidth=0,c=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${_}" stroke-width="${A}">`],this.container.classList.add("hasBorder")}const h=s-t,f=o-n,{svgFactory:p}=this,g=p.createElement("svg");g.classList.add("quadrilateralsContainer"),g.setAttribute("width",0),g.setAttribute("height",0),g.role="none";const y=p.createElement("defs");g.append(y);const w=p.createElement("clipPath"),b=`clippath_${this.data.id}`;w.setAttribute("id",b),w.setAttribute("clipPathUnits","objectBoundingBox"),y.append(w);for(let _=2,A=e.length;_<A;_+=8){const E=e[_],C=e[_+1],T=e[_+2],R=e[_+3],L=p.createElement("rect"),k=(T-t)/h,N=(o-C)/f,U=(E-T)/h,z=(C-R)/f;L.setAttribute("x",k),L.setAttribute("y",N),L.setAttribute("width",U),L.setAttribute("height",z),w.append(L),c?.push(`<rect vector-effect="non-scaling-stroke" x="${k}" y="${N}" width="${U}" height="${z}"/>`)}this.#t&&(c.push("</g></svg>')"),l.backgroundImage=c.join("")),this.container.append(g),this.container.style.clipPath=`url(#${b})`}_createPopup(e=null){const{data:t}=this;let n,s;e?(n={str:e.text},s=e.date):(n=t.contentsObj,s=t.modificationDate);const o=this.#i=new bh({data:{color:t.color,titleObj:t.titleObj,modificationDate:s,contentsObj:n,richText:t.richText,parentRect:t.rect,borderStyle:0,id:`popup_${t.id}`,rotation:t.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]});this.parent._commentManager||this.parent.div.append(o.render())}get hasPopupElement(){return!!(this.#i||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#i}render(){Ue("Abstract method `AnnotationElement.render` called")}_getElementsByName(e,t=null){const n=[];if(this._fieldObjects){const s=this._fieldObjects[e];if(s)for(const{page:o,id:l,exportValues:c}of s){if(o===-1||l===t)continue;const h=typeof c=="string"?c:null,f=document.querySelector(`[data-element-id="${l}"]`);if(f&&!hs.has(f)){Ae(`_getElementsByName - element not allowed: ${l}`);continue}n.push({id:l,exportValue:h,domElement:f})}return n}for(const s of document.getElementsByName(e)){const{exportValue:o}=s,l=s.getAttribute("data-element-id");l!==t&&hs.has(s)&&n.push({id:l,exportValue:o,domElement:s})}return n}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const e=this.getElementsToTriggerPopup();if(Array.isArray(e))for(const t of e)t.classList.add("highlightArea");else e.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:e,data:{id:t}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:e,editId:t,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class PC extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.editor=e.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:e}=this;e.hasComment&&(this._createPopup(e.comment),this.extraPopupElement.popup.renderCommentButton())}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(e){this.editor.comment=e,e||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.container.remove(),this.container=null,this.removePopup()}}class ud extends Qe{constructor(e,t=null){super(e,{isRenderable:!0,ignoreBorder:!!t?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=e.data.isTooltipOnly}render(){const{data:e,linkService:t}=this,n=document.createElement("a");n.setAttribute("data-element-id",e.id);let s=!1;return e.url?(t.addLinkAttributes(n,e.url,e.newWindow),s=!0):e.action?(this._bindNamedAction(n,e.action,e.overlaidText),s=!0):e.attachment?(this.#t(n,e.attachment,e.overlaidText,e.attachmentDest),s=!0):e.setOCGState?(this.#i(n,e.setOCGState,e.overlaidText),s=!0):e.dest?(this._bindLink(n,e.dest,e.overlaidText),s=!0):(e.actions&&(e.actions.Action||e.actions["Mouse Up"]||e.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(n,e),s=!0),e.resetForm?(this._bindResetFormAction(n,e.resetForm),s=!0):this.isTooltipOnly&&!s&&(this._bindLink(n,""),s=!0)),this.container.classList.add("linkAnnotation"),s&&this.container.append(n),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(e,t,n=""){e.href=this.linkService.getDestinationHash(t),e.onclick=()=>(t&&this.linkService.goToDestination(t),!1),(t||t==="")&&this.#e(),n&&(e.title=n)}_bindNamedAction(e,t,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeNamedAction(t),!1),n&&(e.title=n),this.#e()}#t(e,t,n="",s=null){e.href=this.linkService.getAnchorUrl(""),t.description?e.title=t.description:n&&(e.title=n),e.onclick=()=>(this.downloadManager?.openOrDownloadData(t.content,t.filename,s),!1),this.#e()}#i(e,t,n=""){e.href=this.linkService.getAnchorUrl(""),e.onclick=()=>(this.linkService.executeSetOCGState(t),!1),n&&(e.title=n),this.#e()}_bindJSAction(e,t){e.href=this.linkService.getAnchorUrl("");const n=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const s of Object.keys(t.actions)){const o=n.get(s);o&&(e[o]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t.id,name:s}}),!1))}t.overlaidText&&(e.title=t.overlaidText),e.onclick||(e.onclick=()=>!1),this.#e()}_bindResetFormAction(e,t){const n=e.onclick;if(n||(e.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){Ae('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),n||(e.onclick=()=>!1);return}e.onclick=()=>{n?.();const{fields:s,refs:o,include:l}=t,c=[];if(s.length!==0||o.length!==0){const p=new Set(o);for(const g of s){const y=this._fieldObjects[g]||[];for(const{id:w}of y)p.add(w)}for(const g of Object.values(this._fieldObjects))for(const y of g)p.has(y.id)===l&&c.push(y)}else for(const p of Object.values(this._fieldObjects))c.push(...p);const h=this.annotationStorage,f=[];for(const p of c){const{id:g}=p;switch(f.push(g),p.type){case"text":{const w=p.defaultValue||"";h.setValue(g,{value:w});break}case"checkbox":case"radiobutton":{const w=p.defaultValue===p.exportValues;h.setValue(g,{value:w});break}case"combobox":case"listbox":{const w=p.defaultValue||"";h.setValue(g,{value:w});break}default:continue}const y=document.querySelector(`[data-element-id="${g}"]`);if(y){if(!hs.has(y)){Ae(`_bindResetFormAction - element not allowed: ${g}`);continue}}else continue;y.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class RC extends Qe{constructor(e){super(e,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const e=document.createElement("img");return e.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",e.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),e.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(e),this.container}}class ps extends Qe{render(){return this.container}showElementAndHideCanvas(e){this.data.hasOwnCanvas&&(e.previousSibling?.nodeName==="CANVAS"&&(e.previousSibling.hidden=!0),e.hidden=!1)}_getKeyModifier(e){return pt.platform.isMac?e.metaKey:e.ctrlKey}_setEventListener(e,t,n,s,o){n.includes("mouse")?e.addEventListener(n,l=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:o(l),shift:l.shiftKey,modifier:this._getKeyModifier(l)}})}):e.addEventListener(n,l=>{if(n==="blur"){if(!t.focused||!l.relatedTarget)return;t.focused=!1}else if(n==="focus"){if(t.focused)return;t.focused=!0}o&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:s,value:o(l)}})})}_setEventListeners(e,t,n,s){for(const[o,l]of n)(l==="Action"||this.data.actions?.[l])&&((l==="Focus"||l==="Blur")&&(t||={focused:!1}),this._setEventListener(e,t,o,l,s),l==="Focus"&&!this.data.actions?.Blur?this._setEventListener(e,t,"blur","Blur",null):l==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(e,t,"focus","Focus",null))}_setBackgroundColor(e){const t=this.data.backgroundColor||null;e.style.backgroundColor=t===null?"transparent":re.makeHexColor(t[0],t[1],t[2])}_setTextStyle(e){const t=["left","center","right"],{fontColor:n}=this.data.defaultAppearanceData,s=this.data.defaultAppearanceData.fontSize||xC,o=e.style;let l;const c=2,h=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c),p=Math.round(f/(Ku*s))||1,g=f/p;l=Math.min(s,h(g/Ku))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-c);l=Math.min(s,h(f/Ku))}o.fontSize=`calc(${l}px * var(--total-scale-factor))`,o.color=re.makeHexColor(n[0],n[1],n[2]),this.data.textAlignment!==null&&(o.textAlign=t[this.data.textAlignment])}_setRequired(e,t){t?e.setAttribute("required",!0):e.removeAttribute("required"),e.setAttribute("aria-required",t)}}class IC extends ps{constructor(e){const t=e.renderForms||e.data.hasOwnCanvas||!e.data.hasAppearance&&!!e.data.fieldValue;super(e,{isRenderable:t})}setPropertyOnSiblings(e,t,n,s){const o=this.annotationStorage;for(const l of this._getElementsByName(e.name,e.id))l.domElement&&(l.domElement[t]=n),o.setValue(l.id,{[s]:n})}render(){const e=this.annotationStorage,t=this.data.id;this.container.classList.add("textWidgetAnnotation");let n=null;if(this.renderForms){const s=e.getValue(t,{value:this.data.fieldValue});let o=s.value||"";const l=e.getValue(t,{charLimit:this.data.maxLen}).charLimit;l&&o.length>l&&(o=o.slice(0,l));let c=s.formattedValue||this.data.textContent?.join(`
`)||null;c&&this.data.comb&&(c=c.replaceAll(/\s+/g,""));const h={userValue:o,formattedValue:c,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(n=document.createElement("textarea"),n.textContent=c??o,this.data.doNotScroll&&(n.style.overflowY="hidden")):(n=document.createElement("input"),n.type=this.data.password?"password":"text",n.setAttribute("value",c??o),this.data.doNotScroll&&(n.style.overflowX="hidden")),this.data.hasOwnCanvas&&(n.hidden=!0),hs.add(n),n.setAttribute("data-element-id",t),n.disabled=this.data.readOnly,n.name=this.data.fieldName,n.tabIndex=0;const{datetimeFormat:f,datetimeType:p,timeStep:g}=this.data,y=!!p&&this.enableScripting;f&&(n.title=f),this._setRequired(n,this.data.required),l&&(n.maxLength=l),n.addEventListener("input",b=>{e.setValue(t,{value:b.target.value}),this.setPropertyOnSiblings(n,"value",b.target.value,"value"),h.formattedValue=null}),n.addEventListener("resetform",b=>{const _=this.data.defaultFieldValue??"";n.value=h.userValue=_,h.formattedValue=null});let w=b=>{const{formattedValue:_}=h;_!=null&&(b.target.value=_),b.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){n.addEventListener("focus",_=>{if(h.focused)return;const{target:A}=_;if(y&&(A.type=p,g&&(A.step=g)),h.userValue){const E=h.userValue;if(y)if(p==="time"){const C=new Date(E),T=[C.getHours(),C.getMinutes(),C.getSeconds()];A.value=T.map(R=>R.toString().padStart(2,"0")).join(":")}else A.value=new Date(E-kC).toISOString().split(p==="date"?"T":".",1)[0];else A.value=E}h.lastCommittedValue=A.value,h.commitKey=1,this.data.actions?.Focus||(h.focused=!0)}),n.addEventListener("updatefromsandbox",_=>{this.showElementAndHideCanvas(_.target);const A={value(E){h.userValue=E.detail.value??"",y||e.setValue(t,{value:h.userValue.toString()}),E.target.value=h.userValue},formattedValue(E){const{formattedValue:C}=E.detail;h.formattedValue=C,C!=null&&E.target!==document.activeElement&&(E.target.value=C);const T={formattedValue:C};y&&(T.value=C),e.setValue(t,T)},selRange(E){E.target.setSelectionRange(...E.detail.selRange)},charLimit:E=>{const{charLimit:C}=E.detail,{target:T}=E;if(C===0){T.removeAttribute("maxLength");return}T.setAttribute("maxLength",C);let R=h.userValue;!R||R.length<=C||(R=R.slice(0,C),T.value=h.userValue=R,e.setValue(t,{value:R}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:R,willCommit:!0,commitKey:1,selStart:T.selectionStart,selEnd:T.selectionEnd}}))}};this._dispatchEventFromSandbox(A,_)}),n.addEventListener("keydown",_=>{h.commitKey=1;let A=-1;if(_.key==="Escape"?A=0:_.key==="Enter"&&!this.data.multiLine?A=2:_.key==="Tab"&&(h.commitKey=3),A===-1)return;const{value:E}=_.target;h.lastCommittedValue!==E&&(h.lastCommittedValue=E,h.userValue=E,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:A,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}}))});const b=w;w=null,n.addEventListener("blur",_=>{if(!h.focused||!_.relatedTarget)return;this.data.actions?.Blur||(h.focused=!1);const{target:A}=_;let{value:E}=A;if(y){if(E&&p==="time"){const C=E.split(":").map(T=>parseInt(T,10));E=new Date(2e3,0,1,C[0],C[1],C[2]||0).valueOf(),A.step=""}else E.includes("T")||(E=`${E}T00:00`),E=new Date(E).valueOf();A.type="text"}h.userValue=E,h.lastCommittedValue!==E&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:E,willCommit:!0,commitKey:h.commitKey,selStart:_.target.selectionStart,selEnd:_.target.selectionEnd}}),b(_)}),this.data.actions?.Keystroke&&n.addEventListener("beforeinput",_=>{h.lastCommittedValue=null;const{data:A,target:E}=_,{value:C,selectionStart:T,selectionEnd:R}=E;let L=T,k=R;switch(_.inputType){case"deleteWordBackward":{const N=C.substring(0,T).match(/\w*[^\w]*$/);N&&(L-=N[0].length);break}case"deleteWordForward":{const N=C.substring(T).match(/^[^\w]*\w*/);N&&(k+=N[0].length);break}case"deleteContentBackward":T===R&&(L-=1);break;case"deleteContentForward":T===R&&(k+=1);break}_.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:C,change:A||"",willCommit:!1,selStart:L,selEnd:k}})}),this._setEventListeners(n,h,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],_=>_.target.value)}if(w&&n.addEventListener("blur",w),this.data.comb){const _=(this.data.rect[2]-this.data.rect[0])/l;n.classList.add("comb"),n.style.letterSpacing=`calc(${_}px * var(--total-scale-factor) - 1ch)`}}else n=document.createElement("div"),n.textContent=this.data.fieldValue,n.style.verticalAlign="middle",n.style.display="table-cell",this.data.hasOwnCanvas&&(n.hidden=!0);return this._setTextStyle(n),this._setBackgroundColor(n),this._setDefaultPropertiesFromJS(n),this.container.append(n),this.container}}class LC extends ps{constructor(e){super(e,{isRenderable:!!e.data.hasOwnCanvas})}}class DC extends ps{constructor(e){super(e,{isRenderable:e.renderForms})}render(){const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.exportValue===t.fieldValue}).value;typeof s=="string"&&(s=s!=="Off",e.setValue(n,{value:s})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const o=document.createElement("input");return hs.add(o),o.setAttribute("data-element-id",n),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="checkbox",o.name=t.fieldName,s&&o.setAttribute("checked",!0),o.setAttribute("exportValue",t.exportValue),o.tabIndex=0,o.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const f of this._getElementsByName(c,n)){const p=h&&f.exportValue===t.exportValue;f.domElement&&(f.domElement.checked=p),e.setValue(f.id,{value:p})}e.setValue(n,{value:h})}),o.addEventListener("resetform",l=>{const c=t.defaultFieldValue||"Off";l.target.checked=c===t.exportValue}),this.enableScripting&&this.hasJSActions&&(o.addEventListener("updatefromsandbox",l=>{const c={value(h){h.target.checked=h.detail.value!=="Off",e.setValue(n,{value:h.target.checked})}};this._dispatchEventFromSandbox(c,l)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],l=>l.target.checked)),this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class mv extends ps{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const e=this.annotationStorage,t=this.data,n=t.id;let s=e.getValue(n,{value:t.fieldValue===t.buttonValue}).value;if(typeof s=="string"&&(s=s!==t.buttonValue,e.setValue(n,{value:s})),s)for(const l of this._getElementsByName(t.fieldName,n))e.setValue(l.id,{value:!1});const o=document.createElement("input");if(hs.add(o),o.setAttribute("data-element-id",n),o.disabled=t.readOnly,this._setRequired(o,this.data.required),o.type="radio",o.name=t.fieldName,s&&o.setAttribute("checked",!0),o.tabIndex=0,o.addEventListener("change",l=>{const{name:c,checked:h}=l.target;for(const f of this._getElementsByName(c,n))e.setValue(f.id,{value:!1});e.setValue(n,{value:h})}),o.addEventListener("resetform",l=>{const c=t.defaultFieldValue;l.target.checked=c!=null&&c===t.buttonValue}),this.enableScripting&&this.hasJSActions){const l=t.buttonValue;o.addEventListener("updatefromsandbox",c=>{const h={value:f=>{const p=l===f.detail.value;for(const g of this._getElementsByName(f.target.name)){const y=p&&g.id===n;g.domElement&&(g.domElement.checked=y),e.setValue(g.id,{value:y})}}};this._dispatchEventFromSandbox(h,c)}),this._setEventListeners(o,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)}return this._setBackgroundColor(o),this._setDefaultPropertiesFromJS(o),this.container.append(o),this.container}}class MC extends ud{constructor(e){super(e,{ignoreBorder:e.data.hasAppearance})}render(){const e=super.render();e.classList.add("buttonWidgetAnnotation","pushButton");const t=e.lastChild;return this.enableScripting&&this.hasJSActions&&t&&(this._setDefaultPropertiesFromJS(t),t.addEventListener("updatefromsandbox",n=>{this._dispatchEventFromSandbox({},n)})),e}}class NC extends ps{constructor(e){super(e,{isRenderable:e.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const e=this.annotationStorage,t=this.data.id,n=e.getValue(t,{value:this.data.fieldValue}),s=document.createElement("select");hs.add(s),s.setAttribute("data-element-id",t),s.disabled=this.data.readOnly,this._setRequired(s,this.data.required),s.name=this.data.fieldName,s.tabIndex=0;let o=this.data.combo&&this.data.options.length>0;this.data.combo||(s.size=this.data.options.length,this.data.multiSelect&&(s.multiple=!0)),s.addEventListener("resetform",p=>{const g=this.data.defaultFieldValue;for(const y of s.options)y.selected=y.value===g});for(const p of this.data.options){const g=document.createElement("option");g.textContent=p.displayValue,g.value=p.exportValue,n.value.includes(p.exportValue)&&(g.setAttribute("selected",!0),o=!1),s.append(g)}let l=null;if(o){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),s.prepend(p),l=()=>{p.remove(),s.removeEventListener("input",l),l=null},s.addEventListener("input",l)}const c=p=>{const g=p?"value":"textContent",{options:y,multiple:w}=s;return w?Array.prototype.filter.call(y,b=>b.selected).map(b=>b[g]):y.selectedIndex===-1?null:y[y.selectedIndex][g]};let h=c(!1);const f=p=>{const g=p.target.options;return Array.prototype.map.call(g,y=>({displayValue:y.textContent,exportValue:y.value}))};return this.enableScripting&&this.hasJSActions?(s.addEventListener("updatefromsandbox",p=>{const g={value(y){l?.();const w=y.detail.value,b=new Set(Array.isArray(w)?w:[w]);for(const _ of s.options)_.selected=b.has(_.value);e.setValue(t,{value:c(!0)}),h=c(!1)},multipleSelection(y){s.multiple=!0},remove(y){const w=s.options,b=y.detail.remove;w[b].selected=!1,s.remove(b),w.length>0&&Array.prototype.findIndex.call(w,A=>A.selected)===-1&&(w[0].selected=!0),e.setValue(t,{value:c(!0),items:f(y)}),h=c(!1)},clear(y){for(;s.length!==0;)s.remove(0);e.setValue(t,{value:null,items:[]}),h=c(!1)},insert(y){const{index:w,displayValue:b,exportValue:_}=y.detail.insert,A=s.children[w],E=document.createElement("option");E.textContent=b,E.value=_,A?A.before(E):s.append(E),e.setValue(t,{value:c(!0),items:f(y)}),h=c(!1)},items(y){const{items:w}=y.detail;for(;s.length!==0;)s.remove(0);for(const b of w){const{displayValue:_,exportValue:A}=b,E=document.createElement("option");E.textContent=_,E.value=A,s.append(E)}s.options.length>0&&(s.options[0].selected=!0),e.setValue(t,{value:c(!0),items:f(y)}),h=c(!1)},indices(y){const w=new Set(y.detail.indices);for(const b of y.target.options)b.selected=w.has(b.index);e.setValue(t,{value:c(!0)}),h=c(!1)},editable(y){y.target.disabled=!y.detail.editable}};this._dispatchEventFromSandbox(g,p)}),s.addEventListener("input",p=>{const g=c(!0),y=c(!1);e.setValue(t,{value:g}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:t,name:"Keystroke",value:h,change:y,changeEx:g,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(s,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):s.addEventListener("input",function(p){e.setValue(t,{value:c(!0)})}),this.data.combo&&this._setTextStyle(s),this._setBackgroundColor(s),this._setDefaultPropertiesFromJS(s),this.container.append(s),this.container}}class bh extends Qe{constructor(e){const{data:t,elements:n,parent:s}=e,o=!!s._commentManager;if(super(e,{isRenderable:!o&&Qe._hasPopupData(t)}),this.elements=n,o&&Qe._hasPopupData(t)){const l=this.popup=this.#e();for(const c of n)c.popup=l}else this.popup=null}#e(){return new OC({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:e}=this;e.classList.add("popupAnnotation"),e.role="comment";const t=this.popup=this.#e(),n=[];for(const s of this.elements)s.popup=t,s.container.ariaHasPopup="dialog",n.push(s.data.id),s.addHighlightArea();return this.container.setAttribute("aria-controls",n.map(s=>`${Jh}${s}`).join(",")),this.container}}class OC{#e=null;#t=this.#V.bind(this);#i=this.#U.bind(this);#n=this.#D.bind(this);#o=this.#b.bind(this);#s=null;#r=null;#a=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#m=null;#p=null;#u=null;#g=null;#y=null;#w=null;#v=null;#C=null;#A=null;#_=null;#x=!1;#S=null;#E=null;constructor({container:e,color:t,elements:n,titleObj:s,modificationDate:o,contentsObj:l,richText:c,parent:h,rect:f,parentRect:p,open:g,commentManager:y=null}){this.#r=e,this.#A=s,this.#a=l,this.#C=c,this.#d=h,this.#s=t,this.#v=f,this.#h=p,this.#l=n,this.#e=y,this.#S=n[0],this.#c=Cl.toDateObject(o),this.trigger=n.flatMap(w=>w.getElementsToTriggerPopup()),y?this.renderCommentButton():(this.#R(),this.#r.hidden=!0,g&&this.#b())}#R(){if(this.#p)return;this.#p=new AbortController;const{signal:e}=this.#p;for(const t of this.trigger)t.addEventListener("click",this.#o,{signal:e}),t.addEventListener("pointerenter",this.#n,{signal:e}),t.addEventListener("pointerleave",this.#i,{signal:e}),t.classList.add("popupTriggerArea");for(const t of this.#l)t.container?.addEventListener("keydown",this.#t,{signal:e})}#k(){const e=this.#l.find(t=>t.hasCommentButton);e&&(this.#y=e._normalizePoint(e.commentButtonPosition))}renderCommentButton(){if(this.#g||(this.#y||this.#k(),!this.#y))return;const{signal:e}=this.#p=new AbortController,t=!!this.#S.extraPopupElement,n=()=>{this.#e.toggleCommentPopup(this,!0,void 0,!t)},s=()=>{this.#e.toggleCommentPopup(this,!1,!0,!t)},o=()=>{this.#e.toggleCommentPopup(this,!1,!1)};if(t){this.#g=this.#S.container;for(const l of this.trigger)l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.addEventListener("keydown",this.#t,{signal:e}),l.addEventListener("click",n,{signal:e}),l.addEventListener("pointerenter",s,{signal:e}),l.addEventListener("pointerleave",o,{signal:e}),l.classList.add("popupTriggerArea")}else{const l=this.#g=document.createElement("button");l.className="annotationCommentButton";const c=this.#S.container;l.style.zIndex=c.style.zIndex+1,l.tabIndex=0,l.ariaHasPopup="dialog",l.ariaControls="commentPopup",l.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#F(),this.#P(),l.addEventListener("keydown",this.#t,{signal:e}),l.addEventListener("click",n,{signal:e}),l.addEventListener("pointerenter",s,{signal:e}),l.addEventListener("pointerleave",o,{signal:e}),c.after(l)}}#P(){if(this.#S.extraPopupElement&&!this.#S.editor)return;this.renderCommentButton();const[e,t]=this.#y,{style:n}=this.#g;n.left=`calc(${e}%)`,n.top=`calc(${t}% - var(--comment-button-dim))`}#F(){this.#S.extraPopupElement||(this.renderCommentButton(),this.#g.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:e,opacity:t}=this.#S.commentData;return e?this.#d._commentManager.makeCommentColor(e,t):null}focusCommentButton(){setTimeout(()=>{this.#g?.focus()},0)}getData(){const{richText:e,color:t,opacity:n,creationDate:s,modificationDate:o}=this.#S.commentData;return{contentsObj:{str:this.comment},richText:e,color:t,opacity:n,creationDate:s,modificationDate:o}}get elementBeforePopup(){return this.#g}get comment(){return this.#E||=this.#S.commentText,this.#E}set comment(e){e!==this.comment&&(this.#S.commentText=this.#E=e)}get parentBoundingClientRect(){return this.#S.layer.getBoundingClientRect()}setCommentButtonStates({selected:e,hasPopup:t}){this.#g&&(this.#g.classList.toggle("selected",e),this.#g.ariaExpanded=t)}setSelectedCommentButton(e){this.#g.classList.toggle("selected",e)}get commentPopupPosition(){if(this.#w)return this.#w;const{x:e,y:t,height:n}=this.#g.getBoundingClientRect(),{x:s,y:o,width:l,height:c}=this.#S.layer.getBoundingClientRect();return[(e-s)/l,(t+n-o)/c]}set commentPopupPosition(e){this.#w=e}hasDefaultPopupPosition(){return this.#w===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#g.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(e){const[t,n]=this.#w||this.commentButtonPosition.map(f=>f/100),s=this.parentBoundingClientRect,{x:o,y:l,width:c,height:h}=s;this.#e.showDialog(null,this,o+t*c,l+n*h,{...e,parentDimensions:s})}render(){if(this.#m)return;const e=this.#m=document.createElement("div");if(e.className="popup",this.#s){const n=e.style.outlineColor=re.makeHexColor(...this.#s);e.style.backgroundColor=`color-mix(in srgb, ${n} 30%, white)`}const t=document.createElement("span");if(t.className="header",this.#A?.str){const n=document.createElement("span");n.className="title",t.append(n),{dir:n.dir,str:n.textContent}=this.#A}if(e.append(t),this.#c){const n=document.createElement("time");n.className="popupDate",n.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),n.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),n.dateTime=this.#c.toISOString(),t.append(n)}ed({html:this.#L||this.#a.str,dir:this.#a?.dir,className:"popupContent"},e),this.#r.append(e)}get#L(){const e=this.#C,t=this.#a;return e?.str&&(!t?.str||t.str===e.str)&&this.#C.html||null}get#M(){return this.#L?.attributes?.style?.fontSize||0}get#B(){return this.#L?.attributes?.style?.color||null}#N(e){const t=[],n={str:e,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:t}]}},s={style:{color:this.#B,fontSize:this.#M?`calc(${this.#M}px * var(--total-scale-factor))`:""}};for(const o of e.split(`
`))t.push({name:"span",value:o,attributes:s});return n}#V(e){e.altKey||e.shiftKey||e.ctrlKey||e.metaKey||(e.key==="Enter"||e.key==="Escape"&&this.#f)&&this.#b()}updateEdited({rect:e,popup:t,deleted:n}){if(this.#e){n?(this.remove(),this.#E=null):t&&(t.deleted?this.remove():(this.#F(),this.#E=t.text)),e&&(this.#y=null,this.#k(),this.#P());return}if(n||t?.deleted){this.remove();return}this.#R(),this.#_||={contentsObj:this.#a,richText:this.#C},e&&(this.#u=null),t&&t.text&&(this.#C=this.#N(t.text),this.#c=Cl.toDateObject(t.date),this.#a=null),this.#m?.remove(),this.#m=null}resetEdited(){this.#_&&({contentsObj:this.#a,richText:this.#C}=this.#_,this.#_=null,this.#m?.remove(),this.#m=null,this.#u=null)}remove(){if(this.#p?.abort(),this.#p=null,this.#m?.remove(),this.#m=null,this.#x=!1,this.#f=!1,this.#g?.remove(),this.#g=null,this.trigger)for(const e of this.trigger)e.classList.remove("popupTriggerArea")}#T(){if(this.#u!==null)return;const{page:{view:e},viewport:{rawDims:{pageWidth:t,pageHeight:n,pageX:s,pageY:o}}}=this.#d;let l=!!this.#h,c=l?this.#h:this.#v;for(const b of this.#l)if(!c||re.intersect(b.data.rect,c)!==null){c=b.data.rect,l=!0;break}const h=re.normalizeRect([c[0],e[3]-c[1]+e[1],c[2],e[3]-c[3]+e[1]]),p=l?c[2]-c[0]+5:0,g=h[0]+p,y=h[1];this.#u=[100*(g-s)/t,100*(y-o)/n];const{style:w}=this.#r;w.left=`${this.#u[0]}%`,w.top=`${this.#u[1]}%`}#b(){if(this.#e){this.#e.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#D(),this.#r.addEventListener("click",this.#o),this.#r.addEventListener("keydown",this.#t)):(this.#U(),this.#r.removeEventListener("click",this.#o),this.#r.removeEventListener("keydown",this.#t))}#D(){this.#m||this.render(),this.isVisible?this.#f&&this.#r.classList.add("focused"):(this.#T(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#U(){this.#r.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#x=this.isVisible,this.#x&&(this.#r.hidden=!0)}maybeShow(){this.#e||(this.#R(),this.#x&&(this.#m||this.#D(),this.#x=!1,this.#r.hidden=!1))}get isVisible(){return this.#e?!1:this.#r.hidden===!1}}class yv extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.textContent=e.data.textContent,this.textPosition=e.data.textPosition,this.annotationEditorType=Se.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const e=document.createElement("div");e.classList.add("annotationTextContent"),e.setAttribute("role","comment");for(const t of this.textContent){const n=document.createElement("span");n.textContent=t,e.append(n)}this.container.append(e)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class FC extends Qe{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),o=this.#e=this.svgFactory.createElement("svg:line");return o.setAttribute("x1",e.rect[2]-e.lineCoordinates[0]),o.setAttribute("y1",e.rect[3]-e.lineCoordinates[1]),o.setAttribute("x2",e.rect[2]-e.lineCoordinates[2]),o.setAttribute("y2",e.rect[3]-e.lineCoordinates[3]),o.setAttribute("stroke-width",e.borderStyle.width||1),o.setAttribute("stroke","transparent"),o.setAttribute("fill","transparent"),s.append(o),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class BC extends Qe{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),o=e.borderStyle.width,l=this.#e=this.svgFactory.createElement("svg:rect");return l.setAttribute("x",o/2),l.setAttribute("y",o/2),l.setAttribute("width",t-o),l.setAttribute("height",n-o),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class UC extends Qe{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:e,width:t,height:n}=this,s=this.svgFactory.create(t,n,!0),o=e.borderStyle.width,l=this.#e=this.svgFactory.createElement("svg:ellipse");return l.setAttribute("cx",t/2),l.setAttribute("cy",n/2),l.setAttribute("rx",t/2-o/2),l.setAttribute("ry",n/2-o/2),l.setAttribute("stroke-width",o||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),s.append(l),this.container.append(s),!e.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class vv extends Qe{#e=null;constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,vertices:t,borderStyle:n,popupRef:s},width:o,height:l}=this;if(!t)return this.container;const c=this.svgFactory.create(o,l,!0);let h=[];for(let p=0,g=t.length;p<g;p+=2){const y=t[p]-e[0],w=e[3]-t[p+1];h.push(`${y},${w}`)}h=h.join(" ");const f=this.#e=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",h),f.setAttribute("stroke-width",n.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),c.append(f),this.container.append(c),!s&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class jC extends vv{constructor(e){super(e),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class HC extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class hd extends Qe{#e=null;#t=[];constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?Se.HIGHLIGHT:Se.INK}#i(e,t){switch(e){case 90:return{transform:`rotate(90) translate(${-t[0]},${t[1]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};case 180:return{transform:`rotate(180) translate(${-t[2]},${t[1]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]};case 270:return{transform:`rotate(270) translate(${-t[2]},${t[3]}) scale(1,-1)`,width:t[3]-t[1],height:t[2]-t[0]};default:return{transform:`translate(${-t[0]},${t[3]}) scale(1,-1)`,width:t[2]-t[0],height:t[3]-t[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:e,rotation:t,inkLists:n,borderStyle:s,popupRef:o}}=this,{transform:l,width:c,height:h}=this.#i(t,e),f=this.svgFactory.create(c,h,!0),p=this.#e=this.svgFactory.createElement("svg:g");f.append(p),p.setAttribute("stroke-width",s.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",l);for(let g=0,y=n.length;g<y;g++){const w=this.svgFactory.createElement(this.svgElementName);this.#t.push(w),w.setAttribute("points",n[g].join(",")),p.append(w)}return!o&&this.hasPopupData&&this._createPopup(),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(e){super.updateEdited(e);const{thickness:t,points:n,rect:s}=e,o=this.#e;if(t>=0&&o.setAttribute("stroke-width",t||1),n)for(let l=0,c=this.#t.length;l<c;l++)this.#t[l].setAttribute("points",n[l].join(","));if(s){const{transform:l,width:c,height:h}=this.#i(this.data.rotation,s);o.parentElement.setAttribute("viewBox",`0 0 ${c} ${h}`),o.setAttribute("transform",l)}}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class wv extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=Se.HIGHLIGHT}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),e){const n=document.createElement("mark");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class zC extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class $C extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),e){const n=document.createElement("u");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class VC extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:e,popupRef:t}}=this;if(!t&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),e){const n=document.createElement("s");n.classList.add("overlaidText"),n.textContent=e,this.container.append(n)}return this.container}}class _v extends Qe{constructor(e){super(e,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=Se.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}class WC extends Qe{#e=null;constructor(e){super(e,{isRenderable:!0});const{file:t}=this.data;this.filename=t.filename,this.content=t.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...t})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:e,data:t}=this;let n;t.hasAppearance||t.fillAlpha===0?n=document.createElement("div"):(n=document.createElement("img"),n.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(t.name)?"paperclip":"pushpin"}.svg`,t.fillAlpha&&t.fillAlpha<1&&(n.style=`filter: opacity(${Math.round(t.fillAlpha*100)}%);`)),n.addEventListener("dblclick",this.#t.bind(this)),this.#e=n;const{isMac:s}=pt.platform;return e.addEventListener("keydown",o=>{o.key==="Enter"&&(s?o.metaKey:o.ctrlKey)&&this.#t()}),!t.popupRef&&this.hasPopupData?this._createPopup():n.classList.add("popupTriggerArea"),e.append(n),e}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}let dd=class bv{#e=null;#t=null;#i=null;#n=new Map;#o=null;#s=null;constructor({div:e,accessibilityManager:t,annotationCanvasMap:n,annotationEditorUIManager:s,page:o,viewport:l,structTreeLayer:c,commentManager:h,linkService:f,annotationStorage:p}){this.div=e,this.#e=t,this.#t=n,this.#o=c||null,this.#s=f||null,this.#i=p||new id,this.page=o,this.viewport=l,this.zIndex=0,this._annotationEditorUIManager=s,this._commentManager=h||null}hasEditableAnnotations(){return this.#n.size>0}async#r(e,t,n){const s=e.firstChild||e,o=s.id=`${Jh}${t}`,l=await this.#o?.getAriaAttributes(o);if(l)for(const[c,h]of l)s.setAttribute(c,h);n?n.at(-1).container.after(e):(this.div.append(e),this.#e?.moveElementInDOM(this.div,e,s,!1))}async render(e){const{annotations:t}=e,n=this.div;Oi(n,this.viewport);const s=new Map,o={data:null,layer:n,linkService:this.#s,downloadManager:e.downloadManager,imageResourcesPath:e.imageResourcesPath||"",renderForms:e.renderForms!==!1,svgFactory:new _o,annotationStorage:this.#i,enableComment:e.enableComment===!0,enableScripting:e.enableScripting===!0,hasJSActions:e.hasJSActions,fieldObjects:e.fieldObjects,parent:this,elements:null};for(const l of t){if(l.noHTML)continue;const c=l.annotationType===it.POPUP;if(c){const p=s.get(l.id);if(!p)continue;o.elements=p}else if(l.rect[2]===l.rect[0]||l.rect[3]===l.rect[1])continue;o.data=l;const h=bm.create(o);if(!h.isRenderable)continue;if(!c&&l.popupRef){const p=s.get(l.popupRef);p?p.push(h):s.set(l.popupRef,[h])}const f=h.render();l.hidden&&(f.style.visibility="hidden"),await this.#r(f,l.id,o.elements),h.extraPopupElement?.popup?.renderCommentButton(),h._isEditable&&(this.#n.set(h.data.id,h),this._annotationEditorUIManager?.renderAnnotationElement(h))}this.#a()}async addLinkAnnotations(e){const t={data:null,layer:this.div,linkService:this.#s,svgFactory:new _o,parent:this};for(const n of e){n.borderStyle||=bv._defaultBorderStyle,t.data=n;const s=bm.create(t);if(!s.isRenderable)continue;const o=s.render();await this.#r(o,n.id,null)}}update({viewport:e}){const t=this.div;this.viewport=e,Oi(t,{rotation:e.rotation}),this.#a(),t.hidden=!1}#a(){if(!this.#t)return;const e=this.div;for(const[t,n]of this.#t){const s=e.querySelector(`[data-annotation-id="${t}"]`);if(!s)continue;n.className="annotationContent";const{firstChild:o}=s;o?o.nodeName==="CANVAS"?o.replaceWith(n):o.classList.contains("annotationContent")?o.after(n):o.before(n):s.append(n);const l=this.#n.get(t);l&&(l._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(t,s.id,n),l._hasNoCanvas=!1):l.canvas=n)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(e){return this.#n.get(e)}addFakeAnnotation(e){const{div:t}=this,{id:n,rotation:s}=e,o=new PC({data:{id:n,rect:e.getPDFRect(),rotation:s},editor:e,layer:t,parent:this,enableComment:!!this._commentManager,linkService:this.#s,annotationStorage:this.#i}),l=o.render();return t.append(l),this.#e?.moveElementInDOM(t,l,l,!1),o.createOrUpdatePopup(),o}static get _defaultBorderStyle(){return Ee(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:js.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}};const ol=/\r\n?|\n/g;class dt extends he{#e="";#t=`${this.id}-editor`;#i=null;#n;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const e=dt.prototype,t=o=>o.isEmpty(),n=ai.TRANSLATE_SMALL,s=ai.TRANSLATE_BIG;return Ee(this,"_keyboardManager",new Do([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],e.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],e.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],e._translateEmpty,{args:[-n,0],checker:t}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],e._translateEmpty,{args:[-s,0],checker:t}],[["ArrowRight","mac+ArrowRight"],e._translateEmpty,{args:[n,0],checker:t}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],e._translateEmpty,{args:[s,0],checker:t}],[["ArrowUp","mac+ArrowUp"],e._translateEmpty,{args:[0,-n],checker:t}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],e._translateEmpty,{args:[0,-s],checker:t}],[["ArrowDown","mac+ArrowDown"],e._translateEmpty,{args:[0,n],checker:t}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],e._translateEmpty,{args:[0,s],checker:t}]]))}static _type="freetext";static _editorType=Se.FREETEXT;constructor(e){super({...e,name:"freeTextEditor"}),this.color=e.color||dt._defaultColor||he._defaultLineColor,this.#n=e.fontSize||dt._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert")}static initialize(e,t){he.initialize(e,t);const n=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(n.getPropertyValue("--freetext-padding"))}static updateDefaultParams(e,t){switch(e){case Re.FREETEXT_SIZE:dt._defaultFontSize=t;break;case Re.FREETEXT_COLOR:dt._defaultColor=t;break}}updateParams(e,t){switch(e){case Re.FREETEXT_SIZE:this.#o(t);break;case Re.FREETEXT_COLOR:this.#s(t);break}}static get defaultPropertiesToUpdate(){return[[Re.FREETEXT_SIZE,dt._defaultFontSize],[Re.FREETEXT_COLOR,dt._defaultColor||he._defaultLineColor]]}get propertiesToUpdate(){return[[Re.FREETEXT_SIZE,this.#n],[Re.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new wo(this),[["colorPicker",this._colorPicker]]}get colorType(){return Re.FREETEXT_COLOR}#o(e){const t=s=>{this.editorDiv.style.fontSize=`calc(${s}px * var(--total-scale-factor))`,this.translate(0,-(s-this.#n)*this.parentScale),this.#n=s,this.#a()},n=this.#n;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Re.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#s(e){const t=s=>{this.color=s,this.onUpdatedColor()},n=this.color;this.addCommands({cmd:t.bind(this,e),undo:t.bind(this,n),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Re.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(e,t){this._uiManager.translateSelectedEditors(e,t,!0)}getInitialTranslation(){const e=this.parentScale;return[-dt._internalPadding*e,-(dt._internalPadding+this.#n)*e]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const e=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:e}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:e}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:e}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:e}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:e}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#t),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(e){this._focusEventsAllowed&&(super.focusin(e),e.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(e){this.width||(this.enableEditMode(),e&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#r(){const e=[];this.editorDiv.normalize();let t=null;for(const n of this.editorDiv.childNodes)t?.nodeType===Node.TEXT_NODE&&n.nodeName==="BR"||(e.push(dt.#c(n)),t=n);return e.join(`
`)}#a(){const[e,t]=this.parentDimensions;let n;if(this.isAttachedToDOM)n=this.div.getBoundingClientRect();else{const{currentLayer:s,div:o}=this,l=o.style.display,c=o.classList.contains("hidden");o.classList.remove("hidden"),o.style.display="hidden",s.div.append(this.div),n=o.getBoundingClientRect(),o.remove(),o.style.display=l,o.classList.toggle("hidden",c)}this.rotation%180===this.parentRotation%180?(this.width=n.width/e,this.height=n.height/t):(this.width=n.height/e,this.height=n.width/t),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const e=this.#e,t=this.#e=this.#r().trimEnd();if(e===t)return;const n=s=>{if(this.#e=s,!s){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#a()};this.addCommands({cmd:()=>{n(t)},undo:()=>{n(e)},mustExec:!1}),this.#a()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(e){e.target===this.div&&e.key==="Enter"&&(this.enterInEditMode(),e.preventDefault())}editorDivKeydown(e){dt._keyboardManager.exec(this,e)}editorDivFocus(e){this.isEditing=!0}editorDivBlur(e){this.isEditing=!1}editorDivInput(e){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let e,t;(this._isCopy||this.annotationElementId)&&(e=this.x,t=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#t),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:n}=this.editorDiv;if(n.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,n.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[s,o]=this.parentDimensions;if(this.annotationElementId){const{position:l}=this._initialData;let[c,h]=this.getInitialTranslation();[c,h]=this.pageTranslationToScreen(c,h);const[f,p]=this.pageDimensions,[g,y]=this.pageTranslation;let w,b;switch(this.rotation){case 0:w=e+(l[0]-g)/f,b=t+this.height-(l[1]-y)/p;break;case 90:w=e+(l[0]-g)/f,b=t-(l[1]-y)/p,[c,h]=[h,-c];break;case 180:w=e-this.width+(l[0]-g)/f,b=t-(l[1]-y)/p,[c,h]=[-c,-h];break;case 270:w=e+(l[0]-g-this.height*p)/f,b=t+(l[1]-y-this.width*f)/p,[c,h]=[-h,c];break}this.setAt(w*s,b*o,c,h)}else this._moveAfterPaste(e,t);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(e){return(e.nodeType===Node.TEXT_NODE?e.nodeValue:e.innerText).replaceAll(ol,"")}editorDivPaste(e){const t=e.clipboardData||window.clipboardData,{types:n}=t;if(n.length===1&&n[0]==="text/plain")return;e.preventDefault();const s=dt.#h(t.getData("text")||"").replaceAll(ol,`
`);if(!s)return;const o=window.getSelection();if(!o.rangeCount)return;this.editorDiv.normalize(),o.deleteFromDocument();const l=o.getRangeAt(0);if(!s.includes(`
`)){l.insertNode(document.createTextNode(s)),this.editorDiv.normalize(),o.collapseToStart();return}const{startContainer:c,startOffset:h}=l,f=[],p=[];if(c.nodeType===Node.TEXT_NODE){const w=c.parentElement;if(p.push(c.nodeValue.slice(h).replaceAll(ol,"")),w!==this.editorDiv){let b=f;for(const _ of this.editorDiv.childNodes){if(_===w){b=p;continue}b.push(dt.#c(_))}}f.push(c.nodeValue.slice(0,h).replaceAll(ol,""))}else if(c===this.editorDiv){let w=f,b=0;for(const _ of this.editorDiv.childNodes)b++===h&&(w=p),w.push(dt.#c(_))}this.#e=`${f.join(`
`)}${s}${p.join(`
`)}`,this.#l();const g=new Range;let y=Math.sumPrecise(f.map(w=>w.length));for(const{firstChild:w}of this.editorDiv.childNodes)if(w.nodeType===Node.TEXT_NODE){const b=w.nodeValue.length;if(y<=b){g.setStart(w,y),g.setEnd(w,y);break}y-=b}o.removeAllRanges(),o.addRange(g)}#l(){if(this.editorDiv.replaceChildren(),!!this.#e)for(const e of this.#e.split(`
`)){const t=document.createElement("div");t.append(e?document.createTextNode(e):document.createElement("br")),this.editorDiv.append(t)}}#d(){return this.#e.replaceAll(""," ")}static#h(e){return e.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const e=dt._internalPadding*this.parentScale;return this.getRect(e,e)}static async deserialize(e,t,n){let s=null;if(e instanceof yv){const{data:{defaultAppearanceData:{fontSize:l,fontColor:c},rect:h,rotation:f,id:p,popupRef:g,richText:y,contentsObj:w,creationDate:b,modificationDate:_},textContent:A,textPosition:E,parent:{page:{pageNumber:C}}}=e;if(!A||A.length===0)return null;s=e={annotationType:Se.FREETEXT,color:Array.from(c),fontSize:l,value:A.join(`
`),position:E,pageIndex:C-1,rect:h.slice(0),rotation:f,annotationElementId:p,id:p,deleted:!1,popupRef:g,comment:w?.str||null,richText:y,creationDate:b,modificationDate:_}}const o=await super.deserialize(e,t,n);return o.#n=e.fontSize,o.color=re.makeHexColor(...e.color),o.#e=dt.#h(e.value),o._initialData=s,e.comment&&o.setCommentData(e),o}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const t=he._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),n=Object.assign(super.serialize(e),{color:t,fontSize:this.#n,value:this.#d()});return this.addComment(n),e?(n.isCopy=!0,n):this.annotationElementId&&!this.#f(n)?null:(n.id=this.annotationElementId,n)}#f(e){const{value:t,fontSize:n,color:s,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||e.value!==t||e.fontSize!==n||e.color.some((l,c)=>l!==s[c])||e.pageIndex!==o}renderAnnotationElement(e){const t=super.renderAnnotationElement(e);if(!t)return null;const{style:n}=t;n.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,n.color=this.color,t.replaceChildren();for(const s of this.#e.split(`
`)){const o=document.createElement("div");o.append(s?document.createTextNode(s):document.createElement("br")),t.append(o)}return e.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#e}}),t}resetAnnotationElement(e){super.resetAnnotationElement(e),e.resetEdited()}}class se{static PRECISION=1e-4;toSVGPath(){Ue("Abstract method `toSVGPath` must be implemented.")}get box(){Ue("Abstract getter `box` must be implemented.")}serialize(e,t){Ue("Abstract method `serialize` must be implemented.")}static _rescale(e,t,n,s,o,l){l||=new Float32Array(e.length);for(let c=0,h=e.length;c<h;c+=2)l[c]=t+e[c]*s,l[c+1]=n+e[c+1]*o;return l}static _rescaleAndSwap(e,t,n,s,o,l){l||=new Float32Array(e.length);for(let c=0,h=e.length;c<h;c+=2)l[c]=t+e[c+1]*s,l[c+1]=n+e[c]*o;return l}static _translate(e,t,n,s){s||=new Float32Array(e.length);for(let o=0,l=e.length;o<l;o+=2)s[o]=t+e[o],s[o+1]=n+e[o+1];return s}static svgRound(e){return Math.round(e*1e4)}static _normalizePoint(e,t,n,s,o){switch(o){case 90:return[1-t/n,e/s];case 180:return[1-e/n,1-t/s];case 270:return[t/n,1-e/s];default:return[e/n,t/s]}}static _normalizePagePoint(e,t,n){switch(n){case 90:return[1-t,e];case 180:return[1-e,1-t];case 270:return[t,1-e];default:return[e,t]}}static createBezierPoints(e,t,n,s,o,l){return[(e+5*n)/6,(t+5*s)/6,(5*n+o)/6,(5*s+l)/6,(n+o)/2,(s+l)/2]}}class ss{#e;#t=[];#i;#n;#o=[];#s=new Float32Array(18);#r;#a;#c;#l;#d;#h;#f=[];static#m=8;static#p=2;static#u=ss.#m+ss.#p;constructor({x:e,y:t},n,s,o,l,c=0){this.#e=n,this.#h=o*s,this.#n=l,this.#s.set([NaN,NaN,NaN,NaN,e,t],6),this.#i=c,this.#l=ss.#m*s,this.#c=ss.#u*s,this.#d=s,this.#f.push(e,t)}isEmpty(){return isNaN(this.#s[8])}#g(){const e=this.#s.subarray(4,6),t=this.#s.subarray(16,18),[n,s,o,l]=this.#e;return[(this.#r+(e[0]-t[0])/2-n)/o,(this.#a+(e[1]-t[1])/2-s)/l,(this.#r+(t[0]-e[0])/2-n)/o,(this.#a+(t[1]-e[1])/2-s)/l]}add({x:e,y:t}){this.#r=e,this.#a=t;const[n,s,o,l]=this.#e;let[c,h,f,p]=this.#s.subarray(8,12);const g=e-f,y=t-p,w=Math.hypot(g,y);if(w<this.#c)return!1;const b=w-this.#l,_=b/w,A=_*g,E=_*y;let C=c,T=h;c=f,h=p,f+=A,p+=E,this.#f?.push(e,t);const R=-E/b,L=A/b,k=R*this.#h,N=L*this.#h;return this.#s.set(this.#s.subarray(2,8),0),this.#s.set([f+k,p+N],4),this.#s.set(this.#s.subarray(14,18),12),this.#s.set([f-k,p-N],16),isNaN(this.#s[6])?(this.#o.length===0&&(this.#s.set([c+k,h+N],2),this.#o.push(NaN,NaN,NaN,NaN,(c+k-n)/o,(h+N-s)/l),this.#s.set([c-k,h-N],14),this.#t.push(NaN,NaN,NaN,NaN,(c-k-n)/o,(h-N-s)/l)),this.#s.set([C,T,c,h,f,p],6),!this.isEmpty()):(this.#s.set([C,T,c,h,f,p],6),Math.abs(Math.atan2(T-h,C-c)-Math.atan2(E,A))<Math.PI/2?([c,h,f,p]=this.#s.subarray(2,6),this.#o.push(NaN,NaN,NaN,NaN,((c+f)/2-n)/o,((h+p)/2-s)/l),[c,h,C,T]=this.#s.subarray(14,18),this.#t.push(NaN,NaN,NaN,NaN,((C+c)/2-n)/o,((T+h)/2-s)/l),!0):([C,T,c,h,f,p]=this.#s.subarray(0,6),this.#o.push(((C+5*c)/6-n)/o,((T+5*h)/6-s)/l,((5*c+f)/6-n)/o,((5*h+p)/6-s)/l,((c+f)/2-n)/o,((h+p)/2-s)/l),[f,p,c,h,C,T]=this.#s.subarray(12,18),this.#t.push(((C+5*c)/6-n)/o,((T+5*h)/6-s)/l,((5*c+f)/6-n)/o,((5*h+p)/6-s)/l,((c+f)/2-n)/o,((h+p)/2-s)/l),!0))}toSVGPath(){if(this.isEmpty())return"";const e=this.#o,t=this.#t;if(isNaN(this.#s[6])&&!this.isEmpty())return this.#y();const n=[];n.push(`M${e[4]} ${e[5]}`);for(let s=6;s<e.length;s+=6)isNaN(e[s])?n.push(`L${e[s+4]} ${e[s+5]}`):n.push(`C${e[s]} ${e[s+1]} ${e[s+2]} ${e[s+3]} ${e[s+4]} ${e[s+5]}`);this.#v(n);for(let s=t.length-6;s>=6;s-=6)isNaN(t[s])?n.push(`L${t[s+4]} ${t[s+5]}`):n.push(`C${t[s]} ${t[s+1]} ${t[s+2]} ${t[s+3]} ${t[s+4]} ${t[s+5]}`);return this.#w(n),n.join(" ")}#y(){const[e,t,n,s]=this.#e,[o,l,c,h]=this.#g();return`M${(this.#s[2]-e)/n} ${(this.#s[3]-t)/s} L${(this.#s[4]-e)/n} ${(this.#s[5]-t)/s} L${o} ${l} L${c} ${h} L${(this.#s[16]-e)/n} ${(this.#s[17]-t)/s} L${(this.#s[14]-e)/n} ${(this.#s[15]-t)/s} Z`}#w(e){const t=this.#t;e.push(`L${t[4]} ${t[5]} Z`)}#v(e){const[t,n,s,o]=this.#e,l=this.#s.subarray(4,6),c=this.#s.subarray(16,18),[h,f,p,g]=this.#g();e.push(`L${(l[0]-t)/s} ${(l[1]-n)/o} L${h} ${f} L${p} ${g} L${(c[0]-t)/s} ${(c[1]-n)/o}`)}newFreeDrawOutline(e,t,n,s,o,l){return new Sv(e,t,n,s,o,l)}getOutlines(){const e=this.#o,t=this.#t,n=this.#s,[s,o,l,c]=this.#e,h=new Float32Array((this.#f?.length??0)+2);for(let g=0,y=h.length-2;g<y;g+=2)h[g]=(this.#f[g]-s)/l,h[g+1]=(this.#f[g+1]-o)/c;if(h[h.length-2]=(this.#r-s)/l,h[h.length-1]=(this.#a-o)/c,isNaN(n[6])&&!this.isEmpty())return this.#C(h);const f=new Float32Array(this.#o.length+24+this.#t.length);let p=e.length;for(let g=0;g<p;g+=2){if(isNaN(e[g])){f[g]=f[g+1]=NaN;continue}f[g]=e[g],f[g+1]=e[g+1]}p=this.#_(f,p);for(let g=t.length-6;g>=6;g-=6)for(let y=0;y<6;y+=2){if(isNaN(t[g+y])){f[p]=f[p+1]=NaN,p+=2;continue}f[p]=t[g+y],f[p+1]=t[g+y+1],p+=2}return this.#A(f,p),this.newFreeDrawOutline(f,h,this.#e,this.#d,this.#i,this.#n)}#C(e){const t=this.#s,[n,s,o,l]=this.#e,[c,h,f,p]=this.#g(),g=new Float32Array(36);return g.set([NaN,NaN,NaN,NaN,(t[2]-n)/o,(t[3]-s)/l,NaN,NaN,NaN,NaN,(t[4]-n)/o,(t[5]-s)/l,NaN,NaN,NaN,NaN,c,h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(t[16]-n)/o,(t[17]-s)/l,NaN,NaN,NaN,NaN,(t[14]-n)/o,(t[15]-s)/l],0),this.newFreeDrawOutline(g,e,this.#e,this.#d,this.#i,this.#n)}#A(e,t){const n=this.#t;return e.set([NaN,NaN,NaN,NaN,n[4],n[5]],t),t+=6}#_(e,t){const n=this.#s.subarray(4,6),s=this.#s.subarray(16,18),[o,l,c,h]=this.#e,[f,p,g,y]=this.#g();return e.set([NaN,NaN,NaN,NaN,(n[0]-o)/c,(n[1]-l)/h,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,g,y,NaN,NaN,NaN,NaN,(s[0]-o)/c,(s[1]-l)/h],t),t+=24}}class Sv extends se{#e;#t=new Float32Array(4);#i;#n;#o;#s;#r;constructor(e,t,n,s,o,l){super(),this.#r=e,this.#o=t,this.#e=n,this.#s=s,this.#i=o,this.#n=l,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#a(l);const[c,h,f,p]=this.#t;for(let g=0,y=e.length;g<y;g+=2)e[g]=(e[g]-c)/f,e[g+1]=(e[g+1]-h)/p;for(let g=0,y=t.length;g<y;g+=2)t[g]=(t[g]-c)/f,t[g+1]=(t[g+1]-h)/p}toSVGPath(){const e=[`M${this.#r[4]} ${this.#r[5]}`];for(let t=6,n=this.#r.length;t<n;t+=6){if(isNaN(this.#r[t])){e.push(`L${this.#r[t+4]} ${this.#r[t+5]}`);continue}e.push(`C${this.#r[t]} ${this.#r[t+1]} ${this.#r[t+2]} ${this.#r[t+3]} ${this.#r[t+4]} ${this.#r[t+5]}`)}return e.push("Z"),e.join(" ")}serialize([e,t,n,s],o){const l=n-e,c=s-t;let h,f;switch(o){case 0:h=se._rescale(this.#r,e,s,l,-c),f=se._rescale(this.#o,e,s,l,-c);break;case 90:h=se._rescaleAndSwap(this.#r,e,t,l,c),f=se._rescaleAndSwap(this.#o,e,t,l,c);break;case 180:h=se._rescale(this.#r,n,t,-l,c),f=se._rescale(this.#o,n,t,-l,c);break;case 270:h=se._rescaleAndSwap(this.#r,n,s,-l,-c),f=se._rescaleAndSwap(this.#o,n,s,-l,-c);break}return{outline:Array.from(h),points:[Array.from(f)]}}#a(e){const t=this.#r;let n=t[4],s=t[5];const o=[n,s,n,s];let l=n,c=s,h=n,f=s;const p=e?Math.max:Math.min,g=new Float32Array(4);for(let w=6,b=t.length;w<b;w+=6){const _=t[w+4],A=t[w+5];isNaN(t[w])?(re.pointBoundingBox(_,A,o),c>A?(l=_,c=A):c===A&&(l=p(l,_)),f<A?(h=_,f=A):f===A&&(h=p(h,_))):(g[0]=g[1]=1/0,g[2]=g[3]=-1/0,re.bezierBoundingBox(n,s,...t.slice(w,w+6),g),re.rectBoundingBox(g[0],g[1],g[2],g[3],o),c>g[1]?(l=g[0],c=g[1]):c===g[1]&&(l=p(l,g[0])),f<g[3]?(h=g[2],f=g[3]):f===g[3]&&(h=p(h,g[2]))),n=_,s=A}const y=this.#t;y[0]=o[0]-this.#i,y[1]=o[1]-this.#i,y[2]=o[2]-o[0]+2*this.#i,y[3]=o[3]-o[1]+2*this.#i,this.firstPoint=[l,c],this.lastPoint=[h,f]}get box(){return this.#t}newOutliner(e,t,n,s,o,l=0){return new ss(e,t,n,s,o,l)}getNewOutline(e,t){const[n,s,o,l]=this.#t,[c,h,f,p]=this.#e,g=o*f,y=l*p,w=n*f+c,b=s*p+h,_=this.newOutliner({x:this.#o[0]*g+w,y:this.#o[1]*y+b},this.#e,this.#s,e,this.#n,t??this.#i);for(let A=2;A<this.#o.length;A+=2)_.add({x:this.#o[A]*g+w,y:this.#o[A+1]*y+b});return _.getOutlines()}}class Sh{#e;#t;#i;#n=[];#o=[];constructor(e,t=0,n=0,s=!0){const o=[1/0,1/0,-1/0,-1/0],l=10**-4;for(const{x:_,y:A,width:E,height:C}of e){const T=Math.floor((_-t)/l)*l,R=Math.ceil((_+E+t)/l)*l,L=Math.floor((A-t)/l)*l,k=Math.ceil((A+C+t)/l)*l,N=[T,L,k,!0],U=[R,L,k,!1];this.#n.push(N,U),re.rectBoundingBox(T,L,R,k,o)}const c=o[2]-o[0]+2*n,h=o[3]-o[1]+2*n,f=o[0]-n,p=o[1]-n;let g=s?-1/0:1/0,y=1/0;const w=this.#n.at(s?-1:-2),b=[w[0],w[2]];for(const _ of this.#n){const[A,E,C,T]=_;!T&&s?E<y?(y=E,g=A):E===y&&(g=Math.max(g,A)):T&&!s&&(E<y?(y=E,g=A):E===y&&(g=Math.min(g,A))),_[0]=(A-f)/c,_[1]=(E-p)/h,_[2]=(C-p)/h}this.#e=new Float32Array([f,p,c,h]),this.#t=[g,y],this.#i=b}getOutlines(){this.#n.sort((t,n)=>t[0]-n[0]||t[1]-n[1]||t[2]-n[2]);const e=[];for(const t of this.#n)t[3]?(e.push(...this.#l(t)),this.#a(t)):(this.#c(t),e.push(...this.#l(t)));return this.#s(e)}#s(e){const t=[],n=new Set;for(const l of e){const[c,h,f]=l;t.push([c,h,l],[c,f,l])}t.sort((l,c)=>l[1]-c[1]||l[0]-c[0]);for(let l=0,c=t.length;l<c;l+=2){const h=t[l][2],f=t[l+1][2];h.push(f),f.push(h),n.add(h),n.add(f)}const s=[];let o;for(;n.size>0;){const l=n.values().next().value;let[c,h,f,p,g]=l;n.delete(l);let y=c,w=h;for(o=[c,f],s.push(o);;){let b;if(n.has(p))b=p;else if(n.has(g))b=g;else break;n.delete(b),[c,h,f,p,g]=b,y!==c&&(o.push(y,w,c,w===h?h:f),y=c),w=w===h?f:h}o.push(y,w)}return new GC(s,this.#e,this.#t,this.#i)}#r(e){const t=this.#o;let n=0,s=t.length-1;for(;n<=s;){const o=n+s>>1,l=t[o][0];if(l===e)return o;l<e?n=o+1:s=o-1}return s+1}#a([,e,t]){const n=this.#r(e);this.#o.splice(n,0,[e,t])}#c([,e,t]){const n=this.#r(e);for(let s=n;s<this.#o.length;s++){const[o,l]=this.#o[s];if(o!==e)break;if(o===e&&l===t){this.#o.splice(s,1);return}}for(let s=n-1;s>=0;s--){const[o,l]=this.#o[s];if(o!==e)break;if(o===e&&l===t){this.#o.splice(s,1);return}}}#l(e){const[t,n,s]=e,o=[[t,n,s]],l=this.#r(s);for(let c=0;c<l;c++){const[h,f]=this.#o[c];for(let p=0,g=o.length;p<g;p++){const[,y,w]=o[p];if(!(f<=y||w<=h)){if(y>=h){if(w>f)o[p][1]=f;else{if(g===1)return[];o.splice(p,1),p--,g--}continue}o[p][2]=h,w>f&&o.push([t,f,w])}}}return o}}class GC extends se{#e;#t;constructor(e,t,n,s){super(),this.#t=e,this.#e=t,this.firstPoint=n,this.lastPoint=s}toSVGPath(){const e=[];for(const t of this.#t){let[n,s]=t;e.push(`M${n} ${s}`);for(let o=2;o<t.length;o+=2){const l=t[o],c=t[o+1];l===n?(e.push(`V${c}`),s=c):c===s&&(e.push(`H${l}`),n=l)}e.push("Z")}return e.join(" ")}serialize([e,t,n,s],o){const l=[],c=n-e,h=s-t;for(const f of this.#t){const p=new Array(f.length);for(let g=0;g<f.length;g+=2)p[g]=e+f[g]*c,p[g+1]=s-f[g+1]*h;l.push(p)}return l}get box(){return this.#e}get classNamesForOutlining(){return["highlightOutline"]}}class Ah extends ss{newFreeDrawOutline(e,t,n,s,o,l){return new qC(e,t,n,s,o,l)}}class qC extends Sv{newOutliner(e,t,n,s,o,l=0){return new Ah(e,t,n,s,o,l)}}class st extends he{#e=null;#t=0;#i;#n=null;#o=null;#s=null;#r=null;#a=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#m=null;#p=null;#u="";#g;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=Se.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const e=st.prototype;return Ee(this,"_keyboardManager",new Do([[["ArrowLeft","mac+ArrowLeft"],e._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],e._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],e._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],e._moveCaret,{args:[3]}]]))}constructor(e){super({...e,name:"highlightEditor"}),this.color=e.color||st._defaultColor,this.#g=e.thickness||st._defaultThickness,this.opacity=e.opacity||st._defaultOpacity,this.#i=e.boxes||null,this.#y=e.methodOfCreation||"",this.#u=e.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",e.highlightId>-1?(this.#h=!0,this.#v(e),this.#S()):this.#i&&(this.#e=e.anchorNode,this.#t=e.anchorOffset,this.#r=e.focusNode,this.#a=e.focusOffset,this.#w(),this.#S(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#g,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(e){return{numberOfColors:e.get("color").size}}#w(){const e=new Sh(this.#i,.001);this.#l=e.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const t=new Sh(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#s=t.getOutlines();const{firstPoint:n}=this.#l;this.#f=[(n[0]-this.x)/this.width,(n[1]-this.y)/this.height];const{lastPoint:s}=this.#s;this.#m=[(s[0]-this.x)/this.width,(s[1]-this.y)/this.height]}#v({highlightOutlines:e,highlightId:t,clipPathId:n}){this.#l=e;const s=1.5;if(this.#s=e.getNewOutline(this.#g/2+s,.0025),t>=0)this.#d=t,this.#n=n,this.parent.drawLayer.finalizeDraw(t,{bbox:e.box,path:{d:e.toSVGPath()}}),this.#p=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},!0);else if(this.parent){const g=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:st.#E(this.#l.box,(g-this.rotation+360)%360),path:{d:e.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#p,{bbox:st.#E(this.#s.box,g),path:{d:this.#s.toSVGPath()}})}const[o,l,c,h]=e.box;switch(this.rotation){case 0:this.x=o,this.y=l,this.width=c,this.height=h;break;case 90:{const[g,y]=this.parentDimensions;this.x=l,this.y=1-o,this.width=c*y/g,this.height=h*g/y;break}case 180:this.x=1-o,this.y=1-l,this.width=c,this.height=h;break;case 270:{const[g,y]=this.parentDimensions;this.x=1-l,this.y=o,this.width=c*y/g,this.height=h*g/y;break}}const{firstPoint:f}=e;this.#f=[(f[0]-o)/c,(f[1]-l)/h];const{lastPoint:p}=this.#s;this.#m=[(p[0]-o)/c,(p[1]-l)/h]}static initialize(e,t){he.initialize(e,t),st._defaultColor||=t.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(e,t){switch(e){case Re.HIGHLIGHT_COLOR:st._defaultColor=t;break;case Re.HIGHLIGHT_THICKNESS:st._defaultThickness=t;break}}translateInPage(e,t){}get toolbarPosition(){return this.#m}get commentButtonPosition(){return this.#f}updateParams(e,t){switch(e){case Re.HIGHLIGHT_COLOR:this.#C(t);break;case Re.HIGHLIGHT_THICKNESS:this.#A(t);break}}static get defaultPropertiesToUpdate(){return[[Re.HIGHLIGHT_COLOR,st._defaultColor],[Re.HIGHLIGHT_THICKNESS,st._defaultThickness]]}get propertiesToUpdate(){return[[Re.HIGHLIGHT_COLOR,this.color||st._defaultColor],[Re.HIGHLIGHT_THICKNESS,this.#g||st._defaultThickness],[Re.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#o?.updateColor(this.color),super.onUpdatedColor()}#C(e){const t=(o,l)=>{this.color=o,this.opacity=l,this.onUpdatedColor()},n=this.color,s=this.opacity;this.addCommands({cmd:t.bind(this,e,st._defaultOpacity),undo:t.bind(this,n,s),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Re.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(e)},!0)}#A(e){const t=this.#g,n=s=>{this.#g=s,this.#_(s)};this.addCommands({cmd:n.bind(this,e),undo:n.bind(this,t),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:Re.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:e},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#o=new Wt({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#P())}getBaseTranslation(){return[0,0]}getRect(e,t){return super.getRect(e,t,this.#P())}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),e&&this.div.focus()}remove(){this.#x(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#S(),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?this.#x():e&&(this.#S(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),this.show(this._isVisible),t&&this.select()}#_(e){this.#h&&(this.#v({highlightOutlines:this.#l.getNewOutline(e/2)}),this.fixAndSetPosition(),this.setDims(this.width,this.height))}#x(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#p),this.#p=null)}#S(e=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#n}=e.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#p=e.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#s.box,path:{d:this.#s.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#n))}static#E([e,t,n,s],o){switch(o){case 90:return[1-t-s,e,s,n];case 180:return[1-e-n,1-t-s,n,s];case 270:return[t,1-e-n,s,n]}return[e,t,n,s]}rotate(e){const{drawLayer:t}=this.parent;let n;this.#h?(e=(e-this.rotation+360)%360,n=st.#E(this.#l.box,e)):n=st.#E([this.x,this.y,this.width,this.height],e),t.updateProperties(this.#d,{bbox:n,root:{"data-main-rotation":e}}),t.updateProperties(this.#p,{bbox:st.#E(this.#s.box,e),root:{"data-main-rotation":e}})}render(){if(this.div)return this.div;const e=super.render();this.#u&&(e.setAttribute("aria-label",this.#u),e.setAttribute("role","mark")),this.#h?e.classList.add("free"):this.div.addEventListener("keydown",this.#R.bind(this),{signal:this._uiManager._signal});const t=this.#c=document.createElement("div");return e.append(t),t.setAttribute("aria-hidden","true"),t.className="internal",t.style.clipPath=this.#n,this.setDims(this.width,this.height),Yy(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),e}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1}})}#R(e){st._keyboardManager.exec(this,e)}_moveCaret(e){switch(this.parent.unselect(this),e){case 0:case 2:this.#k(!0);break;case 1:case 3:this.#k(!1);break}}#k(e){if(!this.#e)return;const t=window.getSelection();e?t.setPosition(this.#e,this.#t):t.setPosition(this.#r,this.#a)}select(){super.select(),this.#p&&this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#p&&(this.parent?.drawLayer.updateProperties(this.#p,{rootClass:{selected:!1}}),this.#h||this.#k(!1))}get _mustFixPosition(){return!this.#h}show(e=this._isVisible){super.show(e),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!e}}),this.parent.drawLayer.updateProperties(this.#p,{rootClass:{hidden:!e}}))}#P(){return this.#h?this.rotation:0}#F(){if(this.#h)return null;const[e,t]=this.pageDimensions,[n,s]=this.pageTranslation,o=this.#i,l=new Float32Array(o.length*8);let c=0;for(const{x:h,y:f,width:p,height:g}of o){const y=h*e+n,w=(1-f)*t+s;l[c]=l[c+4]=y,l[c+1]=l[c+3]=w,l[c+2]=l[c+6]=y+p*e,l[c+5]=l[c+7]=w-g*t,c+=8}return l}#L(e){return this.#l.serialize(e,this.#P())}static startHighlighting(e,t,{target:n,x:s,y:o}){const{x:l,y:c,width:h,height:f}=n.getBoundingClientRect(),p=new AbortController,g=e.combinedSignal(p),y=w=>{p.abort(),this.#B(e,w)};window.addEventListener("blur",y,{signal:g}),window.addEventListener("pointerup",y,{signal:g}),window.addEventListener("pointerdown",Ye,{capture:!0,passive:!1,signal:g}),window.addEventListener("contextmenu",qt,{signal:g}),n.addEventListener("pointermove",this.#M.bind(this,e),{signal:g}),this._freeHighlight=new Ah({x:s,y:o},[l,c,h,f],e.scale,this._defaultThickness/2,t,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#M(e,t){this._freeHighlight.add(t)&&e.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#B(e,t){this._freeHighlight.isEmpty()?e.drawLayer.remove(this._freeHighlightId):e.createAndAddNewEditor(t,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(e,t,n){let s=null;if(e instanceof wv){const{data:{quadPoints:b,rect:_,rotation:A,id:E,color:C,opacity:T,popupRef:R,richText:L,contentsObj:k,creationDate:N,modificationDate:U},parent:{page:{pageNumber:z}}}=e;s=e={annotationType:Se.HIGHLIGHT,color:Array.from(C),opacity:T,quadPoints:b,boxes:null,pageIndex:z-1,rect:_.slice(0),rotation:A,annotationElementId:E,id:E,deleted:!1,popupRef:R,richText:L,comment:k?.str||null,creationDate:N,modificationDate:U}}else if(e instanceof hd){const{data:{inkLists:b,rect:_,rotation:A,id:E,color:C,borderStyle:{rawWidth:T},popupRef:R,richText:L,contentsObj:k,creationDate:N,modificationDate:U},parent:{page:{pageNumber:z}}}=e;s=e={annotationType:Se.HIGHLIGHT,color:Array.from(C),thickness:T,inkLists:b,boxes:null,pageIndex:z-1,rect:_.slice(0),rotation:A,annotationElementId:E,id:E,deleted:!1,popupRef:R,richText:L,comment:k?.str||null,creationDate:N,modificationDate:U}}const{color:o,quadPoints:l,inkLists:c,opacity:h}=e,f=await super.deserialize(e,t,n);f.color=re.makeHexColor(...o),f.opacity=h||1,c&&(f.#g=e.thickness),f._initialData=s,e.comment&&f.setCommentData(e);const[p,g]=f.pageDimensions,[y,w]=f.pageTranslation;if(l){const b=f.#i=[];for(let _=0;_<l.length;_+=8)b.push({x:(l[_]-y)/p,y:1-(l[_+1]-w)/g,width:(l[_+2]-l[_])/p,height:(l[_+1]-l[_+5])/g});f.#w(),f.#S(),f.rotate(f.rotation)}else if(c){f.#h=!0;const b=c[0],_={x:b[0]-y,y:g-(b[1]-w)},A=new Ah(_,[0,0,p,g],1,f.#g/2,!0,.001);for(let T=0,R=b.length;T<R;T+=2)_.x=b[T]-y,_.y=g-(b[T+1]-w),A.add(_);const{id:E,clipPathId:C}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:A.toSVGPath()}},!0,!0);f.#v({highlightOutlines:A.getOutlines(),highlightId:E,clipPathId:C}),f.#S(),f.rotate(f.parentRotation)}return f}serialize(e=!1){if(this.isEmpty()||e)return null;if(this.deleted)return this.serializeDeleted();const t=he._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),n=super.serialize(e);return Object.assign(n,{color:t,opacity:this.opacity,thickness:this.#g,quadPoints:this.#F(),outlines:this.#L(n.rect)}),this.addComment(n),this.annotationElementId&&!this.#N(n)?null:(n.id=this.annotationElementId,n)}#N(e){const{color:t}=this._initialData;return this.hasEditedComment||e.color.some((n,s)=>n!==t[s])}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class Av{#e=Object.create(null);updateProperty(e,t){this[e]=t,this.updateSVGProperty(e,t)}updateProperties(e){if(e)for(const[t,n]of Object.entries(e))t.startsWith("_")||this.updateProperty(t,n)}updateSVGProperty(e,t){this.#e[e]=t}toSVGProperties(){const e=this.#e;return this.#e=Object.create(null),{root:e}}reset(){this.#e=Object.create(null)}updateAll(e=this){this.updateProperties(e)}clone(){Ue("Not implemented")}}class me extends he{#e=null;#t;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#n=null;static#o=null;static#s=NaN;static#r=null;static#a=null;static#c=NaN;static _INNER_MARGIN=3;constructor(e){super(e),this.#t=e.mustBeCommitted||!1,this._addOutlines(e)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(e){e.drawOutlines&&(this.#l(e),this.#f())}#l({drawOutlines:e,drawId:t,drawingOptions:n}){this.#e=e,this._drawingOptions||=n,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),t>=0?(this._drawId=t,this.parent.drawLayer.finalizeDraw(t,e.defaultProperties)):this._drawId=this.#d(e,this.parent),this.#u(e.box)}#d(e,t){const{id:n}=t.drawLayer.draw(me._mergeSVGProperties(this._drawingOptions.toSVGProperties(),e.defaultSVGProperties),!1,!1);return n}static _mergeSVGProperties(e,t){const n=new Set(Object.keys(e));for(const[s,o]of Object.entries(t))n.has(s)?Object.assign(e[s],o):e[s]=o;return e}static getDefaultDrawingOptions(e){Ue("Not implemented")}static get typesMap(){Ue("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(e,t){const n=this.typesMap.get(e);n&&this._defaultDrawingOptions.updateProperty(n,t),this._currentParent&&(me.#i.updateProperty(n,t),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(e,t){const n=this.constructor.typesMap.get(e);n&&this._updateProperty(e,n,t)}static get defaultPropertiesToUpdate(){const e=[],t=this._defaultDrawingOptions;for(const[n,s]of this.typesMap)e.push([n,t[s]]);return e}get propertiesToUpdate(){const e=[],{_drawingOptions:t}=this;for(const[n,s]of this.constructor.typesMap)e.push([n,t[s]]);return e}_updateProperty(e,t,n){const s=this._drawingOptions,o=s[t],l=c=>{s.updateProperty(t,c);const h=this.#e.updateProperty(t,c);h&&this.#u(h),this.parent?.drawLayer.updateProperties(this._drawId,s.toSVGProperties()),e===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:l.bind(this,n),undo:l.bind(this,o),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:e,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,me._mergeSVGProperties(this.#e.getPathResizingSVGProperties(this.#p()),{bbox:this.#g()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,me._mergeSVGProperties(this.#e.getPathResizedSVGProperties(this.#p()),{bbox:this.#g()}))}_onTranslating(e,t){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#g()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,me._mergeSVGProperties(this.#e.getPathTranslatedSVGProperties(this.#p(),this.parentDimensions),{bbox:this.#g()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(e){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#t&&(this.#t=!1,this.commit(),this.parent.setSelected(this),e&&this.isOnScreen&&this.div.focus())}remove(){this.#h(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#f(),this.#u(this.#e.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(e){let t=!1;this.parent&&!e?(this._uiManager.removeShouldRescale(this),this.#h()):e&&(this._uiManager.addShouldRescale(this),this.#f(e),t=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(e),t&&this.select()}#h(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#f(e=this.parent){if(!(this._drawId!==null&&this.parent===e)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,e.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#d(this.#e,e)}}#m([e,t,n,s]){const{parentDimensions:[o,l],rotation:c}=this;switch(c){case 90:return[t,1-e,n*(l/o),s*(o/l)];case 180:return[1-e,1-t,n,s];case 270:return[1-t,e,n*(l/o),s*(o/l)];default:return[e,t,n,s]}}#p(){const{x:e,y:t,width:n,height:s,parentDimensions:[o,l],rotation:c}=this;switch(c){case 90:return[1-t,e,n*(o/l),s*(l/o)];case 180:return[1-e,1-t,n,s];case 270:return[t,1-e,n*(o/l),s*(l/o)];default:return[e,t,n,s]}}#u(e){[this.x,this.y,this.width,this.height]=this.#m(e),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#g(){const{x:e,y:t,width:n,height:s,rotation:o,parentRotation:l,parentDimensions:[c,h]}=this;switch((o*4+l)/90){case 1:return[1-t-s,e,s,n];case 2:return[1-e-n,1-t-s,n,s];case 3:return[t,1-e-n,s,n];case 4:return[e,t-n*(c/h),s*(h/c),n*(c/h)];case 5:return[1-t,e,n*(c/h),s*(h/c)];case 6:return[1-e-s*(h/c),1-t,s*(h/c),n*(c/h)];case 7:return[t-n*(c/h),1-e-s*(h/c),n*(c/h),s*(h/c)];case 8:return[e-n,t-s,n,s];case 9:return[1-t,e-n,s,n];case 10:return[1-e,1-t,n,s];case 11:return[t-s,1-e,s,n];case 12:return[e-s*(h/c),t,s*(h/c),n*(c/h)];case 13:return[1-t-n*(c/h),e-s*(h/c),n*(c/h),s*(h/c)];case 14:return[1-e,1-t-n*(c/h),s*(h/c),n*(c/h)];case 15:return[t,1-e,n*(c/h),s*(h/c)];default:return[e,t,n,s]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,me._mergeSVGProperties({bbox:this.#g()},this.#e.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#u(this.#e.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let e,t;this._isCopy&&(e=this.x,t=this.y);const n=super.render();n.classList.add("draw");const s=document.createElement("div");return n.append(s),s.setAttribute("aria-hidden","true"),s.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(e,t),n}static createDrawerInstance(e,t,n,s,o){Ue("Not implemented")}static startDrawing(e,t,n,s){const{target:o,offsetX:l,offsetY:c,pointerId:h,pointerType:f}=s;if(me.#r&&me.#r!==f)return;const{viewport:{rotation:p}}=e,{width:g,height:y}=o.getBoundingClientRect(),w=me.#n=new AbortController,b=e.combinedSignal(w);if(me.#s||=h,me.#r??=f,window.addEventListener("pointerup",_=>{me.#s===_.pointerId?this._endDraw(_):me.#a?.delete(_.pointerId)},{signal:b}),window.addEventListener("pointercancel",_=>{me.#s===_.pointerId?this._currentParent.endDrawingSession():me.#a?.delete(_.pointerId)},{signal:b}),window.addEventListener("pointerdown",_=>{me.#r===_.pointerType&&((me.#a||=new Set).add(_.pointerId),me.#i.isCancellable()&&(me.#i.removeLastElement(),me.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:b}),window.addEventListener("contextmenu",qt,{signal:b}),o.addEventListener("pointermove",this._drawMove.bind(this),{signal:b}),o.addEventListener("touchmove",_=>{_.timeStamp===me.#c&&Ye(_)},{signal:b}),e.toggleDrawing(),t._editorUndoBar?.hide(),me.#i){e.drawLayer.updateProperties(this._currentDrawId,me.#i.startNew(l,c,g,y,p));return}t.updateUIForDefaultProperties(this),me.#i=this.createDrawerInstance(l,c,g,y,p),me.#o=this.getDefaultDrawingOptions(),this._currentParent=e,{id:this._currentDrawId}=e.drawLayer.draw(this._mergeSVGProperties(me.#o.toSVGProperties(),me.#i.defaultSVGProperties),!0,!1)}static _drawMove(e){if(me.#c=-1,!me.#i)return;const{offsetX:t,offsetY:n,pointerId:s}=e;if(me.#s===s){if(me.#a?.size>=1){this._endDraw(e);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,me.#i.add(t,n)),me.#c=e.timeStamp,Ye(e)}}static _cleanup(e){e&&(this._currentDrawId=-1,this._currentParent=null,me.#i=null,me.#o=null,me.#r=null,me.#c=NaN),me.#n&&(me.#n.abort(),me.#n=null,me.#s=NaN,me.#a=null)}static _endDraw(e){const t=this._currentParent;if(t){if(t.toggleDrawing(!0),this._cleanup(!1),e?.target===t.div&&t.drawLayer.updateProperties(this._currentDrawId,me.#i.end(e.offsetX,e.offsetY)),this.supportMultipleDrawings){const n=me.#i,s=this._currentDrawId,o=n.getLastElement();t.addCommands({cmd:()=>{t.drawLayer.updateProperties(s,n.setLastElement(o))},undo:()=>{t.drawLayer.updateProperties(s,n.removeLastElement())},mustExec:!1,type:Re.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(e){const t=this._currentParent;if(!t)return null;if(t.toggleDrawing(!0),t.cleanUndoStack(Re.DRAW_STEP),!me.#i.isEmpty()){const{pageDimensions:[n,s],scale:o}=t,l=t.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:me.#i.getOutlines(n*o,s*o,o,this._INNER_MARGIN),drawingOptions:me.#o,mustBeCommitted:!e});return this._cleanup(!0),l}return t.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(e){}static deserializeDraw(e,t,n,s,o,l){Ue("Not implemented")}static async deserialize(e,t,n){const{rawDims:{pageWidth:s,pageHeight:o,pageX:l,pageY:c}}=t.viewport,h=this.deserializeDraw(l,c,s,o,this._INNER_MARGIN,e),f=await super.deserialize(e,t,n);return f.createDrawingOptions(e),f.#l({drawOutlines:h}),f.#f(),f.onScaleChanging(),f.rotate(),f}serializeDraw(e){const[t,n]=this.pageTranslation,[s,o]=this.pageDimensions;return this.#e.serialize([t,n,s,o],e)}renderAnnotationElement(e){return e.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class XC{#e=new Float64Array(6);#t;#i;#n;#o;#s;#r="";#a=0;#c=new Oo;#l;#d;constructor(e,t,n,s,o,l){this.#l=n,this.#d=s,this.#n=o,this.#o=l,[e,t]=this.#h(e,t);const c=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#s=[e,t],this.#i=[{line:c,points:this.#s}],this.#e.set(c,0)}updateProperty(e,t){e==="stroke-width"&&(this.#o=t)}#h(e,t){return se._normalizePoint(e,t,this.#l,this.#d,this.#n)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#s.length<=10}add(e,t){[e,t]=this.#h(e,t);const[n,s,o,l]=this.#e.subarray(2,6),c=e-o,h=t-l;return Math.hypot(this.#l*c,this.#d*h)<=2?null:(this.#s.push(e,t),isNaN(n)?(this.#e.set([o,l,e,t],2),this.#t.push(NaN,NaN,NaN,NaN,e,t),{path:{d:this.toSVGPath()}}):(isNaN(this.#e[0])&&this.#t.splice(6,6),this.#e.set([n,s,o,l,e,t],0),this.#t.push(...se.createBezierPoints(n,s,o,l,e,t)),{path:{d:this.toSVGPath()}}))}end(e,t){const n=this.add(e,t);return n||(this.#s.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(e,t,n,s,o){this.#l=n,this.#d=s,this.#n=o,[e,t]=this.#h(e,t);const l=this.#t=[NaN,NaN,NaN,NaN,e,t];this.#s=[e,t];const c=this.#i.at(-1);return c&&(c.line=new Float32Array(c.line),c.points=new Float32Array(c.points)),this.#i.push({line:l,points:this.#s}),this.#e.set(l,0),this.#a=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(e){return this.#i?(this.#i.push(e),this.#t=e.line,this.#s=e.points,this.#a=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(e)}removeLastElement(){if(!this.#i)return this.#c.removeLastElement();this.#i.pop(),this.#r="";for(let e=0,t=this.#i.length;e<t;e++){const{line:n,points:s}=this.#i[e];this.#t=n,this.#s=s,this.#a=0,this.toSVGPath()}return{path:{d:this.#r}}}toSVGPath(){const e=se.svgRound(this.#t[4]),t=se.svgRound(this.#t[5]);if(this.#s.length===2)return this.#r=`${this.#r} M ${e} ${t} Z`,this.#r;if(this.#s.length<=6){const s=this.#r.lastIndexOf("M");this.#r=`${this.#r.slice(0,s)} M ${e} ${t}`,this.#a=6}if(this.#s.length===4){const s=se.svgRound(this.#t[10]),o=se.svgRound(this.#t[11]);return this.#r=`${this.#r} L ${s} ${o}`,this.#a=12,this.#r}const n=[];this.#a===0&&(n.push(`M ${e} ${t}`),this.#a=6);for(let s=this.#a,o=this.#t.length;s<o;s+=6){const[l,c,h,f,p,g]=this.#t.slice(s,s+6).map(se.svgRound);n.push(`C${l} ${c} ${h} ${f} ${p} ${g}`)}return this.#r+=n.join(" "),this.#a=this.#t.length,this.#r}getOutlines(e,t,n,s){const o=this.#i.at(-1);return o.line=new Float32Array(o.line),o.points=new Float32Array(o.points),this.#c.build(this.#i,e,t,n,this.#n,this.#o,s),this.#e=null,this.#t=null,this.#i=null,this.#r=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Oo extends se{#e;#t=0;#i;#n;#o;#s;#r;#a;#c;build(e,t,n,s,o,l,c){this.#o=t,this.#s=n,this.#r=s,this.#a=o,this.#c=l,this.#i=c??0,this.#n=e,this.#h()}get thickness(){return this.#c}setLastElement(e){return this.#n.push(e),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const e=[];for(const{line:t}of this.#n){if(e.push(`M${se.svgRound(t[4])} ${se.svgRound(t[5])}`),t.length===6){e.push("Z");continue}if(t.length===12&&isNaN(t[6])){e.push(`L${se.svgRound(t[10])} ${se.svgRound(t[11])}`);continue}for(let n=6,s=t.length;n<s;n+=6){const[o,l,c,h,f,p]=t.subarray(n,n+6).map(se.svgRound);e.push(`C${o} ${l} ${c} ${h} ${f} ${p}`)}}return e.join("")}serialize([e,t,n,s],o){const l=[],c=[],[h,f,p,g]=this.#d();let y,w,b,_,A,E,C,T,R;switch(this.#a){case 0:R=se._rescale,y=e,w=t+s,b=n,_=-s,A=e+h*n,E=t+(1-f-g)*s,C=e+(h+p)*n,T=t+(1-f)*s;break;case 90:R=se._rescaleAndSwap,y=e,w=t,b=n,_=s,A=e+f*n,E=t+h*s,C=e+(f+g)*n,T=t+(h+p)*s;break;case 180:R=se._rescale,y=e+n,w=t,b=-n,_=s,A=e+(1-h-p)*n,E=t+f*s,C=e+(1-h)*n,T=t+(f+g)*s;break;case 270:R=se._rescaleAndSwap,y=e+n,w=t+s,b=-n,_=-s,A=e+(1-f-g)*n,E=t+(1-h-p)*s,C=e+(1-f)*n,T=t+(1-h)*s;break}for(const{line:L,points:k}of this.#n)l.push(R(L,y,w,b,_,o?new Array(L.length):null)),c.push(R(k,y,w,b,_,o?new Array(k.length):null));return{lines:l,points:c,rect:[A,E,C,T]}}static deserialize(e,t,n,s,o,{paths:{lines:l,points:c},rotation:h,thickness:f}){const p=[];let g,y,w,b,_;switch(h){case 0:_=se._rescale,g=-e/n,y=t/s+1,w=1/n,b=-1/s;break;case 90:_=se._rescaleAndSwap,g=-t/s,y=-e/n,w=1/s,b=1/n;break;case 180:_=se._rescale,g=e/n+1,y=-t/s,w=-1/n,b=1/s;break;case 270:_=se._rescaleAndSwap,g=t/s+1,y=e/n+1,w=-1/s,b=-1/n;break}if(!l){l=[];for(const E of c){const C=E.length;if(C===2){l.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1]]));continue}if(C===4){l.push(new Float32Array([NaN,NaN,NaN,NaN,E[0],E[1],NaN,NaN,NaN,NaN,E[2],E[3]]));continue}const T=new Float32Array(3*(C-2));l.push(T);let[R,L,k,N]=E.subarray(0,4);T.set([NaN,NaN,NaN,NaN,R,L],0);for(let U=4;U<C;U+=2){const z=E[U],V=E[U+1];T.set(se.createBezierPoints(R,L,k,N,z,V),(U-2)*3),[R,L,k,N]=[k,N,z,V]}}}for(let E=0,C=l.length;E<C;E++)p.push({line:_(l[E].map(T=>T??NaN),g,y,w,b),points:_(c[E].map(T=>T??NaN),g,y,w,b)});const A=new this.prototype.constructor;return A.build(p,n,s,1,h,f,o),A}#l(e=this.#c){const t=this.#i+e/2*this.#r;return this.#a%180===0?[t/this.#o,t/this.#s]:[t/this.#s,t/this.#o]}#d(){const[e,t,n,s]=this.#e,[o,l]=this.#l(0);return[e+o,t+l,n-2*o,s-2*l]}#h(){const e=this.#e=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:s}of this.#n){if(s.length<=12){for(let c=4,h=s.length;c<h;c+=6)re.pointBoundingBox(s[c],s[c+1],e);continue}let o=s[4],l=s[5];for(let c=6,h=s.length;c<h;c+=6){const[f,p,g,y,w,b]=s.subarray(c,c+6);re.bezierBoundingBox(o,l,f,p,g,y,w,b,e),o=w,l=b}}const[t,n]=this.#l();e[0]=At(e[0]-t,0,1),e[1]=At(e[1]-n,0,1),e[2]=At(e[2]+t,0,1),e[3]=At(e[3]+n,0,1),e[2]-=e[0],e[3]-=e[1]}get box(){return this.#e}updateProperty(e,t){return e==="stroke-width"?this.#f(t):null}#f(e){const[t,n]=this.#l();this.#c=e;const[s,o]=this.#l(),[l,c]=[s-t,o-n],h=this.#e;return h[0]-=l,h[1]-=c,h[2]+=2*l,h[3]+=2*c,h}updateParentDimensions([e,t],n){const[s,o]=this.#l();this.#o=e,this.#s=t,this.#r=n;const[l,c]=this.#l(),h=l-s,f=c-o,p=this.#e;return p[0]-=h,p[1]-=f,p[2]+=2*h,p[3]+=2*f,p}updateRotation(e){return this.#t=e,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#e.map(se.svgRound).join(" ")}get defaultProperties(){const[e,t]=this.#e;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${se.svgRound(e)} ${se.svgRound(t)}`}}}get rotationTransform(){const[,,e,t]=this.#e;let n=0,s=0,o=0,l=0,c=0,h=0;switch(this.#t){case 90:s=t/e,o=-e/t,c=e;break;case 180:n=-1,l=-1,c=e,h=t;break;case 270:s=-t/e,o=e/t,h=t;break;default:return""}return`matrix(${n} ${s} ${o} ${l} ${se.svgRound(c)} ${se.svgRound(h)})`}getPathResizingSVGProperties([e,t,n,s]){const[o,l]=this.#l(),[c,h,f,p]=this.#e;if(Math.abs(f-o)<=se.PRECISION||Math.abs(p-l)<=se.PRECISION){const _=e+n/2-(c+f/2),A=t+s/2-(h+p/2);return{path:{"transform-origin":`${se.svgRound(e)} ${se.svgRound(t)}`,transform:`${this.rotationTransform} translate(${_} ${A})`}}}const g=(n-2*o)/(f-2*o),y=(s-2*l)/(p-2*l),w=f/n,b=p/s;return{path:{"transform-origin":`${se.svgRound(c)} ${se.svgRound(h)}`,transform:`${this.rotationTransform} scale(${w} ${b}) translate(${se.svgRound(o)} ${se.svgRound(l)}) scale(${g} ${y}) translate(${se.svgRound(-o)} ${se.svgRound(-l)})`}}}getPathResizedSVGProperties([e,t,n,s]){const[o,l]=this.#l(),c=this.#e,[h,f,p,g]=c;if(c[0]=e,c[1]=t,c[2]=n,c[3]=s,Math.abs(p-o)<=se.PRECISION||Math.abs(g-l)<=se.PRECISION){const A=e+n/2-(h+p/2),E=t+s/2-(f+g/2);for(const{line:C,points:T}of this.#n)se._translate(C,A,E,C),se._translate(T,A,E,T);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${se.svgRound(e)} ${se.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const y=(n-2*o)/(p-2*o),w=(s-2*l)/(g-2*l),b=-y*(h+o)+e+o,_=-w*(f+l)+t+l;if(y!==1||w!==1||b!==0||_!==0)for(const{line:A,points:E}of this.#n)se._rescale(A,b,_,y,w,A),se._rescale(E,b,_,y,w,E);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${se.svgRound(e)} ${se.svgRound(t)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([e,t],n){const[s,o]=n,l=this.#e,c=e-l[0],h=t-l[1];if(this.#o===s&&this.#s===o)for(const{line:f,points:p}of this.#n)se._translate(f,c,h,f),se._translate(p,c,h,p);else{const f=this.#o/s,p=this.#s/o;this.#o=s,this.#s=o;for(const{line:g,points:y}of this.#n)se._rescale(g,c,h,f,p,g),se._rescale(y,c,h,f,p,y);l[2]*=f,l[3]*=p}return l[0]=e,l[1]=t,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${se.svgRound(e)} ${se.svgRound(t)}`}}}get defaultSVGProperties(){const e=this.#e;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${se.svgRound(e[0])} ${se.svgRound(e[1])}`,transform:this.rotationTransform||null},bbox:e}}}class Hl extends Av{constructor(e){super(),this._viewParameters=e,super.updateProperties({fill:"none",stroke:he._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(e,t){e==="stroke-width"&&(t??=this["stroke-width"],t*=this._viewParameters.realScale),super.updateSVGProperty(e,t)}clone(){const e=new Hl(this._viewParameters);return e.updateAll(this),e}}class fd extends me{static _type="ink";static _editorType=Se.INK;static _defaultDrawingOptions=null;constructor(e){super({...e,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(e,t){he.initialize(e,t),this._defaultDrawingOptions=new Hl(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!0}static get typesMap(){return Ee(this,"typesMap",new Map([[Re.INK_THICKNESS,"stroke-width"],[Re.INK_COLOR,"stroke"],[Re.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(e,t,n,s,o){return new XC(e,t,n,s,o,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(e,t,n,s,o,l){return Oo.deserialize(e,t,n,s,o,l)}static async deserialize(e,t,n){let s=null;if(e instanceof hd){const{data:{inkLists:l,rect:c,rotation:h,id:f,color:p,opacity:g,borderStyle:{rawWidth:y},popupRef:w,richText:b,contentsObj:_,creationDate:A,modificationDate:E},parent:{page:{pageNumber:C}}}=e;s=e={annotationType:Se.INK,color:Array.from(p),thickness:y,opacity:g,paths:{points:l},boxes:null,pageIndex:C-1,rect:c.slice(0),rotation:h,annotationElementId:f,id:f,deleted:!1,popupRef:w,richText:b,comment:_?.str||null,creationDate:A,modificationDate:E}}const o=await super.deserialize(e,t,n);return o._initialData=s,e.comment&&o.setCommentData(e),o}get toolbarButtons(){return this._colorPicker||=new wo(this),[["colorPicker",this._colorPicker]]}get colorType(){return Re.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:e,_drawingOptions:t,parent:n}=this;t.updateSVGProperty("stroke-width"),n.drawLayer.updateProperties(e,t.toSVGProperties())}static onScaleChangingWhenDrawing(){const e=this._currentParent;e&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),e.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:e,thickness:t,opacity:n}){this._drawingOptions=fd.getDefaultDrawingOptions({stroke:re.makeHexColor(...e),"stroke-width":t,"stroke-opacity":n})}serialize(e=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{stroke:s,"stroke-opacity":o,"stroke-width":l}}=this,c=Object.assign(super.serialize(e),{color:he._colorManager.convert(s),opacity:o,thickness:l,paths:{lines:t,points:n}});return this.addComment(c),e?(c.isCopy=!0,c):this.annotationElementId&&!this.#e(c)?null:(c.id=this.annotationElementId,c)}#e(e){const{color:t,thickness:n,opacity:s,pageIndex:o}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||e.color.some((l,c)=>l!==t[c])||e.thickness!==n||e.opacity!==s||e.pageIndex!==o}renderAnnotationElement(e){if(this.deleted)return e.hide(),null;const{points:t,rect:n}=this.serializeDraw(!1);return e.updateEdited({rect:n,thickness:this._drawingOptions["stroke-width"],points:t,popup:this.comment}),null}}class Eh extends Oo{toSVGPath(){let e=super.toSVGPath();return e.endsWith("Z")||(e+="Z"),e}}const al=8,no=3;class ns{static#e={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#t(e,t,n,s){return n-=e,s-=t,n===0?s>0?0:4:n===1?s+6:2-s}static#i=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(e,t,n,s,o,l,c){const h=this.#t(n,s,o,l);for(let f=0;f<8;f++){const p=(-f+h-c+16)%8,g=this.#i[2*p],y=this.#i[2*p+1];if(e[(n+g)*t+(s+y)]!==0)return p}return-1}static#o(e,t,n,s,o,l,c){const h=this.#t(n,s,o,l);for(let f=0;f<8;f++){const p=(f+h+c+16)%8,g=this.#i[2*p],y=this.#i[2*p+1];if(e[(n+g)*t+(s+y)]!==0)return p}return-1}static#s(e,t,n,s){const o=e.length,l=new Int32Array(o);for(let p=0;p<o;p++)l[p]=e[p]<=s?1:0;for(let p=1;p<n-1;p++)l[p*t]=l[p*t+t-1]=0;for(let p=0;p<t;p++)l[p]=l[t*n-1-p]=0;let c=1,h;const f=[];for(let p=1;p<n-1;p++){h=1;for(let g=1;g<t-1;g++){const y=p*t+g,w=l[y];if(w===0)continue;let b=p,_=g;if(w===1&&l[y-1]===0)c+=1,_-=1;else if(w>=1&&l[y+1]===0)c+=1,_+=1,w>1&&(h=w);else{w!==1&&(h=Math.abs(w));continue}const A=[g,p],E=_===g+1,C={isHole:E,points:A,id:c,parent:0};f.push(C);let T;for(const q of f)if(q.id===h){T=q;break}T?T.isHole?C.parent=E?T.parent:h:C.parent=E?h:T.parent:C.parent=E?h:0;const R=this.#n(l,t,p,g,b,_,0);if(R===-1){l[y]=-c,l[y]!==1&&(h=Math.abs(l[y]));continue}let L=this.#i[2*R],k=this.#i[2*R+1];const N=p+L,U=g+k;b=N,_=U;let z=p,V=g;for(;;){const q=this.#o(l,t,z,V,b,_,1);L=this.#i[2*q],k=this.#i[2*q+1];const ue=z+L,Q=V+k;A.push(Q,ue);const le=z*t+V;if(l[le+1]===0?l[le]=-c:l[le]===1&&(l[le]=c),ue===p&&Q===g&&z===N&&V===U){l[y]!==1&&(h=Math.abs(l[y]));break}else b=z,_=V,z=ue,V=Q}}}return f}static#r(e,t,n,s){if(n-t<=4){for(let N=t;N<n-2;N+=2)s.push(e[N],e[N+1]);return}const o=e[t],l=e[t+1],c=e[n-4]-o,h=e[n-3]-l,f=Math.hypot(c,h),p=c/f,g=h/f,y=p*l-g*o,w=h/c,b=1/f,_=Math.atan(w),A=Math.cos(_),E=Math.sin(_),C=b*(Math.abs(A)+Math.abs(E)),T=b*(1-C+C**2),R=Math.max(Math.atan(Math.abs(E+A)*T),Math.atan(Math.abs(E-A)*T));let L=0,k=t;for(let N=t+2;N<n-2;N+=2){const U=Math.abs(y-p*e[N+1]+g*e[N]);U>L&&(k=N,L=U)}L>(f*R)**2?(this.#r(e,t,k+2,s),this.#r(e,k,n,s)):s.push(o,l)}static#a(e){const t=[],n=e.length;return this.#r(e,0,n,t),t.push(e[n-2],e[n-1]),t.length<=4?null:t}static#c(e,t,n,s,o,l){const c=new Float32Array(l**2),h=-2*s**2,f=l>>1;for(let _=0;_<l;_++){const A=(_-f)**2;for(let E=0;E<l;E++)c[_*l+E]=Math.exp((A+(E-f)**2)/h)}const p=new Float32Array(256),g=-2*o**2;for(let _=0;_<256;_++)p[_]=Math.exp(_**2/g);const y=e.length,w=new Uint8Array(y),b=new Uint32Array(256);for(let _=0;_<n;_++)for(let A=0;A<t;A++){const E=_*t+A,C=e[E];let T=0,R=0;for(let k=0;k<l;k++){const N=_+k-f;if(!(N<0||N>=n))for(let U=0;U<l;U++){const z=A+U-f;if(z<0||z>=t)continue;const V=e[N*t+z],q=c[k*l+U]*p[Math.abs(V-C)];T+=V*q,R+=q}}const L=w[E]=Math.round(T/R);b[L]++}return[w,b]}static#l(e){const t=new Uint32Array(256);for(const n of e)t[n]++;return t}static#d(e){const t=e.length,n=new Uint8ClampedArray(t>>2);let s=-1/0,o=1/0;for(let c=0,h=n.length;c<h;c++){const f=n[c]=e[c<<2];s=Math.max(s,f),o=Math.min(o,f)}const l=255/(s-o);for(let c=0,h=n.length;c<h;c++)n[c]=(n[c]-o)*l;return n}static#h(e){let t,n=-1/0,s=-1/0;const o=e.findIndex(h=>h!==0);let l=o,c=o;for(t=o;t<256;t++){const h=e[t];h>n&&(t-l>s&&(s=t-l,c=t-1),n=h,l=t)}for(t=c-1;t>=0&&!(e[t]>e[t+1]);t--);return t}static#f(e){const t=e,{width:n,height:s}=e,{maxDim:o}=this.#e;let l=n,c=s;if(n>o||s>o){let y=n,w=s,b=Math.log2(Math.max(n,s)/o);const _=Math.floor(b);b=b===_?_-1:_;for(let E=0;E<b;E++){l=Math.ceil(y/2),c=Math.ceil(w/2);const C=new OffscreenCanvas(l,c);C.getContext("2d").drawImage(e,0,0,y,w,0,0,l,c),y=l,w=c,e!==t&&e.close(),e=C.transferToImageBitmap()}const A=Math.min(o/l,o/c);l=Math.round(l*A),c=Math.round(c*A)}const f=new OffscreenCanvas(l,c).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,l,c),f.filter="grayscale(1)",f.drawImage(e,0,0,e.width,e.height,0,0,l,c);const p=f.getImageData(0,0,l,c).data;return[this.#d(p),l,c]}static extractContoursFromText(e,{fontFamily:t,fontStyle:n,fontWeight:s},o,l,c,h){let f=new OffscreenCanvas(1,1),p=f.getContext("2d",{alpha:!1});const g=200,y=p.font=`${n} ${s} ${g}px ${t}`,{actualBoundingBoxLeft:w,actualBoundingBoxRight:b,actualBoundingBoxAscent:_,actualBoundingBoxDescent:A,fontBoundingBoxAscent:E,fontBoundingBoxDescent:C,width:T}=p.measureText(e),R=1.5,L=Math.ceil(Math.max(Math.abs(w)+Math.abs(b)||0,T)*R),k=Math.ceil(Math.max(Math.abs(_)+Math.abs(A)||g,Math.abs(E)+Math.abs(C)||g)*R);f=new OffscreenCanvas(L,k),p=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=y,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,L,k),p.fillStyle="black",p.fillText(e,L*(R-1)/2,k*(3-R)/2);const N=this.#d(p.getImageData(0,0,L,k).data),U=this.#l(N),z=this.#h(U),V=this.#s(N,L,k,z);return this.processDrawnLines({lines:{curves:V,width:L,height:k},pageWidth:o,pageHeight:l,rotation:c,innerMargin:h,mustSmooth:!0,areContours:!0})}static process(e,t,n,s,o){const[l,c,h]=this.#f(e),[f,p]=this.#c(l,c,h,Math.hypot(c,h)*this.#e.sigmaSFactor,this.#e.sigmaR,this.#e.kernelSize),g=this.#h(p),y=this.#s(f,c,h,g);return this.processDrawnLines({lines:{curves:y,width:c,height:h},pageWidth:t,pageHeight:n,rotation:s,innerMargin:o,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:s,innerMargin:o,mustSmooth:l,areContours:c}){s%180!==0&&([t,n]=[n,t]);const{curves:h,width:f,height:p}=e,g=e.thickness??0,y=[],w=Math.min(t/f,n/p),b=w/t,_=w/n,A=[];for(const{points:C}of h){const T=l?this.#a(C):C;if(!T)continue;A.push(T);const R=T.length,L=new Float32Array(R),k=new Float32Array(3*(R===2?2:R-2));if(y.push({line:k,points:L}),R===2){L[0]=T[0]*b,L[1]=T[1]*_,k.set([NaN,NaN,NaN,NaN,L[0],L[1]],0);continue}let[N,U,z,V]=T;N*=b,U*=_,z*=b,V*=_,L.set([N,U,z,V],0),k.set([NaN,NaN,NaN,NaN,N,U],0);for(let q=4;q<R;q+=2){const ue=L[q]=T[q]*b,Q=L[q+1]=T[q+1]*_;k.set(se.createBezierPoints(N,U,z,V,ue,Q),(q-2)*3),[N,U,z,V]=[z,V,ue,Q]}}if(y.length===0)return null;const E=c?new Eh:new Oo;return E.build(y,t,n,1,s,c?0:g,o),{outline:E,newCurves:A,areContours:c,thickness:g,width:f,height:p}}static async compressSignature({outlines:e,areContours:t,thickness:n,width:s,height:o}){let l=1/0,c=-1/0,h=0;for(const T of e){h+=T.length;for(let R=2,L=T.length;R<L;R++){const k=T[R]-T[R-2];l=Math.min(l,k),c=Math.max(c,k)}}let f;l>=-128&&c<=127?f=Int8Array:l>=-32768&&c<=32767?f=Int16Array:f=Int32Array;const p=e.length,g=al+no*p,y=new Uint32Array(g);let w=0;y[w++]=g*Uint32Array.BYTES_PER_ELEMENT+(h-2*p)*f.BYTES_PER_ELEMENT,y[w++]=0,y[w++]=s,y[w++]=o,y[w++]=t?0:1,y[w++]=Math.max(0,Math.floor(n??0)),y[w++]=p,y[w++]=f.BYTES_PER_ELEMENT;for(const T of e)y[w++]=T.length-2,y[w++]=T[0],y[w++]=T[1];const b=new CompressionStream("deflate-raw"),_=b.writable.getWriter();await _.ready,_.write(y);const A=f.prototype.constructor;for(const T of e){const R=new A(T.length-2);for(let L=2,k=T.length;L<k;L++)R[L-2]=T[L]-T[L-2];_.write(R)}_.close();const E=await new Response(b.readable).arrayBuffer(),C=new Uint8Array(E);return $y(C)}static async decompressSignature(e){try{const t=w1(e),{readable:n,writable:s}=new DecompressionStream("deflate-raw"),o=s.getWriter();await o.ready,o.write(t).then(async()=>{await o.ready,await o.close()}).catch(()=>{});let l=null,c=0;for await(const T of n)l||=new Uint8Array(new Uint32Array(T.buffer,0,4)[0]),l.set(T,c),c+=T.length;const h=new Uint32Array(l.buffer,0,l.length>>2),f=h[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const p=h[2],g=h[3],y=h[4]===0,w=h[5],b=h[6],_=h[7],A=[],E=(al+no*b)*Uint32Array.BYTES_PER_ELEMENT;let C;switch(_){case Int8Array.BYTES_PER_ELEMENT:C=new Int8Array(l.buffer,E);break;case Int16Array.BYTES_PER_ELEMENT:C=new Int16Array(l.buffer,E);break;case Int32Array.BYTES_PER_ELEMENT:C=new Int32Array(l.buffer,E);break}c=0;for(let T=0;T<b;T++){const R=h[no*T+al],L=new Float32Array(R+2);A.push(L);for(let k=0;k<no-1;k++)L[k]=h[no*T+al+k+1];for(let k=0;k<R;k++)L[k+2]=L[k]+C[c++]}return{areContours:y,thickness:w,outlines:A,width:p,height:g}}catch(t){return Ae(`decompressSignature: ${t}`),null}}}class pd extends Av{constructor(){super(),super.updateProperties({fill:he._defaultLineColor,"stroke-width":0})}clone(){const e=new pd;return e.updateAll(this),e}}class gd extends Hl{constructor(e){super(e),super.updateProperties({stroke:he._defaultLineColor,"stroke-width":1})}clone(){const e=new gd(this._viewParameters);return e.updateAll(this),e}}class Mn extends me{#e=!1;#t=null;#i=null;#n=null;static _type="signature";static _editorType=Se.SIGNATURE;static _defaultDrawingOptions=null;constructor(e){super({...e,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#i=e.signatureData||null,this.#t=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(e,t){he.initialize(e,t),this._defaultDrawingOptions=new pd,this._defaultDrawnSignatureOptions=new gd(t.viewParameters)}static getDefaultDrawingOptions(e){const t=this._defaultDrawingOptions.clone();return t.updateProperties(e),t}static get supportMultipleDrawings(){return!1}static get typesMap(){return Ee(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#t}}static computeTelemetryFinalData(e){const t=e.get("hasDescription");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let e,t;const{_isCopy:n}=this;if(n&&(this._isCopy=!1,e=this.x,t=this.y),super.render(),this._drawId===null)if(this.#i){const{lines:s,mustSmooth:o,areContours:l,description:c,uuid:h,heightInPage:f}=this.#i,{rawDims:{pageWidth:p,pageHeight:g},rotation:y}=this.parent.viewport,w=ns.processDrawnLines({lines:s,pageWidth:p,pageHeight:g,rotation:y,innerMargin:Mn._INNER_MARGIN,mustSmooth:o,areContours:l});this.addSignature(w,f,c,h)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#t||""}));return n&&(this._isCopy=!0,this._moveAfterPaste(e,t)),this.div}setUuid(e){this.#n=e,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#t}set description(e){this.#t=e,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:e})),super.addEditToolbar().then(t=>{t?.updateEditSignatureButton(e)}))}getSignaturePreview(){const{newCurves:e,areContours:t,thickness:n,width:s,height:o}=this.#i,l=Math.max(s,o),c=ns.processDrawnLines({lines:{curves:e.map(h=>({points:h})),thickness:n,width:s,height:o},pageWidth:l,pageHeight:l,rotation:0,innerMargin:0,mustSmooth:!1,areContours:t});return{areContours:t,outline:c.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(e,t,n,s){const{x:o,y:l}=this,{outline:c}=this.#i=e;this.#e=c instanceof Eh,this.description=n;let h;this.#e?h=Mn.getDefaultDrawingOptions():(h=Mn._defaultDrawnSignatureOptions.clone(),h.updateProperties({"stroke-width":c.thickness})),this._addOutlines({drawOutlines:c,drawingOptions:h});const[,f]=this.pageDimensions;let p=t/f;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(),this.x=o,this.y=l,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(s),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!s,hasDescription:!!n}}),this.div.hidden=!1}getFromImage(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:s}=this.parent.viewport;return ns.process(e,t,n,s,Mn._INNER_MARGIN)}getFromText(e,t){const{rawDims:{pageWidth:n,pageHeight:s},rotation:o}=this.parent.viewport;return ns.extractContoursFromText(e,t,n,s,o,Mn._INNER_MARGIN)}getDrawnSignature(e){const{rawDims:{pageWidth:t,pageHeight:n},rotation:s}=this.parent.viewport;return ns.processDrawnLines({lines:e,pageWidth:t,pageHeight:n,rotation:s,innerMargin:Mn._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:e,thickness:t}){e?this._drawingOptions=Mn.getDefaultDrawingOptions():(this._drawingOptions=Mn._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":t}))}serialize(e=!1){if(this.isEmpty())return null;const{lines:t,points:n}=this.serializeDraw(e),{_drawingOptions:{"stroke-width":s}}=this,o=Object.assign(super.serialize(e),{isSignature:!0,areContours:this.#e,color:[0,0,0],thickness:this.#e?0:s});return this.addComment(o),e?(o.paths={lines:t,points:n},o.uuid=this.#n,o.isCopy=!0):o.lines=t,this.#t&&(o.accessibilityData={type:"Figure",alt:this.#t}),o}static deserializeDraw(e,t,n,s,o,l){return l.areContours?Eh.deserialize(e,t,n,s,o,l):Oo.deserialize(e,t,n,s,o,l)}static async deserialize(e,t,n){const s=await super.deserialize(e,t,n);return s.#e=e.areContours,s.description=e.accessibilityData?.alt||"",s.#n=e.uuid,s}}class KC extends he{#e=null;#t=null;#i=null;#n=null;#o=null;#s="";#r=null;#a=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=Se.STAMP;constructor(e){super({...e,name:"stampEditor"}),this.#n=e.bitmapUrl,this.#o=e.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(e,t){he.initialize(e,t)}static isHandlingMimeForPasting(e){return Tl.includes(e)}static paste(e,t){t.pasteEditor({mode:Se.STAMP},{bitmapFile:e.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(e){const t=e.get("hasAltText");return{hasAltText:t.get(!0)??0,hasNoAltText:t.get(!1)??0}}#h(e,t=!1){if(!e){this.remove();return}this.#e=e.bitmap,t||(this.#t=e.id,this.#l=e.isSvg),e.file&&(this.#s=e.file.name),this.#p()}#f(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#r){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#e){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(e=null,t=!0){if(this.hasAltTextData())return null;const{mlManager:n}=this._uiManager;if(!n)throw new Error("No ML.");if(!await n.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:s,width:o,height:l}=e||this.copyCanvas(null,null,!0).imageData,c=await n.guess({name:"altText",request:{data:s,width:o,height:l,channels:s.length/(o*l)}});if(!c)throw new Error("No response from the AI service.");if(c.error)throw new Error("Error from the AI service.");if(c.cancel)return null;if(!c.output)throw new Error("No valid response from the AI service.");const h=c.output;return await this.setGuessedAltText(h),t&&!this.hasAltTextData()&&(this.altTextData={alt:h,decorative:!1}),h}#m(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(n=>this.#h(n,!0)).finally(()=>this.#f());return}if(this.#n){const n=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(n).then(s=>this.#h(s)).finally(()=>this.#f());return}if(this.#o){const n=this.#o;this.#o=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(n).then(s=>this.#h(s)).finally(()=>this.#f());return}const e=document.createElement("input");e.type="file",e.accept=Tl.join(",");const t=this._uiManager._signal;this.#i=new Promise(n=>{e.addEventListener("change",async()=>{if(!e.files||e.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const s=await this._uiManager.imageManager.getFromFile(e.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(s)}n()},{signal:t}),e.addEventListener("cancel",()=>{this.remove(),n()},{signal:t})}).finally(()=>this.#f()),e.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#r?.remove(),this.#r=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#m();return}super.rebuild(),this.div!==null&&(this.#t&&this.#r===null&&this.#m(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(e){this._isDraggable=!0,e&&this.div.focus()}isEmpty(){return!(this.#i||this.#e||this.#n||this.#o||this.#t||this.#a)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let e,t;return this._isCopy&&(e=this.x,t=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#a||(this.#e?this.#p():this.#m()),this._isCopy&&this._moveAfterPaste(e,t),this._uiManager.addShouldRescale(this),this.div}setCanvas(e,t){const{id:n,bitmap:s}=this._uiManager.imageManager.getFromCanvas(e,t);t.remove(),n&&this._uiManager.imageManager.isValidId(n)&&(this.#t=n,s&&(this.#e=s),this.#a=!1,this.#p())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const e=200;this.#c=setTimeout(()=>{this.#c=null,this.#g()},e)}#p(){const{div:e}=this;let{width:t,height:n}=this.#e;const[s,o]=this.pageDimensions,l=.75;if(this.width)t=this.width*s,n=this.height*o;else if(t>l*s||n>l*o){const h=Math.min(l*s/t,l*o/n);t*=h,n*=h}this._uiManager.enableWaiting(!1);const c=this.#r=document.createElement("canvas");c.setAttribute("role","img"),this.addContainer(c),this.width=t/s,this.height=n/o,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(e.hidden=!1),this.#g(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#s&&this.div.setAttribute("aria-description",this.#s),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(e,t,n=!1){e||(e=224);const{width:s,height:o}=this.#e,l=new An;let c=this.#e,h=s,f=o,p=null;if(t){if(s>t||o>t){const k=Math.min(t/s,t/o);h=Math.floor(s*k),f=Math.floor(o*k)}p=document.createElement("canvas");const y=p.width=Math.ceil(h*l.sx),w=p.height=Math.ceil(f*l.sy);this.#l||(c=this.#u(y,w));const b=p.getContext("2d");b.filter=this._uiManager.hcmFilter;let _="white",A="#cfcfd8";this._uiManager.hcmFilter!=="none"?A="black":S1.isDarkMode&&(_="#8f8f9d",A="#42414d");const E=15,C=E*l.sx,T=E*l.sy,R=new OffscreenCanvas(C*2,T*2),L=R.getContext("2d");L.fillStyle=_,L.fillRect(0,0,C*2,T*2),L.fillStyle=A,L.fillRect(0,0,C,T),L.fillRect(C,T,C,T),b.fillStyle=b.createPattern(R,"repeat"),b.fillRect(0,0,y,w),b.drawImage(c,0,0,c.width,c.height,0,0,y,w)}let g=null;if(n){let y,w;if(l.symmetric&&c.width<e&&c.height<e)y=c.width,w=c.height;else if(c=this.#e,s>e||o>e){const A=Math.min(e/s,e/o);y=Math.floor(s*A),w=Math.floor(o*A),this.#l||(c=this.#u(y,w))}const _=new OffscreenCanvas(y,w).getContext("2d",{willReadFrequently:!0});_.drawImage(c,0,0,c.width,c.height,0,0,y,w),g={width:y,height:w,data:_.getImageData(0,0,y,w).data}}return{canvas:p,width:h,height:f,imageData:g}}#u(e,t){const{width:n,height:s}=this.#e;let o=n,l=s,c=this.#e;for(;o>2*e||l>2*t;){const h=o,f=l;o>2*e&&(o=o>=16384?Math.floor(o/2)-1:Math.ceil(o/2)),l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2));const p=new OffscreenCanvas(o,l);p.getContext("2d").drawImage(c,0,0,h,f,0,0,o,l),c=p.transferToImageBitmap()}return c}#g(){const[e,t]=this.parentDimensions,{width:n,height:s}=this,o=new An,l=Math.ceil(n*e*o.sx),c=Math.ceil(s*t*o.sy),h=this.#r;if(!h||h.width===l&&h.height===c)return;h.width=l,h.height=c;const f=this.#l?this.#e:this.#u(l,c),p=h.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(f,0,0,f.width,f.height,0,0,l,c)}#y(e){if(e){if(this.#l){const s=this._uiManager.imageManager.getSvgUrl(this.#t);if(s)return s}const t=document.createElement("canvas");return{width:t.width,height:t.height}=this.#e,t.getContext("2d").drawImage(this.#e,0,0),t.toDataURL()}if(this.#l){const[t,n]=this.pageDimensions,s=Math.round(this.width*t*us.PDF_TO_CSS_UNITS),o=Math.round(this.height*n*us.PDF_TO_CSS_UNITS),l=new OffscreenCanvas(s,o);return l.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,s,o),l.transferToImageBitmap()}return structuredClone(this.#e)}static async deserialize(e,t,n){let s=null,o=!1;if(e instanceof _v){const{data:{rect:_,rotation:A,id:E,structParent:C,popupRef:T,richText:R,contentsObj:L,creationDate:k,modificationDate:N},container:U,parent:{page:{pageNumber:z}},canvas:V}=e;let q,ue;V?(delete e.canvas,{id:q,bitmap:ue}=n.imageManager.getFromCanvas(U.id,V),V.remove()):(o=!0,e._hasNoCanvas=!0);const Q=(await t._structTree.getAriaAttributes(`${Jh}${E}`))?.get("aria-label")||"";s=e={annotationType:Se.STAMP,bitmapId:q,bitmap:ue,pageIndex:z-1,rect:_.slice(0),rotation:A,annotationElementId:E,id:E,deleted:!1,accessibilityData:{decorative:!1,altText:Q},isSvg:!1,structParent:C,popupRef:T,richText:R,comment:L?.str||null,creationDate:k,modificationDate:N}}const l=await super.deserialize(e,t,n),{rect:c,bitmap:h,bitmapUrl:f,bitmapId:p,isSvg:g,accessibilityData:y}=e;o?(n.addMissingCanvas(e.id,l),l.#a=!0):p&&n.imageManager.isValidId(p)?(l.#t=p,h&&(l.#e=h)):l.#n=f,l.#l=g;const[w,b]=l.pageDimensions;return l.width=(c[2]-c[0])/w,l.height=(c[3]-c[1])/b,y&&(l.altTextData=y),l._initialData=s,e.comment&&l.setCommentData(e),l.#d=!!s,l}serialize(e=!1,t=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const n=Object.assign(super.serialize(e),{bitmapId:this.#t,isSvg:this.#l});if(this.addComment(n),e)return n.bitmapUrl=this.#y(!0),n.accessibilityData=this.serializeAltText(!0),n.isCopy=!0,n;const{decorative:s,altText:o}=this.serializeAltText(!1);if(!s&&o&&(n.accessibilityData={type:"Figure",alt:o}),this.annotationElementId){const c=this.#w(n);return c.isSame?null:(c.isSameAltText?delete n.accessibilityData:n.accessibilityData.structParent=this._initialData.structParent??-1,n.id=this.annotationElementId,delete n.bitmapId,n)}if(t===null)return n;t.stamps||=new Map;const l=this.#l?(n.rect[2]-n.rect[0])*(n.rect[3]-n.rect[1]):null;if(!t.stamps.has(this.#t))t.stamps.set(this.#t,{area:l,serialized:n}),n.bitmap=this.#y(!1);else if(this.#l){const c=t.stamps.get(this.#t);l>c.area&&(c.area=l,c.serialized.bitmap.close(),c.serialized.bitmap=this.#y(!1))}return n}#w(e){const{pageIndex:t,accessibilityData:{altText:n}}=this._initialData,s=e.pageIndex===t,o=(e.accessibilityData?.alt||"")===n;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&s&&o,isSameAltText:o}}renderAnnotationElement(e){return this.deleted?(e.hide(),null):(e.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class On{#e;#t=!1;#i=null;#n=null;#o=null;#s=new Map;#r=!1;#a=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#m=null;#p=-1;#u;static _initialized=!1;static#g=new Map([dt,fd,KC,st,Mn].map(e=>[e._editorType,e]));constructor({uiManager:e,pageIndex:t,div:n,structTreeLayer:s,accessibilityManager:o,annotationLayer:l,drawLayer:c,textLayer:h,viewport:f,l10n:p}){const g=[...On.#g.values()];if(!On._initialized){On._initialized=!0;for(const y of g)y.initialize(p,e)}e.registerEditorTypes(g),this.#u=e,this.pageIndex=t,this.div=n,this.#e=o,this.#i=l,this.viewport=f,this.#h=h,this.drawLayer=c,this._structTree=s,this.#u.addLayer(this)}get isEmpty(){return this.#s.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===Se.NONE}updateToolbar(e){this.#u.updateToolbar(e)}updateMode(e=this.#u.getMode()){switch(this.#_(),e){case Se.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case Se.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case Se.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:t}=this.div;if(t.toggle("nonEditing",!1),e===Se.POPUP)t.toggle("commentEditing",!0);else{t.toggle("commentEditing",!1);for(const n of On.#g.values())t.toggle(`${n._type}Editing`,e===n._editorType)}this.div.hidden=!1}hasTextLayer(e){return e===this.#h?.div}setEditingState(e){this.#u.setEditingState(e)}addCommands(e){this.#u.addCommands(e)}cleanUndoStack(e){this.#u.cleanUndoStack(e)}toggleDrawing(e=!1){this.div.classList.toggle("drawing",!e)}togglePointerEvents(e=!1){this.div.classList.toggle("disabled",!e)}toggleAnnotationLayerPointerEvents(e=!1){this.#i?.div.classList.toggle("disabled",!e)}get#y(){return this.#s.size!==0?this.#s.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#m?.abort(),this.#m=null;const e=new Set;for(const n of this.#y)n.enableEditing(),n.show(!0),n.annotationElementId&&(this.#u.removeChangedExistingAnnotation(n),e.add(n.annotationElementId));const t=this.#i;if(t)for(const n of t.getEditableAnnotations()){if(n.hide(),this.#u.isDeletedAnnotationElement(n.data.id)||e.has(n.data.id))continue;const s=await this.deserialize(n);s&&(this.addOrRebuild(s),s.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#a=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#m){this.#m=new AbortController;const n=this.#u.combinedSignal(this.#m);this.#h.div.addEventListener("pointerdown",s=>{const{clientX:l,clientY:c,timeStamp:h}=s,f=this.#p;if(h-f>500){this.#p=h;return}this.#p=-1;const{classList:p}=this.div;p.toggle("getElements",!0);const g=document.elementsFromPoint(l,c);if(p.toggle("getElements",!1),!this.div.contains(g[0]))return;let y;const w=new RegExp(`^${go}[0-9]+$`);for(const _ of g)if(w.test(_.id)){y=_.id;break}if(!y)return;const b=this.#s.get(y);b?.annotationElementId===null&&(s.stopPropagation(),s.preventDefault(),b.dblclick(s))},{signal:n,capture:!0})}const e=this.#i;if(e){const n=new Map,s=new Map;for(const l of this.#y){if(l.disableEditing(),!l.annotationElementId){l.updateFakeAnnotationElement(e);continue}if(l.serialize()!==null){n.set(l.annotationElementId,l);continue}else s.set(l.annotationElementId,l);this.getEditableAnnotation(l.annotationElementId)?.show(),l.remove()}const o=e.getEditableAnnotations();for(const l of o){const{id:c}=l.data;if(this.#u.isDeletedAnnotationElement(c)){l.updateEdited({deleted:!0});continue}let h=s.get(c);if(h){h.resetAnnotationElement(l),h.show(!1),l.show();continue}h=n.get(c),h&&(this.#u.addChangedExistingAnnotation(h),h.renderAnnotationElement(l)&&h.show(!1)),l.show()}}this.#_(),this.isEmpty&&(this.div.hidden=!0);const{classList:t}=this.div;for(const n of On.#g.values())t.remove(`${n._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),this.#a=!1}getEditableAnnotation(e){return this.#i?.getEditableAnnotation(e)||null}setActiveEditor(e){this.#u.getActive()!==e&&this.#u.setActiveEditor(e)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const e=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#w.bind(this),{signal:e}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#w(e){this.#u.unselectAll();const{target:t}=e;if(t===this.#h.div||(t.getAttribute("role")==="img"||t.classList.contains("endOfContent"))&&this.#h.div.contains(t)){const{isMac:n}=pt.platform;if(e.button!==0||e.ctrlKey&&n)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),st.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:e.x,y:e.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),e.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const e=this.#u.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:e});const t=this.pointerup.bind(this);this.div.addEventListener("pointerup",t,{signal:e}),this.div.addEventListener("pointercancel",t,{signal:e})}disableClick(){this.#n?.abort(),this.#n=null}attach(e){this.#s.set(e.id,e);const{annotationElementId:t}=e;t&&this.#u.isDeletedAnnotationElement(t)&&this.#u.removeDeletedAnnotationElement(e)}detach(e){this.#s.delete(e.id),this.#e?.removePointerInTextLayer(e.contentDiv),!this.#a&&e.annotationElementId&&this.#u.addDeletedAnnotationElement(e)}remove(e){this.detach(e),this.#u.removeEditor(e),e.div.remove(),e.isAttachedToDOM=!1}changeParent(e){e.parent!==this&&(e.parent&&e.annotationElementId&&(this.#u.addDeletedAnnotationElement(e.annotationElementId),he.deleteAnnotationElement(e),e.annotationElementId=null),this.attach(e),e.parent?.detach(e),e.setParent(this),e.div&&e.isAttachedToDOM&&(e.div.remove(),this.div.append(e.div)))}add(e){if(!(e.parent===this&&e.isAttachedToDOM)){if(this.changeParent(e),this.#u.addEditor(e),this.attach(e),!e.isAttachedToDOM){const t=e.render();this.div.append(t),e.isAttachedToDOM=!0}e.fixAndSetPosition(),e.onceAdded(!this.#c),this.#u.addToAnnotationStorage(e),e._reportTelemetry(e.telemetryInitialData)}}moveEditorInDOM(e){if(!e.isAttachedToDOM)return;const{activeElement:t}=document;e.div.contains(t)&&!this.#o&&(e._focusEventsAllowed=!1,this.#o=setTimeout(()=>{this.#o=null,e.div.contains(document.activeElement)?e._focusEventsAllowed=!0:(e.div.addEventListener("focusin",()=>{e._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),t.focus())},0)),e._structTreeParentId=this.#e?.moveElementInDOM(this.div,e.div,e.contentDiv,!0)}addOrRebuild(e){e.needsToBeRebuilt()?(e.parent||=this,e.rebuild(),e.show()):this.add(e)}addUndoableEditor(e){const t=()=>e._uiManager.rebuild(e),n=()=>{e.remove()};this.addCommands({cmd:t,undo:n,mustExec:!1})}getEditorByUID(e){for(const t of this.#s.values())if(t.uid===e)return t;return null}getNextId(){return this.#u.getId()}get#v(){return On.#g.get(this.#u.getMode())}combinedSignal(e){return this.#u.combinedSignal(e)}#C(e){const t=this.#v;return t?new t.prototype.constructor(e):null}canCreateNewEmptyEditor(){return this.#v?.canCreateNewEmptyEditor()}async pasteEditor(e,t){this.updateToolbar(e),await this.#u.updateMode(e.mode);const{offsetX:n,offsetY:s}=this.#A(),o=this.getNextId(),l=this.#C({parent:this,id:o,x:n,y:s,uiManager:this.#u,isCentered:!0,...t});l&&this.add(l)}async deserialize(e){return await On.#g.get(e.annotationType??e.annotationEditorType)?.deserialize(e,this,this.#u)||null}createAndAddNewEditor(e,t,n={}){const s=this.getNextId(),o=this.#C({parent:this,id:s,x:e.offsetX,y:e.offsetY,uiManager:this.#u,isCentered:t,...n});return o&&this.add(o),o}get boundingClientRect(){return this.div.getBoundingClientRect()}#A(){const{x:e,y:t,width:n,height:s}=this.boundingClientRect,o=Math.max(0,e),l=Math.max(0,t),c=Math.min(window.innerWidth,e+n),h=Math.min(window.innerHeight,t+s),f=(o+c)/2-e,p=(l+h)/2-t,[g,y]=this.viewport.rotation%180===0?[f,p]:[p,f];return{offsetX:g,offsetY:y}}addNewEditor(e={}){this.createAndAddNewEditor(this.#A(),!0,e)}setSelected(e){this.#u.setSelected(e)}toggleSelected(e){this.#u.toggleSelected(e)}unselect(e){this.#u.unselect(e)}pointerup(e){const{isMac:t}=pt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div||!this.#r||(this.#r=!1,this.#v?.isDrawer&&this.#v.supportMultipleDrawings))return;if(!this.#t){this.#t=!0;return}const n=this.#u.getMode();if(n===Se.STAMP||n===Se.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(e,!1)}pointerdown(e){if(this.#u.getMode()===Se.HIGHLIGHT&&this.enableTextSelection(),this.#r){this.#r=!1;return}const{isMac:t}=pt.platform;if(e.button!==0||e.ctrlKey&&t||e.target!==this.div)return;if(this.#r=!0,this.#v?.isDrawer){this.startDrawingSession(e);return}const n=this.#u.getActive();this.#t=!n||n.isEmpty()}startDrawingSession(e){if(this.div.focus({preventScroll:!0}),this.#l){this.#v.startDrawing(this,this.#u,!1,e);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const t=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:n})=>{n&&!this.div.contains(n)&&(this.#d=null,this.commitOrRemove())},{signal:t}),this.#v.startDrawing(this,this.#u,!1,e)}pause(e){if(e){const{activeElement:t}=document;this.div.contains(t)&&(this.#d=t);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(e=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#v.endDrawing(e)):null}findNewParent(e,t,n){const s=this.#u.findParent(t,n);return s===null||s===this?!1:(s.changeParent(e),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#v.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#o&&(clearTimeout(this.#o),this.#o=null);for(const e of this.#s.values())this.#e?.removePointerInTextLayer(e.contentDiv),e.setParent(null),e.isAttachedToDOM=!1,e.div.remove();this.div=null,this.#s.clear(),this.#u.removeLayer(this)}#_(){for(const e of this.#s.values())e.isEmpty()&&e.remove()}render({viewport:e}){this.viewport=e,Oi(this.div,e);for(const t of this.#u.getEditors(this.pageIndex))this.add(t),t.rebuild();this.updateMode()}update({viewport:e}){this.#u.commitOrRemove(),this.#_();const t=this.viewport.rotation,n=e.rotation;if(this.viewport=e,Oi(this.div,{rotation:n}),t!==n)for(const s of this.#s.values())s.rotate(n)}get pageDimensions(){const{pageWidth:e,pageHeight:t}=this.viewport.rawDims;return[e,t]}get scale(){return this.#u.viewParameters.realScale}}class ft{#e=null;#t=new Map;#i=new Map;static#n=0;constructor({pageIndex:e}){this.pageIndex=e}setParent(e){if(!this.#e){this.#e=e;return}if(this.#e!==e){if(this.#t.size>0)for(const t of this.#t.values())t.remove(),e.append(t);this.#e=e}}static get _svgFactory(){return Ee(this,"_svgFactory",new _o)}static#o(e,[t,n,s,o]){const{style:l}=e;l.top=`${100*n}%`,l.left=`${100*t}%`,l.width=`${100*s}%`,l.height=`${100*o}%`}#s(){const e=ft._svgFactory.create(1,1,!0);return this.#e.append(e),e.setAttribute("aria-hidden",!0),e}#r(e,t){const n=ft._svgFactory.createElement("clipPath");e.append(n);const s=`clip_${t}`;n.setAttribute("id",s),n.setAttribute("clipPathUnits","objectBoundingBox");const o=ft._svgFactory.createElement("use");return n.append(o),o.setAttribute("href",`#${t}`),o.classList.add("clip"),s}#a(e,t){for(const[n,s]of Object.entries(t))s===null?e.removeAttribute(n):e.setAttribute(n,s)}draw(e,t=!1,n=!1){const s=ft.#n++,o=this.#s(),l=ft._svgFactory.createElement("defs");o.append(l);const c=ft._svgFactory.createElement("path");l.append(c);const h=`path_p${this.pageIndex}_${s}`;c.setAttribute("id",h),c.setAttribute("vector-effect","non-scaling-stroke"),t&&this.#i.set(s,c);const f=n?this.#r(l,h):null,p=ft._svgFactory.createElement("use");return o.append(p),p.setAttribute("href",`#${h}`),this.updateProperties(o,e),this.#t.set(s,o),{id:s,clipPathId:`url(#${f})`}}drawOutline(e,t){const n=ft.#n++,s=this.#s(),o=ft._svgFactory.createElement("defs");s.append(o);const l=ft._svgFactory.createElement("path");o.append(l);const c=`path_p${this.pageIndex}_${n}`;l.setAttribute("id",c),l.setAttribute("vector-effect","non-scaling-stroke");let h;if(t){const g=ft._svgFactory.createElement("mask");o.append(g),h=`mask_p${this.pageIndex}_${n}`,g.setAttribute("id",h),g.setAttribute("maskUnits","objectBoundingBox");const y=ft._svgFactory.createElement("rect");g.append(y),y.setAttribute("width","1"),y.setAttribute("height","1"),y.setAttribute("fill","white");const w=ft._svgFactory.createElement("use");g.append(w),w.setAttribute("href",`#${c}`),w.setAttribute("stroke","none"),w.setAttribute("fill","black"),w.setAttribute("fill-rule","nonzero"),w.classList.add("mask")}const f=ft._svgFactory.createElement("use");s.append(f),f.setAttribute("href",`#${c}`),h&&f.setAttribute("mask",`url(#${h})`);const p=f.cloneNode();return s.append(p),f.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(s,e),this.#t.set(n,s),n}finalizeDraw(e,t){this.#i.delete(e),this.updateProperties(e,t)}updateProperties(e,t){if(!t)return;const{root:n,bbox:s,rootClass:o,path:l}=t,c=typeof e=="number"?this.#t.get(e):e;if(c){if(n&&this.#a(c,n),s&&ft.#o(c,s),o){const{classList:h}=c;for(const[f,p]of Object.entries(o))h.toggle(f,p)}if(l){const f=c.firstChild.firstChild;this.#a(f,l)}}}updateParent(e,t){if(t===this)return;const n=this.#t.get(e);n&&(t.#e.append(n),this.#t.delete(e),t.#t.set(e,n))}remove(e){this.#i.delete(e),this.#e!==null&&(this.#t.get(e).remove(),this.#t.delete(e))}destroy(){this.#e=null;for(const e of this.#t.values())e.remove();this.#t.clear(),this.#i.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:Sh};globalThis.pdfjsLib={AbortException:oi,AnnotationEditorLayer:On,AnnotationEditorParamsType:Re,AnnotationEditorType:Se,AnnotationEditorUIManager:ai,AnnotationLayer:dd,AnnotationMode:Bn,AnnotationType:it,applyOpacity:Xy,build:gv,ColorPicker:Wt,createValidAbsoluteUrl:Kh,CSSConstants:qy,DOMSVGFactory:_o,DrawLayer:ft,FeatureTest:pt,fetchData:hr,findContrastColor:Ky,getDocument:ad,getFilenameFromUrl:Vy,getPdfFilenameFromUrl:Wy,getRGB:dr,getUuid:Qh,getXfaPageViewport:Gy,GlobalWorkerOptions:Ni,ImageKind:lo,InvalidPDFException:El,isDataScheme:Lo,isPdfFile:Ul,isValidExplicitDest:Zy,MathClamp:At,noContextMenu:qt,normalizeUnicode:zy,OPS:ir,OutputScale:An,PasswordResponses:jy,PDFDataRangeTransport:cd,PDFDateString:Cl,PDFWorker:sr,PermissionFlag:Uy,PixelsPerInch:us,RenderingCancelledException:Bl,renderRichText:ed,ResponseException:mo,setLayerDimensions:Oi,shadow:Ee,SignatureExtractor:ns,stopEvent:Ye,SupportedImageMimeTypes:Tl,TextLayer:vo,TouchManager:Mo,updateUrlHash:Yh,Util:re,VerbosityLevel:Po,version:pv,XfaLayer:Zh};const YC=Object.freeze(Object.defineProperty({__proto__:null,AbortException:oi,AnnotationEditorLayer:On,AnnotationEditorParamsType:Re,AnnotationEditorType:Se,AnnotationEditorUIManager:ai,AnnotationLayer:dd,AnnotationMode:Bn,AnnotationType:it,CSSConstants:qy,ColorPicker:Wt,DOMSVGFactory:_o,DrawLayer:ft,FeatureTest:pt,GlobalWorkerOptions:Ni,ImageKind:lo,InvalidPDFException:El,MathClamp:At,OPS:ir,OutputScale:An,PDFDataRangeTransport:cd,PDFDateString:Cl,PDFWorker:sr,PasswordResponses:jy,PermissionFlag:Uy,PixelsPerInch:us,RenderingCancelledException:Bl,ResponseException:mo,SignatureExtractor:ns,SupportedImageMimeTypes:Tl,TextLayer:vo,TouchManager:Mo,Util:re,VerbosityLevel:Po,XfaLayer:Zh,applyOpacity:Xy,build:gv,createValidAbsoluteUrl:Kh,fetchData:hr,findContrastColor:Ky,getDocument:ad,getFilenameFromUrl:Vy,getPdfFilenameFromUrl:Wy,getRGB:dr,getUuid:Qh,getXfaPageViewport:Gy,isDataScheme:Lo,isPdfFile:Ul,isValidExplicitDest:Zy,noContextMenu:qt,normalizeUnicode:zy,renderRichText:ed,setLayerDimensions:Oi,shadow:Ee,stopEvent:Ye,updateUrlHash:Yh,version:pv},Symbol.toStringTag,{value:"Module"}));function Ev(a){var e,t,n="";if(typeof a=="string"||typeof a=="number")n+=a;else if(typeof a=="object")if(Array.isArray(a)){var s=a.length;for(e=0;e<s;e++)a[e]&&(t=Ev(a[e]))&&(n&&(n+=" "),n+=t)}else for(t in a)a[t]&&(n&&(n+=" "),n+=t);return n}function zl(){for(var a,e,t=0,n="",s=arguments.length;t<s;t++)(a=arguments[t])&&(e=Ev(a))&&(n&&(n+=" "),n+=e);return n}var Sm=Object.prototype.hasOwnProperty;function Am(a,e,t){for(t of a.keys())if(Qs(t,e))return t}function Qs(a,e){var t,n,s;if(a===e)return!0;if(a&&e&&(t=a.constructor)===e.constructor){if(t===Date)return a.getTime()===e.getTime();if(t===RegExp)return a.toString()===e.toString();if(t===Array){if((n=a.length)===e.length)for(;n--&&Qs(a[n],e[n]););return n===-1}if(t===Set){if(a.size!==e.size)return!1;for(n of a)if(s=n,s&&typeof s=="object"&&(s=Am(e,s),!s)||!e.has(s))return!1;return!0}if(t===Map){if(a.size!==e.size)return!1;for(n of a)if(s=n[0],s&&typeof s=="object"&&(s=Am(e,s),!s)||!Qs(n[1],e.get(s)))return!1;return!0}if(t===ArrayBuffer)a=new Uint8Array(a),e=new Uint8Array(e);else if(t===DataView){if((n=a.byteLength)===e.byteLength)for(;n--&&a.getInt8(n)===e.getInt8(n););return n===-1}if(ArrayBuffer.isView(a)){if((n=a.byteLength)===e.byteLength)for(;n--&&a[n]===e[n];);return n===-1}if(!t||typeof a=="object"){n=0;for(t in a)if(Sm.call(a,t)&&++n&&!Sm.call(e,t)||!(t in e)||!Qs(a[t],e[t]))return!1;return Object.keys(e).length===n}}return a!==a&&e!==e}function Fo(a){let e=!1;return{promise:new Promise((n,s)=>{a.then(o=>!e&&n(o)).catch(o=>!e&&s(o))}),cancel(){e=!0}}}const QC=["onCopy","onCut","onPaste"],JC=["onCompositionEnd","onCompositionStart","onCompositionUpdate"],ZC=["onFocus","onBlur"],eT=["onInput","onInvalid","onReset","onSubmit"],tT=["onLoad","onError"],nT=["onKeyDown","onKeyPress","onKeyUp"],iT=["onAbort","onCanPlay","onCanPlayThrough","onDurationChange","onEmptied","onEncrypted","onEnded","onError","onLoadedData","onLoadedMetadata","onLoadStart","onPause","onPlay","onPlaying","onProgress","onRateChange","onSeeked","onSeeking","onStalled","onSuspend","onTimeUpdate","onVolumeChange","onWaiting"],sT=["onClick","onContextMenu","onDoubleClick","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp"],rT=["onDrag","onDragEnd","onDragEnter","onDragExit","onDragLeave","onDragOver","onDragStart","onDrop"],oT=["onSelect"],aT=["onTouchCancel","onTouchEnd","onTouchMove","onTouchStart"],lT=["onPointerDown","onPointerMove","onPointerUp","onPointerCancel","onGotPointerCapture","onLostPointerCapture","onPointerEnter","onPointerLeave","onPointerOver","onPointerOut"],cT=["onScroll"],uT=["onWheel"],hT=["onAnimationStart","onAnimationEnd","onAnimationIteration"],dT=["onTransitionEnd"],fT=["onToggle"],pT=["onChange"],gT=[...QC,...JC,...ZC,...eT,...tT,...nT,...iT,...sT,...rT,...oT,...aT,...lT,...cT,...uT,...hT,...dT,...pT,...fT];function Cv(a,e){const t={};for(const n of gT){const s=a[n];s&&(e?t[n]=(o=>s(o,e(n))):t[n]=s)}return t}var mT="Invariant failed";function Fe(a,e){if(!a)throw new Error(mT)}var ih,Em;function yT(){if(Em)return ih;Em=1;var a=function(){};return ih=a,ih}var vT=yT();const Et=Lm(vT),Tv=I.createContext(null),wT="noopener noreferrer nofollow";class _T{constructor(){this.externalLinkEnabled=!0,this.externalLinkRel=void 0,this.externalLinkTarget=void 0,this.isInPresentationMode=!1,this.pdfDocument=void 0,this.pdfViewer=void 0}setDocument(e){this.pdfDocument=e}setViewer(e){this.pdfViewer=e}setExternalLinkRel(e){this.externalLinkRel=e}setExternalLinkTarget(e){this.externalLinkTarget=e}setHash(){}setHistory(){}get pagesCount(){return this.pdfDocument?this.pdfDocument.numPages:0}get page(){return Fe(this.pdfViewer),this.pdfViewer.currentPageNumber||0}set page(e){Fe(this.pdfViewer),this.pdfViewer.currentPageNumber=e}get rotation(){return 0}set rotation(e){}addLinkAttributes(e,t,n){e.href=t,e.rel=this.externalLinkRel||wT,e.target=n?"_blank":this.externalLinkTarget||""}goToDestination(e){return new Promise(t=>{Fe(this.pdfDocument),Fe(e),typeof e=="string"?this.pdfDocument.getDestination(e).then(t):Array.isArray(e)?t(e):e.then(t)}).then(t=>{Fe(Array.isArray(t));const n=t[0];new Promise(s=>{Fe(this.pdfDocument),n instanceof Object?this.pdfDocument.getPageIndex(n).then(o=>{s(o)}).catch(()=>{Fe(!1)}):typeof n=="number"?s(n):Fe(!1)}).then(s=>{const o=s+1;Fe(this.pdfViewer),Fe(o>=1&&o<=this.pagesCount),this.pdfViewer.scrollPageIntoView({dest:t,pageIndex:s,pageNumber:o})})})}goToPage(e){const t=e-1;Fe(this.pdfViewer),Fe(e>=1&&e<=this.pagesCount),this.pdfViewer.scrollPageIntoView({pageIndex:t,pageNumber:e})}goToXY(){}cachePageRef(){}getDestinationHash(){return"#"}getAnchorUrl(){return"#"}executeNamedAction(){}executeSetOCGState(){}isPageVisible(){return!0}isPageCached(){return!0}navigateTo(e){this.goToDestination(e)}}function Js({children:a,type:e}){return j.jsx("div",{className:`react-pdf__message react-pdf__message--${e}`,children:a})}const Cm={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};function bT(a,e){switch(e.type){case"RESOLVE":return{value:e.value,error:void 0};case"REJECT":return{value:!1,error:e.error};case"RESET":return{value:void 0,error:void 0};default:return a}}function rr(){return I.useReducer(bT,{value:void 0,error:void 0})}const $l=typeof window<"u",xv=$l&&window.location.protocol==="file:";function ST(a){return typeof a<"u"}function es(a){return ST(a)&&a!==null}function AT(a){return typeof a=="string"}function ET(a){return a instanceof ArrayBuffer}function CT(a){return Fe($l),a instanceof Blob}function Ch(a){return AT(a)&&/^data:/.test(a)}function Tm(a){Fe(Ch(a));const[e="",t=""]=a.split(",");return e.split(";").indexOf("base64")!==-1?atob(t):unescape(t)}function TT(){return $l&&window.devicePixelRatio||1}const kv="On Chromium based browsers, you can use --allow-file-access-from-files flag for debugging purposes.";function xm(){Et(!xv,`Loading PDF as base64 strings/URLs may not work on protocols other than HTTP/HTTPS. ${kv}`)}function xT(){Et(!xv,`Loading PDF.js worker may not work on protocols other than HTTP/HTTPS. ${kv}`)}function ds(a){a?.cancel&&a.cancel()}function Th(a,e){return Object.defineProperty(a,"width",{get(){return this.view[2]*e},configurable:!0}),Object.defineProperty(a,"height",{get(){return this.view[3]*e},configurable:!0}),Object.defineProperty(a,"originalWidth",{get(){return this.view[2]},configurable:!0}),Object.defineProperty(a,"originalHeight",{get(){return this.view[3]},configurable:!0}),a}function kT(a){return a.name==="RenderingCancelledException"}function PT(a){return new Promise((e,t)=>{const n=new FileReader;n.onload=()=>{if(!n.result)return t(new Error("Error while reading a file."));e(n.result)},n.onerror=s=>{if(!s.target)return t(new Error("Error while reading a file."));const{error:o}=s.target;if(!o)return t(new Error("Error while reading a file."));switch(o.code){case o.NOT_FOUND_ERR:return t(new Error("Error while reading a file: File not found."));case o.SECURITY_ERR:return t(new Error("Error while reading a file: Security error."));case o.ABORT_ERR:return t(new Error("Error while reading a file: Aborted."));default:return t(new Error("Error while reading a file."))}},n.readAsArrayBuffer(a)})}const{PDFDataRangeTransport:RT}=YC,IT=(a,e)=>{switch(e){case Cm.NEED_PASSWORD:{const t=prompt("Enter the password to open this PDF file.");a(t);break}case Cm.INCORRECT_PASSWORD:{const t=prompt("Invalid password. Please try again.");a(t);break}}};function km(a){return typeof a=="object"&&a!==null&&("data"in a||"range"in a||"url"in a)}const LT=I.forwardRef(function({children:e,className:t,error:n="Failed to load PDF file.",externalLinkRel:s,externalLinkTarget:o,file:l,inputRef:c,imageResourcesPath:h,loading:f="Loading PDF",noData:p="No PDF file specified.",onItemClick:g,onLoadError:y,onLoadProgress:w,onLoadSuccess:b,onPassword:_=IT,onSourceError:A,onSourceSuccess:E,options:C,renderMode:T,rotate:R,scale:L,...k},N){const[U,z]=rr(),{value:V,error:q}=U,[ue,Q]=rr(),{value:le,error:ye}=ue,J=I.useRef(new _T),K=I.useRef([]),$=I.useRef(void 0),ee=I.useRef(void 0);l&&l!==$.current&&km(l)&&(Et(!Qs(l,$.current),`File prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "file" prop.`),$.current=l),C&&C!==ee.current&&(Et(!Qs(C,ee.current),`Options prop passed to <Document /> changed, but it's equal to previous one. This might result in unnecessary reloads. Consider memoizing the value passed to "options" prop.`),ee.current=C);const Z=I.useRef({scrollPageIntoView:Pe=>{const{dest:Ne,pageNumber:Je,pageIndex:et=Je-1}=Pe;if(g){g({dest:Ne,pageIndex:et,pageNumber:Je});return}const En=K.current[et];if(En){En.scrollIntoView();return}Et(!1,`An internal link leading to page ${Je} was clicked, but neither <Document> was provided with onItemClick nor it was able to find the page within itself. Either provide onItemClick to <Document> and handle navigating by yourself or ensure that all pages are rendered within <Document>.`)}});I.useImperativeHandle(N,()=>({linkService:J,pages:K,viewer:Z}),[]);function M(){E&&E()}function H(){q&&(Et(!1,q.toString()),A&&A(q))}function ne(){z({type:"RESET"})}I.useEffect(ne,[l,z]);const de=I.useCallback(async()=>{if(!l)return null;if(typeof l=="string")return Ch(l)?{data:Tm(l)}:(xm(),{url:l});if(l instanceof RT)return{range:l};if(ET(l))return{data:l};if($l&&CT(l))return{data:await PT(l)};if(Fe(typeof l=="object"),Fe(km(l)),"url"in l&&typeof l.url=="string"){if(Ch(l.url)){const{url:Pe,...Ne}=l;return{data:Tm(Pe),...Ne}}xm()}return l},[l]);I.useEffect(()=>{const Pe=Fo(de());return Pe.promise.then(Ne=>{z({type:"RESOLVE",value:Ne})}).catch(Ne=>{z({type:"REJECT",error:Ne})}),()=>{ds(Pe)}},[de,z]),I.useEffect(()=>{if(!(typeof V>"u")){if(V===!1){H();return}M()}},[V]);function we(){le&&(b&&b(le),K.current=new Array(le.numPages),J.current.setDocument(le))}function ve(){ye&&(Et(!1,ye.toString()),y&&y(ye))}I.useEffect(function(){Q({type:"RESET"})},[Q,V]),I.useEffect(function(){if(!V)return;const Ne=C?{...V,...C}:V,Je=ad(Ne);w&&(Je.onProgress=w),_&&(Je.onPassword=_);const et=Je,En=et.promise.then(li=>{Q({type:"RESOLVE",value:li})}).catch(li=>{et.destroyed||Q({type:"REJECT",error:li})});return()=>{En.finally(()=>et.destroy())}},[C,Q,V]),I.useEffect(()=>{if(!(typeof le>"u")){if(le===!1){ve();return}we()}},[le]),I.useEffect(function(){J.current.setViewer(Z.current),J.current.setExternalLinkRel(s),J.current.setExternalLinkTarget(o)},[s,o]);const fe=I.useCallback((Pe,Ne)=>{K.current[Pe]=Ne},[]),Ce=I.useCallback(Pe=>{delete K.current[Pe]},[]),Te=I.useMemo(()=>({imageResourcesPath:h,linkService:J.current,onItemClick:g,pdf:le,registerPage:fe,renderMode:T,rotate:R,scale:L,unregisterPage:Ce}),[h,g,le,fe,T,R,L,Ce]),ke=I.useMemo(()=>Cv(k,()=>le),[k,le]);function Rt(){function Pe(Je){return!!Je?.pdf}if(!Pe(Te))throw new Error("pdf is undefined");const Ne=typeof e=="function"?e(Te):e;return j.jsx(Tv.Provider,{value:Te,children:Ne})}function Xt(){return l?le==null?j.jsx(Js,{type:"loading",children:typeof f=="function"?f():f}):le===!1?j.jsx(Js,{type:"error",children:typeof n=="function"?n():n}):Rt():j.jsx(Js,{type:"no-data",children:typeof p=="function"?p():p})}return j.jsx("div",{className:zl("react-pdf__Document",t),ref:c,...ke,children:Xt()})});function Pv(){return I.useContext(Tv)}function Rv(){for(var a=[],e=0;e<arguments.length;e++)a[e]=arguments[e];var t=a.filter(Boolean);if(t.length<=1){var n=t[0];return n||null}return function(o){for(var l=0,c=t;l<c.length;l++){var h=c[l];typeof h=="function"?h(o):h&&(h.current=o)}}}const Iv=I.createContext(null);function Vl(){return I.useContext(Iv)}function DT(){const a=Pv(),e=Vl();Fe(e);const t={...a,...e},{imageResourcesPath:n,linkService:s,onGetAnnotationsError:o,onGetAnnotationsSuccess:l,onRenderAnnotationLayerError:c,onRenderAnnotationLayerSuccess:h,page:f,pdf:p,renderForms:g,rotate:y,scale:w=1}=t;Fe(p),Fe(f),Fe(s);const[b,_]=rr(),{value:A,error:E}=b,C=I.useRef(null);Et(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-annotation-layer"),10)===1,"AnnotationLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-annotations");function T(){A&&l&&l(A)}function R(){E&&(Et(!1,E.toString()),o&&o(E))}I.useEffect(function(){_({type:"RESET"})},[_,f]),I.useEffect(function(){if(!f)return;const z=Fo(f.getAnnotations()),V=z;return z.promise.then(q=>{_({type:"RESOLVE",value:q})}).catch(q=>{_({type:"REJECT",error:q})}),()=>{ds(V)}},[_,f]),I.useEffect(()=>{if(A!==void 0){if(A===!1){R();return}T()}},[A]);function L(){h&&h()}function k(U){Et(!1,`${U}`),c&&c(U)}const N=I.useMemo(()=>f.getViewport({scale:w,rotation:y}),[f,y,w]);return I.useEffect(function(){if(!p||!f||!s||!A)return;const{current:z}=C;if(!z)return;const V=N.clone({dontFlip:!0}),q={accessibilityManager:null,annotationCanvasMap:null,annotationEditorUIManager:null,annotationStorage:p.annotationStorage,commentManager:null,div:z,l10n:null,linkService:s,page:f,structTreeLayer:null,viewport:V},ue={annotations:A,annotationStorage:p.annotationStorage,div:z,imageResourcesPath:n,linkService:s,page:f,renderForms:g,viewport:V};z.innerHTML="";try{new dd(q).render(ue),L()}catch(Q){k(Q)}return()=>{}},[A,n,s,f,p,g,N]),j.jsx("div",{className:zl("react-pdf__Page__annotations","annotationLayer"),ref:C})}const Lv={Document:null,DocumentFragment:null,Part:"group",Sect:"group",Div:"group",Aside:"note",NonStruct:"none",P:null,H:"heading",Title:null,FENote:"note",Sub:"group",Lbl:null,Span:null,Em:null,Strong:null,Link:"link",Annot:"note",Form:"form",Ruby:null,RB:null,RT:null,RP:null,Warichu:null,WT:null,WP:null,L:"list",LI:"listitem",LBody:null,Table:"table",TR:"row",TH:"columnheader",TD:"cell",THead:"columnheader",TBody:null,TFoot:null,Caption:null,Figure:"figure",Formula:null,Artifact:null},MT=/^H(\d+)$/;function NT(a){return a in Lv}function Wl(a){return"children"in a}function Dv(a){return Wl(a)?a.children.length===1&&0 in a.children&&"id"in a.children[0]:!1}function OT(a){const e={};if(Wl(a)){const{role:t}=a,n=t.match(MT);if(n)e.role="heading",e["aria-level"]=Number(n[1]);else if(NT(t)){const s=Lv[t];s&&(e.role=s)}}return e}function Mv(a){const e={};if(Wl(a)){if(a.alt!==void 0&&(e["aria-label"]=a.alt),a.lang!==void 0&&(e.lang=a.lang),Dv(a)){const[t]=a.children;if(t){const n=Mv(t);return{...e,...n}}}}else"id"in a&&(e["aria-owns"]=a.id);return e}function FT(a){return a?{...OT(a),...Mv(a)}:null}function Nv({className:a,node:e}){const t=I.useMemo(()=>FT(e),[e]),n=I.useMemo(()=>!Wl(e)||Dv(e)?null:e.children.map((s,o)=>j.jsx(Nv,{node:s},o)),[e]);return j.jsx("span",{className:a,...t,children:n})}function BT(){const a=Vl();Fe(a);const{onGetStructTreeError:e,onGetStructTreeSuccess:t}=a,[n,s]=rr(),{value:o,error:l}=n,{customTextRenderer:c,page:h}=a;function f(){o&&t&&t(o)}function p(){l&&(Et(!1,l.toString()),e&&e(l))}return I.useEffect(function(){s({type:"RESET"})},[s,h]),I.useEffect(function(){if(c||!h)return;const y=Fo(h.getStructTree()),w=y;return y.promise.then(b=>{s({type:"RESOLVE",value:b})}).catch(b=>{s({type:"REJECT",error:b})}),()=>ds(w)},[c,h,s]),I.useEffect(()=>{if(o!==void 0){if(o===!1){p();return}f()}},[o]),o?j.jsx(Nv,{className:"react-pdf__Page__structTree structTree",node:o}):null}const Pm=Bn;function UT(a){const e=Vl();Fe(e);const t={...e,...a},{_className:n,canvasBackground:s,devicePixelRatio:o=TT(),onRenderError:l,onRenderSuccess:c,page:h,renderForms:f,renderTextLayer:p,rotate:g,scale:y}=t,{canvasRef:w}=a;Fe(h);const b=I.useRef(null);function _(){h&&c&&c(Th(h,y))}function A(R){kT(R)||(Et(!1,R.toString()),l&&l(R))}const E=I.useMemo(()=>h.getViewport({scale:y*o,rotation:g}),[o,h,g,y]),C=I.useMemo(()=>h.getViewport({scale:y,rotation:g}),[h,g,y]);I.useEffect(function(){if(!h)return;h.cleanup();const{current:L}=b;if(!L)return;L.width=E.width,L.height=E.height,L.style.width=`${Math.floor(C.width)}px`,L.style.height=`${Math.floor(C.height)}px`,L.style.visibility="hidden";const k={annotationMode:f?Pm.ENABLE_FORMS:Pm.ENABLE,canvas:L,canvasContext:L.getContext("2d",{alpha:!1}),viewport:E};s&&(k.background=s);const N=h.render(k),U=N;return N.promise.then(()=>{L.style.visibility="",_()}).catch(A),()=>ds(U)},[s,h,f,E,C]);const T=I.useCallback(()=>{const{current:R}=b;R&&(R.width=0,R.height=0)},[]);return I.useEffect(()=>T,[T]),j.jsx("canvas",{className:`${n}__canvas`,dir:"ltr",ref:Rv(w,b),style:{display:"block",userSelect:"none"},children:p?j.jsx(BT,{}):null})}function jT(a){return"str"in a}function HT(){const a=Vl();Fe(a);const{customTextRenderer:e,onGetTextError:t,onGetTextSuccess:n,onRenderTextLayerError:s,onRenderTextLayerSuccess:o,page:l,pageIndex:c,pageNumber:h,rotate:f,scale:p}=a;Fe(l);const[g,y]=rr(),{value:w,error:b}=g,_=I.useRef(null);Et(Number.parseInt(window.getComputedStyle(document.body).getPropertyValue("--react-pdf-text-layer"),10)===1,"TextLayer styles not found. Read more: https://github.com/wojtekmaj/react-pdf#support-for-text-layer");function A(){w&&n&&n(w)}function E(){b&&(Et(!1,b.toString()),t&&t(b))}I.useEffect(function(){y({type:"RESET"})},[l,y]),I.useEffect(function(){if(!l)return;const U=Fo(l.getTextContent()),z=U;return U.promise.then(V=>{y({type:"RESOLVE",value:V})}).catch(V=>{y({type:"REJECT",error:V})}),()=>ds(z)},[l,y]),I.useEffect(()=>{if(w!==void 0){if(w===!1){E();return}A()}},[w]);const C=I.useCallback(()=>{o&&o()},[o]),T=I.useCallback(N=>{Et(!1,N.toString()),s&&s(N)},[s]);function R(){const N=_.current;N&&N.classList.add("selecting")}function L(){const N=_.current;N&&N.classList.remove("selecting")}const k=I.useMemo(()=>l.getViewport({scale:p,rotation:f}),[l,f,p]);return I.useLayoutEffect(function(){if(!l||!w)return;const{current:U}=_;if(!U)return;U.innerHTML="";const z=l.streamTextContent({includeMarkedContent:!0}),V={container:U,textContentSource:z,viewport:k},q=new vo(V),ue=q;return q.render().then(()=>{const Q=document.createElement("div");Q.className="endOfContent",U.append(Q);const le=U.querySelectorAll('[role="presentation"]');if(e){let ye=0;w.items.forEach((J,K)=>{if(!jT(J))return;const $=le[ye];if(!$)return;const ee=e({pageIndex:c,pageNumber:h,itemIndex:K,...J});$.innerHTML=ee,ye+=J.str&&J.hasEOL?2:1})}C()}).catch(T),()=>ds(ue)},[e,T,C,l,c,h,w,k]),j.jsx("div",{className:zl("react-pdf__Page__textContent","textLayer"),onMouseUp:L,onMouseDown:R,ref:_})}const Rm=1;function zT(a){const t={...Pv(),...a},{_className:n="react-pdf__Page",_enableRegisterUnregisterPage:s=!0,canvasBackground:o,canvasRef:l,children:c,className:h,customRenderer:f,customTextRenderer:p,devicePixelRatio:g,error:y="Failed to load the page.",height:w,inputRef:b,loading:_="Loading page",noData:A="No page specified.",onGetAnnotationsError:E,onGetAnnotationsSuccess:C,onGetStructTreeError:T,onGetStructTreeSuccess:R,onGetTextError:L,onGetTextSuccess:k,onLoadError:N,onLoadSuccess:U,onRenderAnnotationLayerError:z,onRenderAnnotationLayerSuccess:V,onRenderError:q,onRenderSuccess:ue,onRenderTextLayerError:Q,onRenderTextLayerSuccess:le,pageIndex:ye,pageNumber:J,pdf:K,registerPage:$,renderAnnotationLayer:ee=!0,renderForms:Z=!1,renderMode:M="canvas",renderTextLayer:H=!0,rotate:ne,scale:de=Rm,unregisterPage:we,width:ve,...fe}=t,[Ce,Te]=rr(),{value:ke,error:Rt}=Ce,Xt=I.useRef(null);Fe(K);const Pe=es(J)?J-1:ye??null,Ne=J??(es(ye)?ye+1:null),Je=ne??(ke?ke.rotate:null),et=I.useMemo(()=>{if(!ke)return null;let Kt=1;const un=de??Rm;if(ve||w){const hn=ke.getViewport({scale:1,rotation:Je});ve?Kt=ve/hn.width:w&&(Kt=w/hn.height)}return un*Kt},[w,ke,Je,de,ve]);I.useEffect(function(){return()=>{es(Pe)&&s&&we&&we(Pe)}},[s,K,Pe,we]);function En(){if(U){if(!ke||!et)return;U(Th(ke,et))}if(s&&$){if(!es(Pe)||!Xt.current)return;$(Pe,Xt.current)}}function li(){Rt&&(Et(!1,Rt.toString()),N&&N(Rt))}I.useEffect(function(){Te({type:"RESET"})},[Te,K,Pe]),I.useEffect(function(){if(!K||!Ne)return;const un=Fo(K.getPage(Ne)),hn=un;return un.promise.then(zn=>{Te({type:"RESOLVE",value:zn})}).catch(zn=>{Te({type:"REJECT",error:zn})}),()=>ds(hn)},[Te,K,Ne]),I.useEffect(()=>{if(ke!==void 0){if(ke===!1){li();return}En()}},[ke,et]);const Ui=I.useMemo(()=>es(Pe)&&Ne&&es(Je)&&es(et)?{_className:n,canvasBackground:o,customTextRenderer:p,devicePixelRatio:g,onGetAnnotationsError:E,onGetAnnotationsSuccess:C,onGetStructTreeError:T,onGetStructTreeSuccess:R,onGetTextError:L,onGetTextSuccess:k,onRenderAnnotationLayerError:z,onRenderAnnotationLayerSuccess:V,onRenderError:q,onRenderSuccess:ue,onRenderTextLayerError:Q,onRenderTextLayerSuccess:le,page:ke,pageIndex:Pe,pageNumber:Ne,renderForms:Z,renderTextLayer:H,rotate:Je,scale:et}:null,[n,o,p,g,E,C,T,R,L,k,z,V,q,ue,Q,le,ke,Pe,Ne,Z,H,Je,et]),ji=I.useMemo(()=>Cv(fe,()=>ke&&(et?Th(ke,et):void 0)),[fe,ke,et]),cn=`${Pe}@${et}/${Je}`;function fr(){switch(M){case"custom":return Fe(f),j.jsx(f,{},`${cn}_custom`);case"none":return null;case"canvas":default:return j.jsx(UT,{canvasRef:l},`${cn}_canvas`)}}function Bo(){return H?j.jsx(HT,{},`${cn}_text`):null}function Uo(){return ee?j.jsx(DT,{},`${cn}_annotations`):null}function jo(){function Kt(hn){return!!hn?.page}if(!Kt(Ui))throw new Error("page is undefined");const un=typeof c=="function"?c(Ui):c;return j.jsxs(Iv.Provider,{value:Ui,children:[fr(),Bo(),Uo(),un]})}function Ho(){return Ne?K===null||ke===void 0||ke===null?j.jsx(Js,{type:"loading",children:typeof _=="function"?_():_}):K===!1||ke===!1?j.jsx(Js,{type:"error",children:typeof y=="function"?y():y}):jo():j.jsx(Js,{type:"no-data",children:typeof A=="function"?A():A})}return j.jsx("div",{className:zl(n,h),"data-page-number":Ne,ref:Rv(b,Xt),style:{"--scale-round-x":"1px","--scale-round-y":"1px","--scale-factor":"1","--user-unit":`${et}`,"--total-scale-factor":"calc(var(--scale-factor) * var(--user-unit))",backgroundColor:o||"white",position:"relative",minWidth:"min-content",minHeight:"min-content"},...ji,children:Ho()})}xT();Ni.workerSrc="pdf.worker.mjs";Ni.workerSrc="/pdf.worker.min.mjs";if(typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")){const e=window.fetch;window.fetch=function(...l){const c=typeof l[0]=="string"?l[0]:l[0]?.url||"";return c.includes("googleads.g.doubleclick.net")||c.includes("pagead2.googlesyndication.com")||c.includes("googlesyndication.com")?(console.log("[AdSense Blocker] Blocked fetch request to:",c),Promise.reject(new Error("AdSense blocked on localhost"))):e.apply(this,l)};const t=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(l,c,...h){if(typeof c=="string"&&(c.includes("googleads.g.doubleclick.net")||c.includes("pagead2.googlesyndication.com")||c.includes("googlesyndication.com"))){console.log("[AdSense Blocker] Blocked XHR request to:",c),this.send=function(){};return}return t.apply(this,[l,c,...h])};const n=()=>{document.querySelectorAll('script[src*="adsbygoogle"], script[data-adsense]').forEach(c=>{c.parentNode&&c.parentNode.removeChild(c)})};window._adsbygoogleOriginalPush||(window._adsbygoogleOriginalPush=window.adsbygoogle?.push,window.adsbygoogle=window.adsbygoogle||[],window.adsbygoogle.push=function(...l){});const s=()=>{document.querySelectorAll("ins.adsbygoogle").forEach(c=>{c.parentNode&&c.parentNode.removeChild(c)})};n(),s(),document.readyState==="loading"&&document.addEventListener("DOMContentLoaded",()=>{n(),s()});const o=new MutationObserver(()=>{n(),s()});o.observe(document.head,{childList:!0,subtree:!0}),o.observe(document.body,{childList:!0,subtree:!0})}function $T(a,e=!1){return typeof document>"u"||typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")?Promise.resolve(!1):document.querySelector('script[data-adsense="true"]')?Promise.resolve(!0):new Promise(s=>{const o=document.createElement("script");o.async=!0,o.src=e||!a?"https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js":`https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=${encodeURIComponent(a)}`,o.crossOrigin="anonymous",o.setAttribute("data-adsense","true"),o.onload=()=>s(!0),o.onerror=()=>s(!1),document.head.appendChild(o)})}function Im({position:a,client:e,slot:t,testMode:n=!1}){const s=I.useRef(null),[o,l]=I.useState(!1),c=typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1");return I.useEffect(()=>{if(c&&(l(!0),typeof window<"u"&&window.adsbygoogle)){const h=window.adsbygoogle.push;return window.adsbygoogle.push=function(...f){console.log(`[AdSense ${a}] Blocked push on localhost`)},()=>{window.adsbygoogle&&h&&(window.adsbygoogle.push=h)}}},[c,a]),I.useEffect(()=>{if(!e||!t)return;if(c){console.log(`[AdSense ${a}]  Skipping on localhost - AdSense doesn't work on localhost even with test mode`);return}let h=!1;return(async()=>{if(console.log(`[AdSense ${a}] Loading script...`,{client:e,slot:t,testMode:n}),!await $T(e,n)||h){console.warn(`[AdSense ${a}] Script load failed or cancelled`);return}const p=s.current;if(!p){console.warn(`[AdSense ${a}] Element not found`);return}if(p.getAttribute("data-adsbygoogle-status")==="done"){console.log(`[AdSense ${a}] Already filled`);return}try{console.log(`[AdSense ${a}] Pushing to adsbygoogle...`),(window.adsbygoogle=window.adsbygoogle||[]).push({}),setTimeout(()=>{const y=p.getAttribute("data-adsbygoogle-status");console.log(`[AdSense ${a}] Status after push:`,y),y==="error"?(console.error(`[AdSense ${a}] AdSense error - check browser console for details`),l(!0)):(!y||y==="unfilled")&&l(!0)},3e3)}catch(y){console.error(`[AdSense ${a}] Push failed:`,y)}})(),()=>{h=!0}},[e,t,n,a,c]),!e||!t?null:c?j.jsx("div",{className:`adsense-anchor adsense-anchor--${a}`,children:j.jsx("div",{className:"adsense-anchor__inner",children:j.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",minHeight:"90px",color:"#999",fontSize:"12px",textAlign:"center",backgroundColor:"rgba(255, 255, 255, 0.8)",padding:"8px 12px",borderRadius:"4px",border:"1px dashed #ccc"},children:[" Ad slot placeholder",j.jsx("br",{}),j.jsx("small",{children:"localhost - deploy to see real ads"})]})})}):j.jsx("div",{className:`adsense-anchor adsense-anchor--${a}`,children:j.jsxs("div",{className:"adsense-anchor__inner",children:[j.jsx("ins",{ref:s,className:"adsbygoogle",style:{display:"block",width:"100%",minHeight:"90px"},"data-ad-client":e,"data-ad-slot":t,"data-ad-format":"auto","data-full-width-responsive":"true",...n?{"data-adtest":"on"}:{}}),o&&j.jsx("div",{style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:"#999",fontSize:"12px",textAlign:"center",pointerEvents:"none",zIndex:1,backgroundColor:"rgba(255, 255, 255, 0.8)",padding:"8px 12px",borderRadius:"4px",border:"1px dashed #ccc"},children:"Ad loading..."})]})})}function VT(){const{subId:a}=Ih(),e=I.useRef(null),t=`/pdfs/${a}.pdf`,[n,s]=I.useState(null),[o,l]=I.useState(1),[c,h]=I.useState(null),f="ca-pub-3815209599877287",p="1234567890",g="0987654321",y=!0,w=!!p,[b,_]=I.useState(!1),A=!b;function E({numPages:k}){s(k),h(null)}function C(k){console.error("PDF Load Error:",k),console.error("Error details:",{message:k?.message,name:k?.name,stack:k?.stack}),h(`Failed to load PDF: ${a}.pdf. Error: ${k?.message||"Unknown error"}`)}I.useEffect(()=>{const k=e.current;if(!k)return;const N=Q=>(Q.preventDefault(),!1),U=Q=>{if((Q.ctrlKey||Q.metaKey)&&Q.key==="p"||(Q.ctrlKey||Q.metaKey)&&Q.key==="s"||Q.ctrlKey&&Q.shiftKey&&(Q.key==="I"||Q.key==="J")||Q.ctrlKey&&Q.key==="U"||Q.key==="F12"||Q.key==="PrintScreen")return Q.preventDefault(),!1},z=Q=>(Q.preventDefault(),!1),V=Q=>(Q.preventDefault(),!1),q=Q=>(Q.preventDefault(),!1),ue=Q=>(Q.preventDefault(),!1);return k.addEventListener("contextmenu",N),k.addEventListener("keydown",U),k.addEventListener("selectstart",z),k.addEventListener("dragstart",V),k.addEventListener("copy",q),k.addEventListener("cut",ue),document.addEventListener("contextmenu",N),document.addEventListener("keydown",U),()=>{k.removeEventListener("contextmenu",N),k.removeEventListener("keydown",U),k.removeEventListener("selectstart",z),k.removeEventListener("dragstart",V),k.removeEventListener("copy",q),k.removeEventListener("cut",ue),document.removeEventListener("contextmenu",N),document.removeEventListener("keydown",U)}},[]),I.useEffect(()=>{const k=()=>{const N=document.querySelector("header");N&&document.documentElement.style.setProperty("--app-header-height",`${N.offsetHeight}px`)};return k(),window.addEventListener("resize",k),()=>window.removeEventListener("resize",k)},[]),I.useEffect(()=>{const k=document.querySelector("footer");if(!k)return;const N=new IntersectionObserver(U=>{const z=U[0];_(!!z?.isIntersecting)},{threshold:.01});return N.observe(k),()=>N.disconnect()},[]);const T=()=>{o>1&&l(o-1)},R=()=>{o<n&&l(o+1)},L=k=>{const N=parseInt(k);N>=1&&N<=n&&l(N)};return j.jsxs("div",{className:["pdf-page-wrap",w?"pdf-page-wrap--with-top-ad":"",A?"pdf-page-wrap--with-bottom-ad":""].filter(Boolean).join(" "),ref:e,children:[w&&j.jsx(Im,{position:"top",client:f,slot:p,testMode:y}),A&&j.jsx(Im,{position:"bottom",client:f,slot:g,testMode:y}),j.jsxs("div",{className:"pdf-container",children:[j.jsx("div",{className:"pdf-header",children:j.jsx("div",{children:j.jsx("h1",{className:"pdf-title",children:"PDF Viewer"})})}),j.jsxs("div",{className:"pdf-viewer-box",children:[c?j.jsxs("div",{className:"pdf-error",children:[j.jsx("p",{children:c}),j.jsxs("p",{style:{marginTop:"10px",fontSize:"0.9rem"},children:["Trying to load: ",j.jsx("code",{children:t})]})]}):j.jsx(LT,{file:t,onLoadSuccess:E,onLoadError:C,loading:j.jsx("div",{className:"pdf-loading",children:"Loading PDF..."}),error:j.jsxs("div",{className:"pdf-error",children:[j.jsx("p",{children:"Failed to load PDF. Please try again."}),j.jsxs("p",{style:{marginTop:"10px",fontSize:"0.9rem"},children:["File: ",j.jsx("code",{children:t})]})]}),children:j.jsx("div",{className:"pdf-document",children:j.jsx(zT,{pageNumber:o,scale:1.3,renderTextLayer:!1,renderAnnotationLayer:!1})})}),n&&j.jsxs("div",{className:"pdf-footer-controls",children:[j.jsx("button",{onClick:T,disabled:o===1,className:"pdf-nav-btn",children:"Previous"}),j.jsxs("span",{className:"page-info",children:["Page"," ",j.jsx("input",{type:"number",min:"1",max:n,value:o,onChange:k=>L(k.target.value),className:"page-input"})," ","of ",n]}),j.jsx("button",{onClick:R,disabled:o===n,className:"pdf-nav-btn",children:"Next"})]})]})]})]})}function WT(){const{user:a,loading:e}=I.useContext(Nl),t=Hn();return e?j.jsx("div",{style:{padding:"2rem",textAlign:"center"},children:"Loading..."}):a?j.jsx($m,{}):j.jsx(zm,{to:"/login",replace:!0,state:{from:t}})}function GT(){return j.jsx(sb,{children:j.jsxs(N_,{children:[j.jsx(wn,{path:"/login",element:j.jsx(c1,{})}),j.jsx(wn,{element:j.jsx(WT,{}),children:j.jsxs(wn,{element:j.jsx(l1,{}),children:[j.jsx(wn,{path:"/",element:j.jsx(qg,{mode:"degree"})}),j.jsx(wn,{path:"/diploma",element:j.jsx(qg,{mode:"diploma"})}),j.jsx(wn,{path:"/:mode/semester/:semId",element:j.jsx(Xg,{})}),j.jsx(wn,{path:"/:mode/branch/:branchName",element:j.jsx(a1,{})}),j.jsx(wn,{path:"/:mode/branch/:branchName/semester/:semId",element:j.jsx(Xg,{})}),j.jsx(wn,{path:"/:mode/branch/:branchName/semester/:semId/subject/:subId",element:j.jsx(VT,{})})]})}),j.jsx(wn,{path:"*",element:j.jsx(zm,{to:"/",replace:!0})})]})})}if(typeof window<"u"&&(window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1")){const e=window.fetch;window.fetch=function(...n){const s=typeof n[0]=="string"?n[0]:n[0]?.url||"";return s.includes("googleads.g.doubleclick.net")||s.includes("pagead2.googlesyndication.com")||s.includes("googlesyndication.com")?Promise.reject(new Error("AdSense blocked on localhost")):e.apply(this,n)};const t=XMLHttpRequest.prototype.open;XMLHttpRequest.prototype.open=function(n,s,...o){if(typeof s=="string"&&(s.includes("googleads.g.doubleclick.net")||s.includes("pagead2.googlesyndication.com")||s.includes("googlesyndication.com"))){this.send=function(){};return}return t.apply(this,[n,s,...o])},window.adsbygoogle=window.adsbygoogle||[],window.adsbygoogle.push=function(){}}H0.createRoot(document.getElementById("root")).render(j.jsx(I.StrictMode,{children:j.jsx(s1,{children:j.jsx(GT,{})})}));
